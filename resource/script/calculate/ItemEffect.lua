--------------------------------------------------------------------------
--									--
--									--
--				ItemEffect.lua				--
--									--
--									--
--------------------------------------------------------------------------
print( "Loading ItemEffect.lua" )


function hp_med_min( role , Item ) --[[迷你hp回复药品公式]]--
	--LuaPrint("Enter function hp_med_min() --[[迷你hp回复药品公式]]--") 
	local hp = GetChaAttr( role , ATTR_HP ) 
	local con = Con(role)
	--LG("药品使用", "当前hp = ", hp , "\n" ) 
	if hp <= 0 then --人物死亡时不可使用
		--LuaPrint("人物死后或非法hp值")  
		--LG("药品使用", "人物死后或非法hp值","\n" )  
		return 
	end 
	hp_resume = 20 +con*5 
	hp = hp + hp_resume 
	mxhp = GetChaAttr( role , ATTR_MXHP) 
	if hp > mxhp then --加超过最大hp时返回为最大hp
		 hp = mxhp 
		 --LG("药品使用", "已达hp最大上限", "\n" ) 
	 end 
		--LG("药品使用", "hp回复为", hp ,"\n" ) 
	SetCharaAttr(hp, role, ATTR_HP) 
	--LuaPrint("Out function hp_med_min() --[[迷你hp回复药品公式]]--") 
end 

function hp_med_small(role, Item ) --[[小型血瓶公式]]--
	--LuaPrint("Enter function hp_med_small() --[[小型血瓶公式]]--") 

	local hp = GetChaAttr(role, ATTR_HP)
	local con = Con(role)
	--LG("药品使用", "当前hp = ", hp , "\n" ) 
	if hp <= 0 then 
		--LuaPrint("人物死后或非法hp值")  return 
		--LG("药品使用", "人物死后或非法hp值","\n" )  
	end 
	hp_resume = 20+ con*5  
	hp = hp + hp_resume 
	mxhp = GetChaAttr(role,ATTR_MXHP) 
	if hp > mxhp then --加超过最大hp时返回为最大hp
		hp = mxhp 
		--LG("药品使用", "已达hp最大上限", "\n" ) 
	end 
		--LG("药品使用", "hp回复为", hp ,"\n" ) 
	SetCharaAttr(hp, role, ATTR_HP) 
	--LuaPrint("Out function hp_med_small() --[[小型血瓶公式]]--") 
end 





----[[面包公式]]--————————————————————————————————————————————————————————————————————————————

function ItemUse_BREAD (role, Item ) --[[面包公式]]--
	-- local i = 0 
	-- for i = 1 , 48,1 do 
		-- local item1 =GetChaItem(role , 2, i-1)
		-- if ValidCha(item1)~=0 then
			-- local id = GetItemID(item1)
			-- local roleid = GetRoleID(role)
			-- LG("面包移除物品","角色id为",roleid,"    移除的物品ID为",id)
			-- local j = 0
			-- for j= 1,119,1 do 
				-- local attr = GetItemAttr(item1,j)
				-- if attr~= 0 then 
					-- LG("面包移除物品","该物品的第",j,"号属性值为",attr)
				-- end
				-- if id == 1848 then 
				-- else
				-- RemoveChaItem ( role , id ,99 , 2 , i-1, 2 , 1  )	
				-- end
			-- end
		-- end
	-- end

	local hp = GetChaAttr(role, ATTR_HP) 
	--LG("药品使用", "当前hp = ", hp , "\n" ) 
	if hp <= 0 then 
		--LuaPrint("人物死后或非法hp值")  return 
		--LG("药品使用", "人物死后或非法hp值","\n" )  
	end 
	hp_resume = 80    
	hp = hp + hp_resume 
	mxhp = GetChaAttr(role,ATTR_MXHP) 
	if hp > mxhp then --加超过最大hp时返回为最大hp
		hp = mxhp 
		--LG("药品使用", "已达hp最大上限", "\n" ) 
	end 
		--LG("药品使用", "hp回复为", hp ,"\n" ) 
	SetCharaAttr(hp, role, ATTR_HP) 
	--LuaPrint("Out function hp_med_small() --[[精灵果公式]]--") 
end 

----[[苹果公式]]--————————————————————————————————————————————————————————————————————————————

function ItemUse_APPLE ( role , Item )  --[[苹果公式]]--

	local hp = GetChaAttr(role, ATTR_HP) 
	--LG("药品使用", "当前hp = ", hp , "\n" ) 
	if hp <= 0 then 
		--LuaPrint("人物死后或非法hp值")  return 
		--LG("药品使用", "人物死后或非法hp值","\n" )  
	end 
	hp_resume = 20    
	hp = hp + hp_resume 
	mxhp = GetChaAttr(role,ATTR_MXHP) 
	if hp > mxhp then --加超过最大hp时返回为最大hp
		hp = mxhp 
		--LG("药品使用", "已达hp最大上限", "\n" ) 
	end 
		--LG("药品使用", "hp回复为", hp ,"\n" ) 
	SetCharaAttr(hp, role, ATTR_HP) 
	--LuaPrint("Out function hp_med_small( role )  --[[精灵果公式]]--") 
end 

------[[碗仔翅公式]]--————————————————————————————————————————————————————————————————————————————
--
--function ItemUse_WANZICHI ( role , Item )  --[[碗仔饭公式]]--
--	local hp = GetChaAttr(role, ATTR_HP) 
--	--LG("药品使用", "当前hp = ", hp , "\n" ) 
--	if hp <= 0 then 
--		--LuaPrint("人物死后或非法hp值")  return 
--		--LG("药品使用", "人物死后或非法hp值","\n" )  
--	end 
--	hp_resume = 400    
--	hp = hp + hp_resume 
--	mxhp = GetChaAttr(role,ATTR_MXHP) 
--	if hp > mxhp then --加超过最大hp时返回为最大hp
--		hp = mxhp 
--		--LG("药品使用", "已达hp最大上限", "\n" ) 
--	end 
--		--LG("药品使用", "hp回复为", hp ,"\n" ) 
--	SetCharaAttr(hp, role, ATTR_HP) 
--	--LuaPrint("Out function hp_med_small( role )  --[[精灵果公式]]--") 
--end 
----[[蛋糕公式]]--————————————————————————————————————————————————————————————————————————————

function ItemUse_CAKE ( role , Item )  --[[蛋糕公式]]--

	local hp = GetChaAttr(role, ATTR_HP) 
	--LG("药品使用", "当前hp = ", hp , "\n" ) 
	if hp <= 0 then 
		--LuaPrint("人物死后或非法hp值")  return 
		--LG("药品使用", "人物死后或非法hp值","\n" )  
	end 
	hp_resume = 180   
	hp = hp + hp_resume 
	mxhp = GetChaAttr(role,ATTR_MXHP) 
	if hp > mxhp then --加超过最大hp时返回为最大hp
		hp = mxhp 
		--LG("药品使用", "已达hp最大上限", "\n" ) 
	end 
		--LG("药品使用", "hp回复为", hp ,"\n" ) 
	SetCharaAttr(hp, role, ATTR_HP) 
	--LuaPrint("Out function hp_med_small( role )  --[[精灵果公式]]--") 
end 
--function ItemUse_CAKE ( role )
--	local str = GetChaAttr( role , ATTR_BSTR )
--	local ap = GetChaAttr( role , ATTR_AP )
--	SystemNotice ( role , "力量修改前为"..str )
--	SystemNotice ( role , "属性点修改前应为"..ap )
--	if str <= 5 then 
--		SystemNotice ( role , "你没有足够的点数来洗点,洗点失败" )
--		return
--	end
--	local str_dif = 1
--	local ap_dif = 1
--	str = str - str_dif
--	ap = ap + 1
--	
--	SystemNotice ( role , "力量修改后应为"..str )
--	SystemNotice ( role , "属性点修改后应为"..ap )
--	SetCharaAttr ( str , role , ATTR_BSTR )
--	SetCharaAttr ( ap , role , ATTR_AP )
--end

-- function ItemUse_CAKE ( role )  --[[蛋糕公式]]--
--	local cha = TurnToCha ( cha ) 
--	local x_give = 0 
--	local y_give = 0 
--	local script_count = CheckBagItem ( cha , 887 )					--检查背包中兑换券数量
--	local DiamondId = Roll_DiamondId ( cha )						--随机兑换宝石的种类
--	if script_count >= 1 then 
--		x_del = DelBagItem ( cha , 887 , 1 ) 
--		if x_del == 1 then 
--			x_give = GiveItem ( cha , 0 , DiamondId , 1 , 101 )				--兑换宝石
--
--			y_give = GiveItem ( cha , 0 , 885 , 1 , 101 )					--兑换精炼石
--
--
--		else 
--			SystemNotice ( cha , "无法正确扣除宝石兑换券" ) 
--		end 
--	else 
--		SystemNotice ( cha , "背包内需要一级宝石兑换券才可兑换"  ) 
--	end 
--	if x_give == 1 and y_give ==1 then 
--		return 1 
--	else 
--		return 0 
--	end 
--end 
--
--
--



----[[精灵果公式]]--————————————————————————————————————————————————————————————————————————————

function ItemUse_JLG( role , Item )  --[[精灵果公式]]--

	local hp = GetChaAttr(role, ATTR_HP) 
	--LG("药品使用", "当前hp = ", hp , "\n" ) 
	if hp <= 0 then 
		--LuaPrint("人物死后或非法hp值")  return 
		--LG("药品使用", "人物死后或非法hp值","\n" )  
	end 
	hp_resume = 15   
	hp = hp + hp_resume 
	mxhp = GetChaAttr(role,ATTR_MXHP) 
	if hp > mxhp then --加超过最大hp时返回为最大hp
		hp = mxhp 
		--LG("药品使用", "已达hp最大上限", "\n" ) 
	end 
		--LG("药品使用", "hp回复为", hp ,"\n" ) 
	SetCharaAttr(hp, role, ATTR_HP) 
	--LuaPrint("Out function hp_med_small( role )  --[[精灵果公式]]--") 
end 


function ItemUse_SZ ( role , Item )  --[[沙枣]]--

	local hp = GetChaAttr(role, ATTR_HP) 
	--LG("药品使用", "当前hp = ", hp , "\n" ) 
	if hp <= 0 then 
		--LuaPrint("人物死后或非法hp值")  return 
		--LG("药品使用", "人物死后或非法hp值","\n" )  
	end 
	hp_resume = 20   
	hp = hp + hp_resume 
	mxhp = GetChaAttr(role,ATTR_MXHP) 
	if hp > mxhp then --加超过最大hp时返回为最大hp
		hp = mxhp 
		--LG("药品使用", "已达hp最大上限", "\n" ) 
	end 
		--LG("药品使用", "hp回复为", hp ,"\n" ) 
	SetCharaAttr(hp, role, ATTR_HP) 
	--LuaPrint("Out function hp_med_small( role )  --[[精灵果公式]]--") 
end 



function ItemUse_MG ( role , Item )  --[[蘑菇]]--

	local hp = GetChaAttr(role, ATTR_HP) 
	--LG("药品使用", "当前hp = ", hp , "\n" ) 
	if hp <= 0 then 
		--LuaPrint("人物死后或非法hp值")  return 
		--LG("药品使用", "人物死后或非法hp值","\n" )  
	end 
	hp_resume = 35  
	hp = hp + hp_resume 
	mxhp = GetChaAttr(role,ATTR_MXHP) 
	if hp > mxhp then --加超过最大hp时返回为最大hp
		hp = mxhp 
		--LG("药品使用", "已达hp最大上限", "\n" ) 
	end 
		--LG("药品使用", "hp回复为", hp ,"\n" ) 
	SetCharaAttr(hp, role, ATTR_HP) 
	--LuaPrint("Out function hp_med_small( role )  --[[精灵果公式]]--") 
end 




function ItemUse_MTLG ( role , Item )  --[[曼陀罗果]]--

	local hp = GetChaAttr(role, ATTR_HP) 
	--LG("药品使用", "当前hp = ", hp , "\n" ) 
	if hp <= 0 then 
		--LuaPrint("人物死后或非法hp值")  return 
		--LG("药品使用", "人物死后或非法hp值","\n" )  
	end 
	hp_resume = 40  
	hp = hp + hp_resume 
	mxhp = GetChaAttr(role,ATTR_MXHP) 
	if hp > mxhp then --加超过最大hp时返回为最大hp
		hp = mxhp 
		--LG("药品使用", "已达hp最大上限", "\n" ) 
	end 
		--LG("药品使用", "hp回复为", hp ,"\n" ) 
	SetCharaAttr(hp, role, ATTR_HP) 
	--LuaPrint("Out function hp_med_small( role )  --[[精灵果公式]]--") 
end 


function ItemUse_BG ( role , Item )  --[[冰果]]--

	local hp = GetChaAttr(role, ATTR_HP) 
	--LG("药品使用", "当前hp = ", hp , "\n" ) 
	if hp <= 0 then 
		--LuaPrint("人物死后或非法hp值")  return 
		--LG("药品使用", "人物死后或非法hp值","\n" )  
	end 
	hp_resume = 50 
	hp = hp + hp_resume 
	mxhp = GetChaAttr(role,ATTR_MXHP) 
	if hp > mxhp then --加超过最大hp时返回为最大hp
		hp = mxhp 
		--LG("药品使用", "已达hp最大上限", "\n" ) 
	end 
		--LG("药品使用", "hp回复为", hp ,"\n" ) 
	SetCharaAttr(hp, role, ATTR_HP) 
	--LuaPrint("Out function hp_med_small( role )  --[[精灵果公式]]--") 
end 



function ItemUse_WCG( role , Item )  --[[五彩果]]--

	local hp = GetChaAttr(role, ATTR_HP) 
	--LG("药品使用", "当前hp = ", hp , "\n" ) 
	if hp <= 0 then 
		--LuaPrint("人物死后或非法hp值")  return 
		--LG("药品使用", "人物死后或非法hp值","\n" )  
	end 
	hp_resume = 108 
	hp = hp + hp_resume 
	mxhp = GetChaAttr(role,ATTR_MXHP) 
	if hp > mxhp then --加超过最大hp时返回为最大hp
		hp = mxhp 
		--LG("药品使用", "已达hp最大上限", "\n" ) 
	end 
		--LG("药品使用", "hp回复为", hp ,"\n" ) 
	SetCharaAttr(hp, role, ATTR_HP) 
	--LuaPrint("Out function hp_med_small( role )  --[[精灵果公式]]--") 
end 


function ItemUse_JLGZ( role , Item )  --[[精灵果汁]]--

	local hp = GetChaAttr(role, ATTR_HP) 
	--LG("药品使用", "当前hp = ", hp , "\n" ) 
	if hp <= 0 then 
		--LuaPrint("人物死后或非法hp值")  return 
		--LG("药品使用", "人物死后或非法hp值","\n" )  
	end 
	hp_resume = 250 
	
	hp = hp + hp_resume 
	mxhp = GetChaAttr(role,ATTR_MXHP) 
	if hp > mxhp then --加超过最大hp时返回为最大hp
		hp = mxhp 
		--LG("药品使用", "已达hp最大上限", "\n" ) 
	end 
		--LG("药品使用", "hp回复为", hp ,"\n" ) 
	SetCharaAttr(hp, role, ATTR_HP) 
	--LuaPrint("Out function hp_med_small( role )  --[[精灵果公式]]--") 
end 

function ItemUse_SZC( role , Item )  --[[沙枣茶]]--

	local hp = GetChaAttr(role, ATTR_HP) 
	--LG("药品使用", "当前hp = ", hp , "\n" ) 
	if hp <= 0 then 
		--LuaPrint("人物死后或非法hp值")  return 
		--LG("药品使用", "人物死后或非法hp值","\n" )  
	end 
	hp_resume = 300
	
	hp = hp + hp_resume 
	mxhp = GetChaAttr(role,ATTR_MXHP) 
	if hp > mxhp then --加超过最大hp时返回为最大hp
		hp = mxhp 
		--LG("药品使用", "已达hp最大上限", "\n" ) 
	end 
		--LG("药品使用", "hp回复为", hp ,"\n" ) 
	SetCharaAttr(hp, role, ATTR_HP) 
	--LuaPrint("Out function hp_med_small( role )  --[[精灵果公式]]--") 
end 



function ItemUse_MGT( role , Item )  --[[蘑菇汤]]--

	local hp = GetChaAttr(role, ATTR_HP) 
	--LG("药品使用", "当前hp = ", hp , "\n" ) 
	if hp <= 0 then 
		--LuaPrint("人物死后或非法hp值")  return 
		--LG("药品使用", "人物死后或非法hp值","\n" )  
	end 
	hp_resume = 350 
	
	hp = hp + hp_resume 
	mxhp = GetChaAttr(role,ATTR_MXHP) 
	if hp > mxhp then --加超过最大hp时返回为最大hp
		hp = mxhp 
		--LG("药品使用", "已达hp最大上限", "\n" ) 
	end 
		--LG("药品使用", "hp回复为", hp ,"\n" ) 
	SetCharaAttr(hp, role, ATTR_HP) 
	--LuaPrint("Out function hp_med_small( role )  --[[精灵果公式]]--") 
end 

function ItemUse_MTLGZ( role , Item )  --[[曼陀罗果汁]]--

	local hp = GetChaAttr(role, ATTR_HP) 
	--LG("药品使用", "当前hp = ", hp , "\n" ) 
	if hp <= 0 then 
		--LuaPrint("人物死后或非法hp值")  return 
		--LG("药品使用", "人物死后或非法hp值","\n" )  
	end 
	hp_resume = 400
	
	hp = hp + hp_resume 
	mxhp = GetChaAttr(role,ATTR_MXHP) 
	if hp > mxhp then --加超过最大hp时返回为最大hp
		hp = mxhp 
		--LG("药品使用", "已达hp最大上限", "\n" ) 
	end 
		--LG("药品使用", "hp回复为", hp ,"\n" ) 
	SetCharaAttr(hp, role, ATTR_HP) 
	--LuaPrint("Out function hp_med_small( role )  --[[精灵果公式]]--") 
end 


function ItemUse_BQL( role , Item )  --[[冰激凌]]--

	local hp = GetChaAttr(role, ATTR_HP) 
	--LG("药品使用", "当前hp = ", hp , "\n" ) 
	if hp <= 0 then 
		--LuaPrint("人物死后或非法hp值")  return 
		--LG("药品使用", "人物死后或非法hp值","\n" )  
	end 
	hp_resume = 450
	
	hp = hp + hp_resume 
	mxhp = GetChaAttr(role,ATTR_MXHP) 
	if hp > mxhp then --加超过最大hp时返回为最大hp
		hp = mxhp 
		--LG("药品使用", "已达hp最大上限", "\n" ) 
	end 
		--LG("药品使用", "hp回复为", hp ,"\n" ) 
	SetCharaAttr(hp, role, ATTR_HP) 
	--LuaPrint("Out function hp_med_small( role )  --[[精灵果公式]]--") 
end 


function ItemUse_WCLLZ( role , Item )  --[[五彩琉璃汁]]--

	local hp = GetChaAttr(role, ATTR_HP) 
	--LG("药品使用", "当前hp = ", hp , "\n" ) 
	if hp <= 0 then 
		--LuaPrint("人物死后或非法hp值")  return 
		--LG("药品使用", "人物死后或非法hp值","\n" )  
	end 
	hp_resume = 500 
	
	hp = hp + hp_resume 
	mxhp = GetChaAttr(role,ATTR_MXHP) 
	if hp > mxhp then --加超过最大hp时返回为最大hp
		hp = mxhp 
		--LG("药品使用", "已达hp最大上限", "\n" ) 
	end 
		--LG("药品使用", "hp回复为", hp ,"\n" ) 
	SetCharaAttr(hp, role, ATTR_HP) 
	--LuaPrint("Out function hp_med_small( role )  --[[精灵果公式]]--") 
end 


function ItemUse_ZHGZ( role , Item )  --[[综合果汁]]--

	local hp = GetChaAttr(role, ATTR_HP) 
	--LG("药品使用", "当前hp = ", hp , "\n" ) 
	if hp <= 0 then 
		--LuaPrint("人物死后或非法hp值")  return 
		--LG("药品使用", "人物死后或非法hp值","\n" )  
	end 
	hp_resume = 550
	
	hp = hp + hp_resume 
	mxhp = GetChaAttr(role,ATTR_MXHP) 
	if hp > mxhp then --加超过最大hp时返回为最大hp
		hp = mxhp 
		--LG("药品使用", "已达hp最大上限", "\n" ) 
	end 
		--LG("药品使用", "hp回复为", hp ,"\n" ) 
	SetCharaAttr(hp, role, ATTR_HP) 
	--LuaPrint("Out function hp_med_small( role )  --[[精灵果公式]]--") 
end 







function ItemUse_YYCY( role , Item )  --[[药用草叶]]--

	local sp = GetChaAttr(role, ATTR_SP) 
	--LG("药品使用", "当前sp = ", sp , "\n" ) 
	sp_resume = 4 
	
	sp = sp + sp_resume 
	mxsp = GetChaAttr(role,ATTR_MXSP) 
	if sp > mxsp then --加超过最大sp时返回为最大sp
		sp = mxsp 
		--LG("药品使用", "已达sp最大上限", "\n" ) 
	end 
		--LG("药品使用", "sp回复为", sp ,"\n" ) 
	SetCharaAttr(sp, role, ATTR_SP) 
end 



function ItemUse_MHHB( role , Item )  --[[梦幻花瓣]]--

	local sp = GetChaAttr(role, ATTR_SP) 
	--LG("药品使用", "当前sp = ", sp , "\n" ) 
	sp_resume = 8 
	
	sp = sp + sp_resume 
	mxsp = GetChaAttr(role,ATTR_MXSP) 
	if sp > mxsp then --加超过最大sp时返回为最大sp
		sp = mxsp 
		--LG("药品使用", "已达sp最大上限", "\n" ) 
	end 
		--LG("药品使用", "sp回复为", sp ,"\n" ) 
	SetCharaAttr(sp, role, ATTR_SP) 
end 



function ItemUse_QYGS( role , Item )  --[[奇异果实]]--

	local sp = GetChaAttr(role, ATTR_SP) 
	--LG("药品使用", "当前sp = ", sp , "\n" ) 
	sp_resume = 18 
	
	sp = sp + sp_resume 
	mxsp = GetChaAttr(role,ATTR_MXSP) 
	if sp > mxsp then --加超过最大sp时返回为最大sp
		sp = mxsp 
		--LG("药品使用", "已达sp最大上限", "\n" ) 
	end 
		--LG("药品使用", "sp回复为", sp ,"\n" ) 
	SetCharaAttr(sp, role, ATTR_SP) 
end 


function ItemUse_BFCY( role , Item )  --[[冰封草芽]]--

	local sp = GetChaAttr(role, ATTR_SP) 
	--LG("药品使用", "当前sp = ", sp , "\n" ) 
	sp_resume = 22 
	
	sp = sp + sp_resume 
	mxsp = GetChaAttr(role,ATTR_MXSP) 
	if sp > mxsp then --加超过最大sp时返回为最大sp
		sp = mxsp 
		--LG("药品使用", "已达sp最大上限", "\n" ) 
	end 
		--LG("药品使用", "sp回复为", sp ,"\n" ) 
	SetCharaAttr(sp, role, ATTR_SP) 
end 


function ItemUse_GCYS( role , Item )  --[[甘草药水]]--

	local sp = GetChaAttr(role, ATTR_SP) 
	--LG("药品使用", "当前sp = ", sp , "\n" ) 
	sp_resume = 33  
	
	sp = sp + sp_resume 
	mxsp = GetChaAttr(role,ATTR_MXSP) 
	if sp > mxsp then --加超过最大sp时返回为最大sp
		sp = mxsp 
		--LG("药品使用", "已达sp最大上限", "\n" ) 
	end 
		--LG("药品使用", "sp回复为", sp ,"\n" ) 
	SetCharaAttr(sp, role, ATTR_SP) 
end 


function ItemUse_XSHC( role , Item )  --[[醒神花茶]]--

	local sp = GetChaAttr(role, ATTR_SP) 
	--LG("药品使用", "当前sp = ", sp , "\n" ) 
	sp_resume = 38 
	
	sp = sp + sp_resume 
	mxsp = GetChaAttr(role,ATTR_MXSP) 
	if sp > mxsp then --加超过最大sp时返回为最大sp
		sp = mxsp 
		--LG("药品使用", "已达sp最大上限", "\n" ) 
	end 
		--LG("药品使用", "sp回复为", sp ,"\n" ) 
	SetCharaAttr(sp, role, ATTR_SP) 
end 


function ItemUse_MZQYG( role , Item )  --[[秘制奇异膏]]--

	local sp = GetChaAttr(role, ATTR_SP) 
	--LG("药品使用", "当前sp = ", sp , "\n" ) 
	sp_resume = 41 
	
	sp = sp + sp_resume 
	mxsp = GetChaAttr(role,ATTR_MXSP) 
	if sp > mxsp then --加超过最大sp时返回为最大sp
		sp = mxsp 
		--LG("药品使用", "已达sp最大上限", "\n" ) 
	end 
		--LG("药品使用", "sp回复为", sp ,"\n" ) 
	SetCharaAttr(sp, role, ATTR_SP) 
end 


function ItemUse_BYS( role , Item )  --[[冰芽酥]]--

	local sp = GetChaAttr(role, ATTR_SP) 
	--LG("药品使用", "当前sp = ", sp , "\n" ) 
	sp_resume = 59 
	
	sp = sp + sp_resume 
	mxsp = GetChaAttr(role,ATTR_MXSP) 
	if sp > mxsp then --加超过最大sp时返回为最大sp
		sp = mxsp 
		--LG("药品使用", "已达sp最大上限", "\n" ) 
	end 
		--LG("药品使用", "sp回复为", sp ,"\n" ) 
	SetCharaAttr(sp, role, ATTR_SP) 
end 


function ItemUse_TMLGZ( role , Item )  --[[提马拉果子]]--

	local sp = GetChaAttr(role, ATTR_SP) 
	--LG("药品使用", "当前sp = ", sp , "\n" ) 
	sp_resume = 100 
	
	sp = sp + sp_resume 
	mxsp = GetChaAttr(role,ATTR_MXSP) 
	if sp > mxsp then --加超过最大sp时返回为最大sp
		sp = mxsp 
		--LG("药品使用", "已达sp最大上限", "\n" ) 
	end 
		--LG("药品使用", "sp回复为", sp ,"\n" ) 
	SetCharaAttr(sp, role, ATTR_SP) 
end 


function ItemUse_SMG( role , Item )  --[[神秘果]]--

	local sp = GetChaAttr(role, ATTR_SP) 
	--LG("药品使用", "当前sp = ", sp , "\n" ) 
	sp_resume = 111 
	
	sp = sp + sp_resume 
	mxsp = GetChaAttr(role,ATTR_MXSP) 
	if sp > mxsp then --加超过最大sp时返回为最大sp
		sp = mxsp 
		--LG("药品使用", "已达sp最大上限", "\n" ) 
	end 
		--LG("药品使用", "sp回复为", sp ,"\n" ) 
	SetCharaAttr(sp, role, ATTR_SP) 
end 



function ItemUse_TSJ( role , Item )  --[[提神剂]]--

	local sp = GetChaAttr(role, ATTR_SP) 
	--LG("药品使用", "当前sp = ", sp , "\n" ) 
	sp_resume = 141 
	
	sp = sp + sp_resume 
	mxsp = GetChaAttr(role,ATTR_MXSP) 
	if sp > mxsp then --加超过最大sp时返回为最大sp
		sp = mxsp 
		--LG("药品使用", "已达sp最大上限", "\n" ) 
	end 
		--LG("药品使用", "sp回复为", sp ,"\n" ) 
	SetCharaAttr(sp, role, ATTR_SP) 
end 



function ItemUse_MHYS( role , Item )  --[[魔幻药水]]--

	local sp = GetChaAttr(role, ATTR_SP) 
	--LG("药品使用", "当前sp = ", sp , "\n" ) 
	sp_resume = 201 
	
	sp = sp + sp_resume 
	mxsp = GetChaAttr(role,ATTR_MXSP) 
	if sp > mxsp then --加超过最大sp时返回为最大sp
		sp = mxsp 
		--LG("药品使用", "已达sp最大上限", "\n" ) 
	end 
		--LG("药品使用", "sp回复为", sp ,"\n" ) 
	SetCharaAttr(sp, role, ATTR_SP) 
end 

function ItemUse_TZCMB ( role , Item )  --[[特制草莓饼]]--

	tempt_monster( role ,  99 )			--招引巨兽

end 











function hp_med_middle( role , Item )  --[[中型血瓶公式]]--

	--LuaPrint("Enter function hp_med_small( role )  --[[中型血瓶公式]]--") 
	local hp = GetChaAttr(role, ATTR_HP) 
	--LG("药品使用", "当前hp = ", hp , "\n" ) 
	if hp <= 0 then 
		--LuaPrint("人物死后或非法hp值")  return 
		--LG("药品使用", "人物死后或非法hp值","\n" )  
	end 
	hp_resume = 800 
	hp = hp + hp_resume 
	mxhp = GetChaAttr(role,ATTR_MXHP) 
	 if hp > mxhp then --加超过最大hp时返回为最大hp
		hp = mxhp 
		--LG("药品使用", "已达hp最大上限", "\n" ) 
	end 
		--LG("药品使用", "hp回复为", hp ,"\n" ) 
	SetCharaAttr(hp, role, ATTR_HP) 
	--LuaPrint("Out function hp_med_small( role )  --[[中型血瓶公式]]--") 
end 

function hp_med_large( role , Item )  --[[大型血瓶公式]]--

	--LuaPrint("Enter function hp_med_small( role )  --[[大型血瓶公式]]--") 
	local hp = GetChaAttr(role, ATTR_HP) 
	--LG("药品使用", "当前hp = ", hp , "\n" ) 
	if hp <= 0 then 
		--LuaPrint("人物死后或非法hp值")  return 
		--LG("药品使用", "人物死后或非法hp值","\n" )  
	end 
	local mxhp = GetChaAttr(role, ATTR_MXHP) 
	hp_resume = 0.2 * mxhp 
	hp = hp + hp_resume 
	mxhp = GetChaAttr(role,ATTR_MXHP) 
	if hp > mxhp then --加超过最大hp时返回为最大hp
		hp = mxhp 
		--LG("药品使用", "已达hp最大上限", "\n" ) 
	end 
	--LG("药品使用", "hp回复为", hp ,"\n" ) 
	SetCharaAttr(hp, role, ATTR_HP) 
	--LuaPrint("Out function hp_med_small( role )  --[[大型血瓶公式]]--") 
end 

function hp_med_super( role , Item )  --[[超级血瓶公式]]--

	--LuaPrint("Enter function hp_med_small( role )  --[[超级血瓶公式]]--") 
	local hp = GetChaAttr(role, ATTR_HP) 
	--LG("药品使用", "当前hp = ", hp , "\n" ) 
	if hp <= 0 then 
		--LuaPrint("人物死后或非法hp值")  return 
		--LG("药品使用", "人物死后或非法hp值","\n" )  
	end 
	local mxhp = GetChaAttr(role, ATTR_MXHP) 
	hp_resume = 0.8 * mxhp  
	hp = hp + hp_resume 
	mxhp = GetChaAttr(role,ATTR_MXHP) 
	if hp > mxhp then --加超过最大hp时返回为最大hp
		hp = mxhp 
		--LG("药品使用", "已达hp最大上限", "\n" ) 
	end 
	--LG("药品使用", "hp回复为", hp ,"\n" ) 
	SetCharaAttr(hp, role, ATTR_HP) 
	--LuaPrint("Out function hp_med_small( role )  --[[超级血瓶公式]]--") 
end 










function Sk_Script_Dpsl ( role , Item ) 											--技能卷轴“盾牌熟练”的使用公式

	local sk_add = SK_DPSL
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 

function Sk_Script_Lzj ( role , Item ) 											--技能卷轴“连珠箭”的使用公式
										
	local sk_add = SK_LZJ  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 


function Sk_Script_Lxjy ( role , Item ) 								--技能卷轴“流星箭雨”的使用公式

	local sk_add = SK_LXJY 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Lh ( role , Item ) 								--技能卷轴“狼嚎”的使用公式

	local sk_add = SK_LH 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 


function Sk_Script_Ssd ( role , Item )  								--技能卷轴“散射弹”的使用公式

	local sk_add = SK_SSD  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 


function Sk_Script_Ctd ( role , Item ) 								--技能卷轴“穿透弹”的使用公式

	local sk_add = SK_CTD 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 


function Sk_Script_Dzy ( role , Item ) 								--技能卷轴“大治愈”的使用公式

	local sk_add = SK_DZY 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 


function Sk_Script_Hx ( role , Item ) 	
	local sk_add = SK_HX 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 


function Sk_Script_Rsd ( role , Item ) 	
	local sk_add =SK_RSD 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 




function Sk_Script_Jssl ( role , Item ) 	
	local sk_add = SK_JSSL 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Gtyz ( role , Item ) 	
	local sk_add = SK_GTYZ 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 


function Sk_Script_Qhtz ( role , Item ) 	
	local sk_add = SK_QHTZ
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 


function Sk_Script_Lqhb ( role , Item ) 	
	local sk_add = SK_LQHB 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Jdzz ( role , Item ) 
	local sk_add = SK_JDZZ 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Hyz ( role , Item ) 			
	local sk_add = SK_HYZ 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	--LG( " learn sk " , " Sk_Script_Hyz ()	: " , "sever 判断返回 = " , a ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Zj ( role , Item ) 		
	local sk_add = SK_ZJ 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 


function Sk_Script_Jjsl ( role , Item ) 	
	local sk_add = SK_JJSL 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 


function Sk_Script_Ymsl ( role , Item )
	local sk_add = SK_YMSL 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Kb ( role , Item ) 
	local sk_add = SK_KB  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	--LG( " learn sk " , " function Sk_Script_Kb ()	: " , "sever 判断返回 = " , a ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Ttcb ( role , Item ) 
	local sk_add = SK_TTCB  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Mnrx ( role , Item ) 
	local sk_add = SK_MNRX 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Swzq ( role , Item ) 
	local sk_add = SK_SWZQ 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Ssjjc ( role , Item ) 	
	local sk_add = SK_FSZ 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Hys ( role , Item ) 		
	local sk_add = SK_HYS  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 


function Sk_Script_Pxkg ( role , Item ) 
	local sk_add = SK_PXKG 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 


function Sk_Script_Qx ( role , Item ) 
	local sk_add = SK_YS  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 


function Sk_Script_Bc ( role , Item ) 
	local sk_add = SK_BC  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Guz ( role , Item ) 
	local sk_add = SK_GWZ 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	--LG( " learn sk " , " function Sk_Script_Guz ()	: " , "sever 判断返回 = " , a ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Db ( role , Item ) 	
	local sk_add = SK_DB  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Mb ( role , Item ) 
	local sk_add = SK_MB  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Shtz ( role , Item )
	local sk_add = SK_SHTZ  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Tzhf ( role , Item )
	local sk_add = SK_TZHF  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Gjsl ( role , Item ) 
	local sk_add = SK_GJSL  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Jfb ( role , Item ) 	
	local sk_add = SK_JFB  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Yy ( role , Item ) 	
	local sk_add = SK_YY 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Hqsl ( role , Item ) 
	local sk_add = SK_HQSL  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Lxjy ( role , Item ) 
	local sk_add = SK_LXJY  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 


function Sk_Script_Dyjj ( role , Item ) 	
	local sk_add = SK_DYJJ 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 


function Sk_Script_Tj ( role , Item ) 	
	local sk_add = SK_TJ 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Sj ( role , Item ) 	
	local sk_add = SK_SJ  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Bt ( role , Item ) 	
	local sk_add = SK_BT  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Jsjc ( role , Item ) 	
	local sk_add = SK_JSJC  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Xzys ( role , Item ) 	
	local sk_add = SK_XZY  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Hfs ( role , Item ) 		
	local sk_add = SK_HFS  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Xlcz ( role , Item )
	local sk_add = SK_XLCZ  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Syzy ( role , Item ) 
	local sk_add = SK_SYZY  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 




function Sk_Script_Dzy( role , Item ) 
	local sk_add = SK_DZY  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 




function Sk_Script_Dhfs ( role , Item ) 
	local sk_add = SK_DHFS  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 


function Sk_Script_Xlzh ( role , Item ) 
	local sk_add = SK_XLZH  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Fzlz ( role , Item ) 
	local sk_add = SK_FZLZ  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Sy ( role , Item ) 
	local sk_add = SK_SY  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Fh ( role , Item )
	local sk_add = SK_FH  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Jsfb ( role , Item ) 
	local sk_add = SK_JSFB  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Tshd ( role , Item ) 
	local sk_add = SK_TSHD  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Xzfy ( role , Item ) 
	local sk_add = SK_XZFY  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Ayzz ( role , Item ) 
	local sk_add = SK_AYZZ 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Zzzh ( role , Item ) 
	local sk_add = SK_ZZZH  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Sdbz ( role , Item ) 
	local sk_add = SK_SDBZ  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Nzs ( role , Item ) 	
	local sk_add = SK_SYNZ  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Xlpz ( role , Item )
	local sk_add = SK_XLPZ 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Hfwq ( role , Item ) 
	local sk_add = SK_HFWQ  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Ks	( role , Item )
	local sk_add = SK_KS  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 
----------------制造
function Sk_Script_ZhiZao( role , Item ) 
	local star_lv=GetItemID(Item)-2678
	local sk_add = SK_ZHIZAO  
	local form_sklv = GetSkillLv( role , sk_add ) 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000001 = GetResString("CALCULATE_ITEMEFFECT_LUA_000001")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000001)
		UseItemFailed ( role )
		return
	end
	if form_sklv ~= star_lv-1  then 
		UseItemFailed ( role )  
		return 
	end 
	local el_sklv = GetSkillLv( role , SK_KS ) 
	if el_sklv <star_lv  then 	
		CALCULATE_ITEMEFFECT_LUA_000002 = GetResString("CALCULATE_ITEMEFFECT_LUA_000002")
		CALCULATE_ITEMEFFECT_LUA_000003 = GetResString("CALCULATE_ITEMEFFECT_LUA_000003")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000003..star_lv..CALCULATE_ITEMEFFECT_LUA_000002 ) 
		UseItemFailed ( role )
		return
	end 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if star_lv==1 and Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000001 = GetResString("CALCULATE_ITEMEFFECT_LUA_000001")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000001)
		UseItemFailed ( role )
		return
	end
	a = AddChaSkill ( role , sk_add, star_lv , 1 , 1 ) 
	if a== 0 then 
		CALCULATE_ITEMEFFECT_LUA_000004 = GetResString("CALCULATE_ITEMEFFECT_LUA_000004")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000004 ) 
		UseItemFailed ( role )  
		return 
	end 
	if star_lv==1 then
		local m1 = -1
		local m2 = -1
		m1, m2 = MakeItem ( role , 1068  , 1 , 4 )
		local Itemfinal = GetChaItem ( role , 2 , m2 )
		SetItemAttr(Itemfinal, ITEMATTR_VAL_STR ,1)--设置工具等级为1
		SetItemAttr(Itemfinal, ITEMATTR_MAXENERGY ,10000)--设置工具最大能量
		SetItemAttr(Itemfinal, ITEMATTR_ENERGY ,1)--设置工具当前能量
	end
end 
----------------铸造
function Sk_Script_ZhuZao( role , Item )
	local star_lv=GetItemID(Item)-2698
	local sk_add = SK_ZHUZAO  
	local form_sklv = GetSkillLv( role , sk_add ) 
	if form_sklv ~= star_lv-1  then 
		UseItemFailed ( role )  
		return 
	end 
	local el_sklv = GetSkillLv( role , SK_WK ) 
	if el_sklv <star_lv  then 	
		CALCULATE_ITEMEFFECT_LUA_000005 = GetResString("CALCULATE_ITEMEFFECT_LUA_000005")
		CALCULATE_ITEMEFFECT_LUA_000003 = GetResString("CALCULATE_ITEMEFFECT_LUA_000003")
		SystemNotice ( role ,  CALCULATE_ITEMEFFECT_LUA_000003..star_lv..CALCULATE_ITEMEFFECT_LUA_000005 ) 
		UseItemFailed ( role )
		return
	end 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if star_lv==1 and Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000001 = GetResString("CALCULATE_ITEMEFFECT_LUA_000001")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000001)
		UseItemFailed ( role )
		return
	end
	a = AddChaSkill ( role , sk_add, star_lv , 1 , 1 ) 
	if a== 0 then 
		CALCULATE_ITEMEFFECT_LUA_000004 = GetResString("CALCULATE_ITEMEFFECT_LUA_000004")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000004 ) 
		UseItemFailed ( role )  
		return 
	end
	if star_lv==1 then
		local m1 = -1
		local m2 = -1
		m1, m2 = MakeItem ( role , 1069  , 1 , 4 )
		local Itemfinal = GetChaItem ( role , 2 , m2 )
		SetItemAttr(Itemfinal, ITEMATTR_VAL_STR ,1)--设置工具等级为1
		SetItemAttr(Itemfinal, ITEMATTR_MAXENERGY ,10000)--设置工具最大能量
		SetItemAttr(Itemfinal, ITEMATTR_ENERGY ,1)--设置工具当前能量
	end
end 
----------------烹饪
function Sk_Script_PengRen( role , Item ) 
	local star_lv=GetItemID(Item)-2688
	local sk_add = SK_PENGREN  
	local form_sklv = GetSkillLv( role , sk_add ) 
	if form_sklv ~= star_lv-1  then 
		UseItemFailed ( role )  
		return 
	end 
	local el_sklv = GetSkillLv( role , SK_BY ) 
	if el_sklv <star_lv  then 	
		CALCULATE_ITEMEFFECT_LUA_000006 = GetResString("CALCULATE_ITEMEFFECT_LUA_000006")
		CALCULATE_ITEMEFFECT_LUA_000003 = GetResString("CALCULATE_ITEMEFFECT_LUA_000003")
		SystemNotice ( role ,  CALCULATE_ITEMEFFECT_LUA_000003..star_lv..CALCULATE_ITEMEFFECT_LUA_000006 ) 
		UseItemFailed ( role )
		return
	end 
	a = AddChaSkill ( role , sk_add, star_lv , 1 , 1 ) 
	if a== 0 then 
		CALCULATE_ITEMEFFECT_LUA_000004 = GetResString("CALCULATE_ITEMEFFECT_LUA_000004")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000004 ) 
		UseItemFailed ( role )  
		return 
	end 
	if star_lv==1 then
		local m1 = -1
		local m2 = -1
		m1, m2 = MakeItem ( role , 1067  , 1 , 4 )
		local Itemfinal = GetChaItem ( role , 2 , m2 )
		SetItemAttr(Itemfinal, ITEMATTR_VAL_STR ,1)--设置工具等级为1
		SetItemAttr(Itemfinal, ITEMATTR_MAXENERGY ,10000)--设置工具最大能量
		SetItemAttr(Itemfinal, ITEMATTR_ENERGY ,1)--设置工具当前能量
	end
end 
----------------分解
function Sk_Script_FenJie( role , Item )
	local star_lv=GetItemID(Item)-2708
	local sk_add = SK_FENJIE  
	local form_sklv = GetSkillLv( role , sk_add ) 
	if form_sklv ~= star_lv-1  then 
		UseItemFailed ( role )  
		return 
	end 
	local el_sklv = GetSkillLv( role , SK_DL ) 
	if el_sklv <star_lv  then 	
		CALCULATE_ITEMEFFECT_LUA_000007 = GetResString("CALCULATE_ITEMEFFECT_LUA_000007")
		CALCULATE_ITEMEFFECT_LUA_000003 = GetResString("CALCULATE_ITEMEFFECT_LUA_000003")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000003..star_lv..CALCULATE_ITEMEFFECT_LUA_000007 ) 
		UseItemFailed ( role )
		return
	end 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if star_lv==1 and Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000001 = GetResString("CALCULATE_ITEMEFFECT_LUA_000001")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000001)
		UseItemFailed ( role )
		return
	end
	a = AddChaSkill ( role , sk_add, star_lv , 1 , 1 ) 
	if a== 0 then 
		CALCULATE_ITEMEFFECT_LUA_000004 = GetResString("CALCULATE_ITEMEFFECT_LUA_000004")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000004 ) 
		UseItemFailed ( role )  
		return 
	end
	if star_lv==1 then
		local m1 = -1
		local m2 = -1
		m1, m2 = MakeItem ( role , 1070  , 1 , 4 )
		local Itemfinal = GetChaItem ( role , 2 , m2 )
		SetItemAttr(Itemfinal, ITEMATTR_VAL_STR ,1)--设置工具等级为1
		SetItemAttr(Itemfinal, ITEMATTR_MAXENERGY ,10000)--设置工具最大能量
		SetItemAttr(Itemfinal, ITEMATTR_ENERGY ,1)--设置工具当前能量
	end
end 
function Sk_Script_Wk	( role , Item ) 
	local sk_add = SK_WK  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 


function Sk_Script_Jr	( role , Item ) 
	local sk_add = SK_JR  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Sl	( role , Item ) 
	local sk_add = SK_SL  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 


function Sk_Script_Bkzj ( role , Item ) 
	local sk_add = SK_BKZJ   
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Jf ( role , Item ) 
	local sk_add = SK_JF   
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 


function Sk_Script_Lj ( role , Item ) 
	local sk_add = SK_LJ    
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 

function Sk_Script_Hzcr ( role , Item ) 
	local sk_add = SK_HZCR     
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 

function Sk_Script_Bkcj ( role , Item ) 
	local sk_add = SK_BKCJ      
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Sf ( role , Item ) 
	local sk_add = SK_SF       
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 



function Sk_Script_Xw ( role , Item ) 
	local sk_add = SK_XW        
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 


function Sk_Script_Mw ( role , Item ) 
	local sk_add = SK_MW        
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 

function Sk_Script_Lm ( role , Item ) 
	local sk_add = SK_LM         
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 

function Sk_Script_Pj ( role , Item ) 
	local sk_add = SK_PJ         
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 

function Sk_Script_Fnq ( role , Item ) 
	local sk_add = SK_FNQ         
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 

function Sk_Script_Bdj ( role , Item )
	local sk_add = SK_BDJ         
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 

function Sk_Script_Dj ( role , Item )
	local sk_add = SK_DJ         
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 

function Sk_Script_Shpf ( role , Item )
	local sk_add = SK_SHPF         
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 

function Sk_Script_Cf ( role , Item )
	local sk_add = SK_CHF         
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end

function Sk_Script_Px ( role , Item )
	local sk_add = SK_PAX         
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end

function Sk_Script_MLCH ( role , Item )
	local sk_add = SK_MLCH         
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end


function Sk_Script_BLYZ ( role , Item )
	local sk_add = SK_BLYZ         
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end


function AddSailSkill ( role , i , sk_add , sailexp_req ) 
	LG ( "AddSailSkill" , "__add a new sailsk________________________ "  ) 

	local form_sklv = GetSkillLv( role , sk_add ) 
	if form_sklv ~= i - 1  then 
		CALCULATE_ITEMEFFECT_LUA_000008 = GetResString("CALCULATE_ITEMEFFECT_LUA_000008")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000008 ) 
		UseItemFailed ( role )  
		return 
	end 

	local sail_exp_remain = GetChaAttr ( role , ATTR_CLEFT_SAILEXP ) 
	if sail_exp_remain < sailexp_req  then 
		CALCULATE_ITEMEFFECT_LUA_000009 = GetResString("CALCULATE_ITEMEFFECT_LUA_000009")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000009 ) 
		UseItemFailed ( role )  
		return 
	end 
	CALCULATE_ITEMEFFECT_LUA_000010 = GetResString("CALCULATE_ITEMEFFECT_LUA_000010")
	CALCULATE_ITEMEFFECT_LUA_000011 = GetResString("CALCULATE_ITEMEFFECT_LUA_000011")
	LG ( "AddSailSkill" , CALCULATE_ITEMEFFECT_LUA_000011 ,  sk_add , CALCULATE_ITEMEFFECT_LUA_000010 , i  ) 
	CALCULATE_ITEMEFFECT_LUA_000012 = GetResString("CALCULATE_ITEMEFFECT_LUA_000012")
	CALCULATE_ITEMEFFECT_LUA_000013 = GetResString("CALCULATE_ITEMEFFECT_LUA_000013")
	LG ( "AddSailSkill" , CALCULATE_ITEMEFFECT_LUA_000013 , sail_exp_remain , CALCULATE_ITEMEFFECT_LUA_000012 , sailexp_req ) 
	sail_exp_remain = sail_exp_remain - sailexp_req 
	CALCULATE_ITEMEFFECT_LUA_000014 = GetResString("CALCULATE_ITEMEFFECT_LUA_000014")
	LG ( "AddSailSkill" , CALCULATE_ITEMEFFECT_LUA_000014 , sail_exp_remain ) 

	SetCharaAttr ( sail_exp_remain , role , ATTR_CLEFT_SAILEXP ) 
	CALCULATE_ITEMEFFECT_LUA_000015 = GetResString("CALCULATE_ITEMEFFECT_LUA_000015")
	SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000015 .. sailexp_req ) 

	a = AddChaSkill ( role , sk_add, 1 , 0 , 0 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 

function Sk_Script_Hpsl1 ( role , Item )
	local i = 1 
	local sk_add = SK_HPSL         
	local sailexp_req = sk_hpsl [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 

end


function Sk_Script_Hpsl2 ( role , Item ) 

	local i = 2 
	local sk_add = SK_HPSL         
	local sailexp_req = sk_hpsl [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end


function Sk_Script_Hpsl3 ( role , Item ) 
	local i = 3 
	local sk_add = SK_HPSL         
	local sailexp_req = sk_hpsl [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Hpsl4 ( role , Item ) 
	local i = 4 
	local sk_add = SK_HPSL         
	local sailexp_req = sk_hpsl [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Hpsl5 ( role , Item ) 
	local i = 5 
	local sk_add = SK_HPSL         
	local sailexp_req = sk_hpsl [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end


function Sk_Script_Hpsl6 ( role , Item ) 
	local i = 6 
	local sk_add = SK_HPSL         
	local sailexp_req = sk_hpsl [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Hpsl7 ( role , Item ) 
	local i = 7 
	local sk_add = SK_HPSL         
	local sailexp_req = sk_hpsl [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Hpsl8 ( role , Item ) 
	local i = 8 
	local sk_add = SK_HPSL         
	local sailexp_req = sk_hpsl [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Hpsl9 ( role , Item ) 
	local i = 9 
	local sk_add = SK_HPSL         
	local sailexp_req = sk_hpsl [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Hpsl10 ( role , Item ) 
	local i = 10 
	local sk_add = SK_HPSL         
	local sailexp_req = sk_hpsl [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Jbjg1 ( role , Item ) 
	local i = 1 
	local sk_add = SK_JBJG         
	local sailexp_req = sk_jbjg [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Jbjg2 ( role , Item ) 
	local i = 2 
	local sk_add = SK_JBJG         
	local sailexp_req = sk_jbjg [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Jbjg3 ( role , Item ) 
	local i = 3 
	local sk_add = SK_JBJG         
	local sailexp_req = sk_jbjg [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Jbjg4 ( role , Item ) 
	local i = 4 
	local sk_add = SK_JBJG         
	local sailexp_req = sk_jbjg [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Jbjg5 ( role , Item ) 
	local i = 5 
	local sk_add = SK_JBJG         
	local sailexp_req = sk_jbjg [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Jbjg6 ( role , Item ) 
	local i = 6 
	local sk_add = SK_JBJG         
	local sailexp_req = sk_jbjg [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Jbjg7 ( role , Item ) 
	local i = 7 
	local sk_add = SK_JBJG         
	local sailexp_req = sk_jbjg [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Jbjg8 ( role , Item ) 
	local i = 8 
	local sk_add = SK_JBJG         
	local sailexp_req = sk_jbjg [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Jbjg9 ( role , Item ) 
	local i = 9 
	local sk_add = SK_JBJG         
	local sailexp_req = sk_jbjg [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Jbjg10 ( role , Item ) 
	local i = 10 
	local sk_add = SK_JBJG         
	local sailexp_req = sk_jbjg [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Cfs1 ( role , Item ) 
	local i = 1 
	local sk_add = SK_CFS         
	local sailexp_req = sk_cfs [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Cfs2 ( role , Item ) 
	local i = 2 
	local sk_add = SK_CFS         
	local sailexp_req = sk_cfs [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Cfs3 ( role , Item ) 
	local i = 3 
	local sk_add = SK_CFS         
	local sailexp_req = sk_cfs [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Cfs4 ( role , Item ) 
	local i = 4 
	local sk_add = SK_CFS         
	local sailexp_req = sk_cfs [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Cfs5 ( role , Item ) 
	local i = 5 
	local sk_add = SK_CFS         
	local sailexp_req = sk_cfs [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Cfs6 ( role , Item ) 
	local i = 6 
	local sk_add = SK_CFS         
	local sailexp_req = sk_cfs [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Cfs7 ( role , Item ) 
	local i = 7 
	local sk_add = SK_CFS         
	local sailexp_req = sk_cfs [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Cfs8 ( role , Item ) 
	local i = 8 
	local sk_add = SK_CFS         
	local sailexp_req = sk_cfs [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Cfs9 ( role , Item ) 
	local i = 9 
	local sk_add = SK_CFS         
	local sailexp_req = sk_cfs [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Cfs10 ( role , Item ) 
	local i = 10 
	local sk_add = SK_CFS         
	local sailexp_req = sk_cfs [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Ctqh1 ( role , Item ) 
	local i = 1 
	local sk_add = SK_CTQH         
	local sailexp_req = sk_ctqh [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Ctqh2 ( role , Item ) 
	local i = 2 
	local sk_add = SK_CTQH         
	local sailexp_req = sk_ctqh [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Ctqh3 ( role , Item ) 
	local i = 3 
	local sk_add = SK_CTQH         
	local sailexp_req = sk_ctqh [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Ctqh4 ( role , Item ) 
	local i = 4 
	local sk_add = SK_CTQH         
	local sailexp_req = sk_ctqh [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 

end

function Sk_Script_Ctqh5 ( role , Item ) 
	local i = 5 
	local sk_add = SK_CTQH         
	local sailexp_req = sk_ctqh [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Ctqh6 ( role , Item ) 
	local i = 6 
	local sk_add = SK_CTQH         
	local sailexp_req = sk_ctqh [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Ctqh7 ( role , Item ) 
	local i = 7 
	local sk_add = SK_CTQH         
	local sailexp_req = sk_ctqh [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Ctqh8 ( role , Item ) 
	local i = 8 
	local sk_add = SK_CTQH         
	local sailexp_req = sk_ctqh [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Ctqh9 ( role , Item ) 
	local i = 9 
	local sk_add = SK_CTQH         
	local sailexp_req = sk_ctqh [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Ctqh10 ( role , Item ) 
	local i = 10 
	local sk_add = SK_CTQH         
	local sailexp_req = sk_ctqh [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Bjkr1 ( role , Item ) 
	local i = 1 
	local sk_add = SK_BJKR         
	local sailexp_req = sk_bjkr [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Bjkr2 ( role , Item ) 
	local i = 2 
	local sk_add = SK_BJKR         
	local sailexp_req = sk_bjkr [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Bjkr3 ( role , Item ) 
	local i = 3 
	local sk_add = SK_BJKR         
	local sailexp_req = sk_bjkr [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Bjkr4 ( role , Item ) 
	local i = 4 
	local sk_add = SK_BJKR         
	local sailexp_req = sk_bjkr [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Bjkr5 ( role , Item ) 
	local i = 5 
	local sk_add = SK_BJKR         
	local sailexp_req = sk_bjkr [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Bjkr6 ( role , Item ) 
	local i = 6 
	local sk_add = SK_BJKR         
	local sailexp_req = sk_bjkr [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Bjkr7 ( role , Item ) 
	local i = 7 
	local sk_add = SK_BJKR         
	local sailexp_req = sk_bjkr [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Bjkr8 ( role , Item ) 
	local i = 8 
	local sk_add = SK_BJKR         
	local sailexp_req = sk_bjkr [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Bjkr9 ( role , Item ) 
	local i = 9 
	local sk_add = SK_BJKR         
	local sailexp_req = sk_bjkr [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_Bjkr10 ( role , Item ) 
	local i = 10 
	local sk_add = SK_BJKR         
	local sailexp_req = sk_bjkr [ i ]  
	AddSailSkill ( role , i , sk_add , sailexp_req ) 
end

function Sk_Script_By ( role , Item )										--技能捕鱼
	local sk_add = SK_BY         
	local form_sklv = GetSkillLv( role , sk_add ) 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end


function Sk_Script_Dl ( role , Item )											--技能打捞
	local sk_add = SK_DL         
	local form_sklv = GetSkillLv( role , sk_add ) 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end

function Sk_Script_Btjn ( role , Item )										---技能摆摊
	local sk_add = SK_BAT         
	local form_sklv = GetSkillLv( role , sk_add ) 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end

function Sk_Script_Pkqx ( role , Item )
	local sk_add = SK_PKQX         
	local form_sklv = GetSkillLv( role , sk_add ) 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end

----回城卷轴-----------------------------------------------------------------------------------------------------------------------------------------

function Jz_Script_hc(role, Item )
	local i = CheckBagItem(role,3141)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3141,1)
			if j == 1 then
				MoveCity(role,"")
				return
			end
		end
	else
		UseItemFailed ( role )
	end
	
end
----白银传送卷轴-------------------------------------------------------------------------------------------------------------------------------------
function Jz_Script_bycs(role, Item )

	local i = CheckBagItem(role,4602)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,4602,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000001 = GetResString("BIRTH_BIRTH_CONF_LUA_000001")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000001)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end
----沙岚传送卷轴--------------------------------------------------------------------------------------------------------------------------------------
function Jz_Script_slcs(role, Item )

	local i = CheckBagItem(role,4603)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,4603,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000003 = GetResString("BIRTH_BIRTH_CONF_LUA_000003")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000003)
				return
			end
		end
	else
		UseItemFailed ( role )
	end

end
----冰狼传送卷轴--------------------------------------------------------------------------------------------------------------------------------------
function Jz_Script_blbcs(role, Item )

	local i = CheckBagItem(role,4604)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end 
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,4604,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000004 = GetResString("BIRTH_BIRTH_CONF_LUA_000004")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000004)
				return
			end
		end
	else
		UseItemFailed ( role )
	end

end
----春风镇送卷轴-------------------------------------------------------------------------------------------------------------------------------------
function Jz_Script_cfzs(role, Item )

	local i = CheckBagItem(role,332)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,332,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000045 = GetResString("BIRTH_BIRTH_CONF_LUA_000045")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000045)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

--木材捆使用效果------------------------------------------------------------------------------------------------------------------

function ItemUse_Wood ( role , Item ) 
	local k = ChaIsBoat ( role ) 
	if k == 0 then 
		UseItemFailed ( role ) 
		CALCULATE_ITEMEFFECT_LUA_000018 = GetResString("CALCULATE_ITEMEFFECT_LUA_000018")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000018 )
		return 
	end 
	local hp = GetChaAttr ( role , ATTR_HP ) 
	local mxhp = GetChaAttr ( role, ATTR_MXHP ) 
	if hp < 0 then 
		UseItemFailed ( role ) 
		CALCULATE_ITEMEFFECT_LUA_000019 = GetResString("CALCULATE_ITEMEFFECT_LUA_000019")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000019 ) 
	end 
	local statelv = 1
	local statetime = 63
	AddState ( role , role , STATE_MCK , statelv , statetime )
	
 

end 

function State_MCK_Add ( role , statelv ) 
	local hpdmg = -100   
	Hp_Endure_Dmg ( role , hpdmg ) 
	ALLExAttrSet(role)  
end 

function State_MCK_Rem ( role , statelv ) 
end

--鱼肉使用效果------------------------------------------------------------------------------------------------------------------

function ItemUse_Fish ( role , Item )
	local k = ChaIsBoat ( role ) 
	if k == 0 then 
		UseItemFailed ( role ) 
		CALCULATE_ITEMEFFECT_LUA_000018 = GetResString("CALCULATE_ITEMEFFECT_LUA_000018")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000018 )
		return 
	end 
	local sp = GetChaAttr ( role , ATTR_SP ) 
	local mxsp = GetChaAttr ( role, ATTR_MXSP ) 
	local hp = GetChaAttr ( role , ATTR_HP ) 
	local mxhp = GetChaAttr ( role, ATTR_MXHP ) 
	if hp < 0 then 
		UseItemFailed ( role ) 
		CALCULATE_ITEMEFFECT_LUA_000019 = GetResString("CALCULATE_ITEMEFFECT_LUA_000019")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000019 ) 
	end 
	local sp_resume = 50 
	sp = math.min ( mxsp , sp + sp_resume  ) 
	SetCharaAttr ( sp , role , ATTR_SP ) 
end 

----月饼使用效果------------------------------------------------------------------------------------------------------------------
function ItemUse_YB ( role , Item )
	local exp = Exp ( role )
	local charLv=Lv ( role )
	local exp_new = 0
	if charLv >= 80 then
		exp_new = exp + 6
	else
		exp_new = exp + 300		
	end
	SetCharaAttr ( exp_new , role , ATTR_CEXP )
end
--华丽宝箱————————————————————————————————————————————————————————————————

function ItemUse_HLBX ( role , Item )
	local item_type = BaoXiang_HLBX 
	local item_type_rad = BaoXiang_HLBX_Rad 
	local item_type_count = BaoXiang_HLBX_Count 
	local maxitem = BaoXiang_HLBX_Mxcount						-- 终结编号
	local item_quality = BaoXiang_HLBX_Qua
	local General = 0  
	local ItemId = 0 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end

	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break 
		end 
		b = d 
	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	--local itemname = GetItemName ( ItemId ) 
	--local cha_name = GetChaDefaultName ( role ) 
	--local message = cha_name.."开启宝箱惊喜地获得"..itemname  
	--Notice ( message )
end 


--神秘宝箱————————————————————————————————————————————————————————————————

function ItemUse_SMBX ( role , Item )
	local item_type = BaoXiang_SMBX 
	local item_type_rad = BaoXiang_SMBX_Rad 
	local item_type_count = BaoXiang_SMBX_Count 
	local maxitem = BaoXiang_SMBX_Mxcount						-- 终结编号
	local item_quality = BaoXiang_SMBX_Qua
	local General = 0  
	local ItemId = 0 
	
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break 
		end 
		b = d 

	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	--local itemname = GetItemName ( ItemId ) 
	--local cha_name = GetChaDefaultName ( role ) 
	--local message = cha_name.."开启宝箱惊喜地获得"..itemname  
	--Notice ( message )
end 


--宠宠宝箱----------------------------------------------------------------

function ItemUse_SYBOX ( role , Item )
	local item_type = BaoXiang_SYBOX 
	local item_type_rad = BaoXiang_SYBOX_Rad 
	local item_type_count = BaoXiang_SYBOX_Count 
	local maxitem = BaoXiang_SYBOX_Mxcount						-- 终结编号
	local item_quality = BaoXiang_SYBOX_Qua
	local General = 0  
	local ItemId = 0 
	
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break 
		end 
		b = d 

	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	 if   ItemId >= 0183 and  ItemId <= 0199   then
	 
		local itemname = GetItemName ( ItemId ) 
		local cha_name = GetChaDefaultName ( role ) 
		CALCULATE_ITEMEFFECT_LUA_000021 = GetResString("CALCULATE_ITEMEFFECT_LUA_000021")
		local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000021..itemname  
 		Notice ( message )
	end
end




----物资箱----------------------------------------------------------------------------------------------

function ItemUse_WZX ( role , Item )
	local item_type = BaoXiang_WZX 
	local item_type_rad = BaoXiang_WZX_Rad 
	local item_type_count = BaoXiang_WZX_Count 
	local maxitem = BaoXiang_WZX_Mxcount						-- 终结编号
	local item_quality = BaoXiang_WZX_Qua
	local General = 0  
	local ItemId = 0 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break 
		end 
		b = d 


	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
--	local itemname = GetItemName ( ItemId ) 
--	local cha_name = GetChaDefaultName ( role ) 
--	local message = cha_name.."开启物资箱惊喜地获得"..itemname  
--	Notice ( message )
end

--骷髅之剑士宝箱————————————————————————————————————————————————————————————————

function ItemUse_KLJS ( role , Item )
	local item_type = BaoXiang_KLJS 
	local item_type_rad = BaoXiang_KLJS_Rad 
	local item_type_count = BaoXiang_KLJS_Count 
	local maxitem = BaoXiang_KLJS_Mxcount						-- 终结编号
	local item_quality = BaoXiang_KLJS_Qua
	local General = 0  
	local ItemId = 0 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break 
		end 
		b = d 

	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000021 = GetResString("CALCULATE_ITEMEFFECT_LUA_000021")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000021..itemname  
	Notice ( message )
end 

--骷髅之猎人宝箱————————————————————————————————————————————————————————————————

function ItemUse_KLLR ( role , Item )
	local item_type = BaoXiang_KLLR 
	local item_type_rad = BaoXiang_KLLR_Rad 
	local item_type_count = BaoXiang_KLLR_Count 
	local maxitem = BaoXiang_KLLR_Mxcount						-- 终结编号
	local item_quality = BaoXiang_KLLR_Qua
	local General = 0  
	local ItemId = 0 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break 
		end 
		b = d 

	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000021 = GetResString("CALCULATE_ITEMEFFECT_LUA_000021")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000021..itemname  
	Notice ( message )
end 

--骷髅之医生宝箱————————————————————————————————————————————————————————————————

function ItemUse_KLYS ( role , Item )
	local item_type = BaoXiang_KLYS 
	local item_type_rad = BaoXiang_KLYS_Rad 
	local item_type_count = BaoXiang_KLYS_Count 
	local maxitem = BaoXiang_KLYS_Mxcount						-- 终结编号
	local item_quality = BaoXiang_KLYS_Qua
	local General = 0  
	local ItemId = 0 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break 
		end 
		b = d 

	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000021 = GetResString("CALCULATE_ITEMEFFECT_LUA_000021")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000021..itemname  
	Notice ( message )
end

--骷髅之冒险者宝箱————————————————————————————————————————————————————————————————

function ItemUse_KLMX ( role , Item )
	local item_type = BaoXiang_KLMX 
	local item_type_rad = BaoXiang_KLMX_Rad 
	local item_type_count = BaoXiang_KLMX_Count 
	local maxitem = BaoXiang_KLMX_Mxcount						-- 终结编号
	local item_quality = BaoXiang_KLMX_Qua
	local General = 0  
	local ItemId = 0 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break 
		end 
		b = d 

	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000021 = GetResString("CALCULATE_ITEMEFFECT_LUA_000021")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000021..itemname  
	Notice ( message )
end


--咒术之双剑士装备箱————————————————————————————————————————————————————————————————

function ItemUse_ZSSJ ( role , Item )
	local item_type = BaoXiang_ZSSJ 
	local item_type_rad = BaoXiang_ZSSJ_Rad 
	local item_type_count = BaoXiang_ZSSJ_Count 
	local maxitem = BaoXiang_ZSSJ_Mxcount						-- 终结编号
	local item_quality = BaoXiang_ZSSJ_Qua
	local General = 0  
	local ItemId = 0 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break 
		end 
		b = d 

	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000021 = GetResString("CALCULATE_ITEMEFFECT_LUA_000021")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000021..itemname  
	Notice ( message )
end

--咒术之巨剑士装备箱————————————————————————————————————————————————————————————————

function ItemUse_ZSJS ( role , Item )
	local item_type = BaoXiang_ZSJS 
	local item_type_rad = BaoXiang_ZSJS_Rad 
	local item_type_count = BaoXiang_ZSJS_Count 
	local maxitem = BaoXiang_ZSJS_Mxcount						-- 终结编号
	local item_quality = BaoXiang_ZSJS_Qua
	local General = 0  
	local ItemId = 0 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break 
		end 
		b = d 

	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000021 = GetResString("CALCULATE_ITEMEFFECT_LUA_000021")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000021..itemname  
	Notice ( message )
end


--咒术之狙击手装备箱————————————————————————————————————————————————————————————————

function ItemUse_ZSJJ ( role , Item )
	local item_type = BaoXiang_ZSJJ
	local item_type_rad = BaoXiang_ZSJJ_Rad 
	local item_type_count = BaoXiang_ZSJJ_Count 
	local maxitem = BaoXiang_ZSJJ_Mxcount						-- 终结编号
	local item_quality = BaoXiang_ZSJJ_Qua
	local General = 0  
	local ItemId = 0 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break 
		end 
		b = d 

	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000021 = GetResString("CALCULATE_ITEMEFFECT_LUA_000021")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000021..itemname  
	Notice ( message )
end


--咒术之圣职者装备箱————————————————————————————————————————————————————————————————

function ItemUse_ZSSZ ( role , Item )
	local item_type = BaoXiang_ZSSZ
	local item_type_rad = BaoXiang_ZSSZ_Rad 
	local item_type_count = BaoXiang_ZSSZ_Count 
	local maxitem = BaoXiang_ZSSZ_Mxcount						-- 终结编号
	local item_quality = BaoXiang_ZSSZ_Qua
	local General = 0  
	local ItemId = 0 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break 
		end 
		b = d 

	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000021 = GetResString("CALCULATE_ITEMEFFECT_LUA_000021")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000021..itemname  
	Notice ( message )
end


--咒术之封印师装备箱————————————————————————————————————————————————————————————————

function ItemUse_ZSFY ( role , Item )
	local item_type = BaoXiang_ZSFY
	local item_type_rad = BaoXiang_ZSFY_Rad 
	local item_type_count = BaoXiang_ZSFY_Count 
	local maxitem = BaoXiang_ZSFY_Mxcount						-- 终结编号
	local item_quality = BaoXiang_ZSFY_Qua
	local General = 0  
	local ItemId = 0 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break 
		end 
		b = d 

	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000021 = GetResString("CALCULATE_ITEMEFFECT_LUA_000021")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000021..itemname  
	Notice ( message )
end


--咒术之航海士装备箱————————————————————————————————————————————————————————————————

function ItemUse_ZSHH ( role , Item )
	local item_type = BaoXiang_ZSHH
	local item_type_rad = BaoXiang_ZSHH_Rad 
	local item_type_count = BaoXiang_ZSHH_Count 
	local maxitem = BaoXiang_ZSHH_Mxcount						-- 终结编号
	local item_quality = BaoXiang_ZSHH_Qua
	local General = 0  
	local ItemId = 0 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break 
		end 
		b = d 
	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000021 = GetResString("CALCULATE_ITEMEFFECT_LUA_000021")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000021..itemname  
	Notice ( message )
end

--幻灵之双剑士装备箱————————————————————————————————————————————————————————————————

function ItemUse_HLSJ ( role , Item )
	local item_type = BaoXiang_HLSJ
	local item_type_rad = BaoXiang_HLSJ_Rad 
	local item_type_count = BaoXiang_HLSJ_Count 
	local maxitem = BaoXiang_HLSJ_Mxcount						-- 终结编号
	local item_quality = BaoXiang_HLSJ_Qua
	local General = 0  
	local ItemId = 0 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break 
		end 
		b = d 
	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000021 = GetResString("CALCULATE_ITEMEFFECT_LUA_000021")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000021..itemname  
	Notice ( message )
end


--幻灵之巨剑士装备箱————————————————————————————————————————————————————————————————

function ItemUse_HLJS ( role , Item )
	local item_type = BaoXiang_HLJS
	local item_type_rad = BaoXiang_HLJS_Rad 
	local item_type_count = BaoXiang_HLJS_Count 
	local maxitem = BaoXiang_HLJS_Mxcount						-- 终结编号
	local item_quality = BaoXiang_HLJS_Qua
	local General = 0  
	local ItemId = 0 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break 
		end 
		b = d 
	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000021 = GetResString("CALCULATE_ITEMEFFECT_LUA_000021")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000021..itemname  
	Notice ( message )
end


--幻灵之狙击手装备箱————————————————————————————————————————————————————————————————

function ItemUse_HLJJ ( role , Item )
	local item_type = BaoXiang_HLJJ
	local item_type_rad = BaoXiang_HLJJ_Rad 
	local item_type_count = BaoXiang_HLJJ_Count 
	local maxitem = BaoXiang_HLJJ_Mxcount						-- 终结编号
	local item_quality = BaoXiang_HLJJ_Qua
	local General = 0  
	local ItemId = 0 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break 
		end 
		b = d 
	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000021 = GetResString("CALCULATE_ITEMEFFECT_LUA_000021")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000021..itemname  
	Notice ( message )
end

--幻灵之圣职者装备箱————————————————————————————————————————————————————————————————

function ItemUse_HLSZ ( role , Item )
	local item_type = BaoXiang_HLSZ
	local item_type_rad = BaoXiang_HLSZ_Rad 
	local item_type_count = BaoXiang_HLSZ_Count 
	local maxitem = BaoXiang_HLSZ_Mxcount						-- 终结编号
	local item_quality = BaoXiang_HLSZ_Qua
	local General = 0  
	local ItemId = 0 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break 
		end 
		b = d 
	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000021 = GetResString("CALCULATE_ITEMEFFECT_LUA_000021")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000021..itemname  
	Notice ( message )
end

--幻灵之封印师装备箱————————————————————————————————————————————————————————————————

function ItemUse_HLFY ( role , Item )
	local item_type = BaoXiang_HLFY
	local item_type_rad = BaoXiang_HLFY_Rad 
	local item_type_count = BaoXiang_HLFY_Count 
	local maxitem = BaoXiang_HLFY_Mxcount						-- 终结编号
	local item_quality = BaoXiang_HLFY_Qua
	local General = 0  
	local ItemId = 0 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break 
		end 
		b = d 
	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000021 = GetResString("CALCULATE_ITEMEFFECT_LUA_000021")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000021..itemname  
	Notice ( message )
end

--幻灵之航海士装备箱————————————————————————————————————————————————————————————————

function ItemUse_HLHH ( role , Item )
	local item_type = BaoXiang_HLHH
	local item_type_rad = BaoXiang_HLHH_Rad 
	local item_type_count = BaoXiang_HLHH_Count 
	local maxitem = BaoXiang_HLHH_Mxcount						-- 终结编号
	local item_quality = BaoXiang_HLHH_Qua
	local General = 0  
	local ItemId = 0 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break 
		end 
		b = d 
	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000021 = GetResString("CALCULATE_ITEMEFFECT_LUA_000021")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000021..itemname  
	Notice ( message )
end

--迷之双剑士装备箱————————————————————————————————————————————————————————————————

function ItemUse_MSJ ( role , Item )
	local item_type = BaoXiang_MSJ
	local item_type_rad = BaoXiang_MSJ_Rad 
	local item_type_count = BaoXiang_MSJ_Count 
	local maxitem = BaoXiang_MSJ_Mxcount						-- 终结编号
	local item_quality = BaoXiang_MSJ_Qua
	local General = 0  
	local ItemId = 0 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break 
		end 
		b = d 
	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000021 = GetResString("CALCULATE_ITEMEFFECT_LUA_000021")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000021..itemname  
	Notice ( message )
end

--迷之巨剑士装备箱————————————————————————————————————————————————————————————————

function ItemUse_MJS ( role , Item )
	local item_type = BaoXiang_MJS
	local item_type_rad = BaoXiang_MJS_Rad 
	local item_type_count = BaoXiang_MJS_Count 
	local maxitem = BaoXiang_MJS_Mxcount						-- 终结编号
	local item_quality = BaoXiang_MJS_Qua
	local General = 0  
	local ItemId = 0 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break 
		end 
		b = d 
	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000021 = GetResString("CALCULATE_ITEMEFFECT_LUA_000021")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000021..itemname  
	Notice ( message )
end


--迷之狙击手装备箱————————————————————————————————————————————————————————————————

function ItemUse_MJJ ( role , Item )
	local item_type = BaoXiang_MJJ
	local item_type_rad = BaoXiang_MJJ_Rad 
	local item_type_count = BaoXiang_MJJ_Count 
	local maxitem = BaoXiang_MJJ_Mxcount						-- 终结编号
	local item_quality = BaoXiang_MJJ_Qua
	local General = 0  
	local ItemId = 0 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break 
		end 
		b = d 
	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000021 = GetResString("CALCULATE_ITEMEFFECT_LUA_000021")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000021..itemname  
	Notice ( message )
end

--迷之圣职者装备箱————————————————————————————————————————————————————————————————

function ItemUse_MSZ ( role , Item )
	local item_type = BaoXiang_MSZ
	local item_type_rad = BaoXiang_MSZ_Rad 
	local item_type_count = BaoXiang_MSZ_Count 
	local maxitem = BaoXiang_MSZ_Mxcount						-- 终结编号
	local item_quality = BaoXiang_MSZ_Qua
	local General = 0  
	local ItemId = 0 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break 
		end 
		b = d 
	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000021 = GetResString("CALCULATE_ITEMEFFECT_LUA_000021")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000021..itemname  
	Notice ( message )
end

--迷之封印师装备箱————————————————————————————————————————————————————————————————

function ItemUse_MFY ( role , Item )
	local item_type = BaoXiang_MFY
	local item_type_rad = BaoXiang_MFY_Rad 
	local item_type_count = BaoXiang_MFY_Count 
	local maxitem = BaoXiang_MFY_Mxcount						-- 终结编号
	local item_quality = BaoXiang_MFY_Qua
	local General = 0  
	local ItemId = 0 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break 
		end 
		b = d 
	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000021 = GetResString("CALCULATE_ITEMEFFECT_LUA_000021")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000021..itemname  
	Notice ( message )
end

--迷之航海士装备箱————————————————————————————————————————————————————————————————

function ItemUse_MHH ( role , Item )
	local item_type = BaoXiang_MHH
	local item_type_rad = BaoXiang_MHH_Rad 
	local item_type_count = BaoXiang_MHH_Count 
	local maxitem = BaoXiang_MHH_Mxcount						-- 终结编号
	local item_quality = BaoXiang_MHH_Qua
	local General = 0  
	local ItemId = 0 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break 
		end 
		b = d 
	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000021 = GetResString("CALCULATE_ITEMEFFECT_LUA_000021")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000021..itemname  
	Notice ( message )
end

--废灵宝箱————————————————————————————————————————————————————————————————

function ItemUse_FLBX ( role , Item )
	local item_type = BaoXiang_FLBX
	local item_type_rad = BaoXiang_FLBX_Rad 
	local item_type_count = BaoXiang_FLBX_Count 
	local maxitem = BaoXiang_FLBX_Mxcount						-- 终结编号
	local item_quality = BaoXiang_FLBX_Qua
	local General = 0  
	local ItemId = 0 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break 
		end 
		b = d 
	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000021 = GetResString("CALCULATE_ITEMEFFECT_LUA_000021")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000021..itemname  
	Notice ( message )
end

--沼泽宝箱————————————————————————————————————————————————————————————————

function ItemUse_ZZBX ( role , Item )
	local item_type = BaoXiang_ZZBX
	local item_type_rad = BaoXiang_ZZBX_Rad 
	local item_type_count = BaoXiang_ZZBX_Count 
	local maxitem = BaoXiang_ZZBX_Mxcount						-- 终结编号
	local item_quality = BaoXiang_ZZBX_Qua
	local General = 0  
	local ItemId = 0 
	
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break 
		end 
		b = d 
	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000021 = GetResString("CALCULATE_ITEMEFFECT_LUA_000021")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000021..itemname  
	Notice ( message )
end

--魔方宝箱————————————————————————————————————————————————————————————————

function ItemUse_MFBX ( role , Item )
	local item_type = BaoXiang_MFBX
	local item_type_rad = BaoXiang_MFBX_Rad 
	local item_type_count = BaoXiang_MFBX_Count 
	local maxitem = BaoXiang_MFBX_Mxcount						-- 终结编号
	local item_quality = BaoXiang_MFBX_Qua
	local General = 0  
	local ItemId = 0 
	
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break 
		end 
		b = d 
	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000021 = GetResString("CALCULATE_ITEMEFFECT_LUA_000021")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000021..itemname  
	Notice ( message )
end


--迷之宝箱-------------------------------------------------------------------------

function ItemUse_MZBX ( role , Item )
	local item_type = BaoXiang_MZBX
	local item_type_rad = BaoXiang_MZBX_Rad 
	local item_type_count = BaoXiang_MZBX_Count 
	local maxitem = BaoXiang_MZBX_Mxcount						-- 终结编号
	local item_quality = BaoXiang_MZBX_Qua
	local General = 0  
	local ItemId = 0 
	
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break 
		end 
		b = d 
	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000021 = GetResString("CALCULATE_ITEMEFFECT_LUA_000021")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000021..itemname  
	Notice ( message )
end


--水雷施放——————————————————————————————————————————————————

function  ItemUse_BOMB ( role , Item ) 
	local bomb = SummonCha ( role , 1 , 704 ) 
	local statetime = 10 
	local statelv = 1 
	AddState ( role , bomb , STATE_BOMB , statelv , statetime ) 
	AddChaSkill ( bomb , SK_BOMB , 1 , 1 , 0 ) 
	CALCULATE_ITEMEFFECT_LUA_000022 = GetResString("CALCULATE_ITEMEFFECT_LUA_000022")
	SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000022 ) 
end 



---PK特殊药品---------------------------------------------------------------------------------------------------

--蛮牛药水--------
function ItemUse_PKMNYS ( role , Item )
	local map_name_role = GetChaMapName ( role )
	local Cha_Boat = 0
		Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000023 = GetResString("CALCULATE_ITEMEFFECT_LUA_000023")
		SystemNotice( Cha_Boat , CALCULATE_ITEMEFFECT_LUA_000023 )
		UseItemFailed ( Cha_Boat )
		return
	end
	local reg = 0
		reg =IsChaInRegion( role, 2 )
	if reg == 1 then
		CALCULATE_ITEMEFFECT_LUA_000024 = GetResString("CALCULATE_ITEMEFFECT_LUA_000024")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000024 )
		UseItemFailed ( role )
		return
	end
	if  map_name_role == "secretgarden" then
	local statelv = 10
	local statetime = 1800
	AddState( role , role , STATE_PKMNYS , statelv , statetime )
	else 
	CALCULATE_ITEMEFFECT_LUA_000025 = GetResString("CALCULATE_ITEMEFFECT_LUA_000025")
	SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000025 )
	UseItemFailed ( role )
	return
	end
end



--战斗药水--------
function ItemUse_PKZDYS ( role , Item )
	local map_name_role = GetChaMapName ( role )
	local Cha_Boat = 0
		Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000023 = GetResString("CALCULATE_ITEMEFFECT_LUA_000023")
		SystemNotice( Cha_Boat , CALCULATE_ITEMEFFECT_LUA_000023 )
		UseItemFailed ( Cha_Boat )
		return
	end
	local reg = 0
		reg =IsChaInRegion( role, 2 )
	if reg == 1 then
		CALCULATE_ITEMEFFECT_LUA_000024 = GetResString("CALCULATE_ITEMEFFECT_LUA_000024")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000024 )
		UseItemFailed ( role )
		return
	end
	if  map_name_role == "secretgarden" then
	local statelv = 10
	local statetime = 150
	AddState( role , role , STATE_PKZDYS , statelv , statetime )
	else 
	CALCULATE_ITEMEFFECT_LUA_000025 = GetResString("CALCULATE_ITEMEFFECT_LUA_000025")
	SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000025 )
	UseItemFailed ( role )
	return
	end
end

--狂暴药水--------
function ItemUse_PKKBYS ( role , Item )
	local map_name_role = GetChaMapName ( role )
	local Cha_Boat = 0
		Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000023 = GetResString("CALCULATE_ITEMEFFECT_LUA_000023")
		SystemNotice( Cha_Boat , CALCULATE_ITEMEFFECT_LUA_000023 )
		UseItemFailed ( Cha_Boat )
		return
	end
	local reg = 0
		reg =IsChaInRegion( role, 2 )
	if reg == 1 then
		CALCULATE_ITEMEFFECT_LUA_000024 = GetResString("CALCULATE_ITEMEFFECT_LUA_000024")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000024 )
		UseItemFailed ( role )
		return
	end
	if  map_name_role == "secretgarden" then
	local statelv = 10
	local statetime = 20
	AddState( role , role , STATE_PKKBYS , statelv , statetime )
	else 
	CALCULATE_ITEMEFFECT_LUA_000025 = GetResString("CALCULATE_ITEMEFFECT_LUA_000025")
	SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000025 )
	UseItemFailed ( role )
	return
	end
end

--精神药水---------
function ItemUse_PKJSYS ( role , Item )
	local map_name_role = GetChaMapName ( role )
	local Cha_Boat = 0
		Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000023 = GetResString("CALCULATE_ITEMEFFECT_LUA_000023")
		SystemNotice( Cha_Boat , CALCULATE_ITEMEFFECT_LUA_000023 )
		UseItemFailed ( Cha_Boat )
		return
	end
	local reg = 0
		reg =IsChaInRegion( role, 2 )
	if reg == 1 then
		CALCULATE_ITEMEFFECT_LUA_000024 = GetResString("CALCULATE_ITEMEFFECT_LUA_000024")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000024 )
		UseItemFailed ( role )
		return
	end
	if  map_name_role == "secretgarden" then
	local statelv = 10
	local statetime = 180
	AddState( role , role , STATE_PKJSYS , statelv , statetime )
	else 
	CALCULATE_ITEMEFFECT_LUA_000025 = GetResString("CALCULATE_ITEMEFFECT_LUA_000025")
	SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000025 )
	UseItemFailed ( role )
	return
	end
end

--石肤药水---------
function ItemUse_PKSFYS ( role , Item )
	local map_name_role = GetChaMapName ( role )
	local Cha_Boat = 0
		Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000023 = GetResString("CALCULATE_ITEMEFFECT_LUA_000023")
		SystemNotice( Cha_Boat , CALCULATE_ITEMEFFECT_LUA_000023 )
		UseItemFailed ( Cha_Boat )
		return
	end
	local reg = 0
		reg =IsChaInRegion( role, 2 )
	if reg == 1 then
		CALCULATE_ITEMEFFECT_LUA_000024 = GetResString("CALCULATE_ITEMEFFECT_LUA_000024")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000024 )
		UseItemFailed ( role )
		return
	end
	if  map_name_role == "secretgarden" then
	local statelv = 10
	local statetime = 300
	AddState( role , role , STATE_PKSFYS , statelv , statetime )
	else 
	CALCULATE_ITEMEFFECT_LUA_000025 = GetResString("CALCULATE_ITEMEFFECT_LUA_000025")
	SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000025 )
	UseItemFailed ( role )
	return
	end	
end

--精准药水--------
function ItemUse_PKJZYS ( role , Item )
	local map_name_role = GetChaMapName ( role )
	local Cha_Boat = 0
		Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000023 = GetResString("CALCULATE_ITEMEFFECT_LUA_000023")
		SystemNotice( Cha_Boat , CALCULATE_ITEMEFFECT_LUA_000023 )
		UseItemFailed ( Cha_Boat )
		return
	end
	local reg = 0
		reg =IsChaInRegion( role, 2 )
	if reg == 1 then
		CALCULATE_ITEMEFFECT_LUA_000024 = GetResString("CALCULATE_ITEMEFFECT_LUA_000024")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000024 )
		UseItemFailed ( role )
		return
	end
	if  map_name_role == "secretgarden" then
	local statelv = 10
	local statetime = 900
	AddState( role , role , STATE_PKJZYS , statelv , statetime )
	else 
	CALCULATE_ITEMEFFECT_LUA_000025 = GetResString("CALCULATE_ITEMEFFECT_LUA_000025")
	SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000025 )
	UseItemFailed ( role )
	return
	end
end

--神佑药水--------
function ItemUse_PKWDYS ( role , Item )
	local map_name_role = GetChaMapName ( role )
	local Cha_Boat = 0
		Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000023 = GetResString("CALCULATE_ITEMEFFECT_LUA_000023")
		SystemNotice( Cha_Boat , CALCULATE_ITEMEFFECT_LUA_000023 )
		UseItemFailed ( Cha_Boat )
		return
	end
	local reg = 0
		reg =IsChaInRegion( role, 2 )
	if reg == 1 then
		CALCULATE_ITEMEFFECT_LUA_000024 = GetResString("CALCULATE_ITEMEFFECT_LUA_000024")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000024 )
		UseItemFailed ( role )
		return
	end
	--if  map_name_role == "guildwar" or map_name_role == "guildwar2" then
	local statelv = 10
	local statetime = 15
	AddState( role , role , STATE_PKWD , statelv , statetime )
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000026 = GetResString("CALCULATE_ITEMEFFECT_LUA_000026")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000026  
	Notice ( message )
	--[[else 
	CALCULATE_ITEMEFFECT_LUA_000027 = GetResString("CALCULATE_ITEMEFFECT_LUA_000027")
	SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000027 )
	UseItemFailed ( role )
	return
	end]]
end

--高级木材捆-------
function ItemUse_PKMCK ( role , Item )

	local map_name = GetChaMapName ( role )	
if map_name == "secretgarden" then
		local hpdmg = -500   
		Hp_Endure_Dmg ( role , hpdmg ) 
		ALLExAttrSet(role)
	else
		CALCULATE_ITEMEFFECT_LUA_000028 = GetResString("CALCULATE_ITEMEFFECT_LUA_000028")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000028 )
	end
end



--------新增商品-------------------------------------------------------------------------------------------
--雷霆堡机票

function Jz_Script_ltcs(role, Item )

	local i = CheckBagItem(role,3828)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end 
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3828,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000002 = GetResString("BIRTH_BIRTH_CONF_LUA_000002")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000002)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end



--雷霆堡军港机票
function Jz_Script_ltjgcs(role, Item )

	local i = CheckBagItem(role,3829)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3829,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000027 = GetResString("BIRTH_BIRTH_CONF_LUA_000027")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000027)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end


--圣雪山机票

function Jz_Script_sxscs(role, Item )

	local i = CheckBagItem(role,3830)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end 
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3830,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000028 = GetResString("BIRTH_BIRTH_CONF_LUA_000028")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000028)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

--赖安森林补给站机票

function Jz_Script_laslcs(role, Item )

	local i = CheckBagItem(role,3831)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3831,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000007 = GetResString("BIRTH_BIRTH_CONF_LUA_000007")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000007)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

--沙泉补给站机票
function Jz_Script_sqcs(role, Item )

	local i = CheckBagItem(role,3832)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3832,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000012 = GetResString("BIRTH_BIRTH_CONF_LUA_000012")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000012)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

--冰极补给站机票

function Jz_Script_bjcs(role, Item )

	local i = CheckBagItem(role,3833)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3833,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000017 = GetResString("BIRTH_BIRTH_CONF_LUA_000017")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000017)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

--寂寞之塔入口机票

function Jz_Script_jmztcs(role, Item )

	local i = CheckBagItem(role,3834)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3834,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000029 = GetResString("BIRTH_BIRTH_CONF_LUA_000029")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000029)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

--沙窟入口机票
function Jz_Script_scrkcs(role, Item )

	local i = CheckBagItem(role,3835)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3835,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000030 = GetResString("BIRTH_BIRTH_CONF_LUA_000030")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000030)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

--废矿2层机票

function Jz_Script_fk2cs(role, Item )

	local i = CheckBagItem(role,3836)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3836,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000031 = GetResString("BIRTH_BIRTH_CONF_LUA_000031")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000031)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

--银矿2层机票

function Jz_Script_yk2cs(role, Item )

	local i = CheckBagItem(role,3837)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3837,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000032 = GetResString("BIRTH_BIRTH_CONF_LUA_000032")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000032)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

--银矿3层机票

function Jz_Script_yk3cs(role, Item )

	local i = CheckBagItem(role,3838)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3838,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000033 = GetResString("BIRTH_BIRTH_CONF_LUA_000033")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000033)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

--寂寞之塔2机票

function Jz_Script_jmzt2cs(role, Item )

	local i = CheckBagItem(role,3839)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3839,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000035 = GetResString("BIRTH_BIRTH_CONF_LUA_000035")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000035)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end
--寂寞之塔3机票

function Jz_Script_jmzt3cs(role, Item )

	local i = CheckBagItem(role,3840)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3840,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000036 = GetResString("BIRTH_BIRTH_CONF_LUA_000036")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000036)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end
--寂寞之塔4机票
function Jz_Script_jmzt4cs(role, Item )

	local i = CheckBagItem(role,3841)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end 
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3841,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000037 = GetResString("BIRTH_BIRTH_CONF_LUA_000037")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000037)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end
--寂寞之塔5机票

function Jz_Script_jmzt5cs(role, Item )

	local i = CheckBagItem(role,3842)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3842,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000038 = GetResString("BIRTH_BIRTH_CONF_LUA_000038")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000038)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end
--寂寞之塔6机票
function Jz_Script_jmzt6cs(role, Item )

	local i = CheckBagItem(role,3843)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3843,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000039 = GetResString("BIRTH_BIRTH_CONF_LUA_000039")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000039)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

--废矿1层机票

function Jz_Script_fk1cs(role, Item )

	local i = CheckBagItem(role,3847)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3847,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000034 = GetResString("BIRTH_BIRTH_CONF_LUA_000034")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000034)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end




--经验果子
function ItemUse_MoreExpGz( role , Item )

	local statelv = 1

	local statetime = 900
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		local ret = UseAexpItem(role,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	else
		local ret = UseAexpItem(Cha_Boat,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	end
end


--组队经验果子
function ItemUse_ZD_MoreExpGz( role , Item )

	local ZDJYstatelv=GetChaStateLv(role,STATE_ZDSBJYGZ)
	if ZDJYstatelv~= 0 then
		CALCULATE_ITEMEFFECT_LUA_000029 = GetResString("CALCULATE_ITEMEFFECT_LUA_000029")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000029 )
		UseItemFailed ( role )
		return
	end
	local statelv = 1

	local statetime = 900
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		AddState( role , role , STATE_ZDSBJYGZ , statelv , statetime )
	else
		AddState( Cha_Boat , Cha_Boat , STATE_ZDSBJYGZ , statelv , statetime )
	end
end


--掉料果子
function ItemUse_MoreItemGz( role , Item )

	local statelv = 1
	local statetime = 900
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ==  nil then
		local ret = UseABLItem(role,Item,statelv,statetime)
		if ret == 0 then
			UseItemFailed ( role )
			return
		end
	else
		local ret = UseABLItem(Cha_Boat,Item,statelv,statetime)
		if ret == 0 then
			UseItemFailed ( role )
			return
		end
	end
end

--经验果子2级
function ItemUse_MoreExpGzLv2( role , Item )

	local Lv = Lv( role )
	if Lv < 40 then
		CALCULATE_ITEMEFFECT_LUA_000030 = GetResString("CALCULATE_ITEMEFFECT_LUA_000030")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000030)
		UseItemFailed ( role )
		return
	end

	local statelv = 4
	local statetime = 900
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		local ret = UseAexpItem(role,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	else
		local ret = UseAexpItem(Cha_Boat,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	end
	CALCULATE_ITEMEFFECT_LUA_000031 = GetResString("CALCULATE_ITEMEFFECT_LUA_000031")
	SystemNotice ( role ,CALCULATE_ITEMEFFECT_LUA_000031 )
end

--掉料果子2级
function ItemUse_MoreItemGzLv2( role , Item )

	local Lv = Lv( role )
	if Lv < 40 then
		CALCULATE_ITEMEFFECT_LUA_000030 = GetResString("CALCULATE_ITEMEFFECT_LUA_000030")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000030)
		UseItemFailed ( role )
		return
	end


	local statelv = 4

	local statetime = 900
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ==  nil then
		local ret = UseABLItem(role,Item,statelv,statetime)
		if ret == 0 then
			UseItemFailed ( role )
			return
		end
	else
		local ret = UseABLItem(Cha_Boat,Item,statelv,statetime)
		if ret == 0 then
			UseItemFailed ( role )
			return
		end
	end
	CALCULATE_ITEMEFFECT_LUA_000032 = GetResString("CALCULATE_ITEMEFFECT_LUA_000032")
	SystemNotice ( role ,CALCULATE_ITEMEFFECT_LUA_000032 )
end

--经验果子3级
function ItemUse_MoreExpGzLv3( role , Item )

	local Lv = Lv( role )
	if Lv < 60 then
		CALCULATE_ITEMEFFECT_LUA_000033 = GetResString("CALCULATE_ITEMEFFECT_LUA_000033")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000033)
		UseItemFailed ( role )
		return
	end

	local statelv = 5
	local statetime = 900
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		local ret = UseAexpItem(role,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	else
		local ret = UseAexpItem(Cha_Boat,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	end
	CALCULATE_ITEMEFFECT_LUA_000034 = GetResString("CALCULATE_ITEMEFFECT_LUA_000034")
	SystemNotice ( role ,CALCULATE_ITEMEFFECT_LUA_000034 )
end

--掉料果子3级
function ItemUse_MoreItemGzLv3( role , Item )

	local Lv = Lv( role )
	if Lv < 60 then
		CALCULATE_ITEMEFFECT_LUA_000033 = GetResString("CALCULATE_ITEMEFFECT_LUA_000033")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000033)
		UseItemFailed ( role )
		return
	end


	local statelv = 5	

	local statetime = 900
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
		if Cha_Boat ==  nil then
		local ret = UseABLItem(role,Item,statelv,statetime)
		if ret == 0 then
			UseItemFailed ( role )
			return
		end
	else
		local ret = UseABLItem(Cha_Boat,Item,statelv,statetime)
		if ret == 0 then
			UseItemFailed ( role )
			return
		end
	end
	CALCULATE_ITEMEFFECT_LUA_000035 = GetResString("CALCULATE_ITEMEFFECT_LUA_000035")
	SystemNotice ( role ,CALCULATE_ITEMEFFECT_LUA_000035 )
end




--奇迹果子
function ItemUse_MoreItemAndExpGz( role , Item )

	local Lv = Lv( role )
	if Lv < 30 then
		CALCULATE_ITEMEFFECT_LUA_000036 = GetResString("CALCULATE_ITEMEFFECT_LUA_000036")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000036)
		UseItemFailed ( role )
		return
	end

	local statelvSB = 2
	local statelvBL = 1
	local statetime = 900
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		local ret = UseABLandSBItem(role,Item,statelvSB,statelvBL,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	else
		local ret = UseABLandSBItem(role,Item,statelvSB,statelvBL,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	end
end

--体力恢复剂
function ItemUse_TLHFJ( role , Item )

	local hp = GetChaAttr(role, ATTR_HP) 
	hp_resume = 800 
	
	hp = hp + hp_resume 
	mxhp = GetChaAttr(role,ATTR_MXHP) 
	if hp > mxhp then --加超过最大sp时返回为最大sp
		hp = mxhp 
	end 
	SetCharaAttr(hp, role, ATTR_HP)
end


-----洗点------------------------------------------------------------------

--力量1点
function ItemUse_XD_Str1 ( role , Item )

	local str = GetChaAttr( role , ATTR_BSTR )
	local ap = GetChaAttr( role , ATTR_AP )
--	SystemNotice ( role , "力量修改前为"..str )
--	SystemNotice ( role , "属性点修改前应为"..ap )
	if str <= 5 then 
		CALCULATE_ITEMEFFECT_LUA_000037 = GetResString("CALCULATE_ITEMEFFECT_LUA_000037")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000037 )
		UseItemFailed ( role )
		return
	end
	local str_dif = 1
	local ap_dif = 1
	str = str - str_dif
	ap = ap + 1

	CALCULATE_ITEMEFFECT_LUA_000038 = GetResString("CALCULATE_ITEMEFFECT_LUA_000038")
	SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000038 )
--	SystemNotice ( role , "力量修改后应为"..str )
--	SystemNotice ( role , "属性点修改后应为"..ap )
	SetCharaAttr ( str , role , ATTR_BSTR )
	SetCharaAttr ( ap , role , ATTR_AP )
end

--体质1点
function ItemUse_XD_Con1 ( role , Item )

	local con = GetChaAttr( role , ATTR_BCON )
	local ap = GetChaAttr( role , ATTR_AP )
--	SystemNotice ( role , "体质修改前为"..con )
--	SystemNotice ( role , "属性点修改前应为"..ap )
	if con <= 5 then 
		CALCULATE_ITEMEFFECT_LUA_000037 = GetResString("CALCULATE_ITEMEFFECT_LUA_000037")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000037 )
		UseItemFailed ( role )
		return
	end
	local con_dif = 1
	local ap_dif = 1
	con = con - con_dif
	ap = ap + 1

	CALCULATE_ITEMEFFECT_LUA_000039 = GetResString("CALCULATE_ITEMEFFECT_LUA_000039")
	SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000039 )
	
--	SystemNotice ( role , "体质修改后应为"..con )
--	SystemNotice ( role , "属性点修改后应为"..ap )
	SetCharaAttr ( con , role , ATTR_BCON )
	SetCharaAttr ( ap , role , ATTR_AP )
end

--敏捷1点
function ItemUse_XD_Agi1 ( role , Item )

	local agi = GetChaAttr( role , ATTR_BAGI )
	local ap = GetChaAttr( role , ATTR_AP )
--	SystemNotice ( role , "敏捷修改前为"..agi )
--	SystemNotice ( role , "属性点修改前应为"..ap )
	if agi <= 5 then 
		CALCULATE_ITEMEFFECT_LUA_000037 = GetResString("CALCULATE_ITEMEFFECT_LUA_000037")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000037 )
		UseItemFailed ( role )
		return
	end
	local agi_dif = 1
	local ap_dif = 1
	agi = agi - agi_dif
	ap = ap + 1

	CALCULATE_ITEMEFFECT_LUA_000040 = GetResString("CALCULATE_ITEMEFFECT_LUA_000040")
	SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000040 )
	
--	SystemNotice ( role , "敏捷修改后应为"..agi )
--	SystemNotice ( role , "属性点修改后应为"..ap )
	SetCharaAttr ( agi , role , ATTR_BAGI )
	SetCharaAttr ( ap , role , ATTR_AP )
end

--专注1点
function ItemUse_XD_Dex1 ( role , Item )

	local dex = GetChaAttr( role , ATTR_BDEX )
	local ap = GetChaAttr( role , ATTR_AP )
--	SystemNotice ( role , "专注修改前为"..dex )
--	SystemNotice ( role , "属性点修改前应为"..ap )
	if dex <= 5 then 
		CALCULATE_ITEMEFFECT_LUA_000037 = GetResString("CALCULATE_ITEMEFFECT_LUA_000037")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000037 )
		UseItemFailed ( role )
		return
	end
	local dex_dif = 1
	local ap_dif = 1
	dex = dex - dex_dif
	ap = ap + 1

	CALCULATE_ITEMEFFECT_LUA_000041 = GetResString("CALCULATE_ITEMEFFECT_LUA_000041")
	SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000041 )
	
--	SystemNotice ( role , "专注修改后应为"..dex )
--	SystemNotice ( role , "属性点修改后应为"..ap )
	SetCharaAttr ( dex , role , ATTR_BDEX )
	SetCharaAttr ( ap , role , ATTR_AP )
end

--精神1点
function ItemUse_XD_Sta1 ( role , Item )

	local sta = GetChaAttr( role , ATTR_BSTA )
	local ap = GetChaAttr( role , ATTR_AP )
--	SystemNotice ( role , "精神修改前为"..sta )
--	SystemNotice ( role , "属性点修改前应为"..ap )
	if sta <= 5 then 
		CALCULATE_ITEMEFFECT_LUA_000037 = GetResString("CALCULATE_ITEMEFFECT_LUA_000037")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000037 )
		UseItemFailed ( role )
		return
	end
	local sta_dif = 1
	local ap_dif = 1
	sta = sta - sta_dif
	ap = ap + 1

	CALCULATE_ITEMEFFECT_LUA_000042 = GetResString("CALCULATE_ITEMEFFECT_LUA_000042")
	SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000042 )
	
--	SystemNotice ( role , "精神修改后应为"..sta )
--	SystemNotice ( role , "属性点修改后应为"..ap )
	SetCharaAttr ( sta , role , ATTR_BSTA )
	SetCharaAttr ( ap , role , ATTR_AP )
end

--商品属性药剂

--灵猴药剂( agi )
function ItemUse_SPLhyj( role , Item )

	local OtherStateLv = 0
	local i = 0
	local State_Num = 3
	local State = {}
	State [0] = GetChaStateLv ( role , STATE_YSLQQH )
	State [1] = GetChaStateLv ( role , STATE_YSTZQH )
	State [2] = GetChaStateLv ( role , STATE_YSJSQH )
	State [3] = GetChaStateLv ( role , STATE_YSLLQH )

	for i = 0 , State_Num , 1 do
		if State[i] >= 1 then
			OtherStateLv = OtherStateLv + 1
		end
	end



	if OtherStateLv > 0 then
		CALCULATE_ITEMEFFECT_LUA_000043 = GetResString("CALCULATE_ITEMEFFECT_LUA_000043")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000043)
		UseItemFailed ( role )
		return
	end
	
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end

	local statelv = 1
	local statetime = 3600
	AddState( role , role , STATE_YSMJQH , statelv , statetime )

end

--鹰眼药剂( dex )
function ItemUse_SPYyyj( role , Item )

	local OtherStateLv = 0
	local i = 0
	local State_Num = 3
	local State = {}
	State [0] = GetChaStateLv ( role , STATE_YSMJQH )
	State [1] = GetChaStateLv ( role , STATE_YSTZQH )
	State [2] = GetChaStateLv ( role , STATE_YSJSQH )
	State [3] = GetChaStateLv ( role , STATE_YSLLQH )

	for i = 0 , State_Num , 1 do
		if State[i] >= 1 then
			OtherStateLv = OtherStateLv + 1
		end
	end



	if OtherStateLv > 0 then
		CALCULATE_ITEMEFFECT_LUA_000043 = GetResString("CALCULATE_ITEMEFFECT_LUA_000043")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000043)
		UseItemFailed ( role )
		return
	end

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end


	local statelv = 1
	local statetime = 3600
	AddState( role , role , STATE_YSLQQH , statelv , statetime )

end

--蛮牛药剂( con )
function ItemUse_SPMnyj( role , Item )

	
	local OtherStateLv = 0
	local i = 0
	local State_Num = 3
	local State = {}
	State [0] = GetChaStateLv ( role , STATE_YSMJQH )
	State [1] = GetChaStateLv ( role , STATE_YSLQQH )
	State [2] = GetChaStateLv ( role , STATE_YSJSQH )
	State [3] = GetChaStateLv ( role , STATE_YSLLQH )

	for i = 0 , State_Num , 1 do
		if State[i] >= 1 then
			OtherStateLv = OtherStateLv + 1
		end
	end



	if OtherStateLv > 0 then
		CALCULATE_ITEMEFFECT_LUA_000043 = GetResString("CALCULATE_ITEMEFFECT_LUA_000043")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000043)
		UseItemFailed ( role )
		return
	end

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end


	local statelv = 1
	local statetime = 3600
	AddState( role , role , STATE_YSTZQH , statelv , statetime )

end

--圣灵药剂( sta )
function ItemUse_SPSlyj( role , Item )
	
	local OtherStateLv = 0
	local i = 0
	local State_Num = 3
	local State = {}
	State [0] = GetChaStateLv ( role , STATE_YSMJQH )
	State [1] = GetChaStateLv ( role , STATE_YSLQQH )
	State [2] = GetChaStateLv ( role , STATE_YSTZQH )
	State [3] = GetChaStateLv ( role , STATE_YSLLQH )

	for i = 0 , State_Num , 1 do
		if State[i] >= 1 then
			OtherStateLv = OtherStateLv + 1
		end
	end


	if OtherStateLv > 0 then
		CALCULATE_ITEMEFFECT_LUA_000043 = GetResString("CALCULATE_ITEMEFFECT_LUA_000043")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000043)
		UseItemFailed ( role )
		return
	end

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end


	local statelv = 1
	local statetime = 3600
	AddState( role , role , STATE_YSJSQH , statelv , statetime )

end

--雄狮药剂( str )
function ItemUse_SPXsyj( role , Item )
	
	local OtherStateLv = 0
	local i = 0
	local State_Num = 3
	local State = {}
	State [0] = GetChaStateLv ( role , STATE_YSMJQH )
	State [1] = GetChaStateLv ( role , STATE_YSLQQH )
	State [2] = GetChaStateLv ( role , STATE_YSTZQH )
	State [3] = GetChaStateLv ( role , STATE_YSJSQH )

	for i = 0 , State_Num , 1 do
		if State[i] >= 1 then
			OtherStateLv = OtherStateLv + 1
		end
	end



	if OtherStateLv > 0 then
		CALCULATE_ITEMEFFECT_LUA_000043 = GetResString("CALCULATE_ITEMEFFECT_LUA_000043")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000043)
		UseItemFailed ( role )
		return
	end	

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end


	local statelv = 1
	local statetime = 3600
	AddState( role , role , STATE_YSLLQH , statelv , statetime )

end


--蓝色锻造果
function ItemUse_LSDZG ( role , Item )

	local statelv = 4
	local statetime = 60
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		AddState( role , role , STATE_JLGLJB , statelv , statetime )
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
end

--红色锻造果

function ItemUse_HSDZG ( role , Item )

	local statelv = 2
	local statetime = 60
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		AddState( role , role , STATE_HCGLJB , statelv , statetime )
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
end

--圣诞道具

--丢失的圣诞帽子

function ItemUse_DSSDM ( role , Item )

	local statelv = 1
	local statetime = 300
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		AddState( role , role , STATE_PKSFYS , statelv , statetime )
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
end

--邪恶之角

function ItemUse_XEZJ ( role , Item )

	local statelv = 1
	local statetime = 1800
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		AddState( role , role , STATE_PKZDYS , statelv , statetime )
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
end

--初级狂战药剂---大幅提高攻击力小幅降低防御力的道具持续时间15分钟
function ItemUse_XEZJB ( role , Item )

	Rem_State_StarUnnormal ( role )
	local statelv = 1
	local statetime = 900
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		Rem_State_StarUnnormal ( role )
		AddState( role , role , STATE_KUANGZ , statelv , statetime )
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
end

--圣诞糖果

function ItemUse_SDTG ( role , Item )
	
	local hp = GetChaAttr(role, ATTR_HP) 
	local sp = GetChaAttr(role, ATTR_SP) 
	
	hp_resume = 30 
	sp_resume = 10
	
	hp = hp + hp_resume 
	sp = sp + sp_resume 

	mxhp = GetChaAttr(role,ATTR_MXHP) 
	mxsp = GetChaAttr(role,ATTR_MXSP) 

	if hp > mxhp then 
		hp = mxhp 
	end 

	if sp > mxsp then 
		sp = mxsp 
	end 

	SetCharaAttr(hp, role, ATTR_HP)
	SetCharaAttr(sp, role, ATTR_SP) 

end

--圣诞袜子

function ItemUse_SDWZBOX ( role , Item )

	local Now_Day = os.date("%d")
	local Now_Month = os.date("%m")
	local Now_Time = os.date("%H")
	local NowTimeNum = tonumber(Now_Time)
	local NowDayNum = tonumber(Now_Day)
	local NowMonthNum = tonumber(Now_Month)
	local CheckDateNum = NowMonthNum * 10000 + NowDayNum * 100 + NowTimeNum
	
	if CheckDateNum < 122423  then
		CALCULATE_ITEMEFFECT_LUA_000045 = GetResString("CALCULATE_ITEMEFFECT_LUA_000045")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000045 )
		UseItemFailed ( role )
		return
	end
	
	if CheckDateNum > 122506 then
		CALCULATE_ITEMEFFECT_LUA_000046 = GetResString("CALCULATE_ITEMEFFECT_LUA_000046")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000046 )
		UseItemFailed ( role )
		return
	end
	local Item_ID = {}
	local Item_Num = {}
	local Item_PZ = {}
	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 3 then
		CALCULATE_ITEMEFFECT_LUA_000047 = GetResString("CALCULATE_ITEMEFFECT_LUA_000047")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000047)
		UseItemFailed ( role )
		return
	end
	
	local role_type = GetChaTypeID ( role )
	local a = math.random ( 1, 100000)
	if a >= 0 and a <= 25000 then
		Item_ID[1] = 2872
		Item_Num[1] = 5
		Item_PZ[1] = 4
	elseif a >= 25001 and a <= 50000 then
		Item_ID[1] = 2873
		Item_Num [1]= 5
		Item_PZ[1] = 4
	elseif a >= 50001 and a <= 55000 then
		if role_type == 1 then
			Item_ID[1] = 5264
			Item_ID[2] = 5265
			Item_ID[3] = 5266
			Item_Num[1] = 1
			Item_Num[2] = 1
			Item_Num[3] = 1
			Item_PZ[1] = 4
			Item_PZ[2] = 4
			Item_PZ[3] = 4
		elseif role_type == 2 then
			Item_ID[1] = 5267
			Item_ID[2] = 5268
			Item_ID[3] = 5269
			Item_Num[1] = 1
			Item_Num[2] = 1
			Item_Num[3] = 1
			Item_PZ[1] = 4
			Item_PZ[2] = 4
			Item_PZ[3] = 4
		elseif role_type == 3 then
			Item_ID[1] = 5270
			Item_ID[2] = 5271
			Item_ID[3] = 5272
			Item_Num[1] = 1
			Item_Num[2] = 1
			Item_Num[3] = 1
			Item_PZ[1] = 4
			Item_PZ[2] = 4
			Item_PZ[3] = 4
		elseif role_type == 4 then
			Item_ID[1] = 5273
			Item_ID[2] = 5274
			Item_ID[3] = 5275
			Item_Num[1] = 1
			Item_Num[2] = 1
			Item_Num[3] = 1
			Item_PZ[1] = 4
			Item_PZ[2] = 4
			Item_PZ[3] = 4
		end
	elseif a >= 55001 and a <= 65000 then
			Item_ID[1] = 2891
			Item_Num[1] = 2
			Item_PZ[1] = 4
	elseif a >= 65001 and a <= 75000 then
			Item_ID[1] = 2888
			Item_Num[1] = 2
			Item_PZ[1] = 4
	elseif a >= 75001 and a <= 85000 then
			Item_ID[1] = 2889
			Item_Num[1] = 2
			Item_PZ[1] = 4
	elseif a >= 85001 and a <= 95000 then
			Item_ID[1] = 2890
			Item_Num[1] = 2
			Item_PZ[1] = 4
	elseif a >= 95001 and a <= 99992 then
			Item_ID[1] = 6294
			Item_Num[1] = 1
			Item_PZ[1] = 4
	else 
			Item_ID[1] = 2877
			Item_Num[1] = 1
			Item_PZ[1] = 4			
	end
	for i = 1, 3, 1 do
		if Item_ID[i] ~= nil and Item_Num[i] ~= nil and Item_PZ[i] ~= nil then
			GiveItem ( role , 0 , Item_ID[i] , Item_Num[i] , Item_PZ[i] )
		end
	end
	-- local Now_Day = os.date("%d")
	-- local Now_Month = os.date("%m")
	-- local Now_Time = os.date("%H")
	-- local NowTimeNum = tonumber(Now_Time)
	-- local NowDayNum = tonumber(Now_Day)
	-- local NowMonthNum = tonumber(Now_Month)
	-- local CheckDateNum = NowMonthNum * 10000 + NowDayNum * 100 + NowTimeNum
	
	-- if CheckDateNum < 122423  then
		-- SystemNotice ( role , "不要着急哦，圣诞老人的礼物是很准时的哦，请在12月24日晚上11点到12月25日早上6点之间使用哦" )
		-- UseItemFailed ( role )
		-- return
	-- end
	
	-- if CheckDateNum > 122506 then
		-- SystemNotice ( role , "圣诞老人好像已经走了，看来只有等待明年了" )
		-- UseItemFailed ( role )
		-- return
	-- end
	
	-- local item_type = BaoXiang_SDWZBOX
	-- local item_type_rad = BaoXiang_SDWZBOX_Rad 
	-- local item_type_count = BaoXiang_SDWZBOX_Count 
	-- local maxitem = BaoXiang_SDWZBOX_Mxcount						-- 终结编号
	-- local item_quality = BaoXiang_SDWZBOX_Qua
	-- local General = 0  
	-- local ItemId = 0 
	
	-- local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	-- if Item_CanGet <= 0 then
		-- SystemNotice(role ,"身上没有足够的空间，宝箱开启失败")
		-- UseItemFailed ( role )
		-- return
	-- end
	-- for i = 1 , maxitem , 1 do 
		-- General = item_type_rad [ i ] + General		
	-- end 
	-- local a = math.random ( 1, General )
	-- local b = 0
	-- local d = 0 
	-- local c = -1							--命中物品编号
	-- for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		-- d = item_type_rad [ k ] + b

		 -- if a <= d and a > b then
			-- c = k

		-- end 
		-- b = d 
	-- end 
	-- if c == -1 then 
		-- ItemId = 3124 
	-- else 
		-- ItemId = item_type [c]  
		-- ItemCount = item_type_count [c] 
	-- end 
	-- GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
end

--圣诞礼盒

function ItemUse_SDLHBOX ( role , Item )

	local Check = math.random ( 1, 100 )
	if Check <= 35 then

		local exp = Exp ( role )
		local exp_dif = math.random ( 100 , 300 )
		if Lv ( TurnToCha ( role )  )  >= 80 then 
			exp_dif = math.floor ( exp_dif / 50  ) 
		end 
		local exp_new = exp + exp_dif
	
		SetCharaAttr ( exp_new , role , ATTR_CEXP )

	elseif Check > 35 and Check <= 70 then
		local Money_add = math.random ( 200 , 600 )
		AddMoney ( role , 0 , Money_add )
	else
		local item_type = BaoXiang_SDLHBOX
		local item_type_rad = BaoXiang_SDLHBOX_Rad 
		local item_type_count = BaoXiang_SDLHBOX_Count 
		local maxitem = BaoXiang_SDLHBOX_Mxcount						-- 终结编号
		local item_quality = BaoXiang_SDLHBOX_Qua
		local General = 0  
		local ItemId = 0 
		
		local Item_CanGet = GetChaFreeBagGridNum ( role )
		
		if Item_CanGet <= 0 then
			CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
			SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
			UseItemFailed ( role )
			return
		end
		for i = 1 , maxitem , 1 do 
			General = item_type_rad [ i ] + General		
		end 
		local a = math.random ( 1, General )
		local b = 0
		local d = 0 
		local c = -1							--命中物品编号
		for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

			d = item_type_rad [ k ] + b

			 if a <= d and a > b then
				c = k

			end 
			b = d 
		end 
		if c == -1 then 
			ItemId = 3124 
		else 
			ItemId = item_type [c]  
			ItemCount = item_type_count [c] 
		end 
		GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	end
end

--好运包
function ItemUse_HYBOX ( role , Item )

--	local Item_CanGet = GetChaFreeBagGridNum ( role )
--	if Item_CanGet <= 1 then
--		SystemNotice(role ,"身上没有足够的空间，好运包开启失败")
--		UseItemFailed ( role )
--		return
--	end
	
	local Money_Add = 8
	local exp_dif = 0
	local exp_random = math.random( 1 , 1000 )
	if exp_random == 1000 then
		Money_Add = 8888
		exp_dif = 66600
	else
		
		exp_dif = math.random ( 2 , 6 )
		exp_dif = exp_dif * 50
	end
	
	local exp = Exp ( role )
	if Lv ( TurnToCha ( role )  )  >= 80 then 
		exp_dif = math.floor ( exp_dif / 50  ) 
	end 
	local exp_new = exp + exp_dif
	
	AddMoney ( role , 0 , Money_Add )
	SetCharaAttr ( exp_new , role , ATTR_CEXP )
	
        local zmbox_random = math.random( 1 , 500 )
        if  zmbox_random == 500 then

	    local item_type = BaoXiang_HYBOX 
	    local item_type_rad = BaoXiang_HYBOX_Rad 
	    local item_type_count = BaoXiang_HYBOX_Count 
	    local maxitem = BaoXiang_HYBOX_Mxcount						-- 终结编号
	    local item_quality = BaoXiang_HYBOX_Qua
	    local General = 0  
	    local ItemId = 0 
	    for i = 1 , maxitem , 1 do 
	  	    General = item_type_rad [ i ] + General		
	    end 
	    local a = math.random ( 1, General )
	    local b = 0
	    local d = 0 
	    local c = -1							--命中物品编号
	    for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		  d = item_type_rad [ k ] + b

		   if a <= d and a > b then
			  c = k
			  break 
		  end 
		  b = d 
	    end 
	    if c == -1 then 
		  ItemId = 3124 
	    else 
		  ItemId = item_type [c]  
	  	  ItemCount = item_type_count [c] 
	    end 
	  GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
       end
	  GiveItem ( role , 0 , 3904 , 1 , 5 ) 
--	local itemname = GetItemName ( ItemId ) 
--	local cha_name = GetChaDefaultName ( role ) 
--	local message = cha_name.."开启好运包惊喜地获得"..itemname  
--	Notice ( message )
end 


--富贵包
function ItemUse_FGBOX ( role , Item )
	
	AddMoney ( role , 0 , 88 )	
	local item_type = BaoXiang_FGBOX 
	local item_type_rad = BaoXiang_FGBOX_Rad 
	local item_type_count = BaoXiang_FGBOX_Count 
	local maxitem = BaoXiang_FGBOX_Mxcount						-- 终结编号
	local item_quality = BaoXiang_FGBOX_Qua
	local General = 0  
	local ItemId = 0 
--	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
--	if Item_CanGet <= 1 then
--		SystemNotice(role ,"身上没有足够的空间，富贵包开启失败")
--		UseItemFailed ( role )
--		return
--	end

	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break
		end 
		b = d 

	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality )
	GiveItem ( role , 0 , 3904 , 1 , item_quality )

	
	if ItemId == 878 then
		local itemname = GetItemName ( ItemId ) 
		local cha_name = GetChaDefaultName ( role ) 
		CALCULATE_ITEMEFFECT_LUA_000048 = GetResString("CALCULATE_ITEMEFFECT_LUA_000048")
		local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000048..itemname  
		Notice ( message )
	end
end 

--鸿运包
function ItemUse_HYUNBOX ( role , Item )
	
	AddMoney ( role , 0 , 888 )
	local item_type = BaoXiang_HYUNBOX 
	local item_type_rad = BaoXiang_HYUNBOX_Rad 
	local item_type_count = BaoXiang_HYUNBOX_Count 
	local maxitem = BaoXiang_HYUNBOX_Mxcount						-- 终结编号
	local item_quality = BaoXiang_HYUNBOX_Qua
	local General = 0  
	local ItemId = 0 
--	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
--	if Item_CanGet <= 1 then
--		SystemNotice(role ,"身上没有足够的空间，鸿运包开启失败")
--		UseItemFailed ( role )
--		return
--	end

	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break		
		end 
		b = d 

	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality )
	GiveItem ( role , 0 , 3904 , 1 , item_quality )

	local GoodItem = {}
	GoodItem[0] = 3844
	GoodItem[1] = 3845
	GoodItem[2] = 899
	GoodItem[3] = 900
	GoodItem[4] = 901
	GoodItem[5] = 902
	GoodItem[6] = 903

	local Good_C = 0
	for Good_C = 0 , 6 , 1 do
		if ItemId == GoodItem[Good_C] then
			local itemname = GetItemName ( ItemId ) 
			local cha_name = GetChaDefaultName ( role ) 
			CALCULATE_ITEMEFFECT_LUA_000049 = GetResString("CALCULATE_ITEMEFFECT_LUA_000049")
			local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000049..itemname  
			Notice ( message )
		end
	end
end 

--暗淡的许愿石
function ItemUse_ADBOX ( role , Item )

	local item_type = BaoXiang_ADBOX 
	local item_type_rad = BaoXiang_ADBOX_Rad 
	local item_type_count = BaoXiang_ADBOX_Count 
	local maxitem = BaoXiang_ADBOX_Mxcount						-- 终结编号
	local item_quality = BaoXiang_ADBOX_Qua
	local General = 0  
	local ItemId = 0 
--	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
--	if Item_CanGet <= 0 then
--		SystemNotice(role ,"身上没有足够的空间，许愿石开启失败")
--		UseItemFailed ( role )
--		return
--	end

	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break
		end 
		b = d 
	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
--	local itemname = GetItemName ( ItemId ) 
--	local cha_name = GetChaDefaultName ( role ) 
--	local message = cha_name.."开启许愿石惊喜地获得"..itemname  
--	Notice ( message )
end 

--闪光的许愿石
function ItemUse_SGBOX ( role , Item )

	local item_type = BaoXiang_SGBOX 
	local item_type_rad = BaoXiang_SGBOX_Rad 
	local item_type_count = BaoXiang_SGBOX_Count 
	local maxitem = BaoXiang_SGBOX_Mxcount						-- 终结编号
	local item_quality = BaoXiang_SGBOX_Qua
	local General = 0  
	local ItemId = 0 
--	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
--	if Item_CanGet <= 0 then
--		SystemNotice(role ,"身上没有足够的空间，许愿石开启失败")
--		UseItemFailed ( role )
--		return
--	end

	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break
		end 
		b = d 
	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
	
	local GoodItem = {}
	
	GoodItem[0] = 879
	GoodItem[1] = 880
	GoodItem[2] = 881
	GoodItem[3] = 882
	GoodItem[4] = 883
	GoodItem[5] = 884
	GoodItem[6] = 885
	GoodItem[7] = 887
	GoodItem[8] = 7
	GoodItem[9] = 42
	GoodItem[10] = 18
	GoodItem[11] = 1375
	GoodItem[12] = 1384
	GoodItem[13] = 1394
	GoodItem[14] = 1411
	GoodItem[15] = 1421
	GoodItem[16] = 4198
	GoodItem[17] = 4200
	GoodItem[18] = 4202
	GoodItem[19] = 4204
	GoodItem[20] = 4206
	GoodItem[21] = 4208
	

	local Good_C = 0
	for Good_C = 0 , 21 , 1 do
		if ItemId == GoodItem[Good_C] then
			local itemname = GetItemName ( ItemId ) 
			local cha_name = GetChaDefaultName ( role ) 
			CALCULATE_ITEMEFFECT_LUA_000050 = GetResString("CALCULATE_ITEMEFFECT_LUA_000050")
			local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000050..itemname  
			Notice ( message )
		end
	end
end 
--精灵礼品盒

--262	Fairy Box
function Eclipse_FairyBox(role,Item)
	local Item_CanGet = GetChaFreeBagGridNum(role)
	if Item_CanGet <= 0 then
		SystemNotice(role, "Insufficient space in inventory!")
		UseItemFailed(role)
		return
	end
	local ItemID = GetItemID(Item)
	local General = 0

	for i = 1 , table.getn(BaoXiang_JingLingBOX), 1 do
		if BaoXiang_JingLingBOX[i].Active == 1 then
			General = BaoXiang_JingLingBOX[i].Rad + General
		end
	end
	local a = math.random(1, General)
	local b = 0
	local d = 0 
	local c = -1
	for k = 1 , table.getn(BaoXiang_JingLingBOX), 1 do
		if BaoXiang_JingLingBOX[k].Active == 1 then
			d = BaoXiang_JingLingBOX[k].Rad + b
			if a <= d and a > b then
				c = k
				break
			end 
			b = d
		end
	end
	if c ~= -1 then
		local FairyID		= BaoXiang_JingLingBOX[c].ItemID 
		local ItemCount		= BaoXiang_JingLingBOX[c].Quantity
		local ItemQuality	= BaoXiang_JingLingBOX[c].Quality
		local GoodItem		= BaoXiang_JingLingBOX[c].GoodItem
		local r1,r2 = MakeItem(role, FairyID, ItemCount, ItemQuality)
		local Fairy = GetChaItem(role, 2, r2)
		local Param	= GetItemForgeParam(Fairy, 1)
		Param = SetNum_Part1(Param, 0)
		SetItemForgeParam(Fairy, 1, Param)
		if GoodItem == 1 then
			local message = ""..GetChaDefaultName(role).." opens a "..GetItemName(ItemID).." and obtains "..GetItemName(FairyID)..""
			Notice(message)
		end
	end
end
function Eclipse_ResetAttrBook(role,Item)
	local Book = {}
	Book[899] = {Attr = ATTR_BSTR, AttrName = "Strength", AttrDefault = 5, AttrRed = 1}			--Book of Strength Reset
	Book[900] = {Attr = ATTR_BCON, AttrName = "Consitution", AttrDefault = 5, AttrRed = 1}		--Book of Consitution Reset
	Book[901] = {Attr = ATTR_BAGI, AttrName = "Agility", AttrDefault = 5, AttrRed = 1}			--Book of Agility Reset
	Book[902] = {Attr = ATTR_BDEX, AttrName = "Accuracy", AttrDefault = 5, AttrRed = 1}			--Book of Accuracy Reset
	Book[903] = {Attr = ATTR_BSTA, AttrName = "Spirit", AttrDefault = 5, AttrRed = 1}			--Book of Spirit Reset
	Book[3109] = {Attr = ATTR_BSTR, AttrName = "Strength", AttrDefault = 5, AttrRed = -2}		--Vial of Strength Reset
	Book[3110] = {Attr = ATTR_BCON, AttrName = "Consitution", AttrDefault = 5, AttrRed = -2}	--Vial of Consitution Reset
	Book[3111] = {Attr = ATTR_BAGI, AttrName = "Agility", AttrDefault = 5, AttrRed = -2}		--Vial of Agility Reset
	Book[3112] = {Attr = ATTR_BDEX, AttrName = "Accuracy", AttrDefault = 5, AttrRed = -2}		--Vial of Accuracy Reset
	Book[3113] = {Attr = ATTR_BSTA, AttrName = "Spirit", AttrDefault = 5, AttrRed = -2}			--Vial of Spirit Reset
	local ItemID = GetItemID(Item)
	if Book[ItemID] ~= nil then
		local Attr = GetChaAttr(role, Book[ItemID].Attr)
		if Attr <= Book[ItemID].AttrDefault then
			SystemNotice(role, "You do not have enough points to reset. Reset failed!")
			UseItemFailed(role)
			return
		end
		if Book[ItemID].AttrRed > 0 then
			local AP = GetChaAttr(role, ATTR_AP)
			Attr = Attr - Book[ItemID].AttrRed
			AP = AP + Book[ItemID].AttrRed
			SystemNotice(role, "Reset "..Book[ItemID].AttrRed.." "..Book[ItemID].AttrName.." point(s)." )
			SetCharaAttr(Attr, role, Book[ItemID].Attr)
			SetCharaAttr(AP, role, ATTR_AP)
		else
			local AP = GetChaAttr(role, ATTR_AP)
			Attr = Attr - Book[ItemID].AttrDefault
			AP = AP + Attr
			SystemNotice(role, "Reset "..Attr.." "..Book[ItemID].AttrName.." point(s)." )
			SetCharaAttr(Book[ItemID].AttrDefault, role, Book[ItemID].Attr)
			SetCharaAttr(AP, role, ATTR_AP)		
		end
		RefreshCha(role)
	end
end
--食神水饺
function ItemUse_SSSJ ( role , Item )

  	local hp = GetChaAttr(role, ATTR_HP) 
	local mxhp = GetChaAttr(role,ATTR_MXHP) 	
	hp = hp + 0.3*mxhp 

	if hp > mxhp then 
		hp = mxhp 
	end 
	SetCharaAttr(hp, role, ATTR_HP)

end




--超级糖葫芦

function ItemUse_CJTHL ( role , Item )
      
	GiveItem ( role , 0 , 3911 , 1 , 5 ) 	
  	local hp = GetChaAttr(role, ATTR_HP) 
	local sp = GetChaAttr(role, ATTR_SP) 
	
	hp_resume = 100 
	sp_resume = 100
	
	hp = hp + hp_resume 
	sp = sp + sp_resume 

	mxhp = GetChaAttr(role,ATTR_MXHP) 
	mxsp = GetChaAttr(role,ATTR_MXSP) 

	if hp > mxhp then 
		hp = mxhp 
	end 

	if sp > mxsp then 
		sp = mxsp 
	end 

	SetCharaAttr(hp, role, ATTR_HP)
	SetCharaAttr(sp, role, ATTR_SP)    


end

--灯笼
function ItemUse_Denglong ( role , Item )

	local statelv = 1
	local statetime = 600
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		AddState( role , role , STATE_DENGLONG , statelv , statetime )
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
end

	
--玫瑰
function ItemUse_MeiGui ( role , Item )

	local statelv = 1
	local statetime = 600
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		AddState( role , role , STATE_MEIGUI , statelv , statetime )
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
end

--爆竹
function ItemUse_BZ ( role , Item )

	local Now_Day = os.date("%d")
	local Now_Month = os.date("%m")
	local Now_Time = os.date("%H")
	local NowTimeNum = tonumber(Now_Time)
	local NowDayNum = tonumber(Now_Day)
	local NowMonthNum = tonumber(Now_Month)
	local CheckDateNum = NowMonthNum * 10000 + NowDayNum * 100 + NowTimeNum
	local Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )

	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
end 


function ItemUse_SaintCloth ( role , Item ) 

	local cha = TurnToCha ( role ) 
	local cha_type = GetChaTypeID ( cha ) 

	local Item_CanGet = GetChaFreeBagGridNum ( cha )

	if Item_CanGet <= 3 then
		CALCULATE_ITEMEFFECT_LUA_000052 = GetResString("CALCULATE_ITEMEFFECT_LUA_000052")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000052)
		UseItemFailed ( role )
		return
	end
	if cha_type == 4 then 
		GiveItem ( cha , 0 , 828 , 1 , 0 )	
	end 
	GiveItem ( cha , 0 , 825 , 1 , 0 )	
	GiveItem ( cha , 0 , 826 , 1 , 0 )	
	GiveItem ( cha , 0 , 827 , 1 , 0 )	
end 


--商城装备宝箱

function ItemUse_SCBoxYXTZ ( role , Item )		--夜行套装

	local cha = TurnToCha ( role ) 
	local cha_type = GetChaTypeID ( cha ) 

	local Item_CanGet = GetChaFreeBagGridNum ( cha )

	if Item_CanGet <= 2 then
		CALCULATE_ITEMEFFECT_LUA_000053 = GetResString("CALCULATE_ITEMEFFECT_LUA_000053")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000053)
		UseItemFailed ( role )
		return
	end

	if cha_type == 1 or cha_type == 3 then
		GiveItem ( cha , 0 , 0395 , 1 , 95 )	
		GiveItem ( cha , 0 , 0587 , 1 , 95 )	
		GiveItem ( cha , 0 , 0747 , 1 , 95 )	
	else
		CALCULATE_ITEMEFFECT_LUA_000054 = GetResString("CALCULATE_ITEMEFFECT_LUA_000054")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000054)
		UseItemFailed ( role )
		return
	end
end

function ItemUse_SCBoxLSTZ ( role , Item )		--力士套装

	local cha = TurnToCha ( role ) 
	local cha_type = GetChaTypeID ( cha ) 

	local Item_CanGet = GetChaFreeBagGridNum ( cha )

	if Item_CanGet <= 3 then
		CALCULATE_ITEMEFFECT_LUA_000055 = GetResString("CALCULATE_ITEMEFFECT_LUA_000055")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000055)
		UseItemFailed ( role )
		return
	end
	if cha_type == 2 then
		GiveItem ( cha , 0 , 0397 , 1 , 95 )
		GiveItem ( cha , 0 , 0829 , 1 , 95 )
		GiveItem ( cha , 0 , 0603 , 1 , 95 )
	else
		CALCULATE_ITEMEFFECT_LUA_000054 = GetResString("CALCULATE_ITEMEFFECT_LUA_000054")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000054)
		UseItemFailed ( role )
		return
	end

end

function ItemUse_SCBoxHYTZ ( role , Item )		--后裔套装

	local cha = TurnToCha ( role ) 
	local cha_type = GetChaTypeID ( cha ) 

	local Item_CanGet = GetChaFreeBagGridNum ( cha )

	if Item_CanGet <= 2 then
		CALCULATE_ITEMEFFECT_LUA_000053 = GetResString("CALCULATE_ITEMEFFECT_LUA_000053")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000053)
		UseItemFailed ( role )
		return
	end

	if cha_type == 1 or cha_type == 3 then
		GiveItem ( cha , 0 , 0399 , 1 , 95 )
		GiveItem ( cha , 0 , 0589 , 1 , 95 )
		GiveItem ( cha , 0 , 0749 , 1 , 95 )
	else
		CALCULATE_ITEMEFFECT_LUA_000054 = GetResString("CALCULATE_ITEMEFFECT_LUA_000054")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000054)
		UseItemFailed ( role )
		return
	end

end

function ItemUse_SCBoxFYSTZ ( role , Item )		--封印职业套装

	local cha = TurnToCha ( role ) 
	local cha_type = GetChaTypeID ( cha ) 

	local Item_CanGet = GetChaFreeBagGridNum ( cha )

	if Item_CanGet <= 3 then
		CALCULATE_ITEMEFFECT_LUA_000056 = GetResString("CALCULATE_ITEMEFFECT_LUA_000056")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000056)
		UseItemFailed ( role )
		return
	end
	
	if cha_type == 3 then
		GiveItem ( cha , 0 , 0401 , 1 , 95 )
		GiveItem ( cha , 0 , 0591 , 1 , 95 )
		GiveItem ( cha , 0 , 0751 , 1 , 95 )
	elseif cha_type == 4 then
		GiveItem ( cha , 0 , 0403 , 1 , 95 )
		GiveItem ( cha , 0 , 0593 , 1 , 95 )
		GiveItem ( cha , 0 , 0753 , 1 , 95 )
		GiveItem ( cha , 0 , 2218 , 1 , 95 )
	else
		CALCULATE_ITEMEFFECT_LUA_000054 = GetResString("CALCULATE_ITEMEFFECT_LUA_000054")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000054)
		UseItemFailed ( role )
		return
	end
	
end

function ItemUse_SCBoxSZZTZ ( role , Item )		--圣职者套装

	local cha = TurnToCha ( role ) 
	local cha_type = GetChaTypeID ( cha ) 

	local Item_CanGet = GetChaFreeBagGridNum ( cha )

	if Item_CanGet <= 3 then
		CALCULATE_ITEMEFFECT_LUA_000056 = GetResString("CALCULATE_ITEMEFFECT_LUA_000056")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000056)
		UseItemFailed ( role )
		return
	end
	
	if cha_type == 3 then
		GiveItem ( cha , 0 , 0405 , 1 , 95 )
		GiveItem ( cha , 0 , 0595 , 1 , 95 )
		GiveItem ( cha , 0 , 0755 , 1 , 95 )
	elseif cha_type == 4 then
		GiveItem ( cha , 0 , 0407 , 1 , 95 )
		GiveItem ( cha , 0 , 0597 , 1 , 95 )
		GiveItem ( cha , 0 , 0757 , 1 , 95 )
		GiveItem ( cha , 0 , 2220 , 1 , 95 )
	else
		CALCULATE_ITEMEFFECT_LUA_000054 = GetResString("CALCULATE_ITEMEFFECT_LUA_000054")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000054)
		UseItemFailed ( role )
		return
	end
end

function ItemUse_SCBoxHHSTZ ( role , Item )		--航海士套装

	local cha = TurnToCha ( role ) 
	local cha_type = GetChaTypeID ( cha ) 

	local Item_CanGet = GetChaFreeBagGridNum ( cha )

	if Item_CanGet <= 3 then
		CALCULATE_ITEMEFFECT_LUA_000056 = GetResString("CALCULATE_ITEMEFFECT_LUA_000056")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000056)
		UseItemFailed ( role )
		return
	end
	
	if cha_type == 1 or cha_type == 3 then
		GiveItem ( cha , 0 , 0409 , 1 , 95 )
		GiveItem ( cha , 0 , 0599 , 1 , 95 )
		GiveItem ( cha , 0 , 0759 , 1 , 95 )
	elseif cha_type == 4 then
		GiveItem ( cha , 0 , 0412 , 1 , 95 )
		GiveItem ( cha , 0 , 0601 , 1 , 95 )
		GiveItem ( cha , 0 , 0761 , 1 , 95 )
		GiveItem ( cha , 0 , 2222 , 1 , 95 )
	else
		CALCULATE_ITEMEFFECT_LUA_000054 = GetResString("CALCULATE_ITEMEFFECT_LUA_000054")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000054)
		UseItemFailed ( role )
		return
	end
end


function ItemUse_SCBoxRYBZ ( role , Item )		--如意宝杖

	local cha = TurnToCha ( role ) 
	local cha_type = GetChaTypeID ( cha ) 

	local Item_CanGet = GetChaFreeBagGridNum ( cha )

	if Item_CanGet == 0 then
		CALCULATE_ITEMEFFECT_LUA_000057 = GetResString("CALCULATE_ITEMEFFECT_LUA_000057")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000057)
		UseItemFailed ( role )
		return
	end

	GiveItem ( cha , 0 , 0109 , 1 , 95 )
end

function ItemUse_SCBoxXMC ( role , Item )		--降魔杵

	local cha = TurnToCha ( role ) 
	local cha_type = GetChaTypeID ( cha ) 

	local Item_CanGet = GetChaFreeBagGridNum ( cha )

	if Item_CanGet == 0 then
		CALCULATE_ITEMEFFECT_LUA_000057 = GetResString("CALCULATE_ITEMEFFECT_LUA_000057")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000057)
		UseItemFailed ( role )
		return
	end

	GiveItem ( cha , 0 , 0111 , 1 , 95 )
end

function ItemUse_SCBoxLQJ ( role , Item )		--龙泉剑

	local cha = TurnToCha ( role ) 
	local cha_type = GetChaTypeID ( cha ) 

	local Item_CanGet = GetChaFreeBagGridNum ( cha )

	if Item_CanGet == 0 then
		CALCULATE_ITEMEFFECT_LUA_000057 = GetResString("CALCULATE_ITEMEFFECT_LUA_000057")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000057)
		UseItemFailed ( role )
		return
	end

	GiveItem ( cha , 0 , 0113 , 1 , 95 )
end

function ItemUse_SCBoxLYJ ( role , Item )		--裂岩剑

	local cha = TurnToCha ( role ) 
	local cha_type = GetChaTypeID ( cha ) 

	local Item_CanGet = GetChaFreeBagGridNum ( cha )

	if Item_CanGet == 0 then
		CALCULATE_ITEMEFFECT_LUA_000057 = GetResString("CALCULATE_ITEMEFFECT_LUA_000057")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000057)
		UseItemFailed ( role )
		return
	end

	GiveItem ( cha , 0 , 0115 , 1 , 95 )
end

function ItemUse_SCBoxFHG ( role , Item )		--飞虹

	local cha = TurnToCha ( role ) 
	local cha_type = GetChaTypeID ( cha ) 

	local Item_CanGet = GetChaFreeBagGridNum ( cha )

	if Item_CanGet == 0 then
		CALCULATE_ITEMEFFECT_LUA_000057 = GetResString("CALCULATE_ITEMEFFECT_LUA_000057")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000057)
		UseItemFailed ( role )
		return
	end

	GiveItem ( cha , 0 , 0117 , 1 , 95 )
end

function ItemUse_SCBoxLXHZ ( role , Item )		--流星火珠

	local cha = TurnToCha ( role ) 
	local cha_type = GetChaTypeID ( cha ) 

	local Item_CanGet = GetChaFreeBagGridNum ( cha )

	if Item_CanGet == 0 then
		CALCULATE_ITEMEFFECT_LUA_000057 = GetResString("CALCULATE_ITEMEFFECT_LUA_000057")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000057)
		UseItemFailed ( role )
		return
	end

	GiveItem ( cha , 0 , 0119 , 1 , 95 )
end

function ItemUse_SCBoxYCJ ( role , Item )		--鱼肠

	local cha = TurnToCha ( role ) 
	local cha_type = GetChaTypeID ( cha ) 

	local Item_CanGet = GetChaFreeBagGridNum ( cha )

	if Item_CanGet == 0 then
		CALCULATE_ITEMEFFECT_LUA_000057 = GetResString("CALCULATE_ITEMEFFECT_LUA_000057")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000057)
		UseItemFailed ( role )
		return
	end

	GiveItem ( cha , 0 , 0150 , 1 , 95 )
end

--羊皮卷 

function ItemUse_Map_YPJ ( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000058 = GetResString("CALCULATE_ITEMEFFECT_LUA_000058")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000058)
		UseItemFailed ( role )
		return
	end 
	local Has_GoldenMap = CheckBagItem ( role , 1093 )
	if Has_GoldenMap >= 1 then
		CALCULATE_ITEMEFFECT_LUA_000059 = GetResString("CALCULATE_ITEMEFFECT_LUA_000059")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000059 )
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 1093 , 1 , 0 )
end

--新式羊皮卷
function ItemUse_Map_JLBYPJ( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000058 = GetResString("CALCULATE_ITEMEFFECT_LUA_000058")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000058)
		UseItemFailed ( role )
		return
	end 
	local Has_GoldenMap = CheckBagItem ( role , 682 )
	local lv= GetChaAttr(role, ATTR_LV) 
	if Has_GoldenMap >= 1 then
		CALCULATE_ITEMEFFECT_LUA_000059 = GetResString("CALCULATE_ITEMEFFECT_LUA_000059")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000059 )
		UseItemFailed ( role )
		return
	end
	if lv <15 or  lv >40 then
		CALCULATE_ITEMEFFECT_LUA_000060 = GetResString("CALCULATE_ITEMEFFECT_LUA_000060")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000060 )
		UseItemFailed ( role )
		return	
	end
	GiveItem ( role , 0 , 682 , 1 , 0 )
end
-- 藏宝图

function ItemUse_GoldenMap ( role , Item )

 	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000058 = GetResString("CALCULATE_ITEMEFFECT_LUA_000058")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000058)
		UseItemFailed ( role )
		return
	end 
	local Has_GoldenMap = CheckBagItem ( role , 1093 )
	if Has_GoldenMap >= 2 then
		CALCULATE_ITEMEFFECT_LUA_000061 = GetResString("CALCULATE_ITEMEFFECT_LUA_000061")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000061 )
		UseItemFailed ( role )
		return
	end
	local Item = GetChaItem2 ( role , 2 , 1093 )
	local Item_MAXURE = GetItemAttr ( Item , ITEMATTR_MAXURE )
	local Item_URE = GetItemAttr ( Item , ITEMATTR_URE )
	local Item_MAXENERGY = GetItemAttr ( Item , ITEMATTR_MAXENERGY )
	local pos_x = Item_MAXURE
	local pos_y = Item_MAXENERGY
	local Themap = Item_URE
--	SystemNotice ( role , "pos_x"..pos_x )
--	SystemNotice ( role , "pos_y"..pos_y )
--	SystemNotice ( role , "Themap"..Themap )
	
	local MapList = { }
	
	MapList [0] = "NoMap"
	MapList [1] = "garner"
	MapList [2] = "magicsea"
	MapList [3] = "darkblue"

	local MapNameList = { }
	
	CALCULATE_ITEMEFFECT_LUA_000062 = GetResString("CALCULATE_ITEMEFFECT_LUA_000062")
	MapNameList [0] = CALCULATE_ITEMEFFECT_LUA_000062
	CALCULATE_ITEMEFFECT_LUA_000063 = GetResString("CALCULATE_ITEMEFFECT_LUA_000063")
	MapNameList [1] = CALCULATE_ITEMEFFECT_LUA_000063
	CALCULATE_ITEMEFFECT_LUA_000064 = GetResString("CALCULATE_ITEMEFFECT_LUA_000064")
	MapNameList [2] = CALCULATE_ITEMEFFECT_LUA_000064
	CALCULATE_ITEMEFFECT_LUA_000065 = GetResString("CALCULATE_ITEMEFFECT_LUA_000065")
	MapNameList [3] = CALCULATE_ITEMEFFECT_LUA_000065
	if pos_x == 0 or pos_y == 0 or Themap == 0 then
		pos_x , pos_y , Themap = GetTheMapPos ( role , 1 )		
--		pos_x,pos_y,Themap = GetMapRanPos ( role )
		Item_MAXURE = pos_x
		Item_URE = Themap
		Item_MAXENERGY = pos_y
		
		SetItemAttr ( Item , ITEMATTR_MAXENERGY , Item_MAXENERGY )
		SetItemAttr ( Item , ITEMATTR_MAXURE , Item_MAXURE )
		SetItemAttr ( Item , ITEMATTR_URE , Item_URE )
--		SystemNotice ( role , "Themap"..Themap )
--		Item_MAXENERGY = GetItemAttr ( Item , ITEMATTR_MAXENERGY )
--		SystemNotice ( role , "Item_MAXENERGY"..Item_MAXENERGY )
	end
	local GetPos = CheckGetMapPos ( role , pos_x , pos_y , MapList[Themap] )
--	SystemNotice ( role , "CheckPosOver"..GetPos ) 
	if GetPos == 0 then
		CALCULATE_ITEMEFFECT_LUA_000066 = GetResString("CALCULATE_ITEMEFFECT_LUA_000066")
		CALCULATE_ITEMEFFECT_LUA_000067 = GetResString("CALCULATE_ITEMEFFECT_LUA_000067")
		CALCULATE_ITEMEFFECT_LUA_000068 = GetResString("CALCULATE_ITEMEFFECT_LUA_000068")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000068..MapNameList[Themap]..CALCULATE_ITEMEFFECT_LUA_000067..pos_x..","..pos_y..CALCULATE_ITEMEFFECT_LUA_000066 )
		UseItemFailed ( role )
		return
	elseif GetPos == 1 then
		local getrandom = math.random ( 1 , 3 )
		if getrandom == 1 then
			GiveGoldenMapItem ( role )
		else
			CALCULATE_ITEMEFFECT_LUA_000069 = GetResString("CALCULATE_ITEMEFFECT_LUA_000069")
			SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000069 )
			UseItemFailed ( role )
			return
		end
	end
end

-- 加勒比藏宝图
function ItemUse_JLB_GoldenMap ( role , Item )

 	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000058 = GetResString("CALCULATE_ITEMEFFECT_LUA_000058")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000058)
		UseItemFailed ( role )
		return
	end 
	local lv= GetChaAttr(role, ATTR_LV) 
	if lv <15 or  lv >40 then
		CALCULATE_ITEMEFFECT_LUA_000070 = GetResString("CALCULATE_ITEMEFFECT_LUA_000070")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000070 )
		UseItemFailed ( role )
		return	
	end
	local Has_GoldenMap = CheckBagItem ( role , 682 )
	if Has_GoldenMap >= 2 then
		CALCULATE_ITEMEFFECT_LUA_000071 = GetResString("CALCULATE_ITEMEFFECT_LUA_000071")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000071 )
		UseItemFailed ( role )
		return
	end
	local Item = GetChaItem2 ( role , 2 , 682 )
	local Item_MAXURE = GetItemAttr ( Item , ITEMATTR_MAXURE )
	local Item_URE = GetItemAttr ( Item , ITEMATTR_URE )
	local Item_MAXENERGY = GetItemAttr ( Item , ITEMATTR_MAXENERGY )
	local pos_x = Item_MAXURE
	local pos_y = Item_MAXENERGY
	local Themap = Item_URE
	local MapList = { }	
	MapList [0] = "NoMap"
	MapList [1] = "jialebi"
	local MapNameList = { }
	CALCULATE_ITEMEFFECT_LUA_000062 = GetResString("CALCULATE_ITEMEFFECT_LUA_000062")
	MapNameList [0] = CALCULATE_ITEMEFFECT_LUA_000062
	CALCULATE_ITEMEFFECT_LUA_000072 = GetResString("CALCULATE_ITEMEFFECT_LUA_000072")
	MapNameList [1] = CALCULATE_ITEMEFFECT_LUA_000072
	if pos_x == 0 or pos_y == 0 or Themap == 0 then
		pos_x , pos_y , Themap = GetTheMapPos_JLB ( role , 1 )	
		Item_MAXURE = pos_x
		Item_URE = Themap
		Item_MAXENERGY = pos_y
		SetItemAttr ( Item , ITEMATTR_MAXENERGY , Item_MAXENERGY )
		SetItemAttr ( Item , ITEMATTR_MAXURE , Item_MAXURE )
		SetItemAttr ( Item , ITEMATTR_URE , Item_URE )
	end
	local GetPos = CheckGetMapPos ( role , pos_x , pos_y , MapList[Themap] )
	if GetPos == 0 then
		CALCULATE_ITEMEFFECT_LUA_000066 = GetResString("CALCULATE_ITEMEFFECT_LUA_000066")
		CALCULATE_ITEMEFFECT_LUA_000067 = GetResString("CALCULATE_ITEMEFFECT_LUA_000067")
		CALCULATE_ITEMEFFECT_LUA_000068 = GetResString("CALCULATE_ITEMEFFECT_LUA_000068")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000068..MapNameList[Themap]..CALCULATE_ITEMEFFECT_LUA_000067..pos_x..","..pos_y..CALCULATE_ITEMEFFECT_LUA_000066 )
		UseItemFailed ( role )
		return
	elseif GetPos == 1 then
		local getrandom = math.random ( 1 , 3 )
		if getrandom == 1 then
			GiveGoldenMapItem_JLB ( role )
		else
			CALCULATE_ITEMEFFECT_LUA_000069 = GetResString("CALCULATE_ITEMEFFECT_LUA_000069")
			SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000069 )
			UseItemFailed ( role )
			return
		end
	end
end




--生日蛋糕
function ItemUse_BirthCake ( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		local attr_ap = Attr_ap( role )
		local ap_extre = 3
		attr_ap = attr_ap + ap_extre 
		SetCharaAttr( attr_ap, role, ATTR_AP )
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
end
------------------------假期欢乐杂志
function ItemUse_HappyBook ( role , Item )

	local Cha_Boat = 0
	local charLv=Lv ( role )
	local dif_exp_one = DEXP[charLv+1]
	local dif_exp_three = DEXP[charLv+3]
	local dif_exp_five = DEXP[charLv+5]
	local Exp_star=GetChaAttr (  role , ATTR_CEXP )----------当前等级经验
	local dif_exp_half = (DEXP[charLv+1] - DEXP[charLv])*0.5 +  Exp_star +10
	local dif_exp_thalf = (DEXP[charLv+1] - DEXP[charLv])*0.3  +  Exp_star + 10
	local dif_exp_thalf_b = dif_exp_thalf - DEXP[charLv+1]
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	elseif charLv>=1 and charLv<=9 then
		SetChaAttrI( role , ATTR_CEXP , dif_exp_five )
	elseif charLv>=10 and charLv<=29 then
			SetChaAttrI( role , ATTR_CEXP , dif_exp_three )
	elseif charLv>=30 and charLv<=59 then
			SetChaAttrI( role , ATTR_CEXP , dif_exp_one )
	elseif charLv>=60 and charLv<=75 then
			SetChaAttrI( role , ATTR_CEXP , dif_exp_half )
	elseif charLv>=76 and charLv<=85 and charLv~=79  then
			SetChaAttrI( role , ATTR_CEXP , dif_exp_thalf )
	elseif charLv==79 and dif_exp_thalf_b<=0 then 
			SetChaAttrI( role , ATTR_CEXP , dif_exp_thalf )
	elseif charLv==79 and dif_exp_thalf_b>0 then 
			dif_exp_thalf = dif_exp_thalf_b*0.02 + DEXP[charLv+1]
			SetChaAttrI( role , ATTR_CEXP , dif_exp_thalf )
	elseif charLv>=86 then
		CALCULATE_ITEMEFFECT_LUA_000073 = GetResString("CALCULATE_ITEMEFFECT_LUA_000073")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000073 )
		UseItemFailed ( role )
		return
	end
end
------------三月精灵

function ItemUse_MarchElf ( role , Item )

	local statelv = 1
	local statetime = 600
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		-- local cha_type = GetChaTypeID ( role )
		-- if cha_type == 3 or cha_type == 4 then
			-- AddState( role , role , STATE_MarchElf , statelv , statetime )
		-- else
			-- SystemNotice ( role , "三月精灵只能女性角色使用" )
			-- UseItemFailed ( role )
			-- return
		-- end
		AddState( role , role , STATE_MarchElf , statelv , statetime )
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end

end

--加速药水

function ItemUse_MspdYS ( role , Item )

	local statelv = 1
	local statetime = 900
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )


	if Cha_Boat ==  nil then
		AddState( role , role , STATE_YSMspd , statelv , statetime )
		--SystemNotice( role , "A" )

	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end

end

--三角帆

function ItemUse_SanJiaoFan ( role , Item )

	local statelv = 1
	local statetime = 900
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ~=  nil then
		AddState( Cha_Boat , Cha_Boat , STATE_YSBoatMspd , statelv , statetime )
	else
		CALCULATE_ITEMEFFECT_LUA_000074 = GetResString("CALCULATE_ITEMEFFECT_LUA_000074")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000074 )
		UseItemFailed ( role )
		return
	end

end

--高级装甲

function ItemUse_GJZhuangJia ( role , Item )

	local statelv = 1
	local statetime = 900
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ~=  nil then
		AddState( Cha_Boat , Cha_Boat , STATE_YSBoatDEF , statelv , statetime )
	else
		CALCULATE_ITEMEFFECT_LUA_000074 = GetResString("CALCULATE_ITEMEFFECT_LUA_000074")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000074 )
		UseItemFailed ( role )
		return
	end

end

--抽签

--财运签

function ItemUse_SuanmingMoney ( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		
		
		local Has_GoldenMap = CheckBagItem ( role , 3336 )
		if Has_GoldenMap >= 1 then
			CALCULATE_ITEMEFFECT_LUA_000075 = GetResString("CALCULATE_ITEMEFFECT_LUA_000075")
			SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000075 )
			SuanmingTeshu_Money ( role )
			DelBagItem( role , 3336 , 1 )
		else
			Suanming_Money ( role )
		end
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end

	
end

--事业钱

function ItemUse_SuanmingWork ( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		local lv = Lv ( role )
		local exp = Exp(role) 
		local clexp = GetChaAttrI ( role , ATTR_CLEXP )
		if exp < clexp then
			CALCULATE_ITEMEFFECT_LUA_000076 = GetResString("CALCULATE_ITEMEFFECT_LUA_000076")
			SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000076 )
			UseItemFailed ( role )
			return
		end
		
		local Has_GoldenMap = CheckBagItem ( role , 3336 )
		if Has_GoldenMap >= 1 then
			CALCULATE_ITEMEFFECT_LUA_000075 = GetResString("CALCULATE_ITEMEFFECT_LUA_000075")
			SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000075 )
			SuanmingTeshu_Work ( role )
			DelBagItem( role , 3336 , 1 )	
		else
			Suanming_Work ( role )
		end
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
end



--火绒

function ItemUse_HuoRongSW ( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		RemoveState( role , STATE_BDJ )
		AddState ( role , role , STATE_TTISW , 1 , 300 )
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	
end

--咒骨

function ItemUse_ZhouGUSW ( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		RemoveState( role , STATE_ZZZH )
		AddState ( role , role , STATE_TTISW , 2 , 300 )
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	
end

--水芒

function ItemUse_ShuiMangSW ( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		RemoveState( role , STATE_CRXSF )
		AddState ( role , role , STATE_TTISW , 3 , 300 )
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	
end

--护符

function ItemUse_HuFuSW ( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		RemoveState( role , STATE_JSDD )
		AddState ( role , role , STATE_TTISW , 4 , 1200 )
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	
end

--[背包]GetKbCap
-- 24格升28格背包————————————————————————————————————————————————————————————————————————————

function ItemUse_28BeiBao( role , Item ) 

	local bagnum = GetKbCap(role) 
	if bagnum >= 28 then
		CALCULATE_ITEMEFFECT_LUA_000077 = GetResString("CALCULATE_ITEMEFFECT_LUA_000077")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000077)
		UseItemFailed ( role )
		return
	end
	AddKbCap(role, 4) 
end 
-- [背包公式]--------------
-- 28格升32格背包————————————————————————————————————————————————————————————————————————————

function ItemUse_32BeiBao( role , Item ) 

	local bagnum = GetKbCap(role) 
	if bagnum >= 32 then
		CALCULATE_ITEMEFFECT_LUA_000077 = GetResString("CALCULATE_ITEMEFFECT_LUA_000077")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000077)
		UseItemFailed ( role )
		return
	end
	if bagnum <= 24 then
		CALCULATE_ITEMEFFECT_LUA_000078 = GetResString("CALCULATE_ITEMEFFECT_LUA_000078")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000078)
		UseItemFailed ( role )
		return
	end
	AddKbCap(role, 4) 
end 

--32格升36格背包————————————————————————————————————————————————————————————————————————————

function ItemUse_36BeiBao( role , Item ) 

	local bagnum = GetKbCap(role) 
	if bagnum >= 36 then
		CALCULATE_ITEMEFFECT_LUA_000077 = GetResString("CALCULATE_ITEMEFFECT_LUA_000077")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000077)
		UseItemFailed ( role )
		return
	end
	if bagnum <= 28 then
		CALCULATE_ITEMEFFECT_LUA_000078 = GetResString("CALCULATE_ITEMEFFECT_LUA_000078")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000078)
		UseItemFailed ( role )
		return
	end
	AddKbCap(role, 4) 
end
 
-- 36格升40格背包————————————————————————————————————————————————————————————————————————————

function ItemUse_40BeiBao( role , Item ) 

	local bagnum = GetKbCap(role) 
	if bagnum >= 40 then
		CALCULATE_ITEMEFFECT_LUA_000077 = GetResString("CALCULATE_ITEMEFFECT_LUA_000077")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000077)
		UseItemFailed ( role )
		return
	end
	if bagnum <= 32 then
		CALCULATE_ITEMEFFECT_LUA_000078 = GetResString("CALCULATE_ITEMEFFECT_LUA_000078")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000078)
		UseItemFailed ( role )
		return
	end
	AddKbCap(role, 4) 
end 

-- 40格升44格背包————————————————————————————————————————————————————————————————————————————

function ItemUse_44BeiBao( role , Item ) 

	local bagnum = GetKbCap(role) 
	if bagnum >= 44 then
		CALCULATE_ITEMEFFECT_LUA_000077 = GetResString("CALCULATE_ITEMEFFECT_LUA_000077")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000077)
		UseItemFailed ( role )
		return
	end
	if bagnum <= 36 then
		CALCULATE_ITEMEFFECT_LUA_000078 = GetResString("CALCULATE_ITEMEFFECT_LUA_000078")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000078)
		UseItemFailed ( role )
		return
	end
	AddKbCap(role, 4) 
end 

-- 44格升48格背包————————————————————————————————————————————————————————————————————————————

function ItemUse_48BeiBao( role , Item )
 
	local bagnum = GetKbCap(role) 
	if bagnum >= 48 then
		CALCULATE_ITEMEFFECT_LUA_000077 = GetResString("CALCULATE_ITEMEFFECT_LUA_000077")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000077)
		UseItemFailed ( role )
		return
	end
	if bagnum <= 40 then
		CALCULATE_ITEMEFFECT_LUA_000078 = GetResString("CALCULATE_ITEMEFFECT_LUA_000078")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000078)
		UseItemFailed ( role )
		return
	end
	AddKbCap(role, 4) 
end 
----[[表情]]--------------------------------------
function ItemUse_BQ ( role , Item )

end 
----[[饲料内容]]--------------------------------------

function ItemUse_SiLiao ( role , Item , Item_Traget )
	
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end      
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
		local Item_Traget_URE=GetItemAttr(Item_Traget,ITEMATTR_URE)  --取当前耐久
		local Item_Traget_MAXURE=GetItemAttr(Item_Traget,ITEMATTR_MAXURE)--取最大耐久
		local Item_type = GetItemType ( Item )
		local Item_Traget_Type = GetItemType ( Item_Traget )
		local Num = 2500

		if Item_type == 57 and Item_Traget_Type == 59 then
				if Item_Traget_URE < Item_Traget_MAXURE then
				   Give_ElfURE ( role , Item_Traget , Num )
   	 			else
                                        CALCULATE_ITEMEFFECT_LUA_000081 = GetResString("CALCULATE_ITEMEFFECT_LUA_000081")
                                        SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000081 ) 
					UseItemFailed ( role )
					return
				end
		end 

end

----[[宠物饲料内容]]--------------------------------------给宠物增加少许体力

function ItemUse_CWSiLiao ( role , Item , Item_Traget )
	
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end      
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
		local Item_Traget_URE=GetItemAttr(Item_Traget,ITEMATTR_URE)  --取当前耐久
		local Item_Traget_MAXURE=GetItemAttr(Item_Traget,ITEMATTR_MAXURE)--取最大耐久
		local Item_type = GetItemType ( Item )
		local Item_Traget_Type = GetItemType ( Item_Traget )
		local Num = 250

		if Item_type == 57 and Item_Traget_Type == 59 then
				if Item_Traget_URE < Item_Traget_MAXURE then
				   Give_ElfURE ( role , Item_Traget , Num )
   	 			else
                                        CALCULATE_ITEMEFFECT_LUA_000081 = GetResString("CALCULATE_ITEMEFFECT_LUA_000081")
                                        SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000081 ) 
					UseItemFailed ( role )
					return
				end
		end 

end


----[[零食内容]]--------------------------------------

--圣雪山龙果(力)
function ItemUse_LS_longguo ( role , Item , Item_Traget ) 

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local ret = CheckJingLingLv1( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
		local Item_type = GetItemType ( Item )
		local Item_Traget_Type = GetItemType ( Item_Traget )
		local Item_Num = GetItemID ( Item )
		local Check_Exp = 0
		local Elf_MaxEXP = GetItemAttr(Item_Traget,ITEMATTR_MAXENERGY) 
		--SystemNotice(role ,Elf_MaxEXP )

		if Item_type == 58 and Item_Traget_Type == 59 then
				Check_Exp = CheckElf_EXP ( role , Item_Traget ) --精灵exp是否满足升级条件
				if Check_Exp == 0 then
					CALCULATE_ITEMEFFECT_LUA_000082 = GetResString("CALCULATE_ITEMEFFECT_LUA_000082")
					SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000082 ) 
					UseItemFailed ( role )
				else
				   Lvup_Str ( role , Item_Num , Item_Traget ) --根据具体道具选择不同属性的成长函数 ( 例中为str )
				end 
		end 
end

--冰极爽口梅(敏)
function ItemUse_LS_koumei ( role , Item , Item_Traget ) 

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local ret = CheckJingLingLv1( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
		local Item_type = GetItemType ( Item )
		local Item_Traget_Type = GetItemType ( Item_Traget )
		local Item_Num = GetItemID ( Item )
		local Check_Exp = 0
		local Elf_MaxEXP = GetItemAttr(Item_Traget,ITEMATTR_MAXENERGY) 

		if Item_type == 58 and Item_Traget_Type == 59 then
				Check_Exp = CheckElf_EXP ( role , Item_Traget ) --精灵exp是否满足升级条件
				if Check_Exp == 0 then
					CALCULATE_ITEMEFFECT_LUA_000083 = GetResString("CALCULATE_ITEMEFFECT_LUA_000083")
					SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000083 ) 
					UseItemFailed ( role )
				else
				   Lvup_Agi ( role , Item_Num , Item_Traget ) --根据具体道具选择不同属性的成长函数 ( 例中为str )
				end 
		end 
end

--海风鳕鱼丝(专)
function ItemUse_LS_yusi ( role , Item , Item_Traget ) 

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local ret = CheckJingLingLv1( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
		local Item_type = GetItemType ( Item )
		local Item_Traget_Type = GetItemType ( Item_Traget )
		local Item_Num = GetItemID ( Item )
		local Check_Exp = 0
		local Elf_MaxEXP = GetItemAttr(Item_Traget,ITEMATTR_MAXENERGY) 

		if Item_type == 58 and Item_Traget_Type == 59  then
				Check_Exp = CheckElf_EXP ( role , Item_Traget ) --精灵exp是否满足升级条件
				if Check_Exp == 0 then
					CALCULATE_ITEMEFFECT_LUA_000084 = GetResString("CALCULATE_ITEMEFFECT_LUA_000084")
					SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000084 ) 
					UseItemFailed ( role )
				else
				   Lvup_Dex ( role , Item_Num , Item_Traget ) --根据具体道具选择不同属性的成长函数 ( 例中为str )
				end 
		end 
end

--白银城果脯(体)
function ItemUse_LS_guopu ( role , Item , Item_Traget ) 

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local ret = CheckJingLingLv1( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
		local Item_type = GetItemType ( Item )
		local Item_Traget_Type = GetItemType ( Item_Traget )
		local Item_Num = GetItemID ( Item )
		local Check_Exp = 0
		local Elf_MaxEXP = GetItemAttr(Item_Traget,ITEMATTR_MAXENERGY) 

		if Item_type == 58 and Item_Traget_Type == 59 then
				Check_Exp = CheckElf_EXP ( role , Item_Traget ) --精灵exp是否满足升级条件
				if Check_Exp == 0 then
					CALCULATE_ITEMEFFECT_LUA_000085 = GetResString("CALCULATE_ITEMEFFECT_LUA_000085")
					SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000085 ) 
					UseItemFailed ( role )
				else
				   Lvup_Con ( role , Item_Num , Item_Traget ) --根据具体道具选择不同属性的成长函数 ( 例中为str )
				end 
		end 
end

--新沙岚米饼(精)
function ItemUse_LS_mibing ( role , Item , Item_Traget ) 
	local ret = CheckJingLingLv1( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type = GetItemType ( Item )
		local Item_Traget_Type = GetItemType ( Item_Traget )
		local Item_Num = GetItemID ( Item )
		local Check_Exp = 0
		local Elf_MaxEXP = GetItemAttr(Item_Traget,ITEMATTR_MAXENERGY) 

		if Item_type == 58 and Item_Traget_Type == 59  then
				Check_Exp = CheckElf_EXP ( role , Item_Traget ) --精灵exp是否满足升级条件
				if Check_Exp == 0 then
					CALCULATE_ITEMEFFECT_LUA_000086 = GetResString("CALCULATE_ITEMEFFECT_LUA_000086")
					SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000086 ) 
					UseItemFailed ( role )
				else
				   Lvup_Sta ( role , Item_Num , Item_Traget ) --根据具体道具选择不同属性的成长函数 ( 例中为str )
				end  
			        --local Item_MAXENERGY = Elf_MaxEXP + 20
				--SetItemAttr ( Item_Traget , ITEMATTR_MAXENERGY , Item_MAXENERGY )				
		end 
end
----------------------------------------------------
function ItemUse_HuDun_CJ ( role , Item , Item_Traget )   --初级护盾术
			--SystemNotice( role , "s" )
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type =  GetItemType ( Item )
		local Item_Traget_Type =  GetItemType ( Item_Traget )
		local Num = GetItemForgeParam ( Item_Traget , 1 )	 --精灵32位技能信息数据
		local SkillType = 1		--要增加的 Skill 类型
		local SkillNum = 1		--要增加的Skill 编号
				--SystemNotice( role , SkillType )
				--SystemNotice( role , SkillNum )

		if Item_type == 58 and Item_Traget_Type == 59 then
			local Check = CheckElfHaveSkill ( Num , SkillType , SkillNum )

			if Check == 1 then
				CALCULATE_ITEMEFFECT_LUA_000087 = GetResString("CALCULATE_ITEMEFFECT_LUA_000087")
				SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000087 ) 
				UseItemFailed ( role )
			else
		        --SystemNotice( role , "AddElfSkill" )

			AddElfSkill ( Item_Traget , SkillType , SkillNum )
		        --SystemNotice( role , "技能已添加" )

			end
		end

end
----------------------------------------------------
function ItemUse_HuDun_ZJ ( role , Item , Item_Traget )   --中级护盾术
			--SystemNotice( role , "s" )
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type =  GetItemType ( Item )
		local Item_Traget_Type =  GetItemType ( Item_Traget )
		local Num = GetItemForgeParam ( Item_Traget , 1 )	 --精灵32位技能信息数据
		local SkillType = 2		--要增加的 Skill 类型
		local SkillNum = 1		--要增加的Skill 编号
				--SystemNotice( role , SkillType )
				--SystemNotice( role , SkillNum )

		if Item_type == 58 and Item_Traget_Type == 59 then
			local Check = CheckElfHaveSkill ( Num , SkillType , SkillNum )

			if Check == 1 then
				CALCULATE_ITEMEFFECT_LUA_000087 = GetResString("CALCULATE_ITEMEFFECT_LUA_000087")
				SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000087 ) 
				UseItemFailed ( role )
			else
		        --SystemNotice( role , "AddElfSkill" )

			AddElfSkill ( Item_Traget , SkillType , SkillNum )
		        --SystemNotice( role , "技能已添加" )

			end
		end

end

----------------------------------------------------
function ItemUse_HuDun_GJ ( role , Item , Item_Traget )   --高级护盾术
			--SystemNotice( role , "s" )

--	local Cha_Boat = 0
--	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
--	if Cha_Boat ~= nil then 
--		SystemNotice( role , "出海时不可使用" ) 
		UseItemFailed ( role ) 
--		return 
--	end 
--		local Item_type =  GetItemType ( Item )
--		local Item_Traget_Type =  GetItemType ( Item_Traget )
--		local Num = GetItemForgeParam ( Item_Traget , 1 )	 --精灵32位技能信息数据
--		local SkillType = 3		--要增加的 Skill 类型
--		local SkillNum = 1		--要增加的Skill 编号
				--SystemNotice( role , SkillType )
				--SystemNotice( role , SkillNum )
--
--		if Item_type == 58 and Item_Traget_Type == 59 then
--			local Check = CheckElfHaveSkill ( Num , SkillType , SkillNum )

--			if Check == 1 then
--				SystemNotice(role , "已有该技能,使用失败" ) 
--				UseItemFailed ( role )
--			else
		        --SystemNotice( role , "AddElfSkill" )

--			AddElfSkill ( Item_Traget , SkillType , SkillNum )
		        --SystemNotice( role , "技能已添加" )
--			end
--		end

end


----------------------------------------------------
function ItemUse_BaoJi_CJ ( role , Item , Item_Traget )   --初级暴击
			--SystemNotice( role , "s" )
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type =  GetItemType ( Item )
		local Item_Traget_Type =  GetItemType ( Item_Traget )
		local Num = GetItemForgeParam ( Item_Traget , 1 )	 --精灵32位技能信息数据
		local SkillType = 1		--要增加的 Skill 类型
		local SkillNum = 2		--要增加的Skill 编号
				--SystemNotice( role , SkillType )
				--SystemNotice( role , SkillNum )

		if Item_type == 58 and Item_Traget_Type == 59 then
			local Check = CheckElfHaveSkill ( Num , SkillType , SkillNum )

			if Check == 1 then
				CALCULATE_ITEMEFFECT_LUA_000087 = GetResString("CALCULATE_ITEMEFFECT_LUA_000087")
				SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000087 ) 
				UseItemFailed ( role )
			else
		        --SystemNotice( role , "AddElfSkill" )

			AddElfSkill ( Item_Traget , SkillType , SkillNum )
		        --SystemNotice( role , "技能已添加" )

			end
		end

end

----------------------------------------------------
function ItemUse_BaoJi_ZJ ( role , Item , Item_Traget )   --中级暴击
			--SystemNotice( role , "s" )
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type =  GetItemType ( Item )
		local Item_Traget_Type =  GetItemType ( Item_Traget )
		local Num = GetItemForgeParam ( Item_Traget , 1 )	 --精灵32位技能信息数据
		local SkillType = 2		--要增加的 Skill 类型
		local SkillNum = 2		--要增加的Skill 编号
				--SystemNotice( role , SkillType )
				--SystemNotice( role , SkillNum )

		if Item_type == 58 and Item_Traget_Type == 59 then
			local Check = CheckElfHaveSkill ( Num , SkillType , SkillNum )

			if Check == 1 then
				CALCULATE_ITEMEFFECT_LUA_000087 = GetResString("CALCULATE_ITEMEFFECT_LUA_000087")
				SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000087 ) 
				UseItemFailed ( role )
			else
		        --SystemNotice( role , "AddElfSkill" )

			AddElfSkill ( Item_Traget , SkillType , SkillNum )
		        --SystemNotice( role , "技能已添加" )

			end
		end

end


----------------------------------------------------
function ItemUse_BaoJi_GJ ( role , Item , Item_Traget )   --高级暴击
			--SystemNotice( role , "s" )

--	local Cha_Boat = 0
--	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
--	if Cha_Boat ~= nil then 
--		SystemNotice( role , "出海时不可使用" ) 
		UseItemFailed ( role ) 
--		return 
--	end 
--		local Item_type =  GetItemType ( Item )
--		local Item_Traget_Type =  GetItemType ( Item_Traget )
--		local Num = GetItemForgeParam ( Item_Traget , 1 )	 --精灵32位技能信息数据
--		local SkillType = 3		--要增加的 Skill 类型
--		local SkillNum = 2		--要增加的Skill 编号
				--SystemNotice( role , SkillType )
				--SystemNotice( role , SkillNum )

--		if Item_type == 58 and Item_Traget_Type == 59 then
--			local Check = CheckElfHaveSkill ( Num , SkillType , SkillNum )
--
--			if Check == 1 then
--				SystemNotice(role , "已有该技能,使用失败" ) 
--				UseItemFailed ( role )
--			else
--		       -- SystemNotice( role , "AddElfSkill" )
--
--			AddElfSkill ( Item_Traget , SkillType , SkillNum )
--		        --SystemNotice( role , "技能已添加" )
--
--			end
--		end
--
end


----------------------------------------------------
function ItemUse_MoLi_CJ ( role , Item , Item_Traget )   --初级魔力
			--SystemNotice( role , "s" )
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type =  GetItemType ( Item )
		local Item_Traget_Type =  GetItemType ( Item_Traget )
		local Num = GetItemForgeParam ( Item_Traget , 1 )	 --精灵32位技能信息数据
		local SkillType = 1		--要增加的 Skill 类型
		local SkillNum = 3		--要增加的Skill 编号
				--SystemNotice( role , SkillType )
				--SystemNotice( role , SkillNum )

		if Item_type == 58 and Item_Traget_Type == 59 then
			local Check = CheckElfHaveSkill ( Num , SkillType , SkillNum )

			if Check == 1 then
				CALCULATE_ITEMEFFECT_LUA_000087 = GetResString("CALCULATE_ITEMEFFECT_LUA_000087")
				SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000087 ) 
				UseItemFailed ( role )
			else
		        --SystemNotice( role , "AddElfSkill" )

			AddElfSkill ( Item_Traget , SkillType , SkillNum )
		        --SystemNotice( role , "技能已添加" )

			end
		end

end


----------------------------------------------------
function ItemUse_MoLi_ZJ ( role , Item , Item_Traget )   --中级魔力
			--SystemNotice( role , "s" )
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type =  GetItemType ( Item )
		local Item_Traget_Type =  GetItemType ( Item_Traget )
		local Num = GetItemForgeParam ( Item_Traget , 1 )	 --精灵32位技能信息数据
		local SkillType = 2		--要增加的 Skill 类型
		local SkillNum = 3		--要增加的Skill 编号
				--SystemNotice( role , SkillType )
				--SystemNotice( role , SkillNum )

		if Item_type == 58 and Item_Traget_Type == 59 then
			local Check = CheckElfHaveSkill ( Num , SkillType , SkillNum )

			if Check == 1 then
				CALCULATE_ITEMEFFECT_LUA_000087 = GetResString("CALCULATE_ITEMEFFECT_LUA_000087")
				SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000087 ) 
				UseItemFailed ( role )
			else
		        --SystemNotice( role , "AddElfSkill" )

			AddElfSkill ( Item_Traget , SkillType , SkillNum )
		        --SystemNotice( role , "技能已添加" )

			end
		end

end

----------------------------------------------------
function ItemUse_MoLi_GJ ( role , Item , Item_Traget )   --高级魔力
			--SystemNotice( role , "s" )

--	local Cha_Boat = 0
--	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
--	if Cha_Boat ~= nil then 
--		SystemNotice( role , "出海时不可使用" ) 
		UseItemFailed ( role ) 
--		return 
--	end 
--		local Item_type =  GetItemType ( Item )
--		local Item_Traget_Type =  GetItemType ( Item_Traget )
--		local Num = GetItemForgeParam ( Item_Traget , 1 )	 --精灵32位技能信息数据
--		local SkillType = 3		--要增加的 Skill 类型
--		local SkillNum = 3		--要增加的Skill 编号
--				--SystemNotice( role , SkillType )
--				--SystemNotice( role , SkillNum )
--
--		if Item_type == 58 and Item_Traget_Type == 59 then
--			local Check = CheckElfHaveSkill ( Num , SkillType , SkillNum )
--
--			if Check == 1 then
--				SystemNotice(role , "已有该技能,使用失败" ) 
--				UseItemFailed ( role )
--			else
--		        --SystemNotice( role , "AddElfSkill" )
--
--			AddElfSkill ( Item_Traget , SkillType , SkillNum )
--		        --SystemNotice( role , "技能已添加" )
--
--			end
--		end

end

----------------------------------------------------
function ItemUse_HuiFu_CJ ( role , Item , Item_Traget )   --初级恢复
			--SystemNotice( role , "s" )
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type =  GetItemType ( Item )
		local Item_Traget_Type =  GetItemType ( Item_Traget )
		local Num = GetItemForgeParam ( Item_Traget , 1 )	 --精灵32位技能信息数据
		local SkillType = 1		--要增加的 Skill 类型
		local SkillNum = 4		--要增加的Skill 编号
				--SystemNotice( role , SkillType )
				--SystemNotice( role , SkillNum )

		if Item_type == 58 and Item_Traget_Type == 59 then
			local Check = CheckElfHaveSkill ( Num , SkillType , SkillNum )

			if Check == 1 then
				CALCULATE_ITEMEFFECT_LUA_000087 = GetResString("CALCULATE_ITEMEFFECT_LUA_000087")
				SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000087 ) 
				UseItemFailed ( role )
			else
		        --SystemNotice( role , "AddElfSkill" )

			AddElfSkill ( Item_Traget , SkillType , SkillNum )
		        --SystemNotice( role , "技能已添加" )

			end
		end

end

----------------------------------------------------
function ItemUse_HuiFu_ZJ ( role , Item , Item_Traget )   --中级恢复
			--SystemNotice( role , "s" )
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type =  GetItemType ( Item )
		local Item_Traget_Type =  GetItemType ( Item_Traget )
		local Num = GetItemForgeParam ( Item_Traget , 1 )	 --精灵32位技能信息数据
		local SkillType = 2		--要增加的 Skill 类型
		local SkillNum = 4		--要增加的Skill 编号
				--SystemNotice( role , SkillType )
				--SystemNotice( role , SkillNum )

		if Item_type == 58 and Item_Traget_Type == 59 then
			local Check = CheckElfHaveSkill ( Num , SkillType , SkillNum )

			if Check == 1 then
				CALCULATE_ITEMEFFECT_LUA_000087 = GetResString("CALCULATE_ITEMEFFECT_LUA_000087")
				SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000087 ) 
				UseItemFailed ( role )
			else
		        --SystemNotice( role , "AddElfSkill" )

			AddElfSkill ( Item_Traget , SkillType , SkillNum )
		        --SystemNotice( role , "技能已添加" )

			end
		end

end


----------------------------------------------------
function ItemUse_HuiFu_GJ ( role , Item , Item_Traget )   --高级恢复
			--SystemNotice( role , "s" )

--	local Cha_Boat = 0
--	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
--	if Cha_Boat ~= nil then 
--		SystemNotice( role , "出海时不可使用" ) 
		UseItemFailed ( role ) 
--		return 
--	end 
--		local Item_type =  GetItemType ( Item )
--		local Item_Traget_Type =  GetItemType ( Item_Traget )
--		local Num = GetItemForgeParam ( Item_Traget , 1 )	 --精灵32位技能信息数据
--		local SkillType = 3		--要增加的 Skill 类型
--		local SkillNum = 4		--要增加的Skill 编号
--				--SystemNotice( role , SkillType )
--				--SystemNotice( role , SkillNum )
--
--		if Item_type == 58 and Item_Traget_Type == 59 then
--			local Check = CheckElfHaveSkill ( Num , SkillType , SkillNum )
--
--			if Check == 1 then
--				SystemNotice(role , "已有该技能,使用失败" ) 
--				UseItemFailed ( role )
--			else
--		        --SystemNotice( role , "AddElfSkill" )
--
--			AddElfSkill ( Item_Traget , SkillType , SkillNum )
--		        --SystemNotice( role , "技能已添加" )

--			end
--		end

end

----------------------------------------------------
function ItemUse_ChenSi_CJ ( role , Item , Item_Traget )   --初级沉思
			--SystemNotice( role , "s" )
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type =  GetItemType ( Item )
		local Item_Traget_Type =  GetItemType ( Item_Traget )
		local Num = GetItemForgeParam ( Item_Traget , 1 )	 --精灵32位技能信息数据
		local SkillType = 1		--要增加的 Skill 类型
		local SkillNum = 5		--要增加的Skill 编号
				--SystemNotice( role , SkillType )
				--SystemNotice( role , SkillNum )

		if Item_type == 58 and Item_Traget_Type == 59 then
			local Check = CheckElfHaveSkill ( Num , SkillType , SkillNum )

			if Check == 1 then
				CALCULATE_ITEMEFFECT_LUA_000087 = GetResString("CALCULATE_ITEMEFFECT_LUA_000087")
				SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000087 ) 
				UseItemFailed ( role )
			else
		        --SystemNotice( role , "AddElfSkill" )

			AddElfSkill ( Item_Traget , SkillType , SkillNum )
		        --SystemNotice( role , "技能已添加" )

			end
		end

end

----------------------------------------------------
function ItemUse_ChenSi_ZJ ( role , Item , Item_Traget )   --中级沉思
			--SystemNotice( role , "s" )
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type =  GetItemType ( Item )
		local Item_Traget_Type =  GetItemType ( Item_Traget )
		local Num = GetItemForgeParam ( Item_Traget , 1 )	 --精灵32位技能信息数据
		local SkillType = 2		--要增加的 Skill 类型
		local SkillNum = 5		--要增加的Skill 编号
				--SystemNotice( role , SkillType )
				--SystemNotice( role , SkillNum )

		if Item_type == 58 and Item_Traget_Type == 59 then
			local Check = CheckElfHaveSkill ( Num , SkillType , SkillNum )

			if Check == 1 then
				CALCULATE_ITEMEFFECT_LUA_000087 = GetResString("CALCULATE_ITEMEFFECT_LUA_000087")
				SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000087 ) 
				UseItemFailed ( role )
			else
		        --SystemNotice( role , "AddElfSkill" )

			AddElfSkill ( Item_Traget , SkillType , SkillNum )
		        --SystemNotice( role , "技能已添加" )

			end
		end

end


----------------------------------------------------
function ItemUse_ChenSi_GJ ( role , Item , Item_Traget )   --高级沉思
			--SystemNotice( role , "s" )

--	local Cha_Boat = 0
--	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
--	if Cha_Boat ~= nil then 
--		SystemNotice( role , "出海时不可使用" ) 
		UseItemFailed ( role ) 
--		return 
--	end 
--		local Item_type =  GetItemType ( Item )
--		local Item_Traget_Type =  GetItemType ( Item_Traget )
--		local Num = GetItemForgeParam ( Item_Traget , 1 )	 --精灵32位技能信息数据
--		local SkillType = 3		--要增加的 Skill 类型
--		local SkillNum = 5		--要增加的Skill 编号
--				--SystemNotice( role , SkillType )
--				--SystemNotice( role , SkillNum )
--
--		if Item_type == 58 and Item_Traget_Type == 59 then
--			local Check = CheckElfHaveSkill ( Num , SkillType , SkillNum )
--
--			if Check == 1 then
--				SystemNotice(role , "已有该技能,使用失败" ) 
--				UseItemFailed ( role )
--			else
--		        --SystemNotice( role , "AddElfSkill" )
--
--			AddElfSkill ( Item_Traget , SkillType , SkillNum )
--		        --SystemNotice( role , "技能已添加" )
--
--			end
--		end

end

-----------------------------------------------------------
--怪物召唤

function ItemUse_MonsterSummon ( role , Item , Item_Traget )

	local Monster_GetID = {}
	Monster_GetID[1] = math.random ( 40 , 80 )
	Monster_GetID[2] = math.random ( 98 , 146 )
	Monster_GetID[3] = math.random ( 194, 241 )
	Monster_GetID[4] = math.random ( 500, 571 )
	Monster_GetID[5]= 789

	local ID_Get = math.random ( 1 , 5 )
	local x, y = GetChaPos( role )
	local MonsterID = Monster_GetID [ ID_Get ]
	local Refresh = 50					--重生时间，秒单位
	local life = 40000					--生命时间，毫秒单位
	local new = CreateCha( MonsterID , x , y , 145 , Refresh )
	SetChaLifeTime( new, life )

end


----------------------------------------------------------

--除草剂
function ItemUse_Ant_Hzcr ( role , Item , Item_Traget )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		RemoveState( Cha_Boat , STATE_HZCR )
	else
		CALCULATE_ITEMEFFECT_LUA_000088 = GetResString("CALCULATE_ITEMEFFECT_LUA_000088")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000088 )
		UseItemFailed ( role )
		return
	end

end


--命之精灵蛋

function ItemUse_MINGZJLD ( role, Item )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000089 = GetResString("CALCULATE_ITEMEFFECT_LUA_000089")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000089)
		UseItemFailed ( role )
		return
	end

	GiveItem ( role , 0 , 183  , 1 , 4 ) 
end

--罚之精灵蛋

function ItemUse_FAZJLD ( role, Item )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000090 = GetResString("CALCULATE_ITEMEFFECT_LUA_000090")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000090)
		UseItemFailed ( role )
		return
	end

	GiveItem ( role , 0 , 184  , 1 , 4 ) 
end

--谦之精灵蛋

function ItemUse_QIANZJLD ( role, Item )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000091 = GetResString("CALCULATE_ITEMEFFECT_LUA_000091")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000091)
		UseItemFailed ( role )
		return
	end

	GiveItem ( role , 0 , 185  , 1 , 4 ) 
end

--恒之精灵蛋

function ItemUse_HENGZJLD( role, Item )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000092 = GetResString("CALCULATE_ITEMEFFECT_LUA_000092")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000092)
		UseItemFailed ( role )
		return
	end

	GiveItem ( role , 0 , 186  , 1 , 4 )  
end

--誉之精灵蛋

function ItemUse_YUZJLD( role, Item )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000093 = GetResString("CALCULATE_ITEMEFFECT_LUA_000093")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000093)
		UseItemFailed ( role )
		return
	end

	GiveItem ( role , 0 , 187  , 1 , 4 )  
end
--血之精灵蛋

function ItemUse_XUEZJLD( role, Item )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000094 = GetResString("CALCULATE_ITEMEFFECT_LUA_000094")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000094)
		UseItemFailed ( role )
		return
	end

	GiveItem ( role , 0 , 188  , 1 , 4 )  
end

--信之精灵蛋

function ItemUse_XINGZJLD ( role, Item )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000095 = GetResString("CALCULATE_ITEMEFFECT_LUA_000095")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000095)
		UseItemFailed ( role )
		return
	end

	GiveItem ( role , 0 , 189  , 1 , 4 )  
end

--悔之精灵蛋

function ItemUse_HUIZJLD( role, Item )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000096 = GetResString("CALCULATE_ITEMEFFECT_LUA_000096")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000096)
		UseItemFailed ( role )
		return
	end

	GiveItem ( role , 0 , 190  , 1 , 4 )  

end

--爱之精灵蛋

function ItemUse_AIZJLD ( role, Item )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000097 = GetResString("CALCULATE_ITEMEFFECT_LUA_000097")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000097)
		UseItemFailed ( role )
		return
	end

	GiveItem ( role , 0 , 191  , 1 , 4 )  
end

--心之精灵蛋

function ItemUse_XINGZHIJLD ( role, Item )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000098 = GetResString("CALCULATE_ITEMEFFECT_LUA_000098")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000098)
		UseItemFailed ( role )
		return
	end

	GiveItem ( role , 0 , 199  , 1 , 4 )  
end
-------------------------------新人宝箱
function ItemUse_XRBOX( role, Item )
--	SystemNotice(role ,"此功能暂时未开放")
--	UseItemFailed ( role )
--	return
	
	local lv = GetChaAttr(role, ATTR_LV)
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 5 then
		CALCULATE_ITEMEFFECT_LUA_000099 = GetResString("CALCULATE_ITEMEFFECT_LUA_000099")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000099)
		UseItemFailed ( role )
		return
	end
	if lv < 5 then
		CALCULATE_ITEMEFFECT_LUA_000100 = GetResString("CALCULATE_ITEMEFFECT_LUA_000100")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000100)
		UseItemFailed ( role )	
	else
		GiveItem ( role , 0 , 437  , 1 , 4 )
		GiveItem ( role , 0 , 9  , 1 , 95 )
		GiveItem ( role , 0 , 4308  , 1 , 95 )
		GiveItem ( role , 0 , 444  , 1 , 4 )
		GiveItem ( role , 0 , 0985  , 1 , 4 )--------------35至尊豪礼
	end
end


-------------------------------35至尊宝箱------------10级
function ItemUse_SANWUBOX( role, Item )

	local lv = GetChaAttr(role, ATTR_LV)
	local job = GetChaAttr( role, ATTR_JOB) --取职业

	local cha_type = GetChaTypeID ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 4 then
		CALCULATE_ITEMEFFECT_LUA_000101 = GetResString("CALCULATE_ITEMEFFECT_LUA_000101")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000101)
		UseItemFailed ( role )
		return
	end
	if lv < 10 then
		CALCULATE_ITEMEFFECT_LUA_000102 = GetResString("CALCULATE_ITEMEFFECT_LUA_000102")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000102)
		UseItemFailed ( role )
		return
	end
	if cha_type ~= 2 and job==4 then
		GiveItem ( role , 0 , 0803 , 1 , 4 )--------------海妖披风		
		GiveItem ( role , 0 , 0986 , 1 , 4 )--------------45至尊宝箱
	elseif cha_type == 3 and job == 1 then
		GiveItem ( role , 0 , 0763 , 1 , 4 )
		GiveItem ( role , 0 , 0986 , 1 , 4 )--------------45至尊宝箱
	elseif cha_type ~= 2 and job==16 then
		GiveItem ( role , 0 , 0803 , 1 , 4 )--------------海妖披风		
		GiveItem ( role , 0 , 0986 , 1 , 4 )--------------45至尊宝箱
	elseif cha_type == 2  and job~=0 then
		GiveItem ( role , 0 , 0763  , 1 , 4 )----------------幽灵铠甲
		GiveItem ( role , 0 , 0986  , 1 , 4 )--------------45至尊宝箱
	elseif cha_type ~= 2 and  cha_type ~= 4 and job==2 then
		GiveItem ( role , 0 , 0777  , 1 , 4 )-----------------亡灵短袍
		GiveItem ( role , 0 , 0986  , 1 , 4 )--------------45至尊宝箱
	elseif cha_type ~= 2 and  cha_type ~= 4 and job==12 then
		GiveItem ( role , 0 , 0777  , 1 , 4 )-----------------亡灵短袍
		GiveItem ( role , 0 , 0986  , 1 , 4 )--------------45至尊宝箱
	elseif cha_type ~= 1 and  cha_type ~= 2 and job==5 then
	        GiveItem ( role , 0 , 0789  , 1 , 4 )-------------巫毒法袍
		GiveItem ( role , 0 , 0986  , 1 , 4 )--------------45至尊宝箱
	elseif cha_type ~= 1 and  cha_type ~= 2 and job==13 then
	        GiveItem ( role , 0 , 0789  , 1 , 4 )-------------巫毒法袍
		GiveItem ( role , 0 , 0986  , 1 , 4 )--------------45至尊宝箱
	elseif cha_type ~= 1 and  cha_type ~= 2 and job==14 then
	        GiveItem ( role , 0 , 0789  , 1 , 4 )-------------巫毒法袍
		GiveItem ( role , 0 , 0986  , 1 , 4 )--------------45至尊宝箱
	elseif cha_type == 1 and  job==1 then
	        GiveItem ( role , 0 , 0763  , 1 , 4 )-------------大地战甲
		GiveItem ( role , 0 , 0986  , 1 , 4 )--------------45至尊宝箱
	else 
		CALCULATE_ITEMEFFECT_LUA_000103 = GetResString("CALCULATE_ITEMEFFECT_LUA_000103")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000103)
		UseItemFailed ( role )
		return
	end
end


-------------------------------45至尊宝箱-----------35级
function ItemUse_SIWUBOX( role, Item )

	local lv = GetChaAttr(role, ATTR_LV)
	local job = GetChaAttr( role, ATTR_JOB) --取职业
	local cha_type = GetChaTypeID ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 4 then
		CALCULATE_ITEMEFFECT_LUA_000101 = GetResString("CALCULATE_ITEMEFFECT_LUA_000101")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000101)
		UseItemFailed ( role )
		return
	end
	if lv < 35 then
		CALCULATE_ITEMEFFECT_LUA_000104 = GetResString("CALCULATE_ITEMEFFECT_LUA_000104")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000104)
		UseItemFailed ( role )
		return
	end
	if cha_type == 1 and job==9 then
		GiveItem ( role , 0 , 0767 , 1 , 4 )----------------诅咒之灵钢甲	
		GiveItem ( role , 0 , 0987 , 1 , 4 )--------------55至尊宝箱
	elseif cha_type == 3 and job == 9 then 
		GiveItem ( role , 0 , 0767 , 1 , 4 )----------------诅咒之灵钢甲	
		GiveItem ( role , 0 , 0987 , 1 , 4 )--------------55至尊宝箱
	elseif cha_type == 2 and job==8 then
		GiveItem ( role , 0 , 0764  , 1 , 4 )-----------------武士之诅咒纹身
		GiveItem ( role , 0 , 0987  , 1 , 4 )--------------55至尊宝箱
	elseif cha_type == 1 and job==12 then
		GiveItem ( role , 0 , 778  , 1 , 4 )-------------咒纹紧身衣
		GiveItem ( role , 0 , 0987  , 1 , 4 )--------------55至尊宝箱
	elseif cha_type == 3 and job==12 then
		GiveItem ( role , 0 , 778  , 1 , 4 )-------------咒纹紧身衣
		GiveItem ( role , 0 , 0987  , 1 , 4 )--------------55至尊宝箱
	elseif cha_type == 4 and job==13 then
		GiveItem ( role , 0 , 0790  , 1 , 4 )-------------符文外衣
		GiveItem ( role , 0 , 0987  , 1 , 4 )--------------55至尊宝箱
	elseif cha_type == 3  and job==13 then
		GiveItem ( role , 0 , 0790  , 1 , 4 )-------------符文外衣
		GiveItem ( role , 0 , 0987  , 1 , 4 )--------------55至尊宝箱
	elseif cha_type == 3  and job==14 then
		GiveItem ( role , 0 , 0796  , 1 , 4 )-------------咒文之袍
		GiveItem ( role , 0 , 0987  , 1 , 4 )--------------55至尊宝箱
	elseif cha_type == 4 and job==14 then
		GiveItem ( role , 0 , 0796  , 1 , 4 )-------------咒文之袍
		GiveItem ( role , 0 , 0987  , 1 , 4 )--------------55至尊宝箱
	elseif cha_type == 3 and job==16 then
		GiveItem ( role , 0 , 0804  , 1 , 4 )-------------咒火斗篷
		GiveItem ( role , 0 , 0987  , 1 , 4 )--------------55至尊宝箱
	elseif cha_type == 1 and job==16 then
		GiveItem ( role , 0 , 0804  , 1 , 4 )-------------咒火斗篷
		GiveItem ( role , 0 , 0987  , 1 , 4 )--------------55至尊宝箱
	elseif cha_type ==4 and job==16 then
		GiveItem ( role , 0 , 0804  , 1 , 4 )-------------咒火斗篷
		GiveItem ( role , 0 , 0987  , 1 , 4 )--------------55至尊宝箱
	else 
		CALCULATE_ITEMEFFECT_LUA_000103 = GetResString("CALCULATE_ITEMEFFECT_LUA_000103")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000103)
		UseItemFailed ( role )
		return
	end
end

-------------------------------55至尊宝箱-----------45级
function ItemUse_WUWUBOX( role, Item )

	local lv = GetChaAttr(role, ATTR_LV)
	local job = GetChaAttr( role, ATTR_JOB) --取职业
	local cha_type = GetChaTypeID ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 4 then
		CALCULATE_ITEMEFFECT_LUA_000101 = GetResString("CALCULATE_ITEMEFFECT_LUA_000101")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000101)
		UseItemFailed ( role )
		return
	end
	if lv < 45 then
		CALCULATE_ITEMEFFECT_LUA_000105 = GetResString("CALCULATE_ITEMEFFECT_LUA_000105")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000105)
		UseItemFailed ( role )
		return
	end
	if cha_type == 1 and job==9 then
		GiveItem ( role , 0 , 0768 , 1 , 4 )----------------幻灵战甲		
		GiveItem ( role , 0 , 0988 , 1 , 4 )--------------65至尊宝箱
	elseif cha_type == 3 and job == 9 then 
		GiveItem ( role , 0 , 0768 , 1 , 4 )----------------幻灵战甲		
		GiveItem ( role , 0 , 0988 , 1 , 4 )--------------65至尊宝箱
	elseif cha_type == 2 and job==8 then
		GiveItem ( role , 0 , 0765  , 1 , 4 )-----------------幻灵纹身
		GiveItem ( role , 0 , 0988  , 1 , 4 )-------------65至尊宝箱
	elseif cha_type == 3 and job==12 then
		GiveItem ( role , 0 , 0779  , 1 , 4 )----------------幻灵外套
		GiveItem ( role , 0 , 0988  , 1 , 4 )--------------65至尊宝箱
	elseif cha_type == 1 and job==12 then
		GiveItem ( role , 0 , 0779  , 1 , 4 )----------------幻灵外套
		GiveItem ( role , 0 , 0988  , 1 , 4 )--------------65至尊宝箱
	elseif cha_type == 3 and job==13 then
	        GiveItem ( role , 0 , 0791  , 1 , 4 )----------------幻法之袍
		GiveItem ( role , 0 , 0988  , 1 , 4 )--------------65至尊宝箱
	elseif cha_type == 4 and job==13 then
	        GiveItem ( role , 0 , 0791  , 1 , 4 )----------------幻法之袍
		GiveItem ( role , 0 , 0988  , 1 , 4 )--------------65至尊宝箱
	elseif cha_type == 3 and job==14 then
	        GiveItem ( role , 0 , 0797  , 1 , 4 )----------------幻咒之袍
		GiveItem ( role , 0 , 0988  , 1 , 4 )--------------65至尊宝箱
	elseif cha_type == 4 and job==14 then
	        GiveItem ( role , 0 , 0797  , 1 , 4 )----------------幻咒之袍
		GiveItem ( role , 0 , 0988  , 1 , 4 )--------------65至尊宝箱
	elseif cha_type == 1 and job==16 then
	        GiveItem ( role , 0 , 0805  , 1 , 4 )----------------幻灵披风
		GiveItem ( role , 0 , 0988  , 1 , 4 )--------------65至尊宝箱
	elseif cha_type == 3 and job==16 then
	        GiveItem ( role , 0 , 0805  , 1 , 4 )----------------幻灵披风
		GiveItem ( role , 0 , 0988  , 1 , 4 )--------------65至尊宝箱
	elseif cha_type == 4 and job==16 then
	        GiveItem ( role , 0 , 0805  , 1 , 4 )----------------幻灵披风
		GiveItem ( role , 0 , 0988  , 1 , 4 )--------------65至尊宝箱
	else 
		CALCULATE_ITEMEFFECT_LUA_000103 = GetResString("CALCULATE_ITEMEFFECT_LUA_000103")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000103)
		UseItemFailed ( role )
		return
	end
end

-------------------------------65至尊宝箱-----------55级
function ItemUse_LIUWUBOX( role, Item )

	local lv = GetChaAttr(role, ATTR_LV)
	local job = GetChaAttr( role, ATTR_JOB) --取职业
	local cha_type = GetChaTypeID ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 4 then
		CALCULATE_ITEMEFFECT_LUA_000101 = GetResString("CALCULATE_ITEMEFFECT_LUA_000101")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000101)
		UseItemFailed ( role )
		return
	end
	if lv < 55 then
		CALCULATE_ITEMEFFECT_LUA_000106 = GetResString("CALCULATE_ITEMEFFECT_LUA_000106")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000106)
		UseItemFailed ( role )
		return
	end
	if cha_type == 1 and job==9 then
		GiveItem ( role , 0 , 0769 , 1 , 4 )----------------迷之战甲	
	elseif cha_type == 3 and job==9 then
		GiveItem ( role , 0 , 0769 , 1 , 4 )----------------迷之战甲	
	elseif cha_type == 2 and job==8 then
		GiveItem ( role , 0 , 0766  , 1 , 4 )-----------------迷之纹身
	elseif cha_type == 3 and job==12 then
		GiveItem ( role , 0 , 0780  , 1 , 4 )----------------迷之斗篷
	elseif cha_type == 1 and job==12 then
		GiveItem ( role , 0 , 0780  , 1 , 4 )----------------迷之斗篷
	elseif cha_type == 3 and job==13 then
	        GiveItem ( role , 0 , 0792  , 1 , 4 )----------------迷之法袍
	elseif cha_type == 4 and job==13 then
	        GiveItem ( role , 0 , 0792  , 1 , 4 )----------------迷之法袍
	elseif cha_type == 3 and job==14 then
	        GiveItem ( role , 0 , 0798  , 1 , 4 )----------------迷咒法袍
	elseif cha_type == 4 and job==14 then
	        GiveItem ( role , 0 , 0798  , 1 , 4 )----------------迷咒法袍
	elseif cha_type == 1 and job==16 then
	        GiveItem ( role , 0 , 0806  , 1 , 4 )----------------迷幻斗篷
	elseif cha_type == 3 and job==16 then
	        GiveItem ( role , 0 , 0806  , 1 , 4 )----------------迷幻斗篷
	elseif cha_type == 4 and job==16 then
	        GiveItem ( role , 0 , 0806  , 1 , 4 )----------------迷幻斗篷
	else 
		CALCULATE_ITEMEFFECT_LUA_000103 = GetResString("CALCULATE_ITEMEFFECT_LUA_000103")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000103)
		UseItemFailed ( role )
		return
	end
end


----------------------------------+1新人宝箱
function ItemUse_XRBOX1( role, Item )

	local job = GetChaAttr(role, ATTR_JOB)
	local lv = GetChaAttr(role, ATTR_LV) 
        local cha_type = GetChaTypeID ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 9 then
		CALCULATE_ITEMEFFECT_LUA_000107 = GetResString("CALCULATE_ITEMEFFECT_LUA_000107")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000107)
		UseItemFailed ( role )
		return
	end
	if lv < 10 then
		CALCULATE_ITEMEFFECT_LUA_000102 = GetResString("CALCULATE_ITEMEFFECT_LUA_000102")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000102)
		UseItemFailed ( role )	
	elseif job == 1 then  
		GiveItem ( role , 0 , 438  , 1 , 4 ) 
		GiveItem ( role , 0 , 1130  , 1 , 4 )--------------精灵技能书-白痴
		GiveItem ( role , 0 , 1037  , 1 , 4 )--------------精灵技能书-大便		
		GiveItem ( role , 0 , 10  , 1 , 95 ) 
		GiveItem ( role , 0 , 296  , 1 , 95 )
		GiveItem ( role , 0 , 4602  , 1 , 4 )
		GiveItem ( role , 0 , 4603  , 1 , 4 )
		GiveItem ( role , 0 , 4604  , 1 , 4 )
		GiveItem ( role , 0 , 445  , 1 , 4 ) 
	elseif job == 2 then   
		GiveItem ( role , 0 , 438  , 1 , 4 ) 
		GiveItem ( role , 0 , 1130  , 1 , 4 )--------------精灵技能书-白痴
		GiveItem ( role , 0 , 1037  , 1 , 4 )--------------精灵技能书-大便		
		GiveItem ( role , 0 , 32  , 1 , 95 ) 
		GiveItem ( role , 0 , 311  , 1 , 95 )
		GiveItem ( role , 0 , 4602  , 1 , 4 )
		GiveItem ( role , 0 , 4603  , 1 , 4 )
		GiveItem ( role , 0 , 4604  , 1 , 4 )
		GiveItem ( role , 0 , 445  , 1 , 4 ) 
	elseif job == 4 then  
		GiveItem ( role , 0 , 4602  , 1 , 4 )
		GiveItem ( role , 0 , 1130  , 1 , 4 )--------------精灵技能书-白痴
		GiveItem ( role , 0 , 1037  , 1 , 4 )--------------精灵技能书-大便		
		GiveItem ( role , 0 , 4603  , 1 , 4 )
		GiveItem ( role , 0 , 4604  , 1 , 4 )
		GiveItem ( role , 0 , 445  , 1 , 4 ) 
		GiveItem ( role , 0 , 438  , 1 , 4 ) 
		GiveItem ( role , 0 , 80  , 1 , 95 ) 
		if cha_type == 1 or cha_type == 3 then 
			GiveItem ( role , 0 , 336  , 1 , 95 ) 
		else 
			GiveItem ( role , 0 , 351  , 1 , 95 ) 
		end
	elseif job == 5 then   
		GiveItem ( role , 0 , 4602  , 1 , 4 ) 
		GiveItem ( role , 0 , 1130  , 1 , 4 )--------------精灵技能书-白痴
		GiveItem ( role , 0 , 1037  , 1 , 4 )--------------精灵技能书-大便		
		GiveItem ( role , 0 , 4603  , 1 , 4 ) 
		GiveItem ( role , 0 , 4604  , 1 , 4 ) 
		GiveItem ( role , 0 , 445  , 1 , 4 ) 
		GiveItem ( role , 0 , 438  , 1 , 4 ) 
		GiveItem ( role , 0 , 104  , 1 , 95 ) 
		if cha_type == 3 then 
			GiveItem ( role , 0 , 372  , 1 , 95 )
		else 
			GiveItem ( role , 0 , 359  , 1 , 95 ) 
		end
	else 
		CALCULATE_ITEMEFFECT_LUA_000108 = GetResString("CALCULATE_ITEMEFFECT_LUA_000108")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000108)
		UseItemFailed ( role )	
	end
end
----------------------------------+2新人宝箱
function ItemUse_XRBOX2( role, Item )

	local job = GetChaAttr(role, ATTR_JOB)
	local lv = GetChaAttr(role, ATTR_LV) 
        local cha_type = GetChaTypeID ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 6 then
		CALCULATE_ITEMEFFECT_LUA_000109 = GetResString("CALCULATE_ITEMEFFECT_LUA_000109")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000109)
		UseItemFailed ( role )
		return
	end
	if lv < 15 then
		CALCULATE_ITEMEFFECT_LUA_000110 = GetResString("CALCULATE_ITEMEFFECT_LUA_000110")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000110)
		UseItemFailed ( role )	
	elseif job == 1 then  
		GiveItem ( role , 0 , 2  , 1 , 95 ) 
		GiveItem ( role , 0 , 291  , 1 , 95 )
		GiveItem ( role , 0 , 4264  , 1 , 4 )
		GiveItem ( role , 0 , 3351  , 1 , 4 )
		GiveItem ( role , 0 , 446  , 1 , 4 ) 
		GiveItem ( role , 0 , 439  , 1 , 4 ) 
	elseif job == 2 then   
		GiveItem ( role , 0 , 26  , 1 , 95 ) 
		GiveItem ( role , 0 , 306  , 1 , 95 )
		GiveItem ( role , 0 , 4264  , 1 , 4 )
		GiveItem ( role , 0 , 3352  , 1 , 4 )
		GiveItem ( role , 0 , 446  , 1 , 4 ) 
		GiveItem ( role , 0 , 439  , 1 , 4 ) 
	elseif job == 4 then  
		GiveItem ( role , 0 , 4264  , 1 , 4 )
		GiveItem ( role , 0 , 3353  , 1 , 4 )
		GiveItem ( role , 0 , 446  , 1 , 4 ) 
		GiveItem ( role , 0 , 74  , 1 , 95 ) 
		GiveItem ( role , 0 , 439  , 1 , 4 ) 
		if cha_type == 1 or cha_type == 3 then 
			GiveItem ( role , 0 , 338  , 1 , 95 )
		else
			GiveItem ( role , 0 , 386  , 1 , 95 ) 
		end
	elseif job == 5 then
		GiveItem ( role , 0 , 4264  , 1 , 4 )
		GiveItem ( role , 0 , 3352  , 1 , 4 )
		GiveItem ( role , 0 , 446  , 1 , 4 ) 
		GiveItem ( role , 0 , 439  , 1 , 4 ) 
		GiveItem ( role , 0 , 98  , 1 , 95 ) 
		if cha_type == 3 then 
			GiveItem ( role , 0 , 366  , 1 , 95 ) 
		else 
			GiveItem ( role , 0 , 381  , 1 , 95 )
		end
	else 
		CALCULATE_ITEMEFFECT_LUA_000108 = GetResString("CALCULATE_ITEMEFFECT_LUA_000108")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000108)
		UseItemFailed ( role )	
	end
end
----------------------------------+3新人宝箱
function ItemUse_XRBOX3( role, Item )

	local job = GetChaAttr(role, ATTR_JOB)
	local lv = GetChaAttr(role, ATTR_LV) 
        local cha_type = GetChaTypeID ( role )
        local cha_type = GetChaTypeID ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 7 then
		CALCULATE_ITEMEFFECT_LUA_000099 = GetResString("CALCULATE_ITEMEFFECT_LUA_000099")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000099)
		UseItemFailed ( role )
		return
	end
	if lv < 20 then
		CALCULATE_ITEMEFFECT_LUA_000111 = GetResString("CALCULATE_ITEMEFFECT_LUA_000111")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000111)
		UseItemFailed ( role )	
	elseif job == 1 then  
		GiveItem ( role , 0 , 14  , 1 , 95 ) 
		GiveItem(role,0,3088,1,4)  ----24格升28格背包
		GiveItem(role,0,3089,1,4)  ----28格升32格背包		
		GiveItem ( role , 0 , 297  , 1 , 95 )
		GiveItem ( role , 0 , 3844  , 1 , 4 )
		GiveItem ( role , 0 , 447  , 1 , 4 ) 
		GiveItem ( role , 0 , 440  , 1 , 4 ) 
	elseif job == 2 then  
		GiveItem ( role , 0 , 33  , 1 , 95 ) 
		GiveItem(role,0,3088,1,4)  ----24格升28格背包
		GiveItem(role,0,3089,1,4)  ----28格升32格背包		
		GiveItem ( role , 0 , 313  , 1 , 95 )
		GiveItem ( role , 0 , 3844  , 1 , 4 )
		GiveItem ( role , 0 , 447  , 1 , 4 ) 
		GiveItem ( role , 0 , 440  , 1 , 4 ) 
	elseif job == 4 then  
		GiveItem ( role , 0 , 3844  , 1 , 4 )
		GiveItem(role,0,3088,1,4)  ----24格升28格背包
		GiveItem(role,0,3089,1,4)  ----28格升32格背包		
		GiveItem ( role , 0 , 447  , 1 , 4 ) 
		GiveItem ( role , 0 , 440  , 1 , 4 ) 
		GiveItem ( role , 0 , 81  , 1 , 95 ) 
		if cha_type == 1 or cha_type == 3 then 
			GiveItem ( role , 0 , 337  , 1 , 95 )
		else
			GiveItem ( role , 0 , 352  , 1 , 95 ) 
		end
	elseif job == 5 then 
		GiveItem ( role , 0 , 3844  , 1 , 4 )
		GiveItem(role,0,3088,1,4)  ----24格升28格背包
		GiveItem(role,0,3089,1,4)  ----28格升32格背包		
		GiveItem ( role , 0 , 447  , 1 , 4 ) 
		GiveItem ( role , 0 , 440  , 1 , 4 ) 
		GiveItem ( role , 0 , 105  , 1 , 95 )
		if cha_type == 3 then 
			GiveItem ( role , 0 , 373  , 1 , 95 )
		else 
			GiveItem ( role , 0 , 360  , 1 , 95 )
		end
	else 
		CALCULATE_ITEMEFFECT_LUA_000108 = GetResString("CALCULATE_ITEMEFFECT_LUA_000108")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000108)
		UseItemFailed ( role )	
	end
end
----------------------------------+4新人宝箱
function ItemUse_XRBOX4( role, Item )

	local job = GetChaAttr(role, ATTR_JOB)
	local lv = GetChaAttr(role, ATTR_LV) 
        local cha_type = GetChaTypeID ( role )
        local cha_type = GetChaTypeID ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	--local r1,r2 =MakeItem ( role , 0 , 3  , 1 , 11 )

	if Item_CanGet < 4 then
		CALCULATE_ITEMEFFECT_LUA_000101 = GetResString("CALCULATE_ITEMEFFECT_LUA_000101")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000101)
		UseItemFailed ( role )
		return
	end
	if lv < 25 then
		CALCULATE_ITEMEFFECT_LUA_000112 = GetResString("CALCULATE_ITEMEFFECT_LUA_000112")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000112)
		UseItemFailed ( role )	
	elseif job == 1 then   ----剑士
		local r1,r2 =MakeItem ( role , 3  , 1 , 11 )
		local Item1 = GetChaItem ( role , 2 , r2 )			--取精炼武器道具指针
		GiveItem ( role , 0 , 293  , 1 , 95 )
		GiveItem ( role , 0 , 448  , 1 , 95 )
		GiveItem ( role , 0 , 441  , 1 , 4 ) 
	elseif job == 2 then  
		local r1,r2 =MakeItem ( role , 27  , 1 , 11 )
		local Item1 = GetChaItem ( role , 2 , r2 )			--取精炼武器道具指针
		GiveItem ( role , 0 , 307  , 1 , 95 )
		GiveItem ( role , 0 , 448  , 1 , 95 )
		GiveItem ( role , 0 , 441  , 1 , 4 ) 
	elseif job == 4 then 
		GiveItem ( role , 0 , 448  , 1 , 95 )
		GiveItem ( role , 0 , 441  , 1 , 4 ) 
		local r1,r2 =MakeItem ( role , 75  , 1 , 11 )
		local Item1 = GetChaItem ( role , 2 , r2 )			--取精炼武器道具指针
		if cha_type == 1 or cha_type == 3 then
			GiveItem ( role , 0 , 340  , 1 , 95 ) 
		else
			GiveItem ( role , 0 , 350  , 1 , 95 ) 
		end
	elseif job == 5 then 
		GiveItem ( role , 0 , 448  , 1 , 95 )
		GiveItem ( role , 0 , 441  , 1 , 4 ) 
		local r1,r2 =MakeItem ( role , 99  , 1 , 11 )
		local Item1 = GetChaItem ( role , 2 , r2 )			--取精炼武器道具指针
		if cha_type == 3 then
			GiveItem ( role , 0 , 368  , 1 , 95 )
		else 
			GiveItem ( role , 0 , 389  , 1 , 95 )
		end
	else 
		CALCULATE_ITEMEFFECT_LUA_000108 = GetResString("CALCULATE_ITEMEFFECT_LUA_000108")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000108)
		UseItemFailed ( role )	
	end
end
----------------------------------+5新人宝箱
function ItemUse_XRBOX5( role, Item )

	local job = GetChaAttr(role, ATTR_JOB)
	local lv = GetChaAttr(role, ATTR_LV) 
        local cha_type = GetChaTypeID ( role )
        local cha_type = GetChaTypeID ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 6 then
		CALCULATE_ITEMEFFECT_LUA_000101 = GetResString("CALCULATE_ITEMEFFECT_LUA_000101")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000101)
		UseItemFailed ( role )
		return
	end
	if lv < 30 then
		CALCULATE_ITEMEFFECT_LUA_000113 = GetResString("CALCULATE_ITEMEFFECT_LUA_000113")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000113)
		UseItemFailed ( role )	
	elseif job == 1 then  
		GiveItem ( role , 0 , 12  , 1 , 95 ) 
		GiveItem ( role , 0 , 3909  , 8 , 95 )--------食神水饺
		GiveItem ( role , 0 , 3098  , 9 , 95 )	-----------	强力体力恢复剂		
		GiveItem ( role , 0 , 298  , 1 , 95 )
		GiveItem ( role , 0 , 449  , 1 , 95 )
		GiveItem ( role , 0 , 442  , 1 , 4 ) 
	elseif job == 2 then 
		GiveItem ( role , 0 , 34  , 1 , 95 ) 
		GiveItem ( role , 0 , 3909  , 8 , 95 )--------食神水饺
		GiveItem ( role , 0 , 3098  , 9 , 95 )	-----------	强力体力恢复剂		
		GiveItem ( role , 0 , 314  , 1 , 95 )
		GiveItem ( role , 0 , 449  , 1 , 95 )
		GiveItem ( role , 0 , 442  , 1 , 4 ) 
	elseif job == 4 then  
		GiveItem ( role , 0 , 449  , 1 , 95 )
		GiveItem ( role , 0 , 3909  , 8 , 95 )--------食神水饺
		GiveItem ( role , 0 , 3098  , 9 , 95 )	-----------	强力体力恢复剂		
		GiveItem ( role , 0 , 442  , 1 , 4 )
		GiveItem ( role , 0 , 82  , 1 , 95 )
		if cha_type == 1 or cha_type == 3 then 
			GiveItem ( role , 0 , 339  , 1 , 95 )
		else 
			GiveItem ( role , 0 , 354  , 1 , 95 ) 
		end
	elseif job == 5 then
		GiveItem ( role , 0 , 449  , 1 , 95 )
		GiveItem ( role , 0 , 3909  , 8 , 95 )--------食神水饺
		GiveItem ( role , 0 , 3098  , 9 , 95 )	-----------	强力体力恢复剂		
		GiveItem ( role , 0 , 442  , 1 , 4 ) 
		GiveItem ( role , 0 , 106  , 1 , 95 )
		if cha_type == 3 then
			GiveItem ( role , 0 , 374  , 1 , 95 )
		else 
			GiveItem ( role , 0 , 361  , 1 , 95 )
		end
	else 
		CALCULATE_ITEMEFFECT_LUA_000108 = GetResString("CALCULATE_ITEMEFFECT_LUA_000108")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000108)
		UseItemFailed ( role )	
	end
end
----------------------------------+6新人宝箱
function ItemUse_XRBOX6( role, Item )

	local job = GetChaAttr(role, ATTR_JOB)
	local lv = GetChaAttr(role, ATTR_LV) 
        local cha_type = GetChaTypeID ( role )
        local cha_type = GetChaTypeID ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 2 then
		CALCULATE_ITEMEFFECT_LUA_000114 = GetResString("CALCULATE_ITEMEFFECT_LUA_000114")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000114)
		UseItemFailed ( role )
		return
	end
	if lv < 35 then
		CALCULATE_ITEMEFFECT_LUA_000104 = GetResString("CALCULATE_ITEMEFFECT_LUA_000104")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000104)
		UseItemFailed ( role )	
	elseif job == 1 or job == 2 or job == 4 or job == 5 then
		GiveItem ( role , 0 , 443  , 1 , 4 ) 
		GiveItem ( role , 0 , 451  , 1 , 4 ) 
		AddMoney ( role , 0 , 20000 ) 
	else 
		CALCULATE_ITEMEFFECT_LUA_000108 = GetResString("CALCULATE_ITEMEFFECT_LUA_000108")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000108)
		UseItemFailed ( role )	
	end
end
----------------------------------+7新人宝箱
function ItemUse_XRBOX7( role, Item )

	local job = GetChaAttr(role, ATTR_JOB)
	local lv = GetChaAttr(role, ATTR_LV) 
        local cha_type = GetChaTypeID ( role )
        local cha_type = GetChaTypeID ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 6 then
		CALCULATE_ITEMEFFECT_LUA_000099 = GetResString("CALCULATE_ITEMEFFECT_LUA_000099")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000099)
		UseItemFailed ( role )
		return
	end
	if lv < 40 then
		CALCULATE_ITEMEFFECT_LUA_000115 = GetResString("CALCULATE_ITEMEFFECT_LUA_000115")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000115)
		UseItemFailed ( role )	
	elseif job == 9 then 
		GiveItem ( role , 0 , 450  , 1 , 4 ) 
		GiveItem( role , 0 , 333 , 2 , 4 )	
		GiveItem ( role , 0 , 295  , 1 , 95 )
		GiveItem ( role , 0 , 4  , 1 , 95 ) 
		GiveItem ( role , 0 , 302  , 1 , 95 )
		local r1,r2 =MakeItem ( role , 22  , 1 , 11 )
		local Item1 = GetChaItem ( role , 2 , r2 )			--取精炼武器道具指针
	elseif job == 8 then   
		GiveItem ( role , 0 , 450  , 1 , 4 ) 
				GiveItem( role , 0 , 333 , 2 , 4 )	
		GiveItem ( role , 0 , 300  , 1 , 95 )
		GiveItem ( role , 0 , 15  , 1 , 95 ) 
		GiveItem ( role , 0 , 301  , 1 , 95 )
		local r1,r2 =MakeItem ( role , 20  , 1 , 11 )
		local Item1 = GetChaItem ( role , 2 , r2 )			--取精炼武器道具指针
	elseif job == 12 then 
		GiveItem ( role , 0 , 39  , 1 , 95 ) 
				GiveItem( role , 0 , 333 , 2 , 4 )	
		GiveItem ( role , 0 , 310  , 1 , 95 )
		local r1,r2 =MakeItem ( role , 44  , 1 , 11 )
		local Item1 = GetChaItem ( role , 2 , r2 )			--取精炼武器道具指针
		GiveItem ( role , 0 , 315  , 1 , 95 )
		GiveItem ( role , 0 , 450  , 1 , 4 ) 
	elseif job == 16 then 
		GiveItem ( role , 0 , 450  , 1 , 95 )
				GiveItem( role , 0 , 333 , 2 , 4 )	
		GiveItem ( role , 0 , 76  , 1 , 95 ) 
		local r1,r2 =MakeItem ( role , 83  , 1 , 11 )
		local Item1 = GetChaItem ( role , 2 , r2 )			--取精炼武器道具指针
		if cha_type == 1 or cha_type == 3 then 
			GiveItem ( role , 0 , 341  , 1 , 95 )
			GiveItem ( role , 0 , 342  , 1 , 95 )
		else 
			GiveItem ( role , 0 , 353  , 1 , 95 )
			GiveItem ( role , 0 , 356  , 1 , 95 )
		end
	elseif job == 13 then    
		GiveItem ( role , 0 , 450  , 1 , 4 ) 
				GiveItem( role , 0 , 333 , 2 , 4 )	
		GiveItem ( role , 0 , 100  , 1 , 95 )
		local r1,r2 =MakeItem ( role , 1440  , 1 , 11 )
		local Item1 = GetChaItem ( role , 2 , r2 )			--取精炼武器道具指针
		if cha_type == 3 then 
			GiveItem ( role , 0 , 370  , 1 , 95 )
			GiveItem ( role , 0 , 378  , 1 , 95 )
		else 
			GiveItem ( role , 0 , 392  , 1 , 95 ) 
			GiveItem ( role , 0 , 388  , 1 , 95 ) 
		end
	elseif job == 14 then    
		GiveItem ( role , 0 , 450  , 1 , 4 ) 
				GiveItem( role , 0 , 333 , 2 , 4 )	
		GiveItem ( role , 0 , 101  , 1 , 95 ) 
		local r1,r2 =MakeItem ( role , 107  , 1 , 11 )
		local Item1 = GetChaItem ( role , 2 , r2 )			--取精炼武器道具指针
		if cha_type == 3 then 
			GiveItem ( role , 0 , 367  , 1 , 95 ) 
			GiveItem ( role , 0 , 375  , 1 , 95 ) 
		else  
			GiveItem ( role , 0 , 390  , 1 , 95 ) 
			GiveItem ( role , 0 , 362  , 1 , 95 ) 
		
		end
	else 
		CALCULATE_ITEMEFFECT_LUA_000116 = GetResString("CALCULATE_ITEMEFFECT_LUA_000116")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000116)
		UseItemFailed ( role )	
	end
end
-------------------------------------------------------- --[[粽子公式]]--
function ItemUse_ZhongZi ( role , Item ) 

	local hp = GetChaAttr(role, ATTR_HP)  
	if hp <= 0 then   
	end 
	hp_resume = 50 
	hp = hp + hp_resume 
	mxhp = GetChaAttr(role,ATTR_MXHP) 
	if hp > mxhp then --加超过最大hp时返回为最大hp
		hp = mxhp 
	end 
	SetCharaAttr(hp, role, ATTR_HP) 
end 
------------------------------------------------------------ --[[雄黄酒公式]]--
function ItemUse_XiongHJ ( role , Item ) 

	local statelv = 1
	local statetime = 1800
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ==  nil then
		AddState( role , role , STATE_PKSFYS , statelv , statetime )
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
end 
---------------------------------------------------------- --[[艾草公式]]--
function ItemUse_AiCao ( role , Item )  

	local statelv = 1
	local statetime = 180
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ==  nil then
		AddState( role , role , STATE_PKSBYS , statelv , statetime )
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
end 



------------------------------------------- 风雷宝箱
function ItemUse_FLeiBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	local BNUM = B1+B2+B3+B4+B5+B6+B7+B8+B9+B10+B11+B12+B13+B14+B15
	if Item_CanGet < BNUM then
		CALCULATE_FUNCTIONS_LUA_000859 = GetResString("CALCULATE_FUNCTIONS_LUA_000859")
		CALCULATE_ITEMEFFECT_LUA_000117 = GetResString("CALCULATE_ITEMEFFECT_LUA_000117")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000117..BNUM..CALCULATE_FUNCTIONS_LUA_000859)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , A1 , B1 , 4 )
	GiveItem ( role , 0 , A2 , B2 , 4 )
	GiveItem ( role , 0 , A3 , B3 , 4 )
	GiveItem ( role , 0 , A4 , B4 , 4 )
	GiveItem ( role , 0 , A5 , B5 , 4 )
	GiveItem ( role , 0 , A6 , B6 , 4 )
	GiveItem ( role , 0 , A7 , B7 , 4 )
	GiveItem ( role , 0 , A8 , B8 , 4 )
	GiveItem ( role , 0 , A9 , B9 , 4 )
	GiveItem ( role , 0 , A10 , B10 , 4 )
	GiveItem ( role , 0 , A11 , B11 , 4 )
	GiveItem ( role , 0 , A12 , B12 , 4 )
	GiveItem ( role , 0 , A13 , B13 , 4 )
	GiveItem ( role , 0 , A14 , B14 , 4 )
	GiveItem ( role , 0 , A15 , B15 , 4 )
	GiveItem ( role , 0 , A16 , B16 , 4 )
	GiveItem ( role , 0 , A17 , B17 , 4 )
	GiveItem ( role , 0 , A18 , B18 , 4 )
	GiveItem ( role , 0 , A19 , B19 , 4 )
	GiveItem ( role , 0 , A20 , B20 , 4 )
	GiveItem ( role , 0 , A21 , B21 , 4 )
	GiveItem ( role , 0 , A22 , B22 , 4 )
	GiveItem ( role , 0 , A23 , B23 , 4 )
	GiveItem ( role , 0 , A24 , B24 , 4 )
end
	 
----------------------------------------------超级宠物宝箱
function ItemUse_CJBOX( role , Item )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local r1,r2 =MakeItem ( role , C1  , 1 , 4 )
	local Item_newJL = GetChaItem ( role , 2 , r2 )			--取新精灵道具指针
	local Item_newJLID = GetItemID ( Item_newJL )			--取新精灵道具指针


	local str_JLone = GetItemAttr( Item_newJL ,ITEMATTR_VAL_STR )       --力量
	local con_JLone = GetItemAttr( Item_newJL ,ITEMATTR_VAL_CON )       --体质
	local agi_JLone = GetItemAttr( Item_newJL ,ITEMATTR_VAL_AGI )       --专注
	local dex_JLone = GetItemAttr( Item_newJL ,ITEMATTR_VAL_DEX )       --敏捷
	local sta_JLone = GetItemAttr( Item_newJL ,ITEMATTR_VAL_STA )       --精神

	local Num_JL = GetItemForgeParam ( Item_newJL , 1 )
	Num_JL = TansferNum ( Num_JL )
	local Part1_JL = GetNum_Part1 ( Num_JL )	--Get Num Part 1 到 Part 7
	local Part2_JL = GetNum_Part2 ( Num_JL )	
	local Part3_JL = GetNum_Part3 ( Num_JL )
	local Part4_JL = GetNum_Part4 ( Num_JL )
	local Part5_JL = GetNum_Part5 ( Num_JL )
	local Part6_JL = GetNum_Part6 ( Num_JL )
	local Part7_JL = GetNum_Part7 ( Num_JL )
	if Item_newJLID==231 or Item_newJLID==232 or Item_newJLID==233 or Item_newJLID==234 or Item_newJLID==235  or Item_newJLID==236  or Item_newJLID==237  or Item_newJLID==681 then
		Part1_JL=1
		Num_JL = SetNum_Part1 ( Num_JL , 1 ) ----------二转标记
		SetItemForgeParam ( Item_newJL , 1 , Num_JL )
	end
	str_JLone	= N1
	con_JLone = N2
	agi_JLone	= N3
	dex_JLone = N4
	sta_JLone	= N5
	local new_lv=N1+N2+N3+N4+N5
	local new_MAXENERGY = 240 * ( new_lv + 1 )
	if new_MAXENERGY > 6480 then
		new_MAXENERGY = 6480
	end
	local new_MAXURE = 5000 + 1000*new_lv
	if new_MAXURE > 32000 then
		new_MAXURE = 32000
	end
	SetItemAttr ( Item_newJL ,ITEMATTR_VAL_STR , str_JLone )
	SetItemAttr ( Item_newJL ,ITEMATTR_VAL_CON , con_JLone )
	SetItemAttr ( Item_newJL ,ITEMATTR_VAL_AGI , agi_JLone )
	SetItemAttr ( Item_newJL ,ITEMATTR_VAL_DEX , dex_JLone)
	SetItemAttr ( Item_newJL ,ITEMATTR_VAL_STA , sta_JLone)
	SetItemAttr ( Item_newJL , ITEMATTR_MAXENERGY , new_MAXENERGY ) 	
	SetItemAttr ( Item_newJL , ITEMATTR_MAXURE , new_MAXURE )
	SetItemAttr ( Item_newJL , ITEMATTR_ENERGY , new_MAXENERGY ) 	
	SetItemAttr ( Item_newJL , ITEMATTR_URE , new_MAXURE )
	local cha_name = GetChaDefaultName ( role )
	--LG( "star_JLZS_lg" ,cha_name,Item_JLone_ID , lv_JLone , str_JLone , con_JLone , agi_JLone , dex_JLone , sta_JLone , Item_JLother_ID , lv_JLother  , str_JLother , con_JLother , agi_JLother , dex_JLother , sta_JLother )
	LG( "star_CJBOX" ,cha_name, C1 , N1 , N2 ,  N3 , N4 , N5 )

end

----------------------------------------------勇者宝箱
function ItemUse_YZheBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 8 then
		CALCULATE_ITEMEFFECT_LUA_000119 = GetResString("CALCULATE_ITEMEFFECT_LUA_000119")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000119)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 453 , 1 , 4 )
	GiveItem ( role , 0 , 454 , 1 , 4 )
	GiveItem ( role , 0 , 455 , 1 , 4 )
	GiveItem ( role , 0 , 456 , 1 , 4 )
	local rad = math.random ( 1, 8 )
	if rad == 1 then
	GiveItem ( role , 0 , 5013  , 1 , 4 ) 
	GiveItem ( role , 0 , 5021  , 1 , 4 ) 
	GiveItem ( role , 0 , 5029  , 1 , 4 ) 
	elseif rad == 2 then
	GiveItem ( role , 0 , 5014  , 1 , 4 ) 
	GiveItem ( role , 0 , 5022  , 1 , 4 ) 
	GiveItem ( role , 0 , 5030  , 1 , 4 ) 
	elseif rad == 3 then
	GiveItem ( role , 0 , 5015  , 1 , 4 ) 
	GiveItem ( role , 0 , 5023  , 1 , 4 ) 
	GiveItem ( role , 0 , 5031  , 1 , 4 ) 
	elseif rad == 4 then
	GiveItem ( role , 0 , 5016  , 1 , 4 ) 
	GiveItem ( role , 0 , 5024  , 1 , 4 ) 
	GiveItem ( role , 0 , 5032  , 1 , 4 ) 
	GiveItem ( role , 0 , 5037  , 1 , 4 ) 
	elseif rad == 5 then
	GiveItem ( role , 0 , 5017  , 1 , 4 ) 
	GiveItem ( role , 0 , 5025  , 1 , 4 ) 
	GiveItem ( role , 0 , 5033  , 1 , 4 )
	elseif rad == 6 then
	GiveItem ( role , 0 , 5018  , 1 , 4 ) 
	GiveItem ( role , 0 , 5026  , 1 , 4 ) 
	GiveItem ( role , 0 , 5034  , 1 , 4 )
	elseif rad == 7 then
	GiveItem ( role , 0 , 5019  , 1 , 4 ) 
	GiveItem ( role , 0 , 5027  , 1 , 4 ) 
	GiveItem ( role , 0 , 5035  , 1 , 4 )
	elseif rad == 8 then
	GiveItem ( role , 0 , 5020  , 1 , 4 ) 
	GiveItem ( role , 0 , 5028  , 1 , 4 ) 
	GiveItem ( role , 0 , 5036  , 1 , 4 )
	GiveItem ( role , 0 , 5038  , 1 , 4 )
	end
end

----------------------------------------双倍经验增幅器
function ItemUse_MoreExpGzA( role , Item )

	local statelv = 1
	local ZBMain= GetChaAttr(role,ATTR_EXTEND0)
	local ZBNType= math.floor(ZBMain/10)      ---第几次占卜
	local ZBNMain= math.fmod(ZBMain,10 )			---BUFF OR DEBUFF
	local ZBday = GetChaAttr(role,ATTR_EXTEND2)		--占卜天数
	local ZBstate=GetChaAttr(role, ATTR_EXTEND1)	--
	local ZBstate1=math.floor(ZBstate/10)			--占卜效果注册
	local ZBstate2=math.fmod(ZBstate,10)				--占卜类型
	local now_day=os.date("%d")
	now_day=tonumber(now_day)
	if now_day==ZBday and ZBstate2==7 then
		statelv=14
	end

	local statetime = 1800  --1800
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		local ret = UseAexpItem(role,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	else
		local ret = UseAexpItem(Cha_Boat,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	end
	if statelv==14 then 
		CALCULATE_ITEMEFFECT_LUA_000120 = GetResString("CALCULATE_ITEMEFFECT_LUA_000120")
		SystemNotice ( role,CALCULATE_ITEMEFFECT_LUA_000120 )
	end
end

----------------------------------------高级努力增幅器
function ItemUse_MoreExpGzLv3A( role , Item )
	
	local Lv = Lv( role )
	if Lv < 60 then
		CALCULATE_ITEMEFFECT_LUA_000033 = GetResString("CALCULATE_ITEMEFFECT_LUA_000033")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000033)
		UseItemFailed ( role )
		return
	end

	local statelv=3 
	local statetime = 1800
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		local ret = UseAexpItem(role,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	else
		local ret = UseAexpItem(Cha_Boat,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	end
	CALCULATE_ITEMEFFECT_LUA_000121 = GetResString("CALCULATE_ITEMEFFECT_LUA_000121")
	SystemNotice ( role ,CALCULATE_ITEMEFFECT_LUA_000121 )
end


--ItemUse_MoreItemGz
-------------------------------双倍掉料增幅器
function ItemUse_MoreItemGzA( role , Item )

	local statelv = 1
	
	
	local statetime = 1800
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ==  nil then
		local ret = UseABLItem(role,Item,statelv,statetime)
		if ret == 0 then
			UseItemFailed ( role )
			return
		end
	else
		local ret = UseABLItem(Cha_Boat,Item,statelv,statetime)
		if ret == 0 then
			UseItemFailed ( role )
			return
		end
	end
end

----------------------------------------高级财富增幅器
function ItemUse_MoreItemGzLv3A( role , Item )

	local Lv = Lv( role )
	if Lv < 60 then
		CALCULATE_ITEMEFFECT_LUA_000033 = GetResString("CALCULATE_ITEMEFFECT_LUA_000033")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000033)
		UseItemFailed ( role )
		return
	end


	local statelv = 5

	local statetime = 1800
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ==  nil then
		local ret = UseABLItem(role,Item,statelv,statetime)
		if ret == 0 then
			UseItemFailed ( role )
			return
		end
	else
		local ret = UseABLItem(Cha_Boat,Item,statelv,statetime)
		if ret == 0 then
			UseItemFailed ( role )
			return
		end
	end
	CALCULATE_ITEMEFFECT_LUA_000122 = GetResString("CALCULATE_ITEMEFFECT_LUA_000122")
	SystemNotice ( role ,CALCULATE_ITEMEFFECT_LUA_000122 )
end
-------------------------------------强力体力恢复剂
function ItemUse_TLHFJA( role , Item )

	local hp = GetChaAttr(role, ATTR_HP) 
	hp_resume = 1000 
	
	hp = hp + hp_resume 
	mxhp = GetChaAttr(role,ATTR_MXHP) 
	if hp > mxhp then --加超过最大sp时返回为最大sp
		hp = mxhp 
	end 
	SetCharaAttr(hp, role, ATTR_HP)
end
------------------------------------SP神仙水
function ItemUse_TMLGZA( role , Item ) 

	local sp = GetChaAttr(role, ATTR_SP) 
	sp_resume = 150 
	
	sp = sp + sp_resume 
	mxsp = GetChaAttr(role,ATTR_MXSP) 
	if sp > mxsp then --加超过最大sp时返回为最大sp
		sp = mxsp 
	end 
	SetCharaAttr(sp, role, ATTR_SP) 
end 
---------------------------------------------雄狮模拟药剂( str )kokora08调整
function ItemUse_SPXsyjA( role , Item )
	
	local OtherStateLv = 0
	local i = 0
	local State_Num = 8
	local State = {}
	State [0] = GetChaStateLv ( role , STATE_YSMJQH )
	State [1] = GetChaStateLv ( role , STATE_YSLQQH )
	State [2] = GetChaStateLv ( role , STATE_YSTZQH )
	State [3] = GetChaStateLv ( role , STATE_YSJSQH )
	State [4] = GetChaStateLv ( role , STATE_DEMON )
	State [5] = GetChaStateLv ( role , STATE_GREATSH )
	State [6] = GetChaStateLv ( role , STATE_MIRAGE )
	State [7] = GetChaStateLv ( role , STATE_DEVOTE )
	State [8] = GetChaStateLv ( role , STATE_VIGOUR )

	for i = 0 , State_Num , 1 do
		if State[i] >= 1 then
			OtherStateLv = OtherStateLv + 1
		end
	end



	if OtherStateLv > 0 then
		CALCULATE_ITEMEFFECT_LUA_000043 = GetResString("CALCULATE_ITEMEFFECT_LUA_000043")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000043)
		UseItemFailed ( role )
		return
	end	

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end


	local statelv = 1
	local statetime = 5400
	AddState( role , role , STATE_YSLLQH , statelv , statetime )

end
-----------------------------------------------灵猴模拟药剂( agi )kokora08调整
function ItemUse_SPLhyjA( role , Item )

	local OtherStateLv = 0
	local i = 0
	local State_Num = 8
	local State = {}
	State [0] = GetChaStateLv ( role , STATE_YSLQQH )
	State [1] = GetChaStateLv ( role , STATE_YSTZQH )
	State [2] = GetChaStateLv ( role , STATE_YSJSQH )
	State [3] = GetChaStateLv ( role , STATE_YSLLQH )
	State [4] = GetChaStateLv ( role , STATE_DEMON )
	State [5] = GetChaStateLv ( role , STATE_GREATSH )
	State [6] = GetChaStateLv ( role , STATE_MIRAGE )
	State [7] = GetChaStateLv ( role , STATE_DEVOTE )
	State [8] = GetChaStateLv ( role , STATE_VIGOUR )

	for i = 0 , State_Num , 1 do
		if State[i] >= 1 then
			OtherStateLv = OtherStateLv + 1
		end
	end



	if OtherStateLv > 0 then
		CALCULATE_ITEMEFFECT_LUA_000043 = GetResString("CALCULATE_ITEMEFFECT_LUA_000043")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000043)
		UseItemFailed ( role )
		return
	end
	
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end

	local statelv = 1
	local statetime = 5400
	AddState( role , role , STATE_YSMJQH , statelv , statetime )

end

------------------------------------------------鹰眼模拟药剂( dex )kokora08调整
function ItemUse_SPYyyjA( role , Item )

	local OtherStateLv = 0
	local i = 0
	local State_Num = 8
	local State = {}
	State [0] = GetChaStateLv ( role , STATE_YSMJQH )
	State [1] = GetChaStateLv ( role , STATE_YSTZQH )
	State [2] = GetChaStateLv ( role , STATE_YSJSQH )
	State [3] = GetChaStateLv ( role , STATE_YSLLQH )
	State [4] = GetChaStateLv ( role , STATE_DEMON )
	State [5] = GetChaStateLv ( role , STATE_GREATSH )
	State [6] = GetChaStateLv ( role , STATE_MIRAGE )
	State [7] = GetChaStateLv ( role , STATE_DEVOTE )
	State [8] = GetChaStateLv ( role , STATE_VIGOUR )

	for i = 0 , State_Num , 1 do
		if State[i] >= 1 then
			OtherStateLv = OtherStateLv + 1
		end
	end



	if OtherStateLv > 0 then
		CALCULATE_ITEMEFFECT_LUA_000043 = GetResString("CALCULATE_ITEMEFFECT_LUA_000043")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000043)
		UseItemFailed ( role )
		return
	end

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end


	local statelv = 1
	local statetime = 5400
	AddState( role , role , STATE_YSLQQH , statelv , statetime )

end

-----------------------------------------------------蛮牛模拟药剂( con )kokora08调整
function ItemUse_SPMnyjA( role , Item )
	
	local OtherStateLv = 0
	local i = 0
	local State_Num = 8
	local State = {}
	State [0] = GetChaStateLv ( role , STATE_YSMJQH )
	State [1] = GetChaStateLv ( role , STATE_YSLQQH )
	State [2] = GetChaStateLv ( role , STATE_YSJSQH )
	State [3] = GetChaStateLv ( role , STATE_YSLLQH )
	State [4] = GetChaStateLv ( role , STATE_DEMON )
	State [5] = GetChaStateLv ( role , STATE_GREATSH )
	State [6] = GetChaStateLv ( role , STATE_MIRAGE )
	State [7] = GetChaStateLv ( role , STATE_DEVOTE )
	State [8] = GetChaStateLv ( role , STATE_VIGOUR )

	for i = 0 , State_Num , 1 do
		if State[i] >= 1 then
			OtherStateLv = OtherStateLv + 1
		end
	end



	if OtherStateLv > 0 then
		CALCULATE_ITEMEFFECT_LUA_000043 = GetResString("CALCULATE_ITEMEFFECT_LUA_000043")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000043)
		UseItemFailed ( role )
		return
	end

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end


	local statelv = 1
	local statetime = 5400
	AddState( role , role , STATE_YSTZQH , statelv , statetime )

end

------------------------------------------------圣灵模拟药剂( sta )kokora08商品调整
function ItemUse_SPSlyjA( role , Item )
	
	local OtherStateLv = 0
	local i = 0
	local State_Num = 8
	local State = {}
	State [0] = GetChaStateLv ( role , STATE_YSMJQH )
	State [1] = GetChaStateLv ( role , STATE_YSLQQH )
	State [2] = GetChaStateLv ( role , STATE_YSTZQH )
	State [3] = GetChaStateLv ( role , STATE_YSLLQH )
	State [4] = GetChaStateLv ( role , STATE_DEMON )
	State [5] = GetChaStateLv ( role , STATE_GREATSH )
	State [6] = GetChaStateLv ( role , STATE_MIRAGE )
	State [7] = GetChaStateLv ( role , STATE_DEVOTE )
	State [8] = GetChaStateLv ( role , STATE_VIGOUR )

	for i = 0 , State_Num , 1 do
		if State[i] >= 1 then
			OtherStateLv = OtherStateLv + 1
		end
	end


	if OtherStateLv > 0 then
		CALCULATE_ITEMEFFECT_LUA_000043 = GetResString("CALCULATE_ITEMEFFECT_LUA_000043")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000043)
		UseItemFailed ( role )
		return
	end

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end


	local statelv = 1
	local statetime = 5400
	AddState( role , role , STATE_YSJSQH , statelv , statetime )

end

--------------------------------行走润滑剂

function ItemUse_MspdYSA ( role , Item )

	local statelv = 1
	local statetime = 1800
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ==  nil then
		AddState( role , role , STATE_YSMspd , statelv , statetime )
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end

end
--------------------------------轻装药水 大幅提高行走速度小幅降低防御的道具持续时间15分钟
function ItemUse_MspdYSB ( role , Item )

	local statelv = 1
	local statetime = 900
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ==  nil then
		Rem_State_StarUnnormal ( role )
		AddState( role , role , STATE_QINGZ , statelv , statetime )
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
end
-------------------------------------战船装甲
function ItemUse_GJZhuangJiaA ( role , Item )

	local statelv = 1
	local statetime = 1800
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ~=  nil then
		AddState( Cha_Boat , Cha_Boat , STATE_YSBoatDEF , statelv , statetime )
	else
		CALCULATE_ITEMEFFECT_LUA_000074 = GetResString("CALCULATE_ITEMEFFECT_LUA_000074")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000074 )
		UseItemFailed ( role )
		return
	end

end
-----------------------------------元宵走马灯
function ItemUse_DenglongA ( role , Item )

	local statelv = 1
	local statetime = 900
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ==  nil then
		AddState( role , role , STATE_DENGLONG , statelv , statetime )
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
end
-----------------------------------全身装甲 大幅提高防御力小幅降低攻击力的道具持续时间15分钟
function ItemUse_DenglongB ( role , Item )

	local statelv = 1
	local statetime = 900
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ==  nil then
		Rem_State_StarUnnormal ( role )
		AddState( role , role , STATE_QUANS , statelv , statetime )
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
end

--雷霆堡机票

function Jz_Script_ltcsA(role, Item )

	local i = CheckBagItem(role,3048)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3048,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000002 = GetResString("BIRTH_BIRTH_CONF_LUA_000002")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000002)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end



--雷霆堡军港机票
function Jz_Script_ltjgcsA(role, Item )

	local i = CheckBagItem(role,3049)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3049,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000027 = GetResString("BIRTH_BIRTH_CONF_LUA_000027")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000027)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

--女生专区--雷霆堡军港直航票
function Jz_Script_ltjgcsA1(role, Item )

	local i = CheckBagItem(role,6400)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,6400,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000027 = GetResString("BIRTH_BIRTH_CONF_LUA_000027")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000027)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end


--圣雪山机票

function Jz_Script_sxscsA(role, Item )

	local i = CheckBagItem(role,3050)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end 
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3050,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000028 = GetResString("BIRTH_BIRTH_CONF_LUA_000028")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000028)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

--女生专区--圣雪山直航票

function Jz_Script_sxscsA1(role, Item )

	local i = CheckBagItem(role,6401)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end 
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,6401,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000028 = GetResString("BIRTH_BIRTH_CONF_LUA_000028")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000028)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

--赖安森林补给站机票

function Jz_Script_laslcsA(role, Item )

	local i = CheckBagItem(role,3051)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3051,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000007 = GetResString("BIRTH_BIRTH_CONF_LUA_000007")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000007)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

--女生专区---赖安森林直航票
function Jz_Script_laslcsA1(role, Item )

	local i = CheckBagItem(role,6399)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,6399,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000007 = GetResString("BIRTH_BIRTH_CONF_LUA_000007")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000007)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

--沙泉补给站机票
function Jz_Script_sqcsA(role, Item )

	local i = CheckBagItem(role,3052)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3052,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000012 = GetResString("BIRTH_BIRTH_CONF_LUA_000012")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000012)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

--冰极补给站机票

function Jz_Script_bjcsA(role, Item )

	local i = CheckBagItem(role,3053)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3053,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000017 = GetResString("BIRTH_BIRTH_CONF_LUA_000017")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000017)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

----女生专区--冰极直航票
function Jz_Script_bjcsA1(role, Item )

	local i = CheckBagItem(role,6398)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,6398,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000017 = GetResString("BIRTH_BIRTH_CONF_LUA_000017")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000017)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

--寂寞之塔入口机票

function Jz_Script_jmztcsA(role, Item )

	local i = CheckBagItem(role,3054)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3054,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000029 = GetResString("BIRTH_BIRTH_CONF_LUA_000029")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000029)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

--沙窟入口机票
function Jz_Script_scrkcsA(role, Item )

	local i = CheckBagItem(role,3055)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3055,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000030 = GetResString("BIRTH_BIRTH_CONF_LUA_000030")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000030)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

--废矿2层机票

function Jz_Script_fk2csA(role, Item )

	local i = CheckBagItem(role,3056)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3056,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000031 = GetResString("BIRTH_BIRTH_CONF_LUA_000031")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000031)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

--银矿2层机票

function Jz_Script_yk2csA(role, Item )

	local i = CheckBagItem(role,3057)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3057,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000032 = GetResString("BIRTH_BIRTH_CONF_LUA_000032")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000032)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

--银矿3层机票

function Jz_Script_yk3csA(role, Item )

	local i = CheckBagItem(role,3058)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3058,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000033 = GetResString("BIRTH_BIRTH_CONF_LUA_000033")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000033)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

--寂寞之塔2机票

function Jz_Script_jmzt2csA(role, Item )

	local i = CheckBagItem(role,3059)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3059,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000035 = GetResString("BIRTH_BIRTH_CONF_LUA_000035")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000035)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end
--寂寞之塔3机票

function Jz_Script_jmzt3csA(role, Item )

	local i = CheckBagItem(role,3060)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3060,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000036 = GetResString("BIRTH_BIRTH_CONF_LUA_000036")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000036)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end
--寂寞之塔4机票
function Jz_Script_jmzt4csA(role, Item )

	local i = CheckBagItem(role,3070)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3070,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000037 = GetResString("BIRTH_BIRTH_CONF_LUA_000037")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000037)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end
--寂寞之塔5机票

function Jz_Script_jmzt5csA(role, Item )

	local i = CheckBagItem(role,3071)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3071,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000038 = GetResString("BIRTH_BIRTH_CONF_LUA_000038")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000038)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end
--寂寞之塔6机票
function Jz_Script_jmzt6csA(role, Item )

	local i = CheckBagItem(role,3072)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3072,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000039 = GetResString("BIRTH_BIRTH_CONF_LUA_000039")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000039)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

--废矿1层机票

function Jz_Script_fk1csA(role, Item )

	local i = CheckBagItem(role,3073)
	local u = CheckBagItem(role,6454)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 and u <= 0 then
			local j = DelBagItem(role,3073,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000034 = GetResString("BIRTH_BIRTH_CONF_LUA_000034")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000034)
				return
			end
			SystemNotice (role, "cccccccc")
		elseif u > 0  then
			local o = DelBagItem(role,6454,1)
			if o == 1 then
				BIRTH_BIRTH_CONF_LUA_000034 = GetResString("BIRTH_BIRTH_CONF_LUA_000034")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000034)
				return
			end
		end
	else
		UseItemFailed ( role )
	end	
end
----春风镇送卷轴-------------------------------------------------------------------------------------------------------------------------------------
function Jz_Script_cfzsA(role, Item )

	local i = CheckBagItem(role,3076)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3076,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000045 = GetResString("BIRTH_BIRTH_CONF_LUA_000045")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000045)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end
---------------黑龙箱子使用-------------------
function ItemUse_CiChang( role, Item )

	local Elf_URE = GetItemAttr(Item,ITEMATTR_URE) --当前耐久记录剩余封印点数
	local Elf_EXP = GetItemAttr(Item,ITEMATTR_ENERGY) --最大能量记录诅咒点数
	if Elf_URE ~= 0 then
		CALCULATE_ITEMEFFECT_LUA_000123 = GetResString("CALCULATE_ITEMEFFECT_LUA_000123")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000123)
		UseItemFailed ( role )
		return
	end
	if Elf_EXP >9 then
		CALCULATE_ITEMEFFECT_LUA_000124 = GetResString("CALCULATE_ITEMEFFECT_LUA_000124")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000124)
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000125 = GetResString("CALCULATE_ITEMEFFECT_LUA_000125")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000125)
		UseItemFailed ( role )
		return
	end
	local sta = GetItemAttr( Item ,ITEMATTR_VAL_STA )       --精神
	if sta == 0 then
		CALCULATE_ITEMEFFECT_LUA_000126 = GetResString("CALCULATE_ITEMEFFECT_LUA_000126")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000126)
		UseItemFailed ( role )
		return
	end
	local cha_name = GetChaDefaultName ( role ) 
	if sta == 1 then ---核心一866黑龙之心----------给黑龙之躯
		if Elf_EXP == 0 then
		GiveItem ( role , 0 , 845  , 1 , 20  )  		
		end
		if Elf_EXP == 1 then
		GiveItem ( role , 0 , 845  , 1 , 19  )  		
		end
		if Elf_EXP == 2 then
		GiveItem ( role , 0 , 845  , 1 , 18  )  		
		end
		if Elf_EXP == 3 then
		GiveItem ( role , 0 , 845  , 1 , 17  )  		
		end
		if Elf_EXP == 4 then
		GiveItem ( role , 0 , 845  , 1 , 16  )  		
		end
		if Elf_EXP == 5 then
		GiveItem ( role , 0 , 845  , 1 , 15  )  		
		end
		if Elf_EXP == 6 then
		GiveItem ( role , 0 , 845  , 1 , 14  )  		
		end
		if Elf_EXP == 7 then
		GiveItem ( role , 0 , 845  , 1 , 13  )  		
		end
		if Elf_EXP == 8 then
		GiveItem ( role , 0 , 845  , 1 , 12  )  		
		end
		if Elf_EXP == 9 then
		GiveItem ( role , 0 , 845  , 1 , 12  )  		
		end
		CALCULATE_ITEMEFFECT_LUA_000127 = GetResString("CALCULATE_ITEMEFFECT_LUA_000127")
		CALCULATE_ITEMEFFECT_LUA_000128 = GetResString("CALCULATE_ITEMEFFECT_LUA_000128")
		local message =CALCULATE_ITEMEFFECT_LUA_000128.. cha_name..CALCULATE_ITEMEFFECT_LUA_000127  
		Notice ( message )
		CALCULATE_ITEMEFFECT_LUA_000129 = GetResString("CALCULATE_ITEMEFFECT_LUA_000129")
		CALCULATE_ITEMEFFECT_LUA_000130 = GetResString("CALCULATE_ITEMEFFECT_LUA_000130")
		CALCULATE_ITEMEFFECT_LUA_000131 = GetResString("CALCULATE_ITEMEFFECT_LUA_000131")
		LG("HeiLongJiTan",CALCULATE_ITEMEFFECT_LUA_000131,cha_name,CALCULATE_ITEMEFFECT_LUA_000130,Elf_EXP,CALCULATE_ITEMEFFECT_LUA_000129)
	end
	if sta == 2 then ---核心二865黑龙之魂---------------给黑龙之翼
		if Elf_EXP == 0 then
		GiveItem ( role , 0 , 847  , 1 , 20  )  		
		end
		if Elf_EXP == 1 then
		GiveItem ( role , 0 , 847  , 1 , 19  )  		
		end
		if Elf_EXP == 2 then
		GiveItem ( role , 0 , 847  , 1 , 18  )  		
		end
		if Elf_EXP == 3 then
		GiveItem ( role , 0 , 847  , 1 , 17  )  		
		end
		if Elf_EXP == 4 then
		GiveItem ( role , 0 , 847  , 1 , 16  )  		
		end
		if Elf_EXP == 5 then
		GiveItem ( role , 0 , 847  , 1 , 15  )  		
		end
		if Elf_EXP == 6 then
		GiveItem ( role , 0 , 847  , 1 , 14  )  		
		end
		if Elf_EXP == 7 then
		GiveItem ( role , 0 , 847  , 1 , 13  )  		
		end
		if Elf_EXP == 8 then
		GiveItem ( role , 0 , 847  , 1 , 12  )  		
		end
		if Elf_EXP == 9 then
		GiveItem ( role , 0 , 847  , 1 , 2  )  		
		end
		CALCULATE_ITEMEFFECT_LUA_000132 = GetResString("CALCULATE_ITEMEFFECT_LUA_000132")
		CALCULATE_ITEMEFFECT_LUA_000128 = GetResString("CALCULATE_ITEMEFFECT_LUA_000128")
		local message =CALCULATE_ITEMEFFECT_LUA_000128.. cha_name..CALCULATE_ITEMEFFECT_LUA_000132  
		Notice ( message )
		CALCULATE_ITEMEFFECT_LUA_000133 = GetResString("CALCULATE_ITEMEFFECT_LUA_000133")
		CALCULATE_ITEMEFFECT_LUA_000130 = GetResString("CALCULATE_ITEMEFFECT_LUA_000130")
		CALCULATE_ITEMEFFECT_LUA_000131 = GetResString("CALCULATE_ITEMEFFECT_LUA_000131")
		LG("HeiLongJiTan",CALCULATE_ITEMEFFECT_LUA_000131,cha_name,CALCULATE_ITEMEFFECT_LUA_000130,Elf_EXP,CALCULATE_ITEMEFFECT_LUA_000133)
	end
	if sta == 3 then ---核心三864黑龙之瞳---------------给黑龙之爪
		if Elf_EXP == 0 then
		GiveItem ( role , 0 , 846  , 1 , 20  )  		
		end
		if Elf_EXP == 1 then
		GiveItem ( role , 0 , 846  , 1 , 19  )  		
		end
		if Elf_EXP == 2 then
		GiveItem ( role , 0 , 846  , 1 , 18  )  		
		end
		if Elf_EXP == 3 then
		GiveItem ( role , 0 , 846  , 1 , 17  )  		
		end
		if Elf_EXP == 4 then
		GiveItem ( role , 0 , 846  , 1 , 16  )  		
		end
		if Elf_EXP == 5 then
		GiveItem ( role , 0 , 846  , 1 , 15  )  		
		end
		if Elf_EXP == 6 then
		GiveItem ( role , 0 , 846  , 1 , 14  )  		
		end
		if Elf_EXP == 7 then
		GiveItem ( role , 0 , 846  , 1 , 13  )  		
		end
		if Elf_EXP == 8 then
		GiveItem ( role , 0 , 846  , 1 , 12  )  		
		end
		if Elf_EXP == 9 then
		GiveItem ( role , 0 , 846  , 1 , 2  )  		
		end
		CALCULATE_ITEMEFFECT_LUA_000134 = GetResString("CALCULATE_ITEMEFFECT_LUA_000134")
		CALCULATE_ITEMEFFECT_LUA_000128 = GetResString("CALCULATE_ITEMEFFECT_LUA_000128")
		local message =CALCULATE_ITEMEFFECT_LUA_000128.. cha_name..CALCULATE_ITEMEFFECT_LUA_000134  
		Notice ( message )
		CALCULATE_ITEMEFFECT_LUA_000135 = GetResString("CALCULATE_ITEMEFFECT_LUA_000135")
		CALCULATE_ITEMEFFECT_LUA_000130 = GetResString("CALCULATE_ITEMEFFECT_LUA_000130")
		CALCULATE_ITEMEFFECT_LUA_000131 = GetResString("CALCULATE_ITEMEFFECT_LUA_000131")
		LG("HeiLongJiTan",CALCULATE_ITEMEFFECT_LUA_000131,cha_name,CALCULATE_ITEMEFFECT_LUA_000130,Elf_EXP,CALCULATE_ITEMEFFECT_LUA_000135)
	end
	if sta == 4 then ---核心三给黑龙之首
		if Elf_EXP == 0 then
		GiveItem ( role , 0 , 848  , 1 , 20  )  		
		end
		if Elf_EXP == 1 then
		GiveItem ( role , 0 , 848  , 1 , 19  )  		
		end
		if Elf_EXP == 2 then
		GiveItem ( role , 0 , 848  , 1 , 18  )  		
		end
		if Elf_EXP == 3 then
		GiveItem ( role , 0 , 848  , 1 , 17  )  		
		end
		if Elf_EXP == 4 then
		GiveItem ( role , 0 , 848  , 1 , 16  )  		
		end
		if Elf_EXP == 5 then
		GiveItem ( role , 0 , 848  , 1 , 15  )  		
		end
		if Elf_EXP == 6 then
		GiveItem ( role , 0 , 848  , 1 , 14  )  		
		end
		if Elf_EXP == 7 then
		GiveItem ( role , 0 , 848  , 1 , 13  )  		
		end
		if Elf_EXP == 8 then
		GiveItem ( role , 0 , 848  , 1 , 12  )  		
		end
		if Elf_EXP == 9 then
		GiveItem ( role , 0 , 848  , 1 , 2  )  		
		end
		CALCULATE_ITEMEFFECT_LUA_000136 = GetResString("CALCULATE_ITEMEFFECT_LUA_000136")
		CALCULATE_ITEMEFFECT_LUA_000128 = GetResString("CALCULATE_ITEMEFFECT_LUA_000128")
		local message =CALCULATE_ITEMEFFECT_LUA_000128.. cha_name..CALCULATE_ITEMEFFECT_LUA_000136  
		Notice ( message )
		CALCULATE_ITEMEFFECT_LUA_000137 = GetResString("CALCULATE_ITEMEFFECT_LUA_000137")
		CALCULATE_ITEMEFFECT_LUA_000130 = GetResString("CALCULATE_ITEMEFFECT_LUA_000130")
		CALCULATE_ITEMEFFECT_LUA_000131 = GetResString("CALCULATE_ITEMEFFECT_LUA_000131")
		LG("HeiLongJiTan",CALCULATE_ITEMEFFECT_LUA_000131,cha_name,CALCULATE_ITEMEFFECT_LUA_000130,Elf_EXP,CALCULATE_ITEMEFFECT_LUA_000137)
	end
	if Elf_EXP ~=0 then
		CALCULATE_ITEMEFFECT_LUA_000138 = GetResString("CALCULATE_ITEMEFFECT_LUA_000138")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000138)
	end
end
---------------核心使用-----------------------sta = GetItemAttr( Item_Traget ,ITEMATTR_VAL_STA )       --精神
function ItemUse_hexin ( role , Item , Item_Traget ) 

	local Item_Traget_ID = GetItemID ( Item_Traget )
	local Item_ID = GetItemID ( Item )		
	local sta = GetItemAttr( Item_Traget ,ITEMATTR_VAL_STA )       --精神
	if Item_Traget_ID ~= 266 then
		CALCULATE_ITEMEFFECT_LUA_000139 = GetResString("CALCULATE_ITEMEFFECT_LUA_000139")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000139)
		UseItemFailed ( role )
		return
	end
	if sta==1 and Item_ID == 866 then
		CALCULATE_ITEMEFFECT_LUA_000140 = GetResString("CALCULATE_ITEMEFFECT_LUA_000140")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000140)
		UseItemFailed ( role )
		return	
	end
	if sta==2 and Item_ID == 865 then
		CALCULATE_ITEMEFFECT_LUA_000141 = GetResString("CALCULATE_ITEMEFFECT_LUA_000141")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000141)
		UseItemFailed ( role )
		return	
	end
	if sta==3 and Item_ID == 864 then
		CALCULATE_ITEMEFFECT_LUA_000142 = GetResString("CALCULATE_ITEMEFFECT_LUA_000142")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000142)
		UseItemFailed ( role )
		return	
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type = GetItemType ( Item )
		local Item_Traget_Type = GetItemType ( Item_Traget )
		local cha_name = GetChaDefaultName ( role ) 
		if Item_type == 49 and Item_Traget_Type == 65 then
				if Item_ID == 866 then						---核心A
				sta =1
				CALCULATE_ITEMEFFECT_LUA_000143 = GetResString("CALCULATE_ITEMEFFECT_LUA_000143")
				SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000143 )
				CALCULATE_ITEMEFFECT_LUA_000144 = GetResString("CALCULATE_ITEMEFFECT_LUA_000144")
				CALCULATE_ITEMEFFECT_LUA_000131 = GetResString("CALCULATE_ITEMEFFECT_LUA_000131")
				LG("HeiLongJiTan_HeXin",CALCULATE_ITEMEFFECT_LUA_000131,cha_name,CALCULATE_ITEMEFFECT_LUA_000144)
				elseif Item_ID == 865 then						---核心B
				sta =2
				CALCULATE_ITEMEFFECT_LUA_000145 = GetResString("CALCULATE_ITEMEFFECT_LUA_000145")
				SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000145 )
				CALCULATE_ITEMEFFECT_LUA_000146 = GetResString("CALCULATE_ITEMEFFECT_LUA_000146")
				CALCULATE_ITEMEFFECT_LUA_000131 = GetResString("CALCULATE_ITEMEFFECT_LUA_000131")
				LG("HeiLongJiTan_HeXin",CALCULATE_ITEMEFFECT_LUA_000131,cha_name,CALCULATE_ITEMEFFECT_LUA_000146)
				elseif Item_ID == 864 then						---核心C
				sta =3
				CALCULATE_ITEMEFFECT_LUA_000147 = GetResString("CALCULATE_ITEMEFFECT_LUA_000147")
				SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000147 )
				CALCULATE_ITEMEFFECT_LUA_000148 = GetResString("CALCULATE_ITEMEFFECT_LUA_000148")
				CALCULATE_ITEMEFFECT_LUA_000131 = GetResString("CALCULATE_ITEMEFFECT_LUA_000131")
				LG("HeiLongJiTan_HeXin",CALCULATE_ITEMEFFECT_LUA_000131,cha_name,CALCULATE_ITEMEFFECT_LUA_000148)
				elseif Item_ID == 275 then						---核心D
				sta =4
				else 
						UseItemFailed ( role )
						return
				end
				SetItemAttr( Item_Traget ,ITEMATTR_VAL_STA ,sta )
		end 
end
---------------炎之力使用--------------------------str = GetItemAttr( Item_Traget ,ITEMATTR_VAL_STR )       --力量
function ItemUse_HZLi ( role , Item , Item_Traget ) 

	local Item_ID = GetItemID ( Item_Traget )
	if Item_ID ~= 266 then
		CALCULATE_ITEMEFFECT_LUA_000149 = GetResString("CALCULATE_ITEMEFFECT_LUA_000149")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000149)
		UseItemFailed ( role )
		return
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type = GetItemType ( Item )
		local Item_Traget_Type = GetItemType ( Item_Traget )
		if Item_type == 66 and Item_Traget_Type == 65  then
				local str = GetItemAttr( Item_Traget ,ITEMATTR_VAL_STR )       --力量
				if str >= 5 then
					UseItemFailed ( role )
				return
				end
				local rad = math.random ( 1, 100 )
				 if rad<=50 then
					local Elf_URE = GetItemAttr(Item_Traget,ITEMATTR_URE) --当前耐久记录剩余封印点数
					str = str + 1
					if Elf_URE >= 50 then
					Elf_URE = Elf_URE-50
					end
					SetItemAttr( Item_Traget ,ITEMATTR_VAL_STR ,str )
					SetItemAttr( Item_Traget ,ITEMATTR_URE ,Elf_URE )
				else 
				local Elf_MaxEXP = GetItemAttr(Item_Traget,ITEMATTR_MAXENERGY) --最大能量记录诅咒点数
				local Elf_EXP = GetItemAttr(Item_Traget,ITEMATTR_ENERGY) --最大能量记录诅咒点数
					Elf_MaxEXP = Elf_MaxEXP + 1
					Elf_EXP = Elf_EXP + 1
					CALCULATE_ITEMEFFECT_LUA_000150 = GetResString("CALCULATE_ITEMEFFECT_LUA_000150")
					SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000150 ) 
					SetItemAttr( Item_Traget ,ITEMATTR_MAXENERGY ,Elf_MaxEXP )
					SetItemAttr( Item_Traget ,ITEMATTR_ENERGY ,Elf_EXP )
				end 
		end 
end


---------------冰之力使用-------------------------con = GetItemAttr( Item_Traget ,ITEMATTR_VAL_CON )       --体质

function ItemUse_BZLi ( role , Item , Item_Traget ) 

	local Item_ID = GetItemID ( Item_Traget )
	if Item_ID ~= 266 then
		CALCULATE_ITEMEFFECT_LUA_000151 = GetResString("CALCULATE_ITEMEFFECT_LUA_000151")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000151)
		UseItemFailed ( role )
		return
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type = GetItemType ( Item )
		local Item_Traget_Type = GetItemType ( Item_Traget )
		if Item_type == 66 and Item_Traget_Type == 65 then
				local con = GetItemAttr( Item_Traget ,ITEMATTR_VAL_CON )       --体质
				if con >= 5 then
					UseItemFailed ( role )
				return
				end
				local rad = math.random ( 1, 100 )
				 if rad<=50 then
					local Elf_URE = GetItemAttr(Item_Traget,ITEMATTR_URE) --当前耐久记录剩余封印点数
					con = con + 1
					if Elf_URE >= 50 then
					Elf_URE = Elf_URE-50
					end
					SetItemAttr( Item_Traget ,ITEMATTR_VAL_CON ,con )
					SetItemAttr( Item_Traget ,ITEMATTR_URE ,Elf_URE )
				else 
				local Elf_MaxEXP = GetItemAttr(Item_Traget,ITEMATTR_MAXENERGY) --最大能量记录诅咒点数
				local Elf_EXP = GetItemAttr(Item_Traget,ITEMATTR_ENERGY) --最大能量记录诅咒点数
					Elf_MaxEXP = Elf_MaxEXP + 1
					Elf_EXP = Elf_EXP + 1
					CALCULATE_ITEMEFFECT_LUA_000150 = GetResString("CALCULATE_ITEMEFFECT_LUA_000150")
					SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000150 ) 
					SetItemAttr( Item_Traget ,ITEMATTR_MAXENERGY ,Elf_MaxEXP )
					SetItemAttr( Item_Traget ,ITEMATTR_ENERGY ,Elf_EXP )
				end 
		end 
end
----------------风之力使用---------------------------agi = GetItemAttr( Item_Traget ,ITEMATTR_VAL_AGI )       --敏捷
function ItemUse_FZLi( role , Item , Item_Traget ) 

	local Item_ID = GetItemID ( Item_Traget )
	if Item_ID ~= 266 then
		CALCULATE_ITEMEFFECT_LUA_000152 = GetResString("CALCULATE_ITEMEFFECT_LUA_000152")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000152)
		UseItemFailed ( role )
		return
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type = GetItemType ( Item )
		local Item_Traget_Type = GetItemType ( Item_Traget )
		if Item_type == 66 and Item_Traget_Type == 65 then
				local agi = GetItemAttr( Item_Traget ,ITEMATTR_VAL_AGI )       --敏捷
					if agi >= 5 then
					UseItemFailed ( role )
					return
					end
				local rad = math.random ( 1, 100 )
				 if rad<=50 then
					local Elf_URE = GetItemAttr(Item_Traget,ITEMATTR_URE) --当前耐久记录剩余封印点数
					agi = agi + 1
					if Elf_URE >= 50 then
					Elf_URE = Elf_URE-50
					end
					SetItemAttr( Item_Traget ,ITEMATTR_VAL_AGI ,agi )
					SetItemAttr( Item_Traget ,ITEMATTR_URE ,Elf_URE )
				else 
				local Elf_MaxEXP = GetItemAttr(Item_Traget,ITEMATTR_MAXENERGY) --最大能量记录诅咒点数
				local Elf_EXP = GetItemAttr(Item_Traget,ITEMATTR_ENERGY) --最大能量记录诅咒点数
					Elf_MaxEXP = Elf_MaxEXP + 1
					Elf_EXP = Elf_EXP + 1
					CALCULATE_ITEMEFFECT_LUA_000150 = GetResString("CALCULATE_ITEMEFFECT_LUA_000150")
					SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000150 ) 
					SetItemAttr( Item_Traget ,ITEMATTR_MAXENERGY ,Elf_MaxEXP )
					SetItemAttr( Item_Traget ,ITEMATTR_ENERGY ,Elf_EXP )
				end 
		end 
end

----------------雷之力使用---------------------------dex = GetItemAttr( Item_Traget ,ITEMATTR_VAL_DEX )       --专注
function ItemUse_LZli ( role , Item , Item_Traget )
 
	local Item_ID = GetItemID ( Item_Traget )
	if Item_ID ~= 266 then
		CALCULATE_ITEMEFFECT_LUA_000153 = GetResString("CALCULATE_ITEMEFFECT_LUA_000153")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000153)
		UseItemFailed ( role )
		return
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type = GetItemType ( Item )
		local Item_Traget_Type = GetItemType ( Item_Traget )
		if Item_type == 66 and Item_Traget_Type == 65 then
				local dex = GetItemAttr( Item_Traget ,ITEMATTR_VAL_DEX )       --力量
					if dex >= 5 then
					UseItemFailed ( role )
					return
					end
				local rad = math.random ( 1, 100 )
				 if rad<=50 then
					local Elf_URE = GetItemAttr(Item_Traget,ITEMATTR_URE) --当前耐久记录剩余封印点数
					dex = dex + 1
					if Elf_URE >= 50 then
					Elf_URE = Elf_URE-50
					end
					SetItemAttr( Item_Traget ,ITEMATTR_VAL_DEX ,dex )
					SetItemAttr( Item_Traget ,ITEMATTR_URE ,Elf_URE )
				else 
				local Elf_MaxEXP = GetItemAttr(Item_Traget,ITEMATTR_MAXENERGY) --最大能量记录诅咒点数
				local Elf_EXP = GetItemAttr(Item_Traget,ITEMATTR_ENERGY) --最大能量记录诅咒点数
					Elf_MaxEXP = Elf_MaxEXP + 1
					Elf_EXP = Elf_EXP + 1
					CALCULATE_ITEMEFFECT_LUA_000150 = GetResString("CALCULATE_ITEMEFFECT_LUA_000150")
					SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000150 ) 
					SetItemAttr( Item_Traget ,ITEMATTR_MAXENERGY ,Elf_MaxEXP )
					SetItemAttr( Item_Traget ,ITEMATTR_ENERGY ,Elf_EXP )
				end 
		end 
end
----------------天使骰子使用-------------------------
function ItemUse_ZhuFu ( role , Item , Item_Traget )
 
	local Item_ID = GetItemID ( Item_Traget )
	if Item_ID ~= 266     then
		CALCULATE_ITEMEFFECT_LUA_000154 = GetResString("CALCULATE_ITEMEFFECT_LUA_000154")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000154)
		UseItemFailed ( role )
		return
	end
	local Elf_EXP = GetItemAttr(Item_Traget,ITEMATTR_ENERGY) --当前能量记录诅咒点数
	local Elf_MaxEXP = GetItemAttr(Item_Traget,ITEMATTR_MAXENERGY) --最大能量记录诅咒点数

	if Elf_EXP ==0 then
		UseItemFailed ( role )
		
		return
	end
	local rad = math.random ( 1, 100 )

	if Elf_EXP <= 5 and Elf_EXP >= 1 then
		if rad <= 30 then
			Elf_EXP = Elf_EXP -1
		else
			CALCULATE_ITEMEFFECT_LUA_000155 = GetResString("CALCULATE_ITEMEFFECT_LUA_000155")
			SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000155)
		end
	end

	if Elf_EXP <= 10 and Elf_EXP >= 6 then
		if rad <= 50 then
			Elf_EXP = Elf_EXP -1
		else
			CALCULATE_ITEMEFFECT_LUA_000155 = GetResString("CALCULATE_ITEMEFFECT_LUA_000155")
			SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000155)
		end
	end

	if Elf_EXP <= 15 and Elf_EXP >= 11 then
		if rad <= 80 then
			Elf_EXP = Elf_EXP -1
		else
			CALCULATE_ITEMEFFECT_LUA_000155 = GetResString("CALCULATE_ITEMEFFECT_LUA_000155")
			SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000155)
		end
	end

	if Elf_EXP >= 16  then
		Elf_EXP = Elf_EXP -1
	end

	SetItemAttr( Item_Traget ,ITEMATTR_ENERGY ,Elf_EXP )
	SetItemAttr( Item_Traget ,ITEMATTR_MAXENERGY ,Elf_EXP )
end

--一元好礼包
function ItemUse_YiYuanHaoYunBOX ( role , Item )

	local Percentage = Percentage_Random ( 0.1 )
			if Percentage == 1 then
				 AddMoney ( role , 0 , 50000 )
			else	
				local item_type = BoxXiang_YiYuanBOX
				local item_type_rad = BoxXiang_YiYuanBOX_Rad 
				local item_type_count = BoxXiang_YiYuanBOX_Count 
				local maxitem = BoxXiang_YiYuanBOX_Mxcount						-- 终结编号
				local item_quality = BoxXiang_YiYuanBOX_Qua
				local General = 0  
				local ItemId = 0 
			--	local Item_CanGet = GetChaFreeBagGridNum ( role )
				
			--	if Item_CanGet <= 1 then
			--		SystemNotice(role ,"身上没有足够的空间，鸿运包开启失败")
			--		UseItemFailed ( role )
			--		return
			--	end
				for i = 1 , maxitem , 1 do 
					General = item_type_rad [ i ] + General		
				end 
				local a = math.random ( 1, General )
				local b = 0
				local d = 0 
				local c = -1							--命中物品编号
				for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

					d = item_type_rad [ k ] + b

					 if a <= d and a > b then
						c = k
						break		
					end 
					b = d 
				end 
				if c == -1 then 
					ItemId = 3124 
				else 
					ItemId = item_type [c]  
					ItemCount = item_type_count [c] 
				end 

				GiveItem ( role , 0 , ItemId , ItemCount , item_quality )
		
				local GoodItem = {}
				GoodItem[0] = 3336
				GoodItem[1] = 3885
				GoodItem[2] = 430
				GoodItem[3] = 3886
				GoodItem[4] = 3113
				GoodItem[5] = 3111
				GoodItem[6] = 3093
				GoodItem[7] = 3090
				GoodItem[8] =0860
				GoodItem[9] =0861
				GoodItem[10] =0862
				GoodItem[11] =0863
				GoodItem[12] =179
				GoodItem[13] =3084
				GoodItem[14] =3085


				local Good_C = 0
				for Good_C = 0 , 14 , 1 do
					if ItemId == GoodItem[Good_C] then
						local itemname = GetItemName ( ItemId ) 
						local cha_name = GetChaDefaultName ( role ) 
						CALCULATE_ITEMEFFECT_LUA_000156 = GetResString("CALCULATE_ITEMEFFECT_LUA_000156")
						local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000156..itemname  
						Notice ( message )
					end
				end
			end 
	end

---------------特等奖
function ItemUse_tedengjiang ( role , Item )

local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 3 then
		CALCULATE_ITEMEFFECT_LUA_000157 = GetResString("CALCULATE_ITEMEFFECT_LUA_000157")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000157)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 845  , 1 , 16  )  
	GiveItem ( role , 0 , 846  , 1 , 16  )  
	GiveItem ( role , 0 , 847  , 1 , 16  ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000158 = GetResString("CALCULATE_ITEMEFFECT_LUA_000158")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000158
		Notice ( message )
end


-----------------------一等奖
function ItemUse_yidengjiang ( role , Item )

local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000157 = GetResString("CALCULATE_ITEMEFFECT_LUA_000157")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000157)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0853  , 1 , 4 ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000159 = GetResString("CALCULATE_ITEMEFFECT_LUA_000159")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000159 
		Notice ( message )
end

---------------------------二等奖
function ItemUse_erdengjiang ( role , Item )

local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 14 then
		CALCULATE_ITEMEFFECT_LUA_000157 = GetResString("CALCULATE_ITEMEFFECT_LUA_000157")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000157)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0456  , 10 , 4  ) 
	local rad = math.random ( 1, 8 )
	if rad == 1 then
	GiveItem ( role , 0 , 5013  , 1 , 4 ) 
	GiveItem ( role , 0 , 5021  , 1 , 4 ) 
	GiveItem ( role , 0 , 5029  , 1 , 4 ) 
	elseif rad == 2 then
	GiveItem ( role , 0 , 5014  , 1 , 4 ) 
	GiveItem ( role , 0 , 5022  , 1 , 4 ) 
	GiveItem ( role , 0 , 5030  , 1 , 4 ) 
	elseif rad == 3 then
	GiveItem ( role , 0 , 5015  , 1 , 4 ) 
	GiveItem ( role , 0 , 5023  , 1 , 4 ) 
	GiveItem ( role , 0 , 5031  , 1 , 4 ) 
	elseif rad == 4 then
	GiveItem ( role , 0 , 5020  , 1 , 4 ) 
	GiveItem ( role , 0 , 5024  , 1 , 4 ) 
	GiveItem ( role , 0 , 5032  , 1 , 4 ) 
	GiveItem ( role , 0 , 5037  , 1 , 4 ) 
	elseif rad == 5 then
	GiveItem ( role , 0 , 5017  , 1 , 4 ) 
	GiveItem ( role , 0 , 5025  , 1 , 4 ) 
	GiveItem ( role , 0 , 5033  , 1 , 4 )
	elseif rad == 6 then
	GiveItem ( role , 0 , 5018  , 1 , 4 ) 
	GiveItem ( role , 0 , 5026  , 1 , 4 ) 
	GiveItem ( role , 0 , 5034  , 1 , 4 )
	elseif rad == 7 then
	GiveItem ( role , 0 , 5019  , 1 , 4 ) 
	GiveItem ( role , 0 , 5027  , 1 , 4 ) 
	GiveItem ( role , 0 , 5035  , 1 , 4 )
	elseif rad == 8 then
	GiveItem ( role , 0 , 5016  , 1 , 4 ) 
	GiveItem ( role , 0 , 5028  , 1 , 4 ) 
	GiveItem ( role , 0 , 5036  , 1 , 4 )
	GiveItem ( role , 0 , 5038  , 1 , 4 )
	end
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000160 = GetResString("CALCULATE_ITEMEFFECT_LUA_000160")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000160   
		Notice ( message )
end

	
--------------------------三等奖
function ItemUse_sandengjiang ( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 2 then
		CALCULATE_ITEMEFFECT_LUA_000157 = GetResString("CALCULATE_ITEMEFFECT_LUA_000157")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000157)
		UseItemFailed ( role )
		return
	end
	local rad = math.random ( 1, 2 )
	if rad == 1 then
		GiveItem ( role , 0 , 3094  , 1 , 4 ) 
		GiveItem ( role , 0 , 3096  , 1 , 4 )
	else
		GiveItem ( role , 0 , 1094  , 1 , 4 ) 
	end
end

-------------------------------------------------------kokora 08商品调整(如修改请把原使用部分解开)--------------------------------------
--99爆炸包
--function ItemUse_BaoZhaBOX ( role , Item )
--	local item_type = BoxXiang_BaoZhaBOX
--	local item_type_rad = BoxXiang_BaoZhaBOX_Rad
--	local item_type_count = BoxXiang_BaoZhaBOX_Count
--	local maxitem = BoxXiang_baozhabao_Mxcount						-- 终结编号
--	local item_quality = BoxXiang_baozhabao_Qua
--	local General = 0  
--	local ItemId = 0 
--	local Item_CanGet = GetChaFreeBagGridNum ( role )
--		
--	--if Item_CanGet <= 1 then
--		--SystemNotice(role ,"身上没有足够的空间，鸿运包开启失败")
--		--UseItemFailed ( role )
--		--return
--	--end
--	for i = 1 , maxitem , 1 do 
--		General = item_type_rad [ i ] + General		
--	end 
--	local a = math.random ( 1, General )
--	local b = 0
--	local d = 0 
--	local c = -1							--命中物品编号
--	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号
--		d = item_type_rad [ k ] + b
--
--		 if a <= d and a > b then
--			c = k
--			break		
--		end 
--		b = d 
--	end 
--	if c == -1 then 
--		ItemId = 3124 
--	else 
--		ItemId = item_type [c]  
--		ItemCount = item_type_count [c] 
--	end 
--
--	GiveItem ( role , 0 , ItemId , ItemCount , item_quality )
--	local GoodItem = {}
--	GoodItem[0] = 3111
--	GoodItem[1] = 3110
--	GoodItem[2] = 3112
--	GoodItem[3] = 3886
--	GoodItem[4] = 3093
--	GoodItem[5] = 3090
--	GoodItem[6] = 430
--	GoodItem[7] = 179
--	GoodItem[8] =3084
--	GoodItem[9] =3085
--	GoodItem[10] =0244
--	GoodItem[11] =0250
--	GoodItem[12] =0253
--	GoodItem[13] =0260
--	GoodItem[14] =0860
--	GoodItem[15] =0861
--	GoodItem[16] =0862
--	GoodItem[17] =3458
--	GoodItem[18] =0247
--	GoodItem[19] =0271
--	local Good_C = 0
--	for Good_C = 0 , 19 , 1 do
--		if ItemId == GoodItem[Good_C] then
--			local itemname = GetItemName ( ItemId ) 
--			local cha_name = GetChaDefaultName ( role ) 
--			local message = cha_name.."打开99爆炸包惊喜地获得"..itemname  
--			Notice ( message )
--		end
--	end
--end
function ItemUse_BaoZhaBOX ( role , Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end 
	local NocLock =	KitbagLock( role, 0 )
	if NocLock == LUA_FALSE then
		CALCULATE_FUNCTIONS_LUA_000144 = GetResString("CALCULATE_FUNCTIONS_LUA_000144")
		SystemNotice( role , CALCULATE_FUNCTIONS_LUA_000144)
		return 
	end
	local Money_Have = GetChaAttr ( role , ATTR_GD )
	if Money_Have>1900000000 then
		CALCULATE_FUNCTIONS_LUA_000146 = GetResString("CALCULATE_FUNCTIONS_LUA_000146")
		SystemNotice (role, CALCULATE_FUNCTIONS_LUA_000146)
		return 
	end
	AddMoney ( role , 0 , 10000 )                 --------10000海盗币
		CALCULATE_ITEMEFFECT_LUA_000161 = GetResString("CALCULATE_ITEMEFFECT_LUA_000161")
		SystemNotice ( role ,CALCULATE_ITEMEFFECT_LUA_000161)	
end

-------------------------------------阴阳五行轮回塔
function ItemUse_wxlh( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local r1,r2 =MakeItem ( role , SI  , SN , SE )
	local Item_star = GetChaItem ( role , 2 , r2 )			--取道具指针
	local num={}
	local numAttr={}
	local b = 0
	local a = {}
	for b=1,5,1 do
		num [b]=0
		numAttr [b]=0
	end
	b = 0
	for i=1,47,1 do		---------------取到道具的全部实例化属性
	    a [i]=GetItemAttr ( Item_star , i )
		if a [i]~=0 then
	--		SystemNotice( role , a [i] )
				b = b + 1
				num [b]=i    -------------num [b]记录实例华属性的编号
				numAttr [b]=a[i] ------------现有的各实例化属性值
		end
	end
	SetItemAttr ( Item_star ,num [1] , SA1 )
	SetItemAttr ( Item_star ,num [2] , SA2 )
	SetItemAttr ( Item_star ,num [3] , SA3 )
	SetItemAttr ( Item_star ,num [4] , SA4)
	SetItemAttr ( Item_star ,num [5] , SA5)

end
----------------------------------高级戒指兑换
function ItemUse_Sjz( role , Item )

	-- local Item_CanGet = GetChaFreeBagGridNum ( role )
	 -- if Item_CanGet < 5 then
		-- SystemNotice(role ,"打开高级戒指兑换券最少需要5个空位")
		-- UseItemFailed ( role )
		-- return 0
	-- end
	local rad = math.random ( 1, 5 )
	if rad ==1 then
	--卫兵的坚持
	--古树球根
	--力量封印
	--雷之锤
	--比特的呼唤
	GiveItem ( role , 0 , 281  , 1 , 4 )	
	GiveItem ( role , 0 , 286  , 1 , 4 )	
	GiveItem ( role , 0 , 324  , 1 , 4 )	
	GiveItem ( role , 0 , 334  , 1 , 4 )	
	GiveItem ( role , 0 , 387  , 1 , 4 )	
	end
	if rad ==2 then
	--盗贼的窥探
	--五月之风
	--幽狼环扣
	--闪电之眼
	--艾维尔之吻
	GiveItem ( role , 0 , 282  , 1 , 4 )	
	GiveItem ( role , 0 , 287  , 1 , 4 )	
	GiveItem ( role , 0 , 327  , 1 , 4 )	
	GiveItem ( role , 0 , 346  , 1 , 4 )	
	GiveItem ( role , 0 , 414  , 1 , 4 )		
	end
	if rad ==3 then
	--猎手之力
	--精灵的依恋
	--龙翼指环
	--光之翼
	--雷欧的愤怒
	GiveItem ( role , 0 , 283  , 1 , 4 )	
	GiveItem ( role , 0 , 288  , 1 , 4 )	
	GiveItem ( role , 0 , 328  , 1 , 4 )	
	GiveItem ( role , 0 , 347  , 1 , 4 )	
	GiveItem ( role , 0 , 415  , 1 , 4 )	
	end
	if rad ==4 then
	--信徒之环
	--苦行僧
	--独角兽的祝福
	--晨钟
	--小山车的歉意
	GiveItem ( role , 0 , 284  , 1 , 4 )	
	GiveItem ( role , 0 , 524  , 1 , 4 )	
	GiveItem ( role , 0 , 329  , 1 , 4 )	
	GiveItem ( role , 0 , 348  , 1 , 4 )	
	GiveItem ( role , 0 , 416  , 1 , 4 )		
	end
	if rad ==5 then
	--灵环
	--圣环
	--天使的悲鸣
	--天籁
	--圣女的奉献
	GiveItem ( role , 0 , 285  , 1 , 4 )	
	GiveItem ( role , 0 , 321  , 1 , 4 )	
	GiveItem ( role , 0 , 330  , 1 , 4 )	
	GiveItem ( role , 0 , 349  , 1 , 4 )	
	GiveItem ( role , 0 , 417  , 1 , 4 )			
	end
end
----------------------------------高级项链兑换
function ItemUse_Sxl( role , Item )

	-- local Item_CanGet = GetChaFreeBagGridNum ( role )
	 -- if Item_CanGet < 5 then
		-- SystemNotice(role ,"打开高级项链兑换券最少需要5个空位")
		-- UseItemFailed ( role )
		-- return
	-- end
	local rad = math.random ( 1, 2 )
	if rad ==1 then
	--太阳石坠子
	--黑耀石的闪光
	--突风
	--快步冒险者
	--心灵永动机
	GiveItem ( role , 0 , 418  , 1 , 4 )	
	GiveItem ( role , 0 , 420  , 1 , 4 )	
	GiveItem ( role , 0 , 739  , 1 , 4 )	
	GiveItem ( role , 0 , 462  , 1 , 4 )	
	GiveItem ( role , 0 , 495  , 1 , 4 )		
	end
	if rad ==2 then
	--白金项链
	--风之信使
	--冰晶仙子
	--迷宫探索者
	--天佑的达人
	GiveItem ( role , 0 , 419  , 1 , 4 )	
	GiveItem ( role , 0 , 421  , 1 , 4 )	
	GiveItem ( role , 0 , 461  , 1 , 4 )	
	GiveItem ( role , 0 , 463  , 1 , 4 )	
	GiveItem ( role , 0 , 497  , 1 , 4 )		
	end
end
----------------------------------高级贝壳兑换
function ItemUse_Sbk( role , Item )

	-- local Item_CanGet = GetChaFreeBagGridNum ( role )
	 -- if Item_CanGet < 5 then
		-- SystemNotice(role ,"打开高级贝壳兑换券最少需要5个空位")
		-- UseItemFailed ( role )
		-- return
	-- end
	local rad = math.random ( 1, 2 )
	if rad ==1 then
	--学徒用雷贝
	--通用型雷贝
	--中级雷之贝
	--高级雷之贝
	--雷神贝2006
	GiveItem ( role , 0 , 498  , 1 , 4 )	
	GiveItem ( role , 0 , 503  , 1 , 4 )	
	GiveItem ( role , 0 , 504  , 1 , 4 )	
	GiveItem ( role , 0 , 505  , 1 , 4 )	
	GiveItem ( role , 0 , 506  , 1 , 4 )		
	end
	if rad ==2 then
	--学徒用风贝  
	--通用型风贝  
	--中级风之贝  
	--高级风之贝  
	--风神贝2006 
	GiveItem ( role , 0 , 508  , 1 , 4 )	
	GiveItem ( role , 0 , 509  , 1 , 4 )	
	GiveItem ( role , 0 , 510  , 1 , 4 )	
	GiveItem ( role , 0 , 522  , 1 , 4 )	
	GiveItem ( role , 0 , 523  , 1 , 4 )		
	end
end
----夏岛飞机票-------------------------------------------------------------------------------------------------------------------------------------
function Jz_Script_xdfjp(role, Item )

	local i = CheckBagItem(role,563)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,563,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000046 = GetResString("BIRTH_BIRTH_CONF_LUA_000046")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000046)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

----秋岛飞机票-------------------------------------------------------------------------------------------------------------------------------------
function Jz_Script_qdfjp(role, Item )

	local i = CheckBagItem(role,583)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,583,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000047 = GetResString("BIRTH_BIRTH_CONF_LUA_000047")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000047)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end
----超人棒棒糖-------------------------------------------------------------------------------------------------------------------------------------
function ItemUse_Crbbt(role, Item )
	CALCULATE_ITEMEFFECT_LUA_000162 = GetResString("CALCULATE_ITEMEFFECT_LUA_000162")
	SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000162)
--	local statelv = 1
--	local statetime = 20
--	AddState( role , role , STATE_CJBBT , statelv , statetime )
end
----巨人巧克力-------------------------------------------------------------------------------------------------------------------------------------
function ItemUse_Jrqkl(role, Item )
	CALCULATE_ITEMEFFECT_LUA_000162 = GetResString("CALCULATE_ITEMEFFECT_LUA_000162")
	SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000162)
--	local statelv = 1
--	local statetime = 20
--	AddState( role , role , STATE_JRQKL , statelv , statetime )
end
--周岁生日
function ItemUse_ZhouSuiBOX ( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 2 then
		CALCULATE_ITEMEFFECT_LUA_000163 = GetResString("CALCULATE_ITEMEFFECT_LUA_000163")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000163)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 1097 , 1 , 0 )
	local item_type = BoxXiang_ZhousSuiBOX
	local item_type_rad = BoxXiang_ZhousSuiBOX_Rad 
	local item_type_count = BoxXiang_ZhousSuiBOX_Count 
	local maxitem = BoxXiang_ZhouSui_Mxcount						-- 终结编号
	local item_quality = BoxXiang_ZhouSui_Qua
	local General = 0  
	local ItemId = 0 
	
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break		
		end 
		b = d 
	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality )
	if ItemId ==  0853 then
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000164 = GetResString("CALCULATE_ITEMEFFECT_LUA_000164")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000164 
	Notice ( message )
	end
end
-------------------------------百万大钞ItemUse_CZHe
function ItemUse_CZHe( role , Item ) 		
					
 	local Money_add = 1000000
	local Money_Have = GetChaAttr ( role , ATTR_GD )
	if Money_Have>=999900000 then
		CALCULATE_ITEMEFFECT_LUA_000165 = GetResString("CALCULATE_ITEMEFFECT_LUA_000165")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000165)
		UseItemFailed ( role )
		return	
	end
	AddMoney ( role , 0 , Money_add )
end 
-----------------------------------摩豆小子精灵蛋ItemUse_MDXZJLD
function ItemUse_MDXZJLD ( role, Item )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000089 = GetResString("CALCULATE_ITEMEFFECT_LUA_000089")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000089)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 680  , 1 , 4 ) 
end
----加勒比观光票-------------------------------------------------------------------------------------------------------------------------------------
function Jz_Script_jialebi(role, Item )

	local i = CheckBagItem(role,2445)
	local ii = CheckBagItem(role,6455)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 and ii <=0 then
			local j = DelBagItem(role,2445,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000048 = GetResString("BIRTH_BIRTH_CONF_LUA_000048")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000048)
				return
			end
		elseif ii > 0 then
			local jj = DelBagItem(role,6455,1)
			if jj == 1 then
				BIRTH_BIRTH_CONF_LUA_000048 = GetResString("BIRTH_BIRTH_CONF_LUA_000048")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000048)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end
----------------------------------运之精灵蛋
function ItemUse_YZJLD( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000166 = GetResString("CALCULATE_ITEMEFFECT_LUA_000166")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000166)
		UseItemFailed ( role )
		return
	end
	local Num_newJL = GetItemForgeParam ( Item , 1 )
	local Part1_newJL = GetNum_Part1 ( Num_newJL )	--Get Num Part 1 到 Part 7
	local Part2_newJL = GetNum_Part2 ( Num_newJL )	
	local Part3_newJL = GetNum_Part3 ( Num_newJL )

	local new_str=GetItemAttr ( Item , ITEMATTR_VAL_STR )      
	local new_dex=GetItemAttr( Item , ITEMATTR_VAL_DEX  )	  
	local new_sta=GetItemAttr ( Item , ITEMATTR_VAL_STA  )    
	local new_agi=GetItemAttr( Item , ITEMATTR_VAL_AGI )       
	local new_con=GetItemAttr ( Item , ITEMATTR_VAL_CON )  
	local new_lv = new_str + new_con + new_agi + new_dex + new_sta
	local new_MAXENERGY = 240 * ( new_lv + 1 )
	if new_MAXENERGY > 6480 then
		Item_MAXENERGY = 6480
	end
	local new_MAXURE = 5000 + 1000*new_lv
	if new_MAXURE > 32000 then
		Item_MAXURE_NUM = 32000
	end	  

	local rad = math.random ( 1, 100 )
	if Part3_newJL==3 then
		GiveItem ( role , 0 , 609  , 1 , 4 ) 
	end
	if Part3_newJL==2 then
		if rad <=95 then
			GiveItem ( role , 0 , 608  , 1 , 4 ) 
		elseif rad > 95 and rad <=100 then
			GiveItem ( role , 0 , 609  , 1 , 4 ) 
		end
	end
	if Part3_newJL==1 then
		if rad <=90 then
			GiveItem ( role , 0 , 239  , 1 , 4 ) 
		elseif rad > 90 and rad <=98 then
			GiveItem ( role , 0 , 608  , 1 , 4 ) 
		elseif rad > 98 and rad <=100 then
			GiveItem ( role , 0 , 609  , 1 , 4 ) 
		end
	end
	local r1,r2 =MakeItem ( role , 231  , 1 , 4 )
	local Item_newJL = GetChaItem ( role , 2 , r2 )			--取新精灵道具指针
	SetItemAttr ( Item_newJL , ITEMATTR_VAL_STR , new_str )
	SetItemAttr( Item_newJL , ITEMATTR_VAL_DEX , new_dex )	 
	SetItemAttr ( Item_newJL , ITEMATTR_VAL_STA , new_sta )
	SetItemAttr( Item_newJL , ITEMATTR_VAL_AGI , new_agi )
	SetItemAttr ( Item_newJL , ITEMATTR_VAL_CON , new_con ) 
	SetItemAttr ( Item_newJL , ITEMATTR_MAXENERGY , new_MAXENERGY ) 	
	SetItemAttr ( Item_newJL , ITEMATTR_MAXURE , new_MAXURE )
end
----------------------------------体之精灵蛋
function ItemUse_TZJLD( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000167 = GetResString("CALCULATE_ITEMEFFECT_LUA_000167")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000167)
		UseItemFailed ( role )
		return
	end
	local Num_newJL = GetItemForgeParam ( Item , 1 )
	local Part1_newJL = GetNum_Part1 ( Num_newJL )	--Get Num Part 1 到 Part 7
	local Part2_newJL = GetNum_Part2 ( Num_newJL )	
	local Part3_newJL = GetNum_Part3 ( Num_newJL )

	local new_str=GetItemAttr ( Item , ITEMATTR_VAL_STR )      
	local new_dex=GetItemAttr( Item , ITEMATTR_VAL_DEX  )	  
	local new_sta=GetItemAttr ( Item , ITEMATTR_VAL_STA  )    
	local new_agi=GetItemAttr( Item , ITEMATTR_VAL_AGI )       
	local new_con=GetItemAttr ( Item , ITEMATTR_VAL_CON )  
	local new_lv = new_str + new_con + new_agi + new_dex + new_sta
	local new_MAXENERGY = 240 * ( new_lv + 1 )
	if new_MAXENERGY > 6480 then
		Item_MAXENERGY = 6480
	end
	local new_MAXURE = 5000 + 1000*new_lv
	if new_MAXURE > 32000 then
		Item_MAXURE_NUM = 32000
	end	  

	local rad = math.random ( 1, 100 )
	if Part3_newJL==3 then
		GiveItem ( role , 0 , 609  , 1 , 4 ) 
	end
	if Part3_newJL==2 then
		if rad <=95 then
			GiveItem ( role , 0 , 608  , 1 , 4 ) 
		elseif rad > 95 and rad <=100 then
			GiveItem ( role , 0 , 609  , 1 , 4 ) 
		end
	end
	if Part3_newJL==1 then
		if rad <=90 then
			GiveItem ( role , 0 , 239  , 1 , 4 ) 
		elseif rad > 90 and rad <=98 then
			GiveItem ( role , 0 , 608  , 1 , 4 ) 
		elseif rad > 98 and rad <=100 then
			GiveItem ( role , 0 , 609  , 1 , 4 ) 
		end
	end
	local r1,r2 =MakeItem ( role , 233  , 1 , 4 )
	local Item_newJL = GetChaItem ( role , 2 , r2 )			--取新精灵道具指针
	SetItemAttr ( Item_newJL , ITEMATTR_VAL_STR , new_str )
	SetItemAttr( Item_newJL , ITEMATTR_VAL_DEX , new_dex )	 
	SetItemAttr ( Item_newJL , ITEMATTR_VAL_STA , new_sta )
	SetItemAttr( Item_newJL , ITEMATTR_VAL_AGI , new_agi )
	SetItemAttr ( Item_newJL , ITEMATTR_VAL_CON , new_con ) 
	SetItemAttr ( Item_newJL , ITEMATTR_MAXENERGY , new_MAXENERGY ) 	
	SetItemAttr ( Item_newJL , ITEMATTR_MAXURE , new_MAXURE )
end
----------------------------------力之精灵蛋
function ItemUse_LZJLD( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000168 = GetResString("CALCULATE_ITEMEFFECT_LUA_000168")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000168)
		UseItemFailed ( role )
		return
	end
	local Num_newJL = GetItemForgeParam ( Item , 1 )
	local Part1_newJL = GetNum_Part1 ( Num_newJL )	--Get Num Part 1 到 Part 7
	local Part2_newJL = GetNum_Part2 ( Num_newJL )	
	local Part3_newJL = GetNum_Part3 ( Num_newJL )

	local new_str=GetItemAttr ( Item , ITEMATTR_VAL_STR )      
	local new_dex=GetItemAttr( Item , ITEMATTR_VAL_DEX  )	  
	local new_sta=GetItemAttr ( Item , ITEMATTR_VAL_STA  )    
	local new_agi=GetItemAttr( Item , ITEMATTR_VAL_AGI )       
	local new_con=GetItemAttr ( Item , ITEMATTR_VAL_CON )  
	local new_lv = new_str + new_con + new_agi + new_dex + new_sta
	local new_MAXENERGY = 240 * ( new_lv + 1 )
	if new_MAXENERGY > 6480 then
		Item_MAXENERGY = 6480
	end
	local new_MAXURE = 5000 + 1000*new_lv
	if new_MAXURE > 32000 then
		Item_MAXURE_NUM = 32000
	end	  

	local rad = math.random ( 1, 100 )
	if Part3_newJL==3 then
		GiveItem ( role , 0 , 609  , 1 , 4 ) 
	end
	if Part3_newJL==2 then
		if rad <=95 then
			GiveItem ( role , 0 , 608  , 1 , 4 ) 
		elseif rad > 95 and rad <=100 then
			GiveItem ( role , 0 , 609  , 1 , 4 ) 
		end
	end
	if Part3_newJL==1 then
		if rad <=90 then
			GiveItem ( role , 0 , 239  , 1 , 4 ) 
		elseif rad > 90 and rad <=98 then
			GiveItem ( role , 0 , 608  , 1 , 4 ) 
		elseif rad > 98 and rad <=100 then
			GiveItem ( role , 0 , 609  , 1 , 4 ) 
		end
	end
	local r1,r2 =MakeItem ( role , 232  , 1 , 4 )
	local Item_newJL = GetChaItem ( role , 2 , r2 )			--取新精灵道具指针
	SetItemAttr ( Item_newJL , ITEMATTR_VAL_STR , new_str )
	SetItemAttr( Item_newJL , ITEMATTR_VAL_DEX , new_dex )	 
	SetItemAttr ( Item_newJL , ITEMATTR_VAL_STA , new_sta )
	SetItemAttr( Item_newJL , ITEMATTR_VAL_AGI , new_agi )
	SetItemAttr ( Item_newJL , ITEMATTR_VAL_CON , new_con ) 
	SetItemAttr ( Item_newJL , ITEMATTR_MAXENERGY , new_MAXENERGY ) 	
	SetItemAttr ( Item_newJL , ITEMATTR_MAXURE , new_MAXURE )
end
----------------------------------神之精灵蛋
function ItemUse_SZJLD( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000169 = GetResString("CALCULATE_ITEMEFFECT_LUA_000169")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000169)
		UseItemFailed ( role )
		return
	end
	local Num_newJL = GetItemForgeParam ( Item , 1 )
	local Part1_newJL = GetNum_Part1 ( Num_newJL )	--Get Num Part 1 到 Part 7
	local Part2_newJL = GetNum_Part2 ( Num_newJL )	
	local Part3_newJL = GetNum_Part3 ( Num_newJL )

	local new_str=GetItemAttr ( Item , ITEMATTR_VAL_STR )      
	local new_dex=GetItemAttr( Item , ITEMATTR_VAL_DEX  )	  
	local new_sta=GetItemAttr ( Item , ITEMATTR_VAL_STA  )    
	local new_agi=GetItemAttr( Item , ITEMATTR_VAL_AGI )       
	local new_con=GetItemAttr ( Item , ITEMATTR_VAL_CON )  
	local new_lv = new_str + new_con + new_agi + new_dex + new_sta
	local new_MAXENERGY = 240 * ( new_lv + 1 )
	if new_MAXENERGY > 6480 then
		Item_MAXENERGY = 6480
	end
	local new_MAXURE = 5000 + 1000*new_lv
	if new_MAXURE > 32000 then
		Item_MAXURE_NUM = 32000
	end	  

	local rad = math.random ( 1, 100 )
	if Part3_newJL==3 then
		GiveItem ( role , 0 , 609  , 1 , 4 ) 
	end
	if Part3_newJL==2 then
		if rad <=95 then
			GiveItem ( role , 0 , 608  , 1 , 4 ) 
		elseif rad > 95 and rad <=100 then
			GiveItem ( role , 0 , 609  , 1 , 4 ) 
		end
	end
	if Part3_newJL==1 then
		if rad <=90 then
			GiveItem ( role , 0 , 239  , 1 , 4 ) 
		elseif rad > 90 and rad <=98 then
			GiveItem ( role , 0 , 608  , 1 , 4 ) 
		elseif rad > 98 and rad <=100 then
			GiveItem ( role , 0 , 609  , 1 , 4 ) 
		end
	end
	local r1,r2 =MakeItem ( role , 234  , 1 , 4 )
	local Item_newJL = GetChaItem ( role , 2 , r2 )			--取新精灵道具指针
	SetItemAttr ( Item_newJL , ITEMATTR_VAL_STR , new_str )
	SetItemAttr( Item_newJL , ITEMATTR_VAL_DEX , new_dex )	 
	SetItemAttr ( Item_newJL , ITEMATTR_VAL_STA , new_sta )
	SetItemAttr( Item_newJL , ITEMATTR_VAL_AGI , new_agi )
	SetItemAttr ( Item_newJL , ITEMATTR_VAL_CON , new_con ) 
	SetItemAttr ( Item_newJL , ITEMATTR_MAXENERGY , new_MAXENERGY ) 	
	SetItemAttr ( Item_newJL , ITEMATTR_MAXURE , new_MAXURE )
end
----------------------------------专之精灵蛋
function ItemUse_ZZJLD( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000170 = GetResString("CALCULATE_ITEMEFFECT_LUA_000170")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000170)
		UseItemFailed ( role )
		return
	end
	local Num_newJL = GetItemForgeParam ( Item , 1 )
	local Part1_newJL = GetNum_Part1 ( Num_newJL )	--Get Num Part 1 到 Part 7
	local Part2_newJL = GetNum_Part2 ( Num_newJL )	
	local Part3_newJL = GetNum_Part3 ( Num_newJL )

	local new_str=GetItemAttr ( Item , ITEMATTR_VAL_STR )      
	local new_dex=GetItemAttr( Item , ITEMATTR_VAL_DEX  )	  
	local new_sta=GetItemAttr ( Item , ITEMATTR_VAL_STA  )    
	local new_agi=GetItemAttr( Item , ITEMATTR_VAL_AGI )       
	local new_con=GetItemAttr ( Item , ITEMATTR_VAL_CON )  
	local new_lv = new_str + new_con + new_agi + new_dex + new_sta
	local new_MAXENERGY = 240 * ( new_lv + 1 )
	if new_MAXENERGY > 6480 then
		Item_MAXENERGY = 6480
	end
	local new_MAXURE = 5000 + 1000*new_lv
	if new_MAXURE > 32000 then
		Item_MAXURE_NUM = 32000
	end	  

	local rad = math.random ( 1, 100 )
	if Part3_newJL==3 then
		GiveItem ( role , 0 , 609  , 1 , 4 ) 
	end
	if Part3_newJL==2 then
		if rad <=95 then
			GiveItem ( role , 0 , 608  , 1 , 4 ) 
		elseif rad > 95 and rad <=100 then
			GiveItem ( role , 0 , 609  , 1 , 4 ) 
		end
	end
	if Part3_newJL==1 then
		if rad <=90 then
			GiveItem ( role , 0 , 239  , 1 , 4 ) 
		elseif rad > 90 and rad <=98 then
			GiveItem ( role , 0 , 608  , 1 , 4 ) 
		elseif rad > 98 and rad <=100 then
			GiveItem ( role , 0 , 609  , 1 , 4 ) 
		end
	end
	local r1,r2 =MakeItem ( role , 235  , 1 , 4 )
	local Item_newJL = GetChaItem ( role , 2 , r2 )			--取新精灵道具指针
	SetItemAttr ( Item_newJL , ITEMATTR_VAL_STR , new_str )
	SetItemAttr( Item_newJL , ITEMATTR_VAL_DEX , new_dex )	 
	SetItemAttr ( Item_newJL , ITEMATTR_VAL_STA , new_sta )
	SetItemAttr( Item_newJL , ITEMATTR_VAL_AGI , new_agi )
	SetItemAttr ( Item_newJL , ITEMATTR_VAL_CON , new_con ) 
	SetItemAttr ( Item_newJL , ITEMATTR_MAXENERGY , new_MAXENERGY ) 	
	SetItemAttr ( Item_newJL , ITEMATTR_MAXURE , new_MAXURE )
end
----------------------------------敏之精灵蛋
function ItemUse_MZJLD( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000171 = GetResString("CALCULATE_ITEMEFFECT_LUA_000171")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000171)
		UseItemFailed ( role )
		return
	end
	local Num_newJL = GetItemForgeParam ( Item , 1 )
	local Part1_newJL = GetNum_Part1 ( Num_newJL )	--Get Num Part 1 到 Part 7
	local Part2_newJL = GetNum_Part2 ( Num_newJL )	
	local Part3_newJL = GetNum_Part3 ( Num_newJL )

	local new_str=GetItemAttr ( Item , ITEMATTR_VAL_STR )      
	local new_dex=GetItemAttr( Item , ITEMATTR_VAL_DEX  )	  
	local new_sta=GetItemAttr ( Item , ITEMATTR_VAL_STA  )    
	local new_agi=GetItemAttr( Item , ITEMATTR_VAL_AGI )       
	local new_con=GetItemAttr ( Item , ITEMATTR_VAL_CON )  
	local new_lv = new_str + new_con + new_agi + new_dex + new_sta
	local new_MAXENERGY = 240 * ( new_lv + 1 )
	if new_MAXENERGY > 6480 then
		Item_MAXENERGY = 6480
	end
	local new_MAXURE = 5000 + 1000*new_lv
	if new_MAXURE > 32000 then
		Item_MAXURE_NUM = 32000
	end	  

	local rad = math.random ( 1, 100 )
	if Part3_newJL==3 then
		GiveItem ( role , 0 , 609  , 1 , 4 ) 
	end
	if Part3_newJL==2 then
		if rad <=95 then
			GiveItem ( role , 0 , 608  , 1 , 4 ) 
		elseif rad > 95 and rad <=100 then
			GiveItem ( role , 0 , 609  , 1 , 4 ) 
		end
	end
	if Part3_newJL==1 then
		if rad <=90 then
			GiveItem ( role , 0 , 239  , 1 , 4 ) 
		elseif rad > 90 and rad <=98 then
			GiveItem ( role , 0 , 608  , 1 , 4 ) 
		elseif rad > 98 and rad <=100 then
			GiveItem ( role , 0 , 609  , 1 , 4 ) 
		end
	end
	local r1,r2 =MakeItem ( role , 236  , 1 , 4 )
	local Item_newJL = GetChaItem ( role , 2 , r2 )			--取新精灵道具指针
	SetItemAttr ( Item_newJL , ITEMATTR_VAL_STR , new_str )
	SetItemAttr( Item_newJL , ITEMATTR_VAL_DEX , new_dex )	 
	SetItemAttr ( Item_newJL , ITEMATTR_VAL_STA , new_sta )
	SetItemAttr( Item_newJL , ITEMATTR_VAL_AGI , new_agi )
	SetItemAttr ( Item_newJL , ITEMATTR_VAL_CON , new_con ) 
	SetItemAttr ( Item_newJL , ITEMATTR_MAXENERGY , new_MAXENERGY ) 	
	SetItemAttr ( Item_newJL , ITEMATTR_MAXURE , new_MAXURE )
end
----------------------------------邪之精灵蛋
function ItemUse_XZJLD( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000172 = GetResString("CALCULATE_ITEMEFFECT_LUA_000172")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000172)
		UseItemFailed ( role )
		return
	end
	local Num_newJL = GetItemForgeParam ( Item , 1 )
	local Part1_newJL = GetNum_Part1 ( Num_newJL )	--Get Num Part 1 到 Part 7
	local Part2_newJL = GetNum_Part2 ( Num_newJL )	
	local Part3_newJL = GetNum_Part3 ( Num_newJL )

	local new_str=GetItemAttr ( Item , ITEMATTR_VAL_STR )      
	local new_dex=GetItemAttr( Item , ITEMATTR_VAL_DEX  )	  
	local new_sta=GetItemAttr ( Item , ITEMATTR_VAL_STA  )    
	local new_agi=GetItemAttr( Item , ITEMATTR_VAL_AGI )       
	local new_con=GetItemAttr ( Item , ITEMATTR_VAL_CON )  
	local new_lv = new_str + new_con + new_agi + new_dex + new_sta
	local new_MAXENERGY = 240 * ( new_lv + 1 )
	if new_MAXENERGY > 6480 then
		Item_MAXENERGY = 6480
	end
	local new_MAXURE = 5000 + 1000*new_lv
	if new_MAXURE > 32000 then
		Item_MAXURE_NUM = 32000
	end	  

	local rad = math.random ( 1, 100 )
	if Part3_newJL==3 then
		GiveItem ( role , 0 , 609  , 1 , 4 ) 
	end
	if Part3_newJL==2 then
		if rad <=95 then
			GiveItem ( role , 0 , 608  , 1 , 4 ) 
		elseif rad > 95 and rad <=100 then
			GiveItem ( role , 0 , 609  , 1 , 4 ) 
		end
	end
	if Part3_newJL==1 then
		if rad <=90 then
			GiveItem ( role , 0 , 239  , 1 , 4 ) 
		elseif rad > 90 and rad <=98 then
			GiveItem ( role , 0 , 608  , 1 , 4 ) 
		elseif rad > 98 and rad <=100 then
			GiveItem ( role , 0 , 609  , 1 , 4 ) 
		end
	end
	local r1,r2 =MakeItem ( role , 237  , 1 , 4 )
	local Item_newJL = GetChaItem ( role , 2 , r2 )			--取新精灵道具指针
	SetItemAttr ( Item_newJL , ITEMATTR_VAL_STR , new_str )
	SetItemAttr( Item_newJL , ITEMATTR_VAL_DEX , new_dex )	 
	SetItemAttr ( Item_newJL , ITEMATTR_VAL_STA , new_sta )
	SetItemAttr( Item_newJL , ITEMATTR_VAL_AGI , new_agi )
	SetItemAttr ( Item_newJL , ITEMATTR_VAL_CON , new_con ) 
	SetItemAttr ( Item_newJL , ITEMATTR_MAXENERGY , new_MAXENERGY ) 	
	SetItemAttr ( Item_newJL , ITEMATTR_MAXURE , new_MAXURE )
end
-----------摩豆小子二世精灵蛋
function ItemUse_MDXZESJLD( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000173 = GetResString("CALCULATE_ITEMEFFECT_LUA_000173")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000173)
		UseItemFailed ( role )
		return
	end
	local new_str=GetItemAttr ( Item , ITEMATTR_VAL_STR )      
	local new_dex=GetItemAttr( Item , ITEMATTR_VAL_DEX  )	  
	local new_sta=GetItemAttr ( Item , ITEMATTR_VAL_STA  )    
	local new_agi=GetItemAttr( Item , ITEMATTR_VAL_AGI )       
	local new_con=GetItemAttr ( Item , ITEMATTR_VAL_CON )  
	local new_lv = new_str + new_con + new_agi + new_dex + new_sta
	local new_MAXENERGY = 240 * ( new_lv + 1 )
	if new_MAXENERGY > 6480 then
		Item_MAXENERGY = 6480
	end
	local new_MAXURE = 5000 + 1000*new_lv
	if new_MAXURE > 32000 then
		Item_MAXURE_NUM = 32000
	end	  
	GiveItem ( role , 0 , 609  , 1 , 4 ) 
	local r1,r2 =MakeItem ( role , 681  , 1 , 4 )
	local Item_newJL = GetChaItem ( role , 2 , r2 )			--取新精灵道具指针
	SetItemAttr ( Item_newJL , ITEMATTR_VAL_STR , new_str )
	SetItemAttr( Item_newJL , ITEMATTR_VAL_DEX , new_dex )	 
	SetItemAttr ( Item_newJL , ITEMATTR_VAL_STA , new_sta )
	SetItemAttr( Item_newJL , ITEMATTR_VAL_AGI , new_agi )
	SetItemAttr ( Item_newJL , ITEMATTR_VAL_CON , new_con ) 
	SetItemAttr ( Item_newJL , ITEMATTR_MAXENERGY , new_MAXENERGY ) 	
	SetItemAttr ( Item_newJL , ITEMATTR_MAXURE , new_MAXURE )
end
-----------------------------------------初级精灵附体
function Sk_Script_CJJLFT( role , Item ) 
							
 	local sk_add = SK_JLFT  
	local form_sklv = GetSkillLv( role , sk_add ) 
	if form_sklv >= 1  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 0 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 
 -----------------------------------------中级精灵附体
function Sk_Script_ZJJLFT ( role , Item ) 	
						
  	local sk_add = SK_JLFT  
	local form_sklv = GetSkillLv( role , sk_add ) 
	if form_sklv >= 2 then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 2 , 1 , 0 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 
 -----------------------------------------高级精灵附体
function Sk_Script_GJJLFT( role , Item ) 	
						
   	local sk_add = SK_JLFT  
	local form_sklv = GetSkillLv( role , sk_add ) 
	if form_sklv >= 3  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 3 , 1 , 0 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 

--[高级零食]-----------------------
--高级圣雪山龙果(力)
function ItemUse_CJ_longguo( role , Item , Item_Traget ) 
local ret = CheckJingLingLv1( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local Item_type = GetItemType ( Item )
	local Item_Traget_Type = GetItemType ( Item_Traget )
	local Item_Num = GetItemID ( Item )
	local Check_Exp = 0
	local Elf_MaxEXP = GetItemAttr(Item_Traget,ITEMATTR_MAXENERGY) 
	--SystemNotice(role ,Elf_MaxEXP )

	if Item_type == 58 and Item_Traget_Type == 59 then
			Check_Exp = CheckElf_EXP ( role , Item_Traget ) --精灵exp是否满足升级条件
			if Check_Exp == 0 then
				CALCULATE_ITEMEFFECT_LUA_000082 = GetResString("CALCULATE_ITEMEFFECT_LUA_000082")
				SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000082 ) 
				UseItemFailed ( role )
			else
			Lvup_Str_1 ( role , Item_Num , Item_Traget ) --力量属性的成长函数
			end 
	end 
end

--高级冰极爽口梅(敏)
function ItemUse_CJ_koumei ( role , Item , Item_Traget ) 
local ret = CheckJingLingLv1( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local Item_type = GetItemType ( Item )
	local Item_Traget_Type = GetItemType ( Item_Traget )
	local Item_Num = GetItemID ( Item )
	local Check_Exp = 0
	local Elf_MaxEXP = GetItemAttr(Item_Traget,ITEMATTR_MAXENERGY) 

	if Item_type == 58 and Item_Traget_Type == 59 then
			Check_Exp = CheckElf_EXP ( role , Item_Traget ) --精灵exp是否满足升级条件
			if Check_Exp == 0 then
				CALCULATE_ITEMEFFECT_LUA_000083 = GetResString("CALCULATE_ITEMEFFECT_LUA_000083")
				SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000083 ) 
				UseItemFailed ( role )
			else
			   Lvup_Agi_1 ( role , Item_Num , Item_Traget ) --敏捷属性的成长函数 
			end 
	end 
end
--高级海风鳕鱼丝(专)
function ItemUse_CJ_yusi ( role , Item , Item_Traget ) 
local ret = CheckJingLingLv1( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local Item_type = GetItemType ( Item )
	local Item_Traget_Type = GetItemType ( Item_Traget )
	local Item_Num = GetItemID ( Item )
	local Check_Exp = 0
	local Elf_MaxEXP = GetItemAttr(Item_Traget,ITEMATTR_MAXENERGY) 

	if Item_type == 58 and Item_Traget_Type == 59  then
			Check_Exp = CheckElf_EXP ( role , Item_Traget ) --精灵exp是否满足升级条件
			if Check_Exp == 0 then
				CALCULATE_ITEMEFFECT_LUA_000084 = GetResString("CALCULATE_ITEMEFFECT_LUA_000084")
				SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000084 ) 
				UseItemFailed ( role )
			else
			   Lvup_Dex_1 ( role , Item_Num , Item_Traget ) --专注属性的成长函数 
			end 
	end 
end
--高级白银城果脯(体)
function ItemUse_CJ_guopu ( role , Item , Item_Traget ) 
local ret = CheckJingLingLv1( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local Item_type = GetItemType ( Item )
	local Item_Traget_Type = GetItemType ( Item_Traget )
	local Item_Num = GetItemID ( Item )
	local Check_Exp = 0
	local Elf_MaxEXP = GetItemAttr(Item_Traget,ITEMATTR_MAXENERGY) 

	if Item_type == 58 and Item_Traget_Type == 59 then
			Check_Exp = CheckElf_EXP ( role , Item_Traget ) --精灵exp是否满足升级条件
			if Check_Exp == 0 then
				CALCULATE_ITEMEFFECT_LUA_000085 = GetResString("CALCULATE_ITEMEFFECT_LUA_000085")
				SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000085 ) 
				UseItemFailed ( role )
			else
			   Lvup_Con_1 ( role , Item_Num , Item_Traget ) --体质属性的成长函数 
			end 
	end 
end

--高级新沙岚米饼(精)
function ItemUse_CJ_mibing ( role , Item , Item_Traget ) 
local ret = CheckJingLingLv1( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local Item_type = GetItemType ( Item )
	local Item_Traget_Type = GetItemType ( Item_Traget )
	local Item_Num = GetItemID ( Item )
	local Check_Exp = 0
	local Elf_MaxEXP = GetItemAttr(Item_Traget,ITEMATTR_MAXENERGY) 

	if Item_type == 58 and Item_Traget_Type == 59  then
			Check_Exp = CheckElf_EXP ( role , Item_Traget ) --精灵exp是否满足升级条件
			if Check_Exp == 0 then
				CALCULATE_ITEMEFFECT_LUA_000086 = GetResString("CALCULATE_ITEMEFFECT_LUA_000086")
				SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000086 ) 
				UseItemFailed ( role )
			else
			   Lvup_Sta_1 ( role , Item_Num , Item_Traget ) --精神属性的成长函数 
			end  
		        --local Item_MAXENERGY = Elf_MaxEXP + 20
			--SetItemAttr ( Item_Traget , ITEMATTR_MAXENERGY , Item_MAXENERGY )				
	end 
end
--精灵加速成长果
function ItemUse_JLJSGz( role , Item )
	local Item_bg = GetChaItem ( role , 2 , 1  )
	local Get_Item_Type = GetItemType ( Item_bg )
	if Item_bg == nil or Get_Item_Type ~= 59 then
		CALCULATE_ITEMEFFECT_LUA_000174 = GetResString("CALCULATE_ITEMEFFECT_LUA_000174")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000174)
		UseItemFailed ( role )
	end
	local ret = CheckJingLingLv ( role , Item_bg)
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000175 = GetResString("CALCULATE_ITEMEFFECT_LUA_000175")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000175)
		UseItemFailed ( role )
	end
	local statelv = 1
	local ChaStateLv = GetChaStateLv ( role , STATE_JLJSGZ)
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	if ChaStateLv > statelv then
		CALCULATE_FUNCTIONS_LUA_000113 = GetResString("CALCULATE_FUNCTIONS_LUA_000113")
		SystemNotice ( role , CALCULATE_FUNCTIONS_LUA_000113 )
		UseItemFailed ( role )
		return
	end
	local statetime = 900
	--local Cha_Boat = 0
	--Cha_Boat = GetCtrlBoat ( role )
	AddState( role , role , STATE_JLJSGZ , statelv , statetime )
end
---------------------70级封印紫武宝箱
function ItemUse_70FYZWBOX( role , Item )
  
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000176 = GetResString("CALCULATE_ITEMEFFECT_LUA_000176")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000176)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 4204  , 1 , 22) 
end
---------------------70级巨剑紫武宝箱
function ItemUse_70JJZWBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000177 = GetResString("CALCULATE_ITEMEFFECT_LUA_000177")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000177)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 1375 , 1 , 22) 
end
---------------------70级双剑紫武宝箱
function ItemUse_70SJZWBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000178 = GetResString("CALCULATE_ITEMEFFECT_LUA_000178")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000178)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 1394 , 1 , 22) 
end
---------------------70级狙击紫武宝箱

function ItemUse_70JUJZWBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000179 = GetResString("CALCULATE_ITEMEFFECT_LUA_000179")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000179)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 42 , 1 , 22) 
end

---------------------70级航海紫武宝箱
function ItemUse_70HHZWBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000180 = GetResString("CALCULATE_ITEMEFFECT_LUA_000180")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000180)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 1421 , 1 , 22) 
end
---------------------70级圣职紫武宝箱
function ItemUse_70SZZWBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000181 = GetResString("CALCULATE_ITEMEFFECT_LUA_000181")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000181)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 4198 , 1 , 22) 
end
---------------------50级双剑宝箱
function ItemUse_50SJBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000182 = GetResString("CALCULATE_ITEMEFFECT_LUA_000182")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000182)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0299 , 1 , 22) 
	GiveItem ( role , 0 , 0475 , 1 , 22) 
	GiveItem ( role , 0 , 0651 , 1 , 22) 
end
--------------------60级双剑宝箱
function ItemUse_60SJBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000183 = GetResString("CALCULATE_ITEMEFFECT_LUA_000183")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000183)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0304 , 1 , 22) 
	GiveItem ( role , 0 , 0480 , 1 , 22) 
	GiveItem ( role , 0 , 0656 , 1 , 22) 
end
--------------------70级双剑宝箱
function ItemUse_70SJBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 2 then
		CALCULATE_ITEMEFFECT_LUA_000184 = GetResString("CALCULATE_ITEMEFFECT_LUA_000184")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000184)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 4150 , 1 , 22) 
	GiveItem ( role , 0 , 4166 , 1 , 22) 
	GiveItem ( role , 0 , 4182 , 1 , 22) 
end
--------------------50级巨剑宝箱
function ItemUse_50JJBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000185 = GetResString("CALCULATE_ITEMEFFECT_LUA_000185")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000185)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0229 , 1 , 22) 
	GiveItem ( role , 0 , 653 , 1 , 22)  
end
--------------------60级巨剑宝箱
function ItemUse_60JJBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000186 = GetResString("CALCULATE_ITEMEFFECT_LUA_000186")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000186)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0230 , 1 , 22) 
	GiveItem ( role , 0 , 477 , 1 , 22)  
end
--------------------70级巨剑宝箱
function ItemUse_70JJBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 2 then
		CALCULATE_ITEMEFFECT_LUA_000187 = GetResString("CALCULATE_ITEMEFFECT_LUA_000187")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000187)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 4148 , 1 , 22) 
	GiveItem ( role , 0 , 653 , 1 , 22)  
	GiveItem ( role , 0 , 477 , 1 , 22)
end
--------------------50级圣职宝箱
function ItemUse_50SZBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000188 = GetResString("CALCULATE_ITEMEFFECT_LUA_000188")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000188)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0371 , 1 , 22) 
	GiveItem ( role , 0 , 0547 , 1 , 22)  
	GiveItem ( role , 0 , 0723 , 1 , 22) 
end
--------------------60级圣职宝箱
function ItemUse_60SZBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000189 = GetResString("CALCULATE_ITEMEFFECT_LUA_000189")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000189)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0394 , 1 , 22) 
	GiveItem ( role , 0 , 0570 , 1 , 22)  
	GiveItem ( role , 0 , 0746 , 1 , 22) 
end
--------------------70级圣职宝箱
function ItemUse_70SZBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 2 then
		CALCULATE_ITEMEFFECT_LUA_000190 = GetResString("CALCULATE_ITEMEFFECT_LUA_000190")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000190)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 4159 , 1 , 22) 
	GiveItem ( role , 0 , 4175 , 1 , 22)  
	GiveItem ( role , 0 , 4191 , 1 , 22) 
end
--------------------50级艾米圣职宝箱
function ItemUse_50AMSZBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000191 = GetResString("CALCULATE_ITEMEFFECT_LUA_000191")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000191)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0382 , 1 , 22) 
	GiveItem ( role , 0 , 0558 , 1 , 22)  
	GiveItem ( role , 0 , 0734 , 1 , 22) 
	GiveItem ( role , 0 , 2204 , 1 , 22) 
end
--------------------60级艾米圣职宝箱
function ItemUse_60AMSZBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000192 = GetResString("CALCULATE_ITEMEFFECT_LUA_000192")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000192)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0393 , 1 , 22) 
	GiveItem ( role , 0 , 0569 , 1 , 22)  
	GiveItem ( role , 0 , 0745 , 1 , 22) 
	GiveItem ( role , 0 , 2215 , 1 , 22) 
end
--------------------70级艾米圣职宝箱
function ItemUse_70AMSZBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 2 then
		CALCULATE_ITEMEFFECT_LUA_000193 = GetResString("CALCULATE_ITEMEFFECT_LUA_000193")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000193)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 4160 , 1 , 22) 
	GiveItem ( role , 0 , 4176 , 1 , 22)  
	GiveItem ( role , 0 , 4192 , 1 , 22)  
end
--------------------50级艾米封印宝箱
function ItemUse_50AMFYBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000194 = GetResString("CALCULATE_ITEMEFFECT_LUA_000194")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000194)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0385 , 1 , 22) 
	GiveItem ( role , 0 , 0561 , 1 , 22)  
	GiveItem ( role , 0 , 0737 , 1 , 22) 
	GiveItem ( role , 0 , 2207 , 1 , 22) 
end
--------------------60级艾米封印宝箱
function ItemUse_60AMFYBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000195 = GetResString("CALCULATE_ITEMEFFECT_LUA_000195")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000195)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0364 , 1 , 22) 
	GiveItem ( role , 0 , 0540 , 1 , 22)  
	GiveItem ( role , 0 , 0716 , 1 , 22) 
	GiveItem ( role , 0 , 2201 , 1 , 22) 
end
--------------------70级艾米封印宝箱
function ItemUse_70AMFYBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 2 then
		CALCULATE_ITEMEFFECT_LUA_000196 = GetResString("CALCULATE_ITEMEFFECT_LUA_000196")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000196)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 4164 , 1 , 22) 
	GiveItem ( role , 0 , 4180 , 1 , 22)  
	GiveItem ( role , 0 , 4196 , 1 , 22) 
end
--------------------50级艾航海印宝箱
function ItemUse_50AMHHBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000197 = GetResString("CALCULATE_ITEMEFFECT_LUA_000197")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000197)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0355 , 1 , 22) 
	GiveItem ( role , 0 , 0531 , 1 , 22)  
	GiveItem ( role , 0 , 0707 , 1 , 22) 
	GiveItem ( role , 0 , 2192 , 1 , 22) 
end
--------------------60级艾航海印宝箱
function ItemUse_60AMHHBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000198 = GetResString("CALCULATE_ITEMEFFECT_LUA_000198")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000198)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0358 , 1 , 22) 
	GiveItem ( role , 0 , 0534 , 1 , 22)  
	GiveItem ( role , 0 , 0710 , 1 , 22) 
	GiveItem ( role , 0 , 2195 , 1 , 22) 
end
--------------------70级艾航海印宝箱
function ItemUse_70AMHHBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 2 then
		CALCULATE_ITEMEFFECT_LUA_000199 = GetResString("CALCULATE_ITEMEFFECT_LUA_000199")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000199)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 4156 , 1 , 22) 
	GiveItem ( role , 0 , 4172 , 1 , 22)  
	GiveItem ( role , 0 , 4188 , 1 , 22)  
end
--------------------50级狙击宝箱
function ItemUse_50JUJBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000200 = GetResString("CALCULATE_ITEMEFFECT_LUA_000200")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000200)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0312 , 1 , 22) 
	GiveItem ( role , 0 , 0488 , 1 , 22)  
	GiveItem ( role , 0 , 0664 , 1 , 22) 
end
--------------------60级狙击宝箱
function ItemUse_60JUJBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000201 = GetResString("CALCULATE_ITEMEFFECT_LUA_000201")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000201)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0317 , 1 , 22) 
	GiveItem ( role , 0 , 0493 , 1 , 22)  
	GiveItem ( role , 0 , 0669 , 1 , 22) 
end
--------------------70级狙击宝箱
function ItemUse_70JUJBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 2 then
		CALCULATE_ITEMEFFECT_LUA_000202 = GetResString("CALCULATE_ITEMEFFECT_LUA_000202")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000202)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 4152 , 1 , 22) 
	GiveItem ( role , 0 , 4168 , 1 , 22)  
	GiveItem ( role , 0 , 4184 , 1 , 22) 
end
--------------------50级航海宝箱
function ItemUse_50HHBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000203 = GetResString("CALCULATE_ITEMEFFECT_LUA_000203")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000203)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0345 , 1 , 22) 
	GiveItem ( role , 0 , 0521 , 1 , 22)  
	GiveItem ( role , 0 , 0697 , 1 , 22) 
end
--------------------60级航海宝箱
function ItemUse_60HHBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000204 = GetResString("CALCULATE_ITEMEFFECT_LUA_000204")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000204)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0344 , 1 , 22) 
	GiveItem ( role , 0 , 0520 , 1 , 22)  
	GiveItem ( role , 0 , 0696 , 1 , 22) 
end
--------------------70级航海宝箱
function ItemUse_70HHBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 2 then
		CALCULATE_ITEMEFFECT_LUA_000205 = GetResString("CALCULATE_ITEMEFFECT_LUA_000205")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000205)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 4155 , 1 , 22) 
	GiveItem ( role , 0 , 4171 , 1 , 22)  
	GiveItem ( role , 0 , 4187 , 1 , 22) 
end
--------------------50级封印宝箱
function ItemUse_50FYBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000206 = GetResString("CALCULATE_ITEMEFFECT_LUA_000206")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000206)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0369 , 1 , 22) 
	GiveItem ( role , 0 , 0545 , 1 , 22)  
	GiveItem ( role , 0 , 0721 , 1 , 22) 
end
--------------------60级封印宝箱
function ItemUse_60FYBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000207 = GetResString("CALCULATE_ITEMEFFECT_LUA_000207")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000207)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0377 , 1 , 22) 
	GiveItem ( role , 0 , 0553 , 1 , 22)  
	GiveItem ( role , 0 , 0729 , 1 , 22) 
end
--------------------70级封印宝箱
function ItemUse_70FYBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 2 then
		CALCULATE_ITEMEFFECT_LUA_000208 = GetResString("CALCULATE_ITEMEFFECT_LUA_000208")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000208)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 4163 , 1 , 22) 
	GiveItem ( role , 0 , 4179 , 1 , 22)  
	GiveItem ( role , 0 , 4195 , 1 , 22) 
end
-------------------------------------------------------kokora 08商品调整(如修改请把原使用部分解开)--------------------------------------
--98天堂包
--function ItemUse_98BOX ( role , Item )
--			local item_type = BaoXiang_98BOX
--			local item_type_rad = BaoXiang_98BOX_Rad 
--			local item_type_count = BaoXiang_98BOX_Count 
--			local maxitem = BaoXiang_98BOX_Mxcount						-- 终结编号
--			local item_quality = BaoXiang_98BOX_Qua
--			local General = 0  
--			local ItemId = 0 
--			
--		local Item_CanGet = GetChaFreeBagGridNum ( role )
--		
--		if Item_CanGet <= 0 then
--			SystemNotice(role ,"身上没有足够的空间，宝箱开启失败")
--			UseItemFailed ( role )
--			return
--		end
--				for i = 1 , maxitem , 1 do 
--					General = item_type_rad [ i ] + General		
--				end 
--				local a = math.random ( 1, General )
--				local b = 0
--				local d = 0 
--				local c = -1							--命中物品编号
--				for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号
--
--					d = item_type_rad [ k ] + b
--
--					 if a <= d and a > b then
--						c = k
--						break		
--					end 
--					b = d 
--				end 
--				if c == -1 then 
--					ItemId = 3124 
--				else 
--					ItemId = item_type [c]  
--					ItemCount = item_type_count [c] 
--				end 
--
--				GiveItem ( role , 0 , ItemId , ItemCount , item_quality )
--		
--				local GoodItem = {}
--				GoodItem[0] = 3074
--				GoodItem[1] = 0937
--				GoodItem[2] = 3885
--				GoodItem[3] = 0680
--				GoodItem[4] = 0938
--				GoodItem[5] = 2488
--				GoodItem[6] = 2489
--				GoodItem[7] = 2490
--				GoodItem[8] =2436
--				GoodItem[9] =3075
--
--				local Good_C = 0
--				for Good_C = 0 , 9 , 1 do
--					if ItemId == GoodItem[Good_C] then
--						local itemname = GetItemName ( ItemId ) 
--						local cha_name = GetChaDefaultName ( role ) 
--						local message = cha_name.."打开98天堂包惊喜地获得"..itemname  
--						Notice ( message )
--					end
--				end
--	
--	end
function ItemUse_98BOX ( role , Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end 
	local NocLock =	KitbagLock( role, 0 )
	if NocLock == LUA_FALSE then
		CALCULATE_FUNCTIONS_LUA_000144 = GetResString("CALCULATE_FUNCTIONS_LUA_000144")
		SystemNotice( role , CALCULATE_FUNCTIONS_LUA_000144)
		return 
	end
	local Money_Have = GetChaAttr ( role , ATTR_GD )
	if Money_Have>1900000000 then
		CALCULATE_FUNCTIONS_LUA_000146 = GetResString("CALCULATE_FUNCTIONS_LUA_000146")
		SystemNotice (role, CALCULATE_FUNCTIONS_LUA_000146)
		return 
	end
	AddMoney ( role , 0 , 10000 )                 --------10000海盗币
		CALCULATE_ITEMEFFECT_LUA_000161 = GetResString("CALCULATE_ITEMEFFECT_LUA_000161")
		SystemNotice ( role ,CALCULATE_ITEMEFFECT_LUA_000161)	
end
--------------------烈炎石兑换券
function ItemUse_lieyanBook( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000209 = GetResString("CALCULATE_ITEMEFFECT_LUA_000209")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000209)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0878 , 1 , 4) 
end
--------------------炙焰石兑换券
function ItemUse_zhiyanBook( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000210 = GetResString("CALCULATE_ITEMEFFECT_LUA_000210")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000210)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0879 , 1 , 4) 
end
--------------------火药石兑换券
function ItemUse_huoyaoBook( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000211 = GetResString("CALCULATE_ITEMEFFECT_LUA_000211")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000211)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0880 , 1 , 4) 
end
--------------------玛瑙石兑换券
function ItemUse_manaoBook( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000212 = GetResString("CALCULATE_ITEMEFFECT_LUA_000212")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000212)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0881 , 1 , 4) 
end
--------------------圣光石兑换券
function ItemUse_shengguangBook( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000213 = GetResString("CALCULATE_ITEMEFFECT_LUA_000213")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000213)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0887 , 1 , 4) 
end
--------------------月之心兑换券
function ItemUse_yuezhixinBook( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000214 = GetResString("CALCULATE_ITEMEFFECT_LUA_000214")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000214)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0883 , 1 , 4) 
end
--------------------寒玉兑换券
function ItemUse_hanyuBook( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000215 = GetResString("CALCULATE_ITEMEFFECT_LUA_000215")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000215)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0882 , 1 , 4) 
end
--------------------风灵石兑换券
function ItemUse_fenglingBook( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000216 = GetResString("CALCULATE_ITEMEFFECT_LUA_000216")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000216)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0860 , 1 , 4) 
end
--------------------仙灵石兑换券
function ItemUse_xianlingBook( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000217 = GetResString("CALCULATE_ITEMEFFECT_LUA_000217")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000217)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0884 , 1 , 4) 
end
--------------------鹰眼石兑换券
function ItemUse_yingyanBook( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000218 = GetResString("CALCULATE_ITEMEFFECT_LUA_000218")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000218)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0861 , 1 , 4) 
end
--------------------岩玉兑换券
function ItemUse_yanyuBook( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000219 = GetResString("CALCULATE_ITEMEFFECT_LUA_000219")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000219)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0862 , 1 , 4) 
end
--------------------炎玉兑换券
function ItemUse_tanyuBook( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000220 = GetResString("CALCULATE_ITEMEFFECT_LUA_000220")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000220)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0863 , 1 , 4) 
end
--------------------50级双剑紫武宝箱
function ItemUse_50SJZWBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000221 = GetResString("CALCULATE_ITEMEFFECT_LUA_000221")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000221)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 1392 , 1 , 22) 
end
--------------------50级巨剑紫武宝箱
function ItemUse_50JJZWBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000222 = GetResString("CALCULATE_ITEMEFFECT_LUA_000222")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000222)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 1373 , 1 , 22) 
end
--------------------50级狙击紫武宝箱
function ItemUse_50JUJZWBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000223 = GetResString("CALCULATE_ITEMEFFECT_LUA_000223")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000223)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0040 , 1 , 22) 
end
--------------------50级航海紫武宝箱
function ItemUse_50HHZWBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000224 = GetResString("CALCULATE_ITEMEFFECT_LUA_000224")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000224)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 1419 , 1 , 22) 
end
--------------------50级圣职紫武宝箱
function ItemUse_50SZZWBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000225 = GetResString("CALCULATE_ITEMEFFECT_LUA_000225")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000225)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0103 , 1 , 22) 
end
--------------------50级封印紫武宝箱
function ItemUse_50FYZWBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000226 = GetResString("CALCULATE_ITEMEFFECT_LUA_000226")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000226)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0102 , 1 , 22) 
end



--------------------60级双剑紫武宝箱
function ItemUse_60SJZWBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000227 = GetResString("CALCULATE_ITEMEFFECT_LUA_000227")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000227)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 1393 , 1 , 22) 
end
--------------------60级巨剑紫武宝箱
function ItemUse_60JJZWBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000228 = GetResString("CALCULATE_ITEMEFFECT_LUA_000228")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000228)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 1374 , 1 , 22) 
end
--------------------60级狙击紫武宝箱
function ItemUse_60JUJZWBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000229 = GetResString("CALCULATE_ITEMEFFECT_LUA_000229")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000229)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0041 , 1 , 22) 
end
--------------------60级航海紫武宝箱
function ItemUse_60HHZWBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000230 = GetResString("CALCULATE_ITEMEFFECT_LUA_000230")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000230)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 1420 , 1 , 22) 
end
--------------------60级圣职紫武宝箱
function ItemUse_60SZZWBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000231 = GetResString("CALCULATE_ITEMEFFECT_LUA_000231")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000231)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 4303 , 1 , 22) 
end
--------------------60级封印紫武宝箱
function ItemUse_60FYZWBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000232 = GetResString("CALCULATE_ITEMEFFECT_LUA_000232")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000232)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 4300 , 1 , 22) 
end
--------------------纯真之心，重生之心
function ItemUse_CZZX( role , Item )

--	local statelv = 1
--	local statetime = 30
--	local Item_ID=GetItemID(Item)
--	AddState( role , role , STATE_CZZX , statelv , statetime )
--	if Item_ID~=1013 then
--		GiveItem ( role , 0 , 1010 , 1 , 4)
--	end
		CALCULATE_ITEMEFFECT_LUA_000233 = GetResString("CALCULATE_ITEMEFFECT_LUA_000233")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000233 )
		UseItemFailed ( role )
end
--------------------辉煌礼炮
function ItemUse_HHLP( role , Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Now_Day = os.date("%d")
	local Now_Month = os.date("%m")
	local Now_Time = os.date("%H")
	local NowTimeNum = tonumber(Now_Time)
	local NowDayNum = tonumber(Now_Day)
	local NowMonthNum = tonumber(Now_Month)
	local CheckDateNum = NowMonthNum * 10000 + NowDayNum * 100 + NowTimeNum
	local star = 0


	if CheckDateNum >= 10122  and CheckDateNum <= 10123 then
		ItemUse_XNBOX ( role , Item )


	--if CheckDateNum >= 100122  and CheckDateNum <= 100123 then
		--star=1
	--end
	--if CheckDateNum >= 100622  and CheckDateNum <= 100623 then
		--star=1
	--end
	--if star ==1 then
		--ItemUse_BaoZhaBOX ( role , Item )	
	end
end
--------------------嘎纳之神
function ItemUse_GNZS( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ==  nil then
		local attr_sta = GetChaAttr( role , ATTR_STA )
		local sta_extre = 5
		attr_sta = attr_sta + sta_extre 
		SetCharaAttr( attr_sta, role, ATTR_STA )
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
end
--------------------技能精灵蛋
function ItemUse_JNJLD( role , Item )

	local star=math.random ( 1, 10 )
	local r1 = 0
	local r2 = 0
	if star==1 then
		r1,r2=MakeItem( role , 183 , 1 , 4)
	elseif  star==2 then
		r1,r2=MakeItem( role , 184 , 1 , 4)
	elseif  star==3 then
		r1,r2=MakeItem( role , 185 , 1 , 4)
	elseif  star==4 then
		r1,r2=MakeItem( role , 186 , 1 , 4)
	elseif  star==5 then
		r1,r2=MakeItem( role , 187 , 1 , 4)
	elseif  star==6 then
		r1,r2=MakeItem( role , 188 , 1 , 4)
	elseif  star==7 then
		r1,r2=MakeItem( role , 189 , 1 , 4)
	elseif  star==8 then
		r1,r2=MakeItem( role , 190 , 1 , 4)
	elseif  star==9 then
		r1,r2=MakeItem( role , 191 , 1 , 4)
	else  
		r1,r2=MakeItem( role , 199 , 1 , 4)
	end
	local Item_newJL = GetChaItem ( role , 2 , r2 )			--取新精灵道具指针
	local Num_newJL = GetItemForgeParam ( Item_newJL , 1 )
	local Part1_newJL = GetNum_Part1 ( Num_newJL )	--Get Num Part 1 到 Part 7
	local Part2_newJL = GetNum_Part2 ( Num_newJL )	
	local Part3_newJL = GetNum_Part3 ( Num_newJL )
	local Part4_newJL = GetNum_Part4 ( Num_newJL )
	local Part5_newJL = GetNum_Part5 ( Num_newJL )
	local Part6_newJL = GetNum_Part6 ( Num_newJL )
	local Part7_newJL= GetNum_Part7 ( Num_newJL )
	local t={}
		t[0]=1
		t[1]=2
		t[2]=3
		t[3]=4
		t[4]=5
	local eleven=math.random ( 1,3 )
	Part2_newJL=t[eleven-1]
	Part4_newJL=t[eleven]
	Part6_newJL=t[eleven+1]
	Num_newJL = SetNum_Part2 ( Num_newJL , Part2_newJL )
	Num_newJL = SetNum_Part3 ( Num_newJL , 1 )
	Num_newJL = SetNum_Part4 ( Num_newJL , Part4_newJL )
	Num_newJL = SetNum_Part5 ( Num_newJL , 1 )
	Num_newJL = SetNum_Part6 ( Num_newJL , Part6_newJL )
	Num_newJL = SetNum_Part7 ( Num_newJL , 1 )
	SetItemForgeParam ( Item_newJL , 1 , Num_newJL )
end
-----------------------------------------------------------
--怪物召唤
function ItemUse_NSSN ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local star = 0
	star =IsChaInRegion( role, 2 )
	if star == 1 then
		CALCULATE_ITEMEFFECT_LUA_000234 = GetResString("CALCULATE_ITEMEFFECT_LUA_000234")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000234 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	local MonsterID = 857
	local Refresh = 3700					--重生时间，秒单位
	local life = 3600000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaLifeTime( new, life )
end
-----------------------------------------------------------
--女神的小包
function ItemUse_NSDXB ( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000235 = GetResString("CALCULATE_ITEMEFFECT_LUA_000235")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000235)
		UseItemFailed ( role )
		return
	end
	local star=math.random ( 1, 12 )
	local r1 = 0
	local r2 = 0
	if star==1 then
		r1,r2=MakeItem( role , 619 , 1 , 4)
	elseif star==2 then
		r1,r2=MakeItem( role , 625 , 1 , 4)
	elseif  star==3 then
		r1,r2=MakeItem( role , 628 , 1 , 4)
	elseif  star==4 then
		r1,r2=MakeItem( role , 631 , 1 , 4)
	elseif  star==5 then
		r1,r2=MakeItem( role , 634 , 1 , 4)
	elseif  star==6 then
		r1,r2=MakeItem( role , 674 , 1 , 4)
	elseif  star==7 then
		r1,r2=MakeItem( role , 698 , 1 , 4)
	elseif  star==8 then
		r1,r2=MakeItem( role , 701 , 1 , 4)
	else 
		local eleven =math.random ( 2530, 2548 )
		r1,r2=MakeItem( role , eleven , 1 , 4)
	end
	local Item_new = GetChaItem ( role , 2 , r2 )			--取道具指针
	local Item_ID = GetItemID ( Item_new )
	local itemname = GetItemName (Item_ID) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000236 = GetResString("CALCULATE_ITEMEFFECT_LUA_000236")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000236..itemname  
	Notice ( message )
end
----加纳宝箱
function ItemUse_JaNaBox ( role , Item ) 

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 1012 , 1 , 4) 			
	local itemname = GetItemName (1012) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000237 = GetResString("CALCULATE_ITEMEFFECT_LUA_000237")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000237..itemname  
	Notice ( message )
end


--------黑市商人黑市装备--Leo
function gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	local cha_name = GetChaDefaultName ( role ) 
	local General = 0  
	local ItemId = 0 
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000020 = GetResString("CALCULATE_ITEMEFFECT_LUA_000020")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000020)
		UseItemFailed ( role )
		return
	end
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break		
		end 
		b = d 
	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	if ItemId==0845 or ItemId==0846 or ItemId==0847 or ItemId==0848 then
		local check_rad = math.random ( 1, 100 )
		local heilong_rad = math.random ( 1, 1000 )
		if check_rad==99 and heilong_rad>=999 then
			item_quality=16
		elseif  check_rad==99 and  heilong_rad>=900 then 
			item_quality=15
		elseif  check_rad==99 and  heilong_rad>=500 then 
			item_quality=14
		elseif  check_rad==99 and  heilong_rad>=200 then 
			item_quality=13
		elseif  check_rad==99 then  
			item_quality=12
		else 
			ItemId=0266
		end
	end	
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality )
	local GoodItem = {}
	GoodItem[0] = 0845
	GoodItem[1] = 0846
	GoodItem[2] = 0847
	GoodItem[3] = 0848
	GoodItem[4] = 0266
	local Good_C = 0
	for Good_C = 0 , 4 , 1 do
		if ItemId == GoodItem[Good_C] then
			local itemname = GetItemName ( ItemId ) 
			CALCULATE_ITEMEFFECT_LUA_000238 = GetResString("CALCULATE_ITEMEFFECT_LUA_000238")
			local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000238..itemname  
			Notice ( message )
		end
	end
	--LG( "HeiShiZhangBei_XinXi" , cha_name , ItemId )

	return 1
end

--游龙宝箱24型
function ItemUse_jsyla( role , Item )

	local item_quality =BaoXiang_jsyla_Qua
	local maxitem = BaoXiang_jsyla_Mxcount
	local item_type = BaoXiang_jsyla
	local item_type_rad =BaoXiang_jsyla_Rad

	local item_type_count =BaoXiang_jsyla_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--游龙宝箱23型
function ItemUse_jsylb( role , Item )

	local item_quality =BaoXiang_jsylb_Qua
	local maxitem =BaoXiang_jsylb_Mxcount
	local item_type = BaoXiang_jsylb
	local item_type_rad =BaoXiang_jsylb_Rad

	local item_type_count =BaoXiang_jsylb_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--迷之利刃宝箱24型
function ItemUse_jsmzlra( role , Item )

	local item_quality =BaoXiang_jsmzlra_Qua
	local maxitem =BaoXiang_jsmzlra_Mxcount
	local item_type = BaoXiang_jsmzlra
	local item_type_rad =BaoXiang_jsmzlra_Rad

	local item_type_count =BaoXiang_jsmzlra_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--迷之利刃宝箱23型
function ItemUse_jsmzlrb( role , Item )

	local item_quality =BaoXiang_jsmzlrb_Qua
	local maxitem =BaoXiang_jsmzlrb_Mxcount
	local item_type = BaoXiang_jsmzlrb
	local item_type_rad =BaoXiang_jsmzlrb_Rad

	local item_type_count =BaoXiang_jsmzlrb_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--巨阙宝箱24型
function ItemUse_jsjqa( role , Item )

	local item_quality =BaoXiang_jsjqa_Qua
	local maxitem =BaoXiang_jsjqa_Mxcount
	local item_type = BaoXiang_jsjqa
	local item_type_rad =BaoXiang_jsjqa_Rad

	local item_type_count =BaoXiang_jsjqa_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--巨阙宝箱23型
function ItemUse_jsjqb( role , Item )
	local item_quality =BaoXiang_jsjqb_Qua
	local maxitem =BaoXiang_jsjqb_Mxcount
	local item_type = BaoXiang_jsjqb
	local item_type_rad =BaoXiang_jsjqb_Rad

	local item_type_count =BaoXiang_jsjqb_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--迷之裁决宝箱24型
function ItemUse_jsmzcja( role , Item )
	local item_quality =BaoXiang_jsmzcja_Qua
	local maxitem =BaoXiang_jsmzcja_Mxcount
	local item_type = BaoXiang_jsmzcja
	local item_type_rad =BaoXiang_jsmzcja_Rad

	local item_type_count =BaoXiang_jsmzcja_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--迷之裁决宝箱23型
function ItemUse_jsmzcjb( role , Item )
	local item_quality =BaoXiang_jsmzcjb_Qua
	local maxitem =BaoXiang_jsmzcjb_Mxcount
	local item_type = BaoXiang_jsmzcjb
	local item_type_rad =BaoXiang_jsmzcjb_Rad

	local item_type_count =BaoXiang_jsmzcjb_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--双剑盔甲宝箱24型
function ItemUse_jssjkja( role , Item )
	local item_quality =BaoXiang_jssjkja_Qua
	local maxitem =BaoXiang_jssjkja_Mxcount
	local item_type = BaoXiang_jssjkja
	local item_type_rad =BaoXiang_jssjkja_Rad

	local item_type_count =BaoXiang_jssjkja_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--双剑盔甲宝箱23型
function ItemUse_jssjkjb( role , Item )
	local item_quality =BaoXiang_jssjkjb_Qua
	local maxitem =BaoXiang_jssjkjb_Mxcount
	local item_type = BaoXiang_jssjkjb
	local item_type_rad =BaoXiang_jssjkjb_Rad

	local item_type_count =BaoXiang_jssjkjb_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--狙击盔甲宝箱24型
function ItemUse_jszjkja( role , Item )
	local item_quality =BaoXiang_jszjkja_Qua
	local maxitem =BaoXiang_jszjkja_Mxcount
	local item_type = BaoXiang_jszjkja
	local item_type_rad =BaoXiang_jszjkja_Rad

	local item_type_count =BaoXiang_jszjkja_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--狙击盔甲宝箱23型
function ItemUse_jszjkjb( role , Item )
	local item_quality =BaoXiang_jszjkjb_Qua
	local maxitem =BaoXiang_jszjkjb_Mxcount
	local item_type = BaoXiang_jszjkjb
	local item_type_rad =BaoXiang_jszjkjb_Rad

	local item_type_count =BaoXiang_jszjkjb_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--圣职盔甲宝箱24型
function ItemUse_jsszkja( role , Item )
	local item_quality =BaoXiang_jsszkja_Qua
	local maxitem =BaoXiang_jsszkja_Mxcount
	local item_type = BaoXiang_jsszkja
	local item_type_rad =BaoXiang_jsszkja_Rad

	local item_type_count =BaoXiang_jsszkja_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--圣职盔甲宝箱23型
function ItemUse_jsszkjb( role , Item )
	local item_quality =BaoXiang_jsszkjb_Qua
	local maxitem =BaoXiang_jsszkjb_Mxcount
	local item_type = BaoXiang_jsszkjb
	local item_type_rad =BaoXiang_jsszkjb_Rad

	local item_type_count =BaoXiang_jsszkjb_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--封印盔甲宝箱24型
function ItemUse_jsfykja( role , Item )
	local item_quality =BaoXiang_jsfykja_Qua
	local maxitem =BaoXiang_jsfykja_Mxcount
	local item_type = BaoXiang_jsfykja
	local item_type_rad =BaoXiang_jsfykja_Rad

	local item_type_count =BaoXiang_jsfykja_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--封印盔甲宝箱23型
function ItemUse_jsfykjb( role , Item )
	local item_quality =BaoXiang_jsfykjb_Qua
	local maxitem =BaoXiang_jsfykjb_Mxcount
	local item_type = BaoXiang_jsfykjb
	local item_type_rad =BaoXiang_jsfykjb_Rad

	local item_type_count =BaoXiang_jsfykjb_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--航海盔甲宝箱24型
function ItemUse_jshhkja( role , Item )
	local item_quality =BaoXiang_jshhkja_Qua
	local maxitem =BaoXiang_jshhkja_Mxcount
	local item_type = BaoXiang_jshhkja
	local item_type_rad =BaoXiang_jshhkja_Rad

	local item_type_count =BaoXiang_jshhkja_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--航海盔甲宝箱23型
function ItemUse_jshhkjb( role , Item )
	local item_quality =BaoXiang_jshhkjb_Qua
	local maxitem =BaoXiang_jshhkjb_Mxcount
	local item_type = BaoXiang_jshhkjb
	local item_type_rad =BaoXiang_jshhkjb_Rad

	local item_type_count =BaoXiang_jshhkjb_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--巨剑盔甲宝箱24型
function ItemUse_jsjjkja( role , Item )
	local item_quality =BaoXiang_jsjjkja_Qua
	local maxitem =BaoXiang_jsjjkja_Mxcount
	local item_type = BaoXiang_jsjjkja
	local item_type_rad =BaoXiang_jsjjkja_Rad

	local item_type_count =BaoXiang_jsjjkja_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--巨剑盔甲宝箱23型
function ItemUse_jsjjkjb( role , Item )
	local item_quality =BaoXiang_jsjjkjb_Qua
	local maxitem =BaoXiang_jsjjkjb_Mxcount
	local item_type = BaoXiang_jsjjkjb
	local item_type_rad =BaoXiang_jsjjkjb_Rad

	local item_type_count =BaoXiang_jsjjkjb_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--黑龙之躯宝箱24型
function ItemUse_jshlza( role , Item )
	local item_quality =BaoXiang_jshlza_Qua
	--local 
	local maxitem =BaoXiang_jshlza_Mxcount
	local item_type = BaoXiang_jshlza
	local item_type_rad =BaoXiang_jshlza_Rad

	local item_type_count =BaoXiang_jshlza_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--黑龙之躯宝箱23型
function ItemUse_jshlzb( role , Item )
	local item_quality =BaoXiang_jshlzb_Qua
	local maxitem =BaoXiang_jshlzb_Mxcount
	local item_type = BaoXiang_jshlzb
	local item_type_rad =BaoXiang_jshlzb_Rad

	local item_type_count =BaoXiang_jshlzb_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--黑龙之首宝箱24型
function ItemUse_jshlta( role , Item )
	local item_quality =BaoXiang_jshlta_Qua
	local maxitem =BaoXiang_jshlta_Mxcount
	local item_type = BaoXiang_jshlta
	local item_type_rad =BaoXiang_jshlta_Rad

	local item_type_count =BaoXiang_jshlta_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--黑龙之爪宝箱24型
function ItemUse_jshlsa( role , Item )
	local item_quality =BaoXiang_jshlsa_Qua
	local maxitem =BaoXiang_jshlsa_Mxcount
	local item_type = BaoXiang_jshlsa
	local item_type_rad =BaoXiang_jshlsa_Rad

	local item_type_count =BaoXiang_jshlsa_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--黑龙之爪宝箱23型
function ItemUse_jshlsb( role , Item )
	local item_quality =BaoXiang_jshlsb_Qua
	local maxitem =BaoXiang_jshlsb_Mxcount
	local item_type = BaoXiang_jshlsb
	local item_type_rad =BaoXiang_jshlsb_Rad

	local item_type_count =BaoXiang_jshlsb_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--黑龙之翼宝箱24型
function ItemUse_jshlya( role , Item )
	local item_quality =BaoXiang_jshlya_Qua
	local maxitem =BaoXiang_jshlya_Mxcount
	local item_type = BaoXiang_jshlya
	local item_type_rad =BaoXiang_jshlya_Rad

	local item_type_count =BaoXiang_jshlya_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--黑龙之翼宝箱23型
function ItemUse_jshlyb( role , Item )
	local item_quality =BaoXiang_jshlyb_Qua
	local maxitem =BaoXiang_jshlyb_Mxcount
	local item_type = BaoXiang_jshlyb
	local item_type_rad =BaoXiang_jshlyb_Rad

	local item_type_count =BaoXiang_jshlyb_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--迷幻之刺宝箱24型
function ItemUse_jsmhzca( role , Item )
	local item_quality =BaoXiang_jsmhzca_Qua
	local maxitem =BaoXiang_jsmhzca_Mxcount
	local item_type = BaoXiang_jsmhzca
	local item_type_rad =BaoXiang_jsmhzca_Rad

	local item_type_count =BaoXiang_jsmhzca_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--迷幻之刺宝箱23型
function ItemUse_jsmhzcb( role , Item )
	local item_quality =BaoXiang_jsmhzcb_Qua
	local maxitem =BaoXiang_jsmhzcb_Mxcount
	local item_type = BaoXiang_jsmhzcb
	local item_type_rad =BaoXiang_jsmhzcb_Rad

	local item_type_count =BaoXiang_jsmhzcb_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--迷咒法杖宝箱24型
function ItemUse_jsmzfza( role , Item )
	local item_quality =BaoXiang_jsmzfza_Qua
	local maxitem =BaoXiang_jsmzfza_Mxcount
	local item_type = BaoXiang_jsmzfza
	local item_type_rad =BaoXiang_jsmzfza_Rad

	local item_type_count =BaoXiang_jsmzfza_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--迷咒法杖宝箱23型
function ItemUse_jsmzfzb( role , Item )
	local item_quality =BaoXiang_jsmzfzb_Qua
	local maxitem =BaoXiang_jsmzfza_Mxcount
	local item_type = BaoXiang_jsmzfzb
	local item_type_rad =BaoXiang_jsmzfzb_Rad

	local item_type_count =BaoXiang_jsmzfzb_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--迷法之杖宝箱24型
function ItemUse_jsmfzza( role , Item )
	local item_quality =BaoXiang_jsmfzza_Qua
	local maxitem =BaoXiang_jsmfzza_Mxcount
	local item_type = BaoXiang_jsmfzza
	local item_type_rad =BaoXiang_jsmfzza_Rad

	local item_type_count =BaoXiang_jsmfzza_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--迷法之杖宝箱23型
function ItemUse_jsmfzzb( role , Item )
	local item_quality =BaoXiang_jsmfzzb_Qua
	local maxitem =BaoXiang_jsmfzzb_Mxcount
	local item_type = BaoXiang_jsmfzzb
	local item_type_rad =BaoXiang_jsmfzzb_Rad

	local item_type_count =BaoXiang_jsmfzzb_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--迷之长枪宝箱24型
function ItemUse_jsmzcqa( role , Item )
	local item_quality =BaoXiang_jsmzcqa_Qua
	local maxitem =BaoXiang_jsmzcqa_Mxcount
	local item_type = BaoXiang_jsmzcqa
	local item_type_rad =BaoXiang_jsmzcqa_Rad

	local item_type_count =BaoXiang_jsmzcqa_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end

--迷之长枪宝箱23型
function ItemUse_jsmzcqa( role , Item )
	local item_quality =BaoXiang_jsmzcqa_Qua
	local maxitem =BaoXiang_jsmzcqa_Mxcount
	local item_type = BaoXiang_jsmzcqa
	local item_type_rad =BaoXiang_jsmzcqa_Rad

	local item_type_count =BaoXiang_jsmzcqa_Count
	local ret = gogogo(role,Item,item_type,item_type_rad,item_type_count,maxitem,item_quality)
end


--迷你黑龙包
function ItemUse_minibh( role , Item )

	-- local Item_CanGet = GetChaFreeBagGridNum ( role )
	-- if Item_CanGet < 1 then
		-- SystemNotice(role ,"背包需要1个格子")
		-- UseItemFailed ( role )
		-- return
	-- end
	local cha_name = GetChaDefaultName ( role ) 
	local star=math.random ( 1, 10000 )
	if star==1 then
		GiveItem ( role , 0 , 272  , 1 , 4  )
		CALCULATE_ITEMEFFECT_LUA_000239 = GetResString("CALCULATE_ITEMEFFECT_LUA_000239")
		local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000239 
		Notice ( message )
	elseif star>1 and star<=51 then
		GiveItem ( role , 0 , 273  , 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000240 = GetResString("CALCULATE_ITEMEFFECT_LUA_000240")
		local message1 = cha_name..CALCULATE_ITEMEFFECT_LUA_000240 
		Notice ( message1 )
	elseif star>51 and star<1652 then
		GiveItem ( role , 0 , 274  , 1 , 4  ) 
	else
		GiveItem ( role , 0 , 275  , 1 , 4  ) 
	end
end
--卡拉的胜利
function ItemUse_kala( role , Item )

	CALCULATE_ITEMEFFECT_LUA_000241 = GetResString("CALCULATE_ITEMEFFECT_LUA_000241")
	SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000241)
--	local statelv = 1
--	local statetime = 20
--	AddState( role , role , STATE_KALA , statelv , statetime )
end
-----------------------------------------------------------
--怪物召唤
function ItemUse_MHDYSD ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local star = 0
	star =IsChaInRegion( role, 2 )
	if star == 1 then
		CALCULATE_ITEMEFFECT_LUA_000234 = GetResString("CALCULATE_ITEMEFFECT_LUA_000234")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000234 )
		UseItemFailed ( role )
		return
	end
	--local pet_num = GetPetNum(role)
	--if pet_num > 1 then
	--	SystemNotice( role , "宠物已满!" )
	--	return
	--end
	local x, y = GetChaPos(role)
	local MonsterID = 858
	local Refresh = 190					--重生时间，秒单位
	local life = 180000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	--SetChaHost(new,role)
	SetChaLifeTime( new, life )
	--SetChaTarget(new, role)
end
----------魔幻女神卡
function ItemUse_mohuan( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000242 = GetResString("CALCULATE_ITEMEFFECT_LUA_000242")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000242)
		UseItemFailed ( role )
		return
	end
	local cha_name = GetChaDefaultName ( role ) 
	local star=math.random ( 1, 1000 )
	--SystemNotice(role ,"star=="..star)
	if star<=8 then
		GiveItem ( role , 0 , 1014  , 1 , 4  )
		CALCULATE_ITEMEFFECT_LUA_000243 = GetResString("CALCULATE_ITEMEFFECT_LUA_000243")
		local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000243 
		Notice ( message )
	elseif star>=9 and star<=17 then
		GiveItem ( role , 0 , 271, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000244 = GetResString("CALCULATE_ITEMEFFECT_LUA_000244")
		local message1 = cha_name..CALCULATE_ITEMEFFECT_LUA_000244 
		Notice ( message1 )
	elseif star>=18 and star<=27 then
		GiveItem ( role , 0 , 1012, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000245 = GetResString("CALCULATE_ITEMEFFECT_LUA_000245")
		local message3 = cha_name..CALCULATE_ITEMEFFECT_LUA_000245 
		Notice ( message3 )
	elseif star>=28 and star<=227 then
		GiveItem ( role , 0 , 3886, 1 , 4  ) 
	else
		GiveItem ( role , 0 , 3830, 5 , 4  ) 
	end
end
----------魔幻字母卡宝箱
function ItemUse_MoHuanBox( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000242 = GetResString("CALCULATE_ITEMEFFECT_LUA_000242")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000242)
		UseItemFailed ( role )
		return
	end
	local star=math.random ( 1, 4663 )
	if star>=1 and star<=3 then
		GiveItem ( role , 0 , 3866, 1 , 4  ) 	
	elseif star>=4 and star<=14 then
		GiveItem ( role , 0 , 3864, 1 , 4  ) 		
	elseif star>=15 and star<=65 then
		GiveItem ( role , 0 , 3858, 1 , 4  )		
	else
		local star=math.random ( 3850, 3875 )
		if star==3858 or star==3864 or star==3866  then
			GiveItem ( role , 0 , 3850  , 1 , 4  ) 
		else 
			GiveItem ( role , 0 , star  , 1 , 4  ) 			
		end
	end
end
-----------------------------------------初级精灵自爆
function Sk_Script_CJJLZB( role , Item ) 
							
 	local sk_add = SK_JLZB  
	local form_sklv = GetSkillLv( role , sk_add ) 
	if form_sklv >= 1  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 0 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 
 -----------------------------------------中级精灵自爆
function Sk_Script_ZJJLZB ( role , Item ) 	
						
  	local sk_add = SK_JLZB
	local form_sklv = GetSkillLv( role , sk_add ) 
	if form_sklv >= 2 then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 2 , 1 , 0 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 
 -----------------------------------------高级精灵自爆
function Sk_Script_GJJLZB( role , Item ) 
							
   	local sk_add = SK_JLZB  
	local form_sklv = GetSkillLv( role , sk_add ) 
	if form_sklv >= 3  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 3 , 1 , 0 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 
function ItemUse_NoExp(role, item)
	local on = GetItemAttr(item, 55);
	local itemname = GetItemName(GetItemID(item))
	if on == 1 then
		SystemNotice(role, itemname..' grants you full EXP!')
		SetItemAttr(item, 55, 0)
	else
		SystemNotice(role, itemname..' grats you zero EXP!')
		SetItemAttr(item, 55, 1)
	end
	SynChaKitbag(role, 13)
end
--1000-1003	Blueprint
function ItemUse_MHDTZ( role , Item ) 		
	Notice("usou o blueprint")
	
 	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		SystemNotice(role, "To open blueprint requires at least 1 empty inventory slot")
		UseItemFailed(role)
		return
	end
	local Itemnew_ID = 2300
	local rad_ID = math.random(1, 100)
	if rad_ID <= 40 then
		Itemnew_ID = 2300 --Manufacturing Blueprint
	elseif rad_ID >= 41 and rad_ID <= 61 then
		Itemnew_ID = 2301 --Crafting Blueprint
	else
		Itemnew_ID = 2302 --Cooking Blueprint
	end
	local rad_energy	= math.random ( 1, 100 )
	local energy		= 1
	local item_ID		= GetItemID(Item)
	if item_ID == 1000 then
		energy = 1
	elseif item_ID == 1001 then
		if rad_energy <= 5 then
			energy = 4
		elseif  rad_energy <= 30 and rad_energy >= 6 then
			energy = 3
		else
			energy = 2
		end
	elseif item_ID == 1002 then
		if rad_energy <= 5 then
			energy = 6
		elseif  rad_energy <= 30 and rad_energy >= 6 then
			energy = 5
		else
			energy = 4
		end
	elseif item_ID == 1003 then
		if rad_energy <= 5 and Itemnew_ID ~= 2301 then
			energy = 8
		elseif  rad_energy <= 30 and rad_energy >= 6 then
			energy = 7
		else
			energy = 6
		end
	end
	local Product_ID	= 0
	local Product_LV	= 0
	local Material1		= 0
	local Material2		= 0
	local Material3		= 0
	local General		= 0
	local Blueprint		= 0
	--Manufacturing Blueprint
	if Itemnew_ID == 2300 then
		local v = {}
		v[1] = {1,28}
		v[2] = {29,56}
		v[3] = {57,84}
		v[4] = {85,112}
		v[5] = {113,140}
		v[6] = {141,168}
		v[7] = {169,196}
		v[8] = {197,224}
		v[9] = {225,252}
		v[10] = {253,280}
		for i = v[energy][1] , v[energy][2], 1 do
			if BTH.Manufacturing[i].Active == 1 then
				General = BTH.Manufacturing[i].Rad + General
			end
		end
		local a = math.random(1, General)
		local b = 0
		local d = 0 
		local c = -1
		for k = v[energy][1] , v[energy][2], 1 do
			if BTH.Manufacturing[k].Active == 1 then
				d = BTH.Manufacturing[k].Rad + b
				if a <= d and a > b then
					c = k
					break
				end 
				b = d
			end
		end
		if c ~= -1 then
			Product_ID	= BTH.Manufacturing[c].ItemID
			Product_LV	= BTH.Manufacturing[c].ItemLv
			Material1	= BTH.Manufacturing[c].Material1
			Material2	= BTH.Manufacturing[c].Material2
			Material3	= BTH.Manufacturing[c].Material3
			Blueprint = 1
		end
	end
	--Crafting Blueprint
	if Itemnew_ID == 2301 then
		local v = {}
		v[1] = {1,77}
		v[2] = {78,166}
		v[3] = {167,278}
		v[4] = {279,434}
		v[5] = {435,596}
		v[6] = {597,732}
		v[7] = {733,871}
		v[8] = {895,902}
		for i = v[energy][1] , v[energy][2], 1 do
			if BTH.Crafting[i].Active == 1 then
				General = BTH.Crafting[i].Rad + General
			end
		end
		local a = math.random(1, General)
		local b = 0
		local d = 0 
		local c = -1
		for k = v[energy][1] , v[energy][2], 1 do
			if BTH.Crafting[k].Active == 1 then
				d = BTH.Crafting[k].Rad + b
				if a <= d and a > b then
					c = k
					break
				end 
				b = d
			end
		end
		if c ~= -1 then
			Product_ID	= BTH.Crafting[c].ItemID
			Product_LV	= BTH.Crafting[c].ItemLv
			Material1	= BTH.Crafting[c].Material1
			Material2	= BTH.Crafting[c].Material2
			Material3	= BTH.Crafting[c].Material3
			Blueprint = 1
		end
	end
	--Cooking Blueprint
	if Itemnew_ID == 2302 then
		local v = {}
		v[1] = {1,7}
		v[2] = {8,12}
		v[3] = {13,17}
		v[4] = {18,26}
		v[5] = {27,31}
		v[6] = {32,36}
		v[7] = {37,38}
		v[8] = {39,40}
		for i = v[energy][1] , v[energy][2], 1 do
			if BTH.Cooking[i].Active == 1 then
				General = BTH.Cooking[i].Rad + General
			end
		end
		local a = math.random(1, General)
		local b = 0
		local d = 0 
		local c = -1
		for k = v[energy][1] , v[energy][2], 1 do
			if BTH.Cooking[k].Active == 1 then
				d = BTH.Cooking[k].Rad + b
				if a <= d and a > b then
					c = k
					break
				end 
				b = d
			end
		end
		if c ~= -1 then
			Product_ID	= BTH.Cooking[c].ItemID
			Product_LV	= BTH.Cooking[c].ItemLv
			Material1	= BTH.Cooking[c].Material1
			Material2	= BTH.Cooking[c].Material2
			Material3	= BTH.Cooking[c].Material3
			Blueprint = 1
		end
	end
	if Blueprint == 1 then
		local r1,r2 = 0,0
		r1, r2 = MakeItem(role, Itemnew_ID, 1, 4)
		local Itemnew = GetChaItem(role, 2, r2)
		
		local star_number = energy * 10
		local yingbi_num = math.random(10, star_number)
		if energy <= 3 then
			SetItemAttr(Itemnew, ITEMATTR_MAXURE, energy)		--Fairy Coin
			SetItemAttr(Itemnew, ITEMATTR_URE, energy)			--Fairy Coin
		else
			SetItemAttr(Itemnew, ITEMATTR_MAXURE, yingbi_num)	--Fairy Coin
			SetItemAttr(Itemnew, ITEMATTR_URE, energy)			--Fairy Coin
		end
		
		local sta =math.random(1,10)
		if Itemnew_ID == 2301 then
			sta = sta * 0.5
			sta = math.max(1,sta)
		end
		SetItemAttr(Itemnew, ITEMATTR_VAL_STA, sta )			--Blueprint Usage
		
		local quality = math.floor(Product_LV * 0.1) + 100
		SetItemAttr(Itemnew, ITEMATTR_MAXENERGY, quality )
	
		local ure = 10 - Product_LV * 0.1
		SetItemAttr(Itemnew, ITEMATTR_ENERGY, ure )				--Base success rate
	
		Notice("Material 1: " .. GetItemName(Material1))
		Notice("Material 2: " .. GetItemName(Material2))
		Notice("Material 3: " .. GetItemName(Material3))

		SetItemAttr(Itemnew, ITEMATTR_VAL_STR, Material1)		--Material 1
		SetItemAttr(Itemnew, ITEMATTR_VAL_CON, Material2)		--Material 2
		SetItemAttr(Itemnew, ITEMATTR_VAL_DEX, Material3)		--Material 3
		SetItemAttr(Itemnew, ITEMATTR_VAL_AGI, Product_ID)		--Product ID
	
		local Num_new = GetItemForgeParam ( Itemnew , 1 )
		local Part2_new = GetNum_Part2 ( Num_new )	
		local Part4_new = GetNum_Part4 ( Num_new )
		local Part6_new = GetNum_Part6 ( Num_new )
		Part2_new = math.random ( 3, 20 )						--Quantity Material 1
		Part4_new = math.random ( 2, 9 )						--Quantity Material 2
		Part6_new = math.random ( 1, 3 )						--Quantity Material 3
		Part6_new = Part6_new * math.max(1,(energy-2))			--Quantity Material 3
		Num_new = SetNum_Part2(Num_new, Part2_new)
		Num_new = SetNum_Part4(Num_new, Part4_new)
		Num_new = SetNum_Part6(Num_new, Part6_new)
		SetItemForgeParam(Itemnew, 1, Num_new)
	end
end


--Sk_Script_GS
--Sk_Script_NK
--Sk_Script_JQ
-----------------------------------------Sk_Script_DBs
function Sk_Script_DBs( role , Item ) 	
						
 	local sk_add = SK_JLTX1  
	local form_sklv = GetSkillLv( role , sk_add ) 
	if form_sklv >= 1  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 0 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 
-----------------------------------------Sk_Script_NKs
function Sk_Script_NKs( role , Item ) 
							
 	local sk_add = SK_JLTX2  
	local form_sklv = GetSkillLv( role , sk_add ) 
	if form_sklv >= 1  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 0 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 
-----------------------------------------Sk_Script_XZs
function Sk_Script_XZs( role , Item ) 	
						
 	local sk_add = SK_JLTX3  
	local form_sklv = GetSkillLv( role , sk_add ) 
	if form_sklv >= 1  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 0 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 
-----------------------------------------Sk_Script_JQs
function Sk_Script_JQs( role , Item ) 	
						
 	local sk_add = SK_JLTX4  
	local form_sklv = GetSkillLv( role , sk_add ) 
	if form_sklv >= 1  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 0 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 
-----------------------------------------Sk_Script_BCs
function Sk_Script_BCs( role , Item ) 			
				
 	local sk_add = SK_JLTX5  
	local form_sklv = GetSkillLv( role , sk_add ) 
	if form_sklv >= 1  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 0 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 
-----------------------------------------Sk_Script_BSs
function Sk_Script_BSs( role , Item ) 							

 	local sk_add = SK_JLTX6  
	local form_sklv = GetSkillLv( role , sk_add ) 
	if form_sklv >= 1  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 0 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 
-----------------------------------------Sk_Script_PZs
function Sk_Script_PZs( role , Item ) 	
						
 	local sk_add = SK_JLTX7  
	local form_sklv = GetSkillLv( role , sk_add ) 
	if form_sklv >= 1  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 0 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 
-----------------------------------------Sk_Script_SZs
function Sk_Script_SZs( role , Item ) 	
						
 	local sk_add = SK_JLTX8  
	local form_sklv = GetSkillLv( role , sk_add ) 
	if form_sklv >= 1  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 0 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 
--------------------------团队之星
function ItemUse_TunDuiZhiXing( role , Item ) 
							
   	local r1 = 0
	local r2 = 0
	r1, r2 = MakeItem ( role , 1034 , 1 , 4 )
	local Itemnew = GetChaItem ( role , 2 , r2 )
	--SetItemAttr(Itemnew, ITEMATTR_ENERGY, 100 )--当前存储经验
	--SetItemAttr(Itemnew, ITEMATTR_MAXENERGY, 201000 )--最高存储经验
	SetItemAttr(Itemnew, ITEMATTR_URE, 100 )--当前存储经验
	SetItemAttr(Itemnew, ITEMATTR_MAXURE, 20100 )--最高存储经验
end 
----------------------微型努力征服器
function ItemUse_WeiXing( role , Item )

	local statelv = 1
	local lv_star = GetChaAttr( role , ATTR_LV) 
	if lv_star > 40 then
		CALCULATE_ITEMEFFECT_LUA_000247 = GetResString("CALCULATE_ITEMEFFECT_LUA_000247")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000247 )
		UseItemFailed ( role )
		return
	end
	local statetime = 60+5*(lv_star-1)
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ==  nil then
		local ret = UseAexpItem(role,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	else
		local ret = UseAexpItem(Cha_Boat,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	end
end
----------------------------------------------------
function ItemUse_JLZhiZ_CJ ( role , Item , Item_Traget )   --初级精灵制造术
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type =  GetItemType ( Item )
		local Item_Traget_Type =  GetItemType ( Item_Traget )
		local Num = GetItemForgeParam ( Item_Traget , 1 )	 --精灵32位技能信息数据
		local SkillType = 1		--要增加的 Skill 类型
		local SkillNum = 13		--要增加的Skill 编号

		if Item_type == 58 and Item_Traget_Type == 59 then
			local Check = CheckElfHaveSkill ( Num , SkillType , SkillNum )
			if Check == 1 then
				CALCULATE_ITEMEFFECT_LUA_000087 = GetResString("CALCULATE_ITEMEFFECT_LUA_000087")
				SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000087 ) 
				UseItemFailed ( role )
			else
				AddElfSkill ( Item_Traget , SkillType , SkillNum )
			end
		end
end
----------------------------------------------------
function ItemUse_JLZhiZ_ZJ ( role , Item , Item_Traget )   --中级精灵制造术
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type =  GetItemType ( Item )
		local Item_Traget_Type =  GetItemType ( Item_Traget )
		local Num = GetItemForgeParam ( Item_Traget , 1 )	 --精灵32位技能信息数据
		local SkillType = 2		--要增加的 Skill 类型
		local SkillNum = 13		--要增加的Skill 编号

		if Item_type == 58 and Item_Traget_Type == 59 then
			local Check = CheckElfHaveSkill ( Num , SkillType , SkillNum )
			if Check == 1 then
				CALCULATE_ITEMEFFECT_LUA_000087 = GetResString("CALCULATE_ITEMEFFECT_LUA_000087")
				SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000087 ) 
				UseItemFailed ( role )
			else
				AddElfSkill ( Item_Traget , SkillType , SkillNum )
			end
		end
end
----------------------------------------------------
function ItemUse_JLZhiZ_GJ ( role , Item , Item_Traget )   --高级精灵制造术
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type =  GetItemType ( Item )
		local Item_Traget_Type =  GetItemType ( Item_Traget )
		local Num = GetItemForgeParam ( Item_Traget , 1 )	 --精灵32位技能信息数据
		local SkillType = 3		--要增加的 Skill 类型
		local SkillNum = 13		--要增加的Skill 编号

		if Item_type == 58 and Item_Traget_Type == 59 then
			local Check = CheckElfHaveSkill ( Num , SkillType , SkillNum )
			if Check == 1 then
				CALCULATE_ITEMEFFECT_LUA_000087 = GetResString("CALCULATE_ITEMEFFECT_LUA_000087")
				SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000087 ) 
				UseItemFailed ( role )
			else
				AddElfSkill ( Item_Traget , SkillType , SkillNum )
			end
		end
end
----------------------------------------------------
function ItemUse_JLZhuZ_CJ ( role , Item , Item_Traget )   --初级精灵铸造术
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type =  GetItemType ( Item )
		local Item_Traget_Type =  GetItemType ( Item_Traget )
		local Num = GetItemForgeParam ( Item_Traget , 1 )	 --精灵32位技能信息数据
		local SkillType = 1		--要增加的 Skill 类型
		local SkillNum = 14		--要增加的Skill 编号

		if Item_type == 58 and Item_Traget_Type == 59 then
			local Check = CheckElfHaveSkill ( Num , SkillType , SkillNum )
			if Check == 1 then
				CALCULATE_ITEMEFFECT_LUA_000087 = GetResString("CALCULATE_ITEMEFFECT_LUA_000087")
				SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000087 ) 
				UseItemFailed ( role )
			else
				AddElfSkill ( Item_Traget , SkillType , SkillNum )
			end
		end
end
----------------------------------------------------
function ItemUse_JLZhuZ_ZJ ( role , Item , Item_Traget )   --中级精灵铸造术
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type =  GetItemType ( Item )
		local Item_Traget_Type =  GetItemType ( Item_Traget )
		local Num = GetItemForgeParam ( Item_Traget , 1 )	 --精灵32位技能信息数据
		local SkillType = 2		--要增加的 Skill 类型
		local SkillNum = 14		--要增加的Skill 编号

		if Item_type == 58 and Item_Traget_Type == 59 then
			local Check = CheckElfHaveSkill ( Num , SkillType , SkillNum )
			if Check == 1 then
				CALCULATE_ITEMEFFECT_LUA_000087 = GetResString("CALCULATE_ITEMEFFECT_LUA_000087")
				SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000087 ) 
				UseItemFailed ( role )
			else
				AddElfSkill ( Item_Traget , SkillType , SkillNum )
			end
		end
end
----------------------------------------------------
function ItemUse_JLZhuZ_GJ ( role , Item , Item_Traget )   --高级精灵铸造术
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type =  GetItemType ( Item )
		local Item_Traget_Type =  GetItemType ( Item_Traget )
		local Num = GetItemForgeParam ( Item_Traget , 1 )	 --精灵32位技能信息数据
		local SkillType = 3		--要增加的 Skill 类型
		local SkillNum = 14		--要增加的Skill 编号

		if Item_type == 58 and Item_Traget_Type == 59 then
			local Check = CheckElfHaveSkill ( Num , SkillType , SkillNum )
			if Check == 1 then
				CALCULATE_ITEMEFFECT_LUA_000087 = GetResString("CALCULATE_ITEMEFFECT_LUA_000087")
				SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000087 ) 
				UseItemFailed ( role )
			else
				AddElfSkill ( Item_Traget , SkillType , SkillNum )
			end
		end
end
----------------------------------------------------
function ItemUse_JLFenJ_CJ ( role , Item , Item_Traget )   --初级精灵分解术
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type =  GetItemType ( Item )
		local Item_Traget_Type =  GetItemType ( Item_Traget )
		local Num = GetItemForgeParam ( Item_Traget , 1 )	 --精灵32位技能信息数据
		local SkillType = 1		--要增加的 Skill 类型
		local SkillNum = 15		--要增加的Skill 编号

		if Item_type == 58 and Item_Traget_Type == 59 then
			local Check = CheckElfHaveSkill ( Num , SkillType , SkillNum )
			if Check == 1 then
				CALCULATE_ITEMEFFECT_LUA_000087 = GetResString("CALCULATE_ITEMEFFECT_LUA_000087")
				SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000087 ) 
				UseItemFailed ( role )
			else
				AddElfSkill ( Item_Traget , SkillType , SkillNum )
			end
		end
end
----------------------------------------------------
function ItemUse_JLFenJ_ZJ ( role , Item , Item_Traget )   --中级精灵分解术
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type =  GetItemType ( Item )
		local Item_Traget_Type =  GetItemType ( Item_Traget )
		local Num = GetItemForgeParam ( Item_Traget , 1 )	 --精灵32位技能信息数据
		local SkillType = 2		--要增加的 Skill 类型
		local SkillNum = 15		--要增加的Skill 编号

		if Item_type == 58 and Item_Traget_Type == 59 then
			local Check = CheckElfHaveSkill ( Num , SkillType , SkillNum )
			if Check == 1 then
				CALCULATE_ITEMEFFECT_LUA_000087 = GetResString("CALCULATE_ITEMEFFECT_LUA_000087")
				SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000087 ) 
				UseItemFailed ( role )
			else
				AddElfSkill ( Item_Traget , SkillType , SkillNum )
			end
		end
end
----------------------------------------------------
function ItemUse_JLFenJ_GJ ( role , Item , Item_Traget )   --高级精灵分解术
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type =  GetItemType ( Item )
		local Item_Traget_Type =  GetItemType ( Item_Traget )
		local Num = GetItemForgeParam ( Item_Traget , 1 )	 --精灵32位技能信息数据
		local SkillType = 3		--要增加的 Skill 类型
		local SkillNum = 15		--要增加的Skill 编号

		if Item_type == 58 and Item_Traget_Type == 59 then
			local Check = CheckElfHaveSkill ( Num , SkillType , SkillNum )
			if Check == 1 then
				CALCULATE_ITEMEFFECT_LUA_000087 = GetResString("CALCULATE_ITEMEFFECT_LUA_000087")
				SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000087 ) 
				UseItemFailed ( role )
			else
				AddElfSkill ( Item_Traget , SkillType , SkillNum )
			end
		end
end
----------------------------------------------------
function ItemUse_JLPengR_CJ ( role , Item , Item_Traget )   --初级精灵烹饪术
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type =  GetItemType ( Item )
		local Item_Traget_Type =  GetItemType ( Item_Traget )
		local Num = GetItemForgeParam ( Item_Traget , 1 )	 --精灵32位技能信息数据
		local SkillType = 1		--要增加的 Skill 类型
		local SkillNum = 16		--要增加的Skill 编号

		if Item_type == 58 and Item_Traget_Type == 59 then
			local Check = CheckElfHaveSkill ( Num , SkillType , SkillNum )
			if Check == 1 then
				CALCULATE_ITEMEFFECT_LUA_000087 = GetResString("CALCULATE_ITEMEFFECT_LUA_000087")
				SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000087 ) 
				UseItemFailed ( role )
			else
				AddElfSkill ( Item_Traget , SkillType , SkillNum )
			end
		end
end
----------------------------------------------------
function ItemUse_JLPengR_ZJ ( role , Item , Item_Traget )   --中级精灵烹饪术
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type =  GetItemType ( Item )
		local Item_Traget_Type =  GetItemType ( Item_Traget )
		local Num = GetItemForgeParam ( Item_Traget , 1 )	 --精灵32位技能信息数据
		local SkillType = 2		--要增加的 Skill 类型
		local SkillNum = 16		--要增加的Skill 编号

		if Item_type == 58 and Item_Traget_Type == 59 then
			local Check = CheckElfHaveSkill ( Num , SkillType , SkillNum )
			if Check == 1 then
				CALCULATE_ITEMEFFECT_LUA_000087 = GetResString("CALCULATE_ITEMEFFECT_LUA_000087")
				SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000087 ) 
				UseItemFailed ( role )
			else
				AddElfSkill ( Item_Traget , SkillType , SkillNum )
			end
		end
end
----------------------------------------------------
function ItemUse_JLPengR_GJ ( role , Item , Item_Traget )   --高级精灵烹饪术
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type =  GetItemType ( Item )
		local Item_Traget_Type =  GetItemType ( Item_Traget )
		local Num = GetItemForgeParam ( Item_Traget , 1 )	 --精灵32位技能信息数据
		local SkillType = 3		--要增加的 Skill 类型
		local SkillNum = 16		--要增加的Skill 编号

		if Item_type == 58 and Item_Traget_Type == 59 then
			local Check = CheckElfHaveSkill ( Num , SkillType , SkillNum )
			if Check == 1 then
				CALCULATE_ITEMEFFECT_LUA_000087 = GetResString("CALCULATE_ITEMEFFECT_LUA_000087")
				SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000087 ) 
				UseItemFailed ( role )
			else
				AddElfSkill ( Item_Traget , SkillType , SkillNum )
			end
		end
end
----------------------------------乱斗宝盒
function ItemUse_FightingBox( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 2 then
		CALCULATE_ITEMEFFECT_LUA_000248 = GetResString("CALCULATE_ITEMEFFECT_LUA_000248")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000248)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 2610  , 1 , 4 )
	
	local bf = math.random ( 1 , 10 )-----10个开一个才会得东西
	if bf == 1 then
		
		local rad = math.random ( 1, 3 )
		if rad ==1 then
		GiveItem ( role , 0 , 1124  , 1 , 15 )
			return
		end	
		if rad ==2 then
		GiveItem ( role , 0 , 1125  , 1 , 15 )
			return
		end
		if rad ==3 then
		GiveItem ( role , 0 , 1126  , 1 , 15 )
			return
		end
		CALCULATE_ITEMEFFECT_LUA_000249 = GetResString("CALCULATE_ITEMEFFECT_LUA_000249")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000249 )
	else
		CALCULATE_ITEMEFFECT_LUA_000250 = GetResString("CALCULATE_ITEMEFFECT_LUA_000250")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000250 )
	end
	
end

---------------------------------鳕鱼闷闷锅：最大HP+100，物力抵抗+1，时间15分钟
function ItemUse_XUEYU( role , Item ) 

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local statelv = 1
	local ChaStateLv = GetChaStateLv ( role , STATE_XUEYU )
	if ChaStateLv > statelv then
		CALCULATE_ITEMEFFECT_LUA_000251 = GetResString("CALCULATE_ITEMEFFECT_LUA_000251")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000251 )
		UseItemFailed ( role )
		return
	end
	local statetime = 900
	AddState( role , role , STATE_XUEYU , statelv , statetime )
end 
---------------------------------翠竹花脸鲟：最大HP+400，物力抵抗+2，时间10分钟
function ItemUse_CUIZHU( role , Item ) 

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local statelv = 2
	local ChaStateLv = GetChaStateLv ( role , STATE_XUEYU )
	if ChaStateLv > statelv then
		CALCULATE_ITEMEFFECT_LUA_000251 = GetResString("CALCULATE_ITEMEFFECT_LUA_000251")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000251 )
		UseItemFailed ( role )
		return
	end
	local statetime = 600
	AddState( role , role , STATE_XUEYU , statelv , statetime )
end 
---------------------------------回香射水鱼：最大HP+900，物力抵抗+2，时间10分钟
function ItemUse_HUIXIANG( role , Item ) 

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local statelv = 3
	local ChaStateLv = GetChaStateLv ( role , STATE_XUEYU )
	if ChaStateLv > statelv then
		CALCULATE_ITEMEFFECT_LUA_000251 = GetResString("CALCULATE_ITEMEFFECT_LUA_000251")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000251 )
		UseItemFailed ( role )
		return
	end
	local statetime = 600
	AddState( role , role , STATE_XUEYU , statelv , statetime )
end 
---------------------------------映月鲟鱼汤：最大HP+1600，物力抵抗+3，时间8分钟
function ItemUse_YINGYUE( role , Item ) 

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local statelv = 4
	local ChaStateLv = GetChaStateLv ( role , STATE_XUEYU )
	if ChaStateLv > statelv then
		CALCULATE_ITEMEFFECT_LUA_000251 = GetResString("CALCULATE_ITEMEFFECT_LUA_000251")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000251 )
		UseItemFailed ( role )
		return
	end
	local statetime =480
	AddState( role , role , STATE_XUEYU , statelv , statetime )
end 
---------------------------------浪贝煨煎羹：最大HP+2500，物力抵抗+3，时间8分钟
function ItemUse_LANGBEI( role , Item )
 
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local statelv =5
	local ChaStateLv = GetChaStateLv ( role , STATE_XUEYU )
	if ChaStateLv > statelv then
		CALCULATE_ITEMEFFECT_LUA_000251 = GetResString("CALCULATE_ITEMEFFECT_LUA_000251")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000251 )
		UseItemFailed ( role )
		return
	end
	local statetime = 480
	AddState( role , role , STATE_XUEYU , statelv , statetime )
end 
---------------------------------小小跳虾饺：最大HP+3600，物力抵抗+4，时间6分钟
function ItemUse_XIAOXIAO( role , Item ) 

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local statelv = 6
	local ChaStateLv = GetChaStateLv ( role , STATE_XUEYU )
	if ChaStateLv > statelv then
		CALCULATE_ITEMEFFECT_LUA_000251 = GetResString("CALCULATE_ITEMEFFECT_LUA_000251")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000251 )
		UseItemFailed ( role )
		return
	end
	local statetime = 360
	AddState( role , role , STATE_XUEYU , statelv , statetime )
end 
---------------------------------虎皮鱼骨酥：最大HP+4900，物力抵抗+5，时间5分钟
function ItemUse_HUPI( role , Item )
 
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local statelv =7
	local ChaStateLv = GetChaStateLv ( role , STATE_XUEYU )
	if ChaStateLv > statelv then
		CALCULATE_ITEMEFFECT_LUA_000251 = GetResString("CALCULATE_ITEMEFFECT_LUA_000251")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000251 )
		UseItemFailed ( role )
		return
	end
	local statetime = 300
	AddState( role , role , STATE_XUEYU , statelv , statetime )
end 
---------------------------------银鲛海鲜饭：最大HP+6400，物力抵抗+6，时间3分钟
function ItemUse_YINJIAO( role , Item )
 
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local statelv = 8
	local ChaStateLv = GetChaStateLv ( role , STATE_XUEYU )
	if ChaStateLv > statelv then
		CALCULATE_ITEMEFFECT_LUA_000251 = GetResString("CALCULATE_ITEMEFFECT_LUA_000251")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000251 )
		UseItemFailed ( role )
		return
	end
	local statetime = 180
	AddState( role , role , STATE_XUEYU , statelv , statetime )
end 
---------------------------------陶土网纹鰧：最大HP+8100，物力抵抗+6，时间3分钟
function ItemUse_TAOTU( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local statelv = 9
	local ChaStateLv = GetChaStateLv ( role , STATE_XUEYU )
	if ChaStateLv > statelv then
		CALCULATE_ITEMEFFECT_LUA_000251 = GetResString("CALCULATE_ITEMEFFECT_LUA_000251")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000251 )
		UseItemFailed ( role )
		return
	end
	local statetime = 180
	AddState( role , role , STATE_XUEYU , statelv , statetime )
end 
---------------------------------百万烤鱼翅：最大HP+10000，物力抵抗+8，时间1分钟
function ItemUse_BAIWANG( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local statelv = 10
	local ChaStateLv = GetChaStateLv ( role , STATE_XUEYU )
	if ChaStateLv > statelv then
		CALCULATE_ITEMEFFECT_LUA_000251 = GetResString("CALCULATE_ITEMEFFECT_LUA_000251")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000251 )
		UseItemFailed ( role )
		return
	end
	local statetime =60
	AddState( role , role , STATE_XUEYU , statelv , statetime )
end 
---------------------------------- 馒头：HP+200，攻击力+50，时间15分钟
function ItemUse_MANTOU( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local hp = GetChaAttr( role , ATTR_HP ) 
	local hp_resume = 200 
	hp = hp + hp_resume 
	local mxhp = GetChaAttr( role , ATTR_MXHP) 
	if hp > mxhp then 
		 hp = mxhp 
	 end 
	SetCharaAttr(hp, role, ATTR_HP) 
	local statelv = 1
	local ChaStateLv = GetChaStateLv ( role , STATE_MANTOU )
	if ChaStateLv > statelv then
		CALCULATE_ITEMEFFECT_LUA_000251 = GetResString("CALCULATE_ITEMEFFECT_LUA_000251")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000251 )
		UseItemFailed ( role )
		return
	end
	local statetime = 900
	AddState( role , role , STATE_MANTOU , statelv , statetime )
end 
---------------------------------包子：HP+400，攻击力+150，时间10分钟
function ItemUse_BAOZI( role , Item ) 

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local hp = GetChaAttr( role , ATTR_HP ) 
	local hp_resume = 400 
	hp = hp + hp_resume 
	local mxhp = GetChaAttr( role , ATTR_MXHP) 
	if hp > mxhp then 
		 hp = mxhp 
	 end 
	SetCharaAttr(hp, role, ATTR_HP) 
	local statelv = 2
	local ChaStateLv = GetChaStateLv ( role , STATE_MANTOU )
	if ChaStateLv > statelv then
		CALCULATE_ITEMEFFECT_LUA_000251 = GetResString("CALCULATE_ITEMEFFECT_LUA_000251")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000251 )
		UseItemFailed ( role )
		return
	end
	local statetime =600
	AddState( role , role , STATE_MANTOU , statelv , statetime )
end 
---------------------------------大饼：HP+600，攻击力+250，时间7分钟
function ItemUse_DABING( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local hp = GetChaAttr( role , ATTR_HP ) 
	local hp_resume = 600 
	hp = hp + hp_resume 
	local mxhp = GetChaAttr( role , ATTR_MXHP) 
	if hp > mxhp then 
		 hp = mxhp 
	 end 
	SetCharaAttr(hp, role, ATTR_HP) 
	local statelv = 3
	local ChaStateLv = GetChaStateLv ( role , STATE_MANTOU )
	if ChaStateLv > statelv then
		CALCULATE_ITEMEFFECT_LUA_000251 = GetResString("CALCULATE_ITEMEFFECT_LUA_000251")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000251 )
		UseItemFailed ( role )
		return
	end
	local statetime = 420
	AddState( role , role , STATE_MANTOU , statelv , statetime )
end 
---------------------------------油条：HP+800，攻击力+350，时间5分钟
function ItemUse_YOUTIAO( role , Item )
 
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local hp = GetChaAttr( role , ATTR_HP ) 
	local hp_resume = 800 
	hp = hp + hp_resume 
	local mxhp = GetChaAttr( role , ATTR_MXHP) 
	if hp > mxhp then 
		 hp = mxhp 
	 end 
	SetCharaAttr(hp, role, ATTR_HP) 
	local statelv = 4
	local ChaStateLv = GetChaStateLv ( role , STATE_MANTOU )
	if ChaStateLv > statelv then
		CALCULATE_ITEMEFFECT_LUA_000251 = GetResString("CALCULATE_ITEMEFFECT_LUA_000251")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000251 )
		UseItemFailed ( role )
		return
	end
	local statetime =300
	AddState( role , role , STATE_MANTOU , statelv , statetime )
end 
---------------------------------春卷：HP+1000，攻击力+450，时间2分钟
function ItemUse_CHUNJUAN( role , Item )
 
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local hp = GetChaAttr( role , ATTR_HP ) 
	local hp_resume = 1000 
	hp = hp + hp_resume 
	local mxhp = GetChaAttr( role , ATTR_MXHP) 
	if hp > mxhp then 
		 hp = mxhp 
	 end 
	SetCharaAttr(hp, role, ATTR_HP) 
	local statelv = 5
	local ChaStateLv = GetChaStateLv ( role , STATE_MANTOU )
	if ChaStateLv > statelv then
		CALCULATE_ITEMEFFECT_LUA_000251 = GetResString("CALCULATE_ITEMEFFECT_LUA_000251")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000251 )
		UseItemFailed ( role )
		return
	end
	local statetime = 120
	AddState( role , role , STATE_MANTOU , statelv , statetime )
end 
---------------------------------女儿红：SP+100，精神+5，时间15分钟
function ItemUse_NVER( role , Item ) 

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local sp = GetChaAttr( role , ATTR_SP ) 
	local sp_resume = 100 
	sp = sp + sp_resume 
	local mxsp = GetChaAttr( role , ATTR_MXSP) 
	if sp > mxsp then 
		 sp = mxsp 
	 end 
	SetCharaAttr(sp, role, ATTR_SP) 
	local statelv = 1
	local ChaStateLv = GetChaStateLv ( role , STATE_NVER )
	if ChaStateLv > statelv then
		CALCULATE_ITEMEFFECT_LUA_000251 = GetResString("CALCULATE_ITEMEFFECT_LUA_000251")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000251 )
		UseItemFailed ( role )
		return
	end
	local statetime = 900
	AddState( role , role , STATE_NVER , statelv , statetime )
end 
---------------------------------状元红：SP+200，精神+10，时间10分钟
function ItemUse_ZHUANGYUAN( role , Item )
 
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local sp = GetChaAttr( role , ATTR_SP ) 
	local sp_resume = 200 
	sp = sp + sp_resume 
	local mxsp = GetChaAttr( role , ATTR_MXSP) 
	if sp > mxsp then 
		 sp = mxsp 
	 end 
	SetCharaAttr(sp, role, ATTR_SP) 
	local statelv = 2
	local ChaStateLv = GetChaStateLv ( role , STATE_NVER )
	if ChaStateLv > statelv then
		CALCULATE_ITEMEFFECT_LUA_000251 = GetResString("CALCULATE_ITEMEFFECT_LUA_000251")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000251 )
		UseItemFailed ( role )
		return
	end
	local statetime = 600
	AddState( role , role , STATE_NVER , statelv , statetime )
end 
---------------------------------杜康：SP+300，精神+15，时间7分钟
function ItemUse_DUKANG( role , Item )
 
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local sp = GetChaAttr( role , ATTR_SP ) 
	local sp_resume = 300 
	sp = sp + sp_resume 
	local mxsp = GetChaAttr( role , ATTR_MXSP) 
	if sp > mxsp then 
		 sp = mxsp 
	 end 
	SetCharaAttr(sp, role, ATTR_SP) 
	local statelv = 3
	local ChaStateLv = GetChaStateLv ( role , STATE_NVER )
	if ChaStateLv > statelv then
		CALCULATE_ITEMEFFECT_LUA_000251 = GetResString("CALCULATE_ITEMEFFECT_LUA_000251")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000251 )
		UseItemFailed ( role )
		return
	end
	local statetime = 420
	AddState( role , role , STATE_NVER , statelv , statetime )
end 
---------------------------------茅台：SP+400，精神+20，时间5分钟
function ItemUse_MAOTAI( role , Item ) 

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local sp = GetChaAttr( role , ATTR_SP ) 
	local sp_resume = 400 
	sp = sp + sp_resume 
	local mxsp = GetChaAttr( role , ATTR_MXSP) 
	if sp > mxsp then 
		 sp = mxsp 
	 end 
	SetCharaAttr(sp, role, ATTR_SP) 
	local statelv = 4
	local ChaStateLv = GetChaStateLv ( role , STATE_NVER )
	if ChaStateLv > statelv then
		CALCULATE_ITEMEFFECT_LUA_000251 = GetResString("CALCULATE_ITEMEFFECT_LUA_000251")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000251 )
		UseItemFailed ( role )
		return
	end
	local statetime = 300
	AddState( role , role , STATE_NVER , statelv , statetime )
end 
---------------------------------人参酒：SP+500，精神+25，时间3分钟
function ItemUse_RENSHEN( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local sp = GetChaAttr( role , ATTR_SP ) 
	local sp_resume = 500 
	sp = sp + sp_resume 
	local mxsp = GetChaAttr( role , ATTR_MXSP) 
	if sp > mxsp then 
		 sp = mxsp 
	 end 
	SetCharaAttr(sp, role, ATTR_SP) 
	local statelv = 5
	local ChaStateLv = GetChaStateLv ( role , STATE_NVER )
	if ChaStateLv > statelv then
		CALCULATE_ITEMEFFECT_LUA_000251 = GetResString("CALCULATE_ITEMEFFECT_LUA_000251")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000251 )
		UseItemFailed ( role )
		return
	end
	local statetime = 180
	AddState( role , role , STATE_NVER , statelv , statetime )
end 
---------------------------------虎骨酒：SP+600，精神+30，时间2分钟
function ItemUse_HUGU( role , Item ) 

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local sp = GetChaAttr( role , ATTR_SP ) 
	local sp_resume = 600 
	sp = sp + sp_resume 
	local mxsp = GetChaAttr( role , ATTR_MXSP) 
	if sp > mxsp then 
		 sp = mxsp 
	 end 
	SetCharaAttr(sp, role, ATTR_SP) 
	local statelv = 6
	local ChaStateLv = GetChaStateLv ( role , STATE_NVER )
	if ChaStateLv > statelv then
		CALCULATE_ITEMEFFECT_LUA_000251 = GetResString("CALCULATE_ITEMEFFECT_LUA_000251")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000251 )
		UseItemFailed ( role )
		return
	end
	local statetime = 120
	AddState( role , role , STATE_NVER , statelv , statetime )
end 
-------------------新式摩力酷装宝箱
-- function ItemUse_MOLIBOX( role , Item )
	-- local Item_CanGet = GetChaFreeBagGridNum ( role )	
	-- if Item_CanGet < 4 then
		-- SystemNotice(role ,"打开宝箱背包里至少需要有4个空位")
		-- UseItemFailed ( role )
		-- return
	-- end
	-- local rad = math.random ( 1, 12 )
	-- if rad == 1 then
	-- GiveItem ( role , 0 , 5107  , 1 , 4 ) 
	-- GiveItem ( role , 0 , 5108  , 1 , 4 ) 
	-- GiveItem ( role , 0 , 5109  , 1 , 4 ) 
	-- elseif rad == 2 then
	-- GiveItem ( role , 0 , 5111  , 1 , 4 ) 
	-- GiveItem ( role , 0 , 5112  , 1 , 4 ) 
	-- GiveItem ( role , 0 , 5113  , 1 , 4 ) 
	-- elseif rad == 3 then
	-- GiveItem ( role , 0 , 5115  , 1 , 4 ) 
	-- GiveItem ( role , 0 , 5116  , 1 , 4 ) 
	-- GiveItem ( role , 0 , 5117  , 1 , 4 ) 
	-- elseif rad == 4 then
	-- GiveItem ( role , 0 , 5119  , 1 , 4 ) 
	-- GiveItem ( role , 0 , 5120  , 1 , 4 ) 
	-- GiveItem ( role , 0 , 5121  , 1 , 4 ) 
	-- elseif rad == 5 then
	-- GiveItem ( role , 0 , 5123  , 1 , 4 ) 
	-- GiveItem ( role , 0 , 5124  , 1 , 4 ) 
	-- GiveItem ( role , 0 , 5125  , 1 , 4 )
	-- elseif rad == 6 then
	-- GiveItem ( role , 0 , 5127  , 1 , 4 ) 
	-- GiveItem ( role , 0 , 5128  , 1 , 4 ) 
	-- GiveItem ( role , 0 , 5129  , 1 , 4 )
	-- elseif rad == 7 then
	-- GiveItem ( role , 0 , 5130  , 1 , 4 ) 
	-- GiveItem ( role , 0 , 5131  , 1 , 4 ) 
	-- GiveItem ( role , 0 , 5132  , 1 , 4 )
	-- GiveItem ( role , 0 , 5133  , 1 , 4 )
	-- elseif rad == 8 then
	-- GiveItem ( role , 0 , 5134  , 1 , 4 ) 
	-- GiveItem ( role , 0 , 5135  , 1 , 4 ) 
	-- GiveItem ( role , 0 , 5136  , 1 , 4 )
	-- GiveItem ( role , 0 , 5137  , 1 , 4 )
	-- elseif rad == 9 then
	-- GiveItem ( role , 0 , 5138  , 1 , 4 ) 
	-- GiveItem ( role , 0 , 5139  , 1 , 4 ) 
	-- GiveItem ( role , 0 , 5140  , 1 , 4 )
	-- GiveItem ( role , 0 , 5141  , 1 , 4 )
	-- elseif rad == 10 then
	-- GiveItem ( role , 0 , 5143  , 1 , 4 ) 
	-- GiveItem ( role , 0 , 5144  , 1 , 4 ) 
	-- GiveItem ( role , 0 , 5145  , 1 , 4 ) 
	-- elseif rad == 11 then
	-- GiveItem ( role , 0 , 5147  , 1 , 4 ) 
	-- GiveItem ( role , 0 , 5148  , 1 , 4 ) 
	-- GiveItem ( role , 0 , 5149  , 1 , 4 )
	-- elseif rad == 12 then
	-- GiveItem ( role , 0 , 5151  , 1 , 4 ) 
	-- GiveItem ( role , 0 , 5152  , 1 , 4 ) 
	-- GiveItem ( role , 0 , 5153  , 1 , 4 )
	-- end
	-- local cha_name = GetChaDefaultName ( role ) 
	-- local message = cha_name.."打开摩力酷装宝箱奖惊喜地获得新式摩力酷装1套"   
	-- Notice ( message )
-- end

function ItemUse_IDBOX(role, Item )

	local lv = GetChaAttr(role, ATTR_LV)
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	local cha_name = GetChaDefaultName ( role ) 
	local count = 1
	
	if lv < 60 then
		CALCULATE_ITEMEFFECT_LUA_000252 = GetResString("CALCULATE_ITEMEFFECT_LUA_000252")
		SystemNotice( role ,CALCULATE_ITEMEFFECT_LUA_000252)
		UseItemFailed ( role )	
	else
		CALCULATE_ITEMEFFECT_LUA_000253 = GetResString("CALCULATE_ITEMEFFECT_LUA_000253")
		SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_000253)
	end
end 

---------------------荣誉加点书
function ItemUse_HonorPoint (role, Item )

	local HonorBook_Num = 0
	local HonorBook_Num = CheckBagItem( role,3849 )
		if HonorBook_Num < 1 then
		CALCULATE_ITEMEFFECT_LUA_000254 = GetResString("CALCULATE_ITEMEFFECT_LUA_000254")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000254)
		return 0
		end
	local Book2 =  GetChaItem2 ( role , 2 , 3849 )
	local HonorPoint=GetItemAttr ( Book2 , ITEMATTR_VAL_STR)
	
	local HonorPoint_X=HonorPoint+100
	SetItemAttr ( Book2 , ITEMATTR_VAL_STR,HonorPoint_X)
	
end
-------------------------乱斗加点书
function ItemUse_FightingPoint (role, Item )

	local HonorBook_Num = 0
	local HonorBook_Num = CheckBagItem( role,3849 )
		if HonorBook_Num < 1 then
		CALCULATE_ITEMEFFECT_LUA_000254 = GetResString("CALCULATE_ITEMEFFECT_LUA_000254")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000254)
		return 0
		end
	local Book2 =  GetChaItem2 ( role , 2 , 3849 )
	local FightingPoint=GetItemAttr ( Book2 , ITEMATTR_MAXENERGY)
	
	local FightingPoint_X=FightingPoint+10
	SetItemAttr ( Book2 , ITEMATTR_MAXENERGY,FightingPoint_X)
	
end
----------------------------[[美味火鸡肉]]--
function ItemUse_MWHJ ( role , Item )  

	local el_exp = GetChaAttr(role, ATTR_CEXP)
	local exp1=el_exp
	local charLv=Lv ( role )
	local exp_resume = 5000
	local	exp_resume_1= 100
	el_exp = el_exp + exp_resume
	 if charLv>=80 then	
		el_exp = exp1 + exp_resume_1
	end
	SetCharaAttr(el_exp, role, ATTR_CEXP) 
end 
------------------------圣诞大餐
function ItemUse_SDDC ( role , Item )

	local Cha_Boat = 0
	local charLv=Lv ( role )
	local dif_exp_one = DEXP[charLv+1]
	local dif_exp_three = DEXP[charLv+3]
	local dif_exp_five = DEXP[charLv+5]
	local Exp_star=GetChaAttr (  role , ATTR_CEXP )----------当前等级经验
	local dif_exp_half = (DEXP[charLv+1] - DEXP[charLv])*0.5 +  Exp_star +10
	local dif_exp_thalf = (DEXP[charLv+1] - DEXP[charLv])*0.3  +  Exp_star + 10
	local dif_exp_thalf_b = dif_exp_thalf - DEXP[charLv+1]
	local dif_exp_thalf_c = (DEXP[charLv+1] - DEXP[charLv])*0.01+Exp_star ----------------
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	elseif charLv>=1 and charLv<=9 then
		SetChaAttrI( role , ATTR_CEXP , dif_exp_five )
	elseif charLv>=10 and charLv<=29 then
			SetChaAttrI( role , ATTR_CEXP , dif_exp_three )
	elseif charLv>=30 and charLv<=59 then
			SetChaAttrI( role , ATTR_CEXP , dif_exp_one )
	elseif charLv>=60 and charLv<=75 then
			SetChaAttrI( role , ATTR_CEXP , dif_exp_half )
	elseif charLv>=76 and charLv<=85 and charLv~=79  then
			SetChaAttrI( role , ATTR_CEXP , dif_exp_thalf )
	elseif charLv==79 and dif_exp_thalf_b<=0 then
			SetChaAttrI( role , ATTR_CEXP , dif_exp_thalf )
	elseif charLv==79 and dif_exp_thalf_b>0 then 
			dif_exp_thalf = dif_exp_thalf_b*0.02 + DEXP[charLv+1]
			SetChaAttrI( role , ATTR_CEXP , dif_exp_thalf )
	elseif charLv>=86 then
		SetChaAttrI( role , ATTR_CEXP , dif_exp_thalf_c )-------------
		--SystemNotice( role , "86级以上角色使用加1%%经验值" )--------------
	end
end
------------------------------------怪物召唤券--双击获得四个召唤券
function ItemUse_GWZHQ ( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <=3 then
		CALCULATE_ITEMEFFECT_LUA_000255 = GetResString("CALCULATE_ITEMEFFECT_LUA_000255")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000255)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 2888  , 1 , 4) 
	GiveItem ( role , 0 , 2889  , 1 , 4)
	GiveItem ( role , 0 , 2890  , 1 , 4)
	GiveItem ( role , 0 , 2891  , 1 , 4)
end
---------------------------------火鸡召唤券--双击召唤火鸡宠物
function ItemUse_HJZHQ ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000256 = GetResString("CALCULATE_ITEMEFFECT_LUA_000256")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000256 )
		UseItemFailed ( role )
		return
	end
	local pet_num = GetPetNum(role)
	if pet_num >= 5 then
		CALCULATE_ITEMEFFECT_LUA_000257 = GetResString("CALCULATE_ITEMEFFECT_LUA_000257")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000257 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	x_resume = 5
	y_resume = 5
	x = x + x_resume
	y = y + y_resume
	local MonsterID =930     -------------------没毛火鸡
	local Refresh = 1800					--重生时间，秒单位
	local life = 1800000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaHost(new,role)
	SetChaLifeTime( new, life )
	SetChaTarget(new, role)
	PlayEffect( new, 361 )
end

------------------------------麋鹿召唤券--双击召唤麋鹿

function ItemUse_MLZHQ ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000256 = GetResString("CALCULATE_ITEMEFFECT_LUA_000256")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000256 )
		UseItemFailed ( role )
		return
	end
	local pet_num = GetPetNum(role)
	if pet_num >= 5 then
		CALCULATE_ITEMEFFECT_LUA_000257 = GetResString("CALCULATE_ITEMEFFECT_LUA_000257")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000257 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	x_resume = 5
	y_resume = 5
	x = x + x_resume
	y = y + y_resume
	local MonsterID =931-----------------------麋鹿
	local Refresh = 3600					--重生时间，秒单位
	local life = 3600000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaHost(new,role)
	SetChaLifeTime( new, life )
	SetChaTarget(new, role)
	PlayEffect( new, 361 )
end
-----------------------------------雪人召唤券--双击召唤雪人
function ItemUse_XRZHQ ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000256 = GetResString("CALCULATE_ITEMEFFECT_LUA_000256")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000256 )
		UseItemFailed ( role )
		return
	end
	local pet_num = GetPetNum(role)
	if pet_num >= 5 then
		CALCULATE_ITEMEFFECT_LUA_000257 = GetResString("CALCULATE_ITEMEFFECT_LUA_000257")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000257 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	x_resume = 5
	y_resume = 5
	x = x + x_resume
	y = y + y_resume
	local MonsterID =932-----------------------------圣诞老人
	local Refresh = 7200					--重生时间，秒单位
	local life = 7200000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaHost(new,role)
	SetChaLifeTime( new, life )
	SetChaTarget(new, role)
	PlayEffect( new, 361 )
end

--------------------------------------------------圣诞老人召唤券--双击召唤圣诞老人

function ItemUse_SDZHQ ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000256 = GetResString("CALCULATE_ITEMEFFECT_LUA_000256")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000256 )
		UseItemFailed ( role )
		return
	end
	local pet_num = GetPetNum(role)
	if pet_num >= 5 then
		CALCULATE_ITEMEFFECT_LUA_000257 = GetResString("CALCULATE_ITEMEFFECT_LUA_000257")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000257 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	x_resume = 5
	y_resume = 5
	x = x + x_resume
	y = y + y_resume
	local MonsterID =929-----------------------------圣诞老人
	local Refresh = 10800					--重生时间，秒单位
	local life = 10800000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaHost(new,role)
	SetChaLifeTime( new, life )
	SetChaTarget(new, role)
	PlayEffect( new, 361 )
end
---------------------------------------------圣诞大礼包--双击获得一系列道具
function ItemUse_SDDLB ( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <=5 then
		CALCULATE_ITEMEFFECT_LUA_000258 = GetResString("CALCULATE_ITEMEFFECT_LUA_000258")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000258)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 2894  , 1 , 4) 
	GiveItem ( role , 0 , 2893  , 10 , 4) 
	GiveItem ( role , 0 , 2889  , 1 , 4) 
	GiveItem ( role , 0 , 2890 , 1 , 4) 
	GiveItem ( role , 0 , 2891  , 1 , 4) 
	GiveItem ( role , 0 , 2896  , 99 , 4) 
end


--------------------------------------------------------台湾机票1
function TW_Ticket_Script1(role, Item )

	local i = CheckBagItem(role,2446)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断

	if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,2446,1)
			if j == 1 then
				GoTo( role,  2816, 3255, "darkblue")
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end
--------------------------------------------------------台湾机票2
function TW_Ticket_Script2(role, Item )

	local i = CheckBagItem(role,2447)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )
	if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,2447,1)
			if j == 1 then
				GoTo( role,  609 , 624 , "jialebi")
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

--------------------------------------------------------台湾机票3
function TW_Ticket_Script3(role, Item )

	local i = CheckBagItem(role,2491)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )
	if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,2491,1)
			if j == 1 then
				GoTo( role,  1080 , 210 , "jialebi" )
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

--精美的圣诞礼盒
function ItemUse_JMSDBOX ( role , Item )

	local Item_ID = {}
	local Item_Num = {}
	local Item_PZ = {}
	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
		
	if Item_CanGet < 3 then
		CALCULATE_ITEMEFFECT_LUA_000047 = GetResString("CALCULATE_ITEMEFFECT_LUA_000047")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000047)
		UseItemFailed ( role )
		return
	end
	local role_type = GetChaTypeID ( role )
	local a = math.random ( 1, 100000)
	if a >= 0 and a <= 25000 then
		Item_ID[1] = 2872
		Item_Num[1] = 5
		Item_PZ[1] = 4
	elseif a >= 25001 and a <= 50000 then
		Item_ID[1] = 2873
		Item_Num [1]= 5
		Item_PZ[1] = 4
	elseif a >= 50001 and a <= 55000 then
		if role_type == 1 then
			Item_ID[1] = 5264
			Item_ID[2] = 5265
			Item_ID[3] = 5266
			Item_Num[1] = 1
			Item_Num[2] = 1
			Item_Num[3] = 1
			Item_PZ[1] = 4
			Item_PZ[2] = 4
			Item_PZ[3] = 4
		elseif role_type == 2 then
			Item_ID[1] = 5267
			Item_ID[2] = 5268
			Item_ID[3] = 5269
			Item_Num[1] = 1
			Item_Num[2] = 1
			Item_Num[3] = 1
			Item_PZ[1] = 4
			Item_PZ[2] = 4
			Item_PZ[3] = 4
		elseif role_type == 3 then
			Item_ID[1] = 5270
			Item_ID[2] = 5271
			Item_ID[3] = 5272
			Item_Num[1] = 1
			Item_Num[2] = 1
			Item_Num[3] = 1
			Item_PZ[1] = 4
			Item_PZ[2] = 4
			Item_PZ[3] = 4
		elseif role_type == 4 then
			Item_ID[1] = 5273
			Item_ID[2] = 5274
			Item_ID[3] = 5275
			Item_Num[1] = 1
			Item_Num[2] = 1
			Item_Num[3] = 1
			Item_PZ[1] = 4
			Item_PZ[2] = 4
			Item_PZ[3] = 4
		end
	elseif a >= 55001 and a <= 65000 then
			Item_ID[1] = 2891
			Item_Num[1] = 2
			Item_PZ[1] = 4
	elseif a >= 65001 and a <= 75000 then
			Item_ID[1] = 2888
			Item_Num[1] = 2
			Item_PZ[1] = 4
	elseif a >= 75001 and a <= 85000 then
			Item_ID[1] = 2889
			Item_Num[1] = 2
			Item_PZ[1] = 4
	elseif a >= 85001 and a <= 95000 then
			Item_ID[1] = 2890
			Item_Num[1] = 2
			Item_PZ[1] = 4
	elseif a >= 95001 and a <= 99992 then
			Item_ID[1] = 6294
			Item_Num[1] = 1
			Item_PZ[1] = 4
	else 
			Item_ID[1] = 2899
			Item_Num[1] = 1
			Item_PZ[1] = 4			
	end
	for i = 1, 3, 1 do
		if Item_ID[i] ~= nil and Item_Num[i] ~= nil and Item_PZ[i] ~= nil then
			GiveItem ( role , 0 , Item_ID[i] , Item_Num[i] , Item_PZ[i] )
		end
	end
	
	-- local item_type = BoxXiang_BaoZhaBOX
	-- local item_type_rad = BoxXiang_BaoZhaBOX_Rad
	-- local item_type_count = BoxXiang_BaoZhaBOX_Count
	-- local maxitem = BoxXiang_baozhabao_Mxcount						-- 终结编号
	-- local item_quality = BoxXiang_baozhabao_Qua
	-- local General = 0  
	-- local ItemId = 0 
	-- local Item_CanGet = GetChaFreeBagGridNum ( role )
		
	-- if Item_CanGet <= 0 then
		-- SystemNotice(role ,"身上没有足够的空间，精美的圣诞礼盒开启失败")
		-- UseItemFailed ( role )
		-- return
	-- end
	-- for i = 1 , maxitem , 1 do 
		-- General = item_type_rad [ i ] + General		
	-- end 
	-- local a = math.random ( 1, General )
	-- local b = 0
	-- local d = 0 
	-- local c = -1							--命中物品编号
	-- for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号
		-- d = item_type_rad [ k ] + b

		 -- if a <= d and a > b then
			-- c = k
			-- break		
		-- end 
		-- b = d 
	-- end 
	-- if c == -1 then 
		-- ItemId = 3124 
	-- else 
		-- ItemId = item_type [c]  
		-- ItemCount = item_type_count [c] 
	-- end 

	-- GiveItem ( role , 0 , ItemId , ItemCount , item_quality )
	-- local GoodItem = {}
	-- GoodItem[0] = 3111
	-- GoodItem[1] = 3110
	-- GoodItem[2] = 3112
	-- GoodItem[3] = 3886
	-- GoodItem[4] = 3093
	-- GoodItem[5] = 3090
	-- GoodItem[6] = 430
	-- GoodItem[7] = 179
	-- GoodItem[8] =3084
	-- GoodItem[9] =3085
	-- GoodItem[10] =0244
	-- GoodItem[11] =0250
	-- GoodItem[12] =0253
	-- GoodItem[13] =0260
	-- GoodItem[14] =0860
	-- GoodItem[15] =0861
	-- GoodItem[16] =0862
	-- GoodItem[17] =3458
	-- GoodItem[18] =0247
	-- GoodItem[19] =0271
	-- local Good_C = 0
	-- for Good_C = 0 , 19 , 1 do
		-- if ItemId == GoodItem[Good_C] then
			-- local itemname = GetItemName ( ItemId ) 
			-- local cha_name = GetChaDefaultName ( role ) 
			-- local message = cha_name.."打开精美的圣诞礼盒惊喜地获得"..itemname  
			-- Notice ( message )
		-- end
	-- end
end



----------------------------------------------------------------------------------新年礼炮
function ItemUse_XNLP( role , Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Now_Day = os.date("%d")
	local Now_Month = os.date("%m")
	local Now_Time = os.date("%H")
	local NowTimeNum = tonumber(Now_Time)
	local NowDayNum = tonumber(Now_Day)
	local NowMonthNum = tonumber(Now_Month)
	local CheckDateNum = NowMonthNum * 10000 + NowDayNum * 100 + NowTimeNum
	local star = 0
	if CheckDateNum >= 10122  and CheckDateNum <= 10123 then
		ItemUse_XINBOX ( role , Item )	
	end
end
function ItemUse_XINBOX ( role , Item )

	local item_type = BoxXiang_BaoZhaBOX
	local item_type_rad = BoxXiang_BaoZhaBOX_Rad
	local item_type_count = BoxXiang_BaoZhaBOX_Count
	local maxitem = BoxXiang_baozhabao_Mxcount						-- 终结编号
	local item_quality = BoxXiang_baozhabao_Qua
	local General = 0  
	local ItemId = 0 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
		
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000259 = GetResString("CALCULATE_ITEMEFFECT_LUA_000259")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000259)
		UseItemFailed ( role )
		return
	end
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号
		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break		
		end 
		b = d 
	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 

	GiveItem ( role , 0 , ItemId , ItemCount , item_quality )
	local GoodItem = {}
	GoodItem[0] = 3111
	GoodItem[1] = 3110
	GoodItem[2] = 3112
	GoodItem[3] = 3886
	GoodItem[4] = 3093
	GoodItem[5] = 3090
	GoodItem[6] = 430
	GoodItem[7] = 179
	GoodItem[8] =3084
	GoodItem[9] =3085
	GoodItem[10] =0244
	GoodItem[11] =0250
	GoodItem[12] =0253
	GoodItem[13] =0260
	GoodItem[14] =0860
	GoodItem[15] =0861
	GoodItem[16] =0862
	GoodItem[17] =3458
	GoodItem[18] =0247
	GoodItem[19] =0271
	local Good_C = 0
	for Good_C = 0 , 19 , 1 do
		if ItemId == GoodItem[Good_C] then
			local itemname = GetItemName ( ItemId ) 
			local cha_name = GetChaDefaultName ( role ) 
			CALCULATE_ITEMEFFECT_LUA_000260 = GetResString("CALCULATE_ITEMEFFECT_LUA_000260")
			local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000260..itemname  
			Notice ( message )
		end
	end
end

-------------------新年宝箱
function ItemUse_XNBOX( role , Item )
		
	local lv = GetChaAttr(role, ATTR_LV)
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if lv < 40 then
		CALCULATE_ITEMEFFECT_LUA_000115 = GetResString("CALCULATE_ITEMEFFECT_LUA_000115")
		SystemNotice( role ,CALCULATE_ITEMEFFECT_LUA_000115)
		UseItemFailed ( role )	
	return
	end
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000261 = GetResString("CALCULATE_ITEMEFFECT_LUA_000261")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000261)
		UseItemFailed ( role )
		return
	end
	local el = math.random ( 1, 30000 )
	if  el>=29700 and el<30000 then
	GiveItem ( role , 0 , 2240  , 1 , 4 ) 
	elseif el>=28700 and el<29700 then
	GiveItem ( role , 0 , 2237  , 1 , 4 ) 
	elseif el>=25700 and el<28700 then
	GiveItem ( role , 0 , 2239  , 1 , 4 ) 
	elseif el>=15700 and el<25700 then
	GiveItem ( role , 0 , 2241  , 1 , 4 )
	else
	local EID = math.random ( 2242, 2245 )
	GiveItem ( role , 0 , EID  , 1 , 4 ) 	
	end
end

------------------------------------数字发
function ItemUse_SZF ( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000262 = GetResString("CALCULATE_ITEMEFFECT_LUA_000262")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000262)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 2306  , 1 , 4)
	local cha_name = GetChaDefaultName ( role ) 
			CALCULATE_ITEMEFFECT_LUA_000263 = GetResString("CALCULATE_ITEMEFFECT_LUA_000263")
			CALCULATE_FORGE_LUA_000186 = GetResString("CALCULATE_FORGE_LUA_000186")
			local message =CALCULATE_FORGE_LUA_000186 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000263 
			Notice ( message )
	
end
----------------------------------------------石头记
function ItemUse_ShiTouJi( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local r1,r2 =MakeItem ( role , STONE_ID  , 1 , 4 )
	local Item_newJL = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID = GetItemID ( Item_newJL )		
	if STONE_LV>8 then
		STONE_LV=8
	end
	SetItemAttr ( Item_newJL , ITEMATTR_VAL_BaoshiLV , STONE_LV )
	local cha_name = GetChaDefaultName ( role )
	LG( "star_stonebox" ,cha_name, STONE_ID , STONE_LV )
end

-------------------练习用沙包Lv1
function ItemUse_ShaBao1(role , Item)

local Cha_Boat = 0
      Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local reg = 0
	      reg =IsChaInRegion( role, 2 )
	if reg == 1 then
		CALCULATE_ITEMEFFECT_LUA_000264 = GetResString("CALCULATE_ITEMEFFECT_LUA_000264")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000264 )
		UseItemFailed ( role )
                return
	end
		local x, y = GetChaPos(role)
		local x_move=5
		local y_move=5
		x=x_move+x
		y=y_move+y
		local MonsterID = 937
                local Refresh = 1900000				        
		local life = 1800000						
		local new = CreateChaX( MonsterID , x , y , 145 , Refresh,role )
		SetChaLifeTime( new, life )
end


-------------------练习用沙包Lv2
function ItemUse_ShaBao2(role , Item)

local Cha_Boat = 0
      Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local reg = 0
	      reg =IsChaInRegion( role, 2 )
	if reg == 1 then
		CALCULATE_ITEMEFFECT_LUA_000264 = GetResString("CALCULATE_ITEMEFFECT_LUA_000264")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000264 )
		UseItemFailed ( role )
                return
	end
	        local x, y = GetChaPos(role)
		local x_move=5
		local y_move=5
		x=x_move+x
		y=y_move+y
		local MonsterID = 938
                local Refresh = 1900000				        
		local life = 1800000						
		local new = CreateChaX( MonsterID , x , y , 145 , Refresh,role )
		SetChaLifeTime( new, life )
end


-------------------练习用沙包Lv3

function ItemUse_ShaBao3(role , Item)

local Cha_Boat = 0
      Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local reg = 0
	      reg =IsChaInRegion( role, 2 )
	if reg == 1 then
		CALCULATE_ITEMEFFECT_LUA_000264 = GetResString("CALCULATE_ITEMEFFECT_LUA_000264")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000264 )
		UseItemFailed ( role )
                return
	end
	        local x, y = GetChaPos(role)
		local x_move=5
		local y_move=5
		x=x_move+x
		y=y_move+y
		local MonsterID = 939
                local Refresh = 1900000				        
		local life = 1800000						
		local new = CreateChaX( MonsterID , x , y , 145 , Refresh , role )
		SetChaLifeTime( new, life )
end


-------------------练习用沙包Lv4
function ItemUse_ShaBao4(role , Item)

local Cha_Boat = 0
      Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local reg = 0
	      reg =IsChaInRegion( role, 2 )
	if reg == 1 then
		CALCULATE_ITEMEFFECT_LUA_000264 = GetResString("CALCULATE_ITEMEFFECT_LUA_000264")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000264 )
		UseItemFailed ( role )
                return
	end
		local x, y = GetChaPos(role)
		local x_move=5
		local y_move=5
		x=x_move+x
		y=y_move+y
		local MonsterID = 940
                local Refresh = 1900000				        
		local life = 1800000						
		local new = CreateChaX( MonsterID , x , y , 145 , Refresh,role )
		SetChaLifeTime( new, life )
end


-------------------练习用沙包Lv5
function ItemUse_ShaBao5(role , Item)

local Cha_Boat = 0
      Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local reg = 0
	      reg =IsChaInRegion( role, 2 )
	if reg == 1 then
		CALCULATE_ITEMEFFECT_LUA_000264 = GetResString("CALCULATE_ITEMEFFECT_LUA_000264")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000264 )
		UseItemFailed ( role )
                return
	end
		local x, y = GetChaPos(role)
		local x_move=5
		local y_move=5
		x=x_move+x
		y=y_move+y
		local MonsterID = 941
                local Refresh = 1900000				        
		local life = 1800000						
		local new = CreateChaX( MonsterID , x , y , 145 , Refresh,role )
		SetChaLifeTime( new, life )
end

------------------邪恶发生器Lv1
function ItemUse_FaSheng1(role,Item)

local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
        local reg = 0
	      reg =IsChaInRegion( role, 2 )
	if reg == 1 then
	      CALCULATE_ITEMEFFECT_LUA_000265 = GetResString("CALCULATE_ITEMEFFECT_LUA_000265")
	      SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000265 )
	      UseItemFailed ( role )
	return
	end
	local radID = math.random ( 1,8 )
	local MonsterID = 0
--	local Monster_GetID = {}
--		Monster_GetID[1] = 841
--		Monster_GetID[2] = 842
--		Monster_GetID[3] = 843
--		Monster_GetID[4] = 844
--		Monster_GetID[5] = 845
--		Monster_GetID[6] = 846
--		Monster_GetID[7] = 229
--		Monster_GetID[8] = 274
--        

	  if radID == 1   then
	       MonsterID = 841
	       
	  elseif radID == 2 then
	       MonsterID = 842
	           
	  elseif radID == 3 then
	       MonsterID = 843

	  elseif radID == 4 then
	       MonsterID = 843

	  elseif radID == 5 then
	       MonsterID = 845
	  elseif radID == 6 then
	       MonsterID = 846
	  elseif radID == 7 then
	       MonsterID = 229
	  elseif radID == 8 then
	       MonsterID = 274

	  end
		
		local x, y = GetChaPos(role)
		local x_move=5
		local y_move=5
		x=x_move+x
		y=y_move+y
                local Refresh = 3700000			                --重生时间，秒单位
		local life =  3600000					--生命时间，毫秒单位
		local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
		SetChaLifeTime( new, life )
end
------------------邪恶发生器Lv2

function ItemUse_FaSheng2(role,Item)

local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
        local reg = 0
	      reg =IsChaInRegion( role, 2 )
	if reg == 1 then	
	      CALCULATE_ITEMEFFECT_LUA_000265 = GetResString("CALCULATE_ITEMEFFECT_LUA_000265")
	      SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000265 )
	      UseItemFailed ( role )
	return
	end
	local radID = math.random ( 1,15 )
	local MonsterID = 0
--	local Monster_GetID = {}
--
--                Monster_GetID[1] = 847      
--		Monster_GetID[2] = 848
--		Monster_GetID[3] = 849
--		Monster_GetID[4] = 850
--		Monster_GetID[5] = 851
--		Monster_GetID[6] = 852
--		Monster_GetID[7] = 211
--		Monster_GetID[8] = 706
--		Monster_GetID[9] = 673
--		Monster_GetID[10] = 690
--		Monster_GetID[11] = 691
--		Monster_GetID[12] = 692
--		Monster_GetID[13] = 693
--		Monster_GetID[14] = 106
--		Monster_GetID[15] = 289

		local x, y = GetChaPos(role)
		local x_move=5
		local y_move=5
		x=x_move+x
		y=y_move+y
	  if radID == 1 then
	      MonsterID = 847
	  elseif radID == 2 then
	      MonsterID = 848
	  elseif radID == 3 then 
	      MonsterID = 849
	  elseif radID == 4 then 
	      MonsterID = 850
          elseif radID == 5 then
	      MonsterID = 851
	    elseif radID == 6 then
	      MonsterID = 852
	    elseif radID == 7 then
	      MonsterID = 211
	    elseif radID == 8 then
	      MonsterID = 706
	    elseif radID == 9 then
	      MonsterID = 673
	    elseif radID == 10 then
	      MonsterID = 690
	    elseif radID == 11 then
	      MonsterID = 691
	    elseif radID == 12 then
	      MonsterID = 692
	    elseif radID == 13 then
	      MonsterID = 693
	    elseif radID == 14 then
	      MonsterID = 106
	    elseif radID == 15 then
	      MonsterID = 289
	  end
		local Refresh = 3700000				        --重生时间，秒单位
		local life = 3600000					--生命时间，毫秒单位
		local new = CreateChaX( MonsterID , x , y , 145 , Refresh,role )
		SetChaLifeTime( new, life )
end
------------------邪恶发生器Lv3
function ItemUse_FaSheng3(role,Item)

local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
        local reg = 0
	      reg =IsChaInRegion( role, 2 )
	if reg == 1 then	
	      CALCULATE_ITEMEFFECT_LUA_000265 = GetResString("CALCULATE_ITEMEFFECT_LUA_000265")
	      SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000265 )
	      UseItemFailed ( role )
	return
	end
	local radID = math.random ( 1,7 )
	local MonsterID = 0
--	local Monster_GetID = {}
--		Monster_GetID[1] = 757
--		Monster_GetID[2] = 679
--		Monster_GetID[3] = 678
--		Monster_GetID[4] = 707
--		Monster_GetID[5] = 708
--		Monster_GetID[6] = 776
--		Monster_GetID[7] = 74
		 
                local x, y = GetChaPos(role)
		local x_move=5
		local y_move=5
		x=x_move+x
		y=y_move+y
	  if radID == 1 then
	       MonsterID = 757       
	  elseif radID == 2 then
	       MonsterID = 679                          
	  elseif radID == 3 then                    
	       MonsterID = 678                           
	  elseif radID == 4 then                    
	       MonsterID = 707      
	  elseif radID == 5 then
	       MonsterID = 708                          
          elseif radID == 6 then
	       MonsterID = 776                           
          elseif radID == 7 then
	       MonsterID = 74   
	  end
		local Refresh = 7300000				        --重生时间，秒单位
		local life = 7200000     				--生命时间，毫秒单位
		local new = CreateChaX( MonsterID , x , y , 145 , Refresh,role )
		SetChaLifeTime( new, life )
end
------------------邪恶发生器Lv4
function ItemUse_FaSheng4(role,Item)

local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
        local reg = 0
	      reg =IsChaInRegion( role, 2 )
	if reg == 1 then	
	      CALCULATE_ITEMEFFECT_LUA_000265 = GetResString("CALCULATE_ITEMEFFECT_LUA_000265")
	      SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000265 )
	      UseItemFailed ( role )
	return
	end
	local radID = math.random ( 1,5 )
	local MonsterID = 0
	local Refresh = 0
	local life = 0
--	local Monster_GetID = {}
--		Monster_GetID[1] = 952
--		Monster_GetID[2] = 805
--		Monster_GetID[3] = 807
--		Monster_GetID[4] = 786
--		Monster_GetID[5] = 788
--		
                local x, y = GetChaPos(role)
		local x_move=5
		local y_move=5
		x=x_move+x
		y=y_move+y
	  if radID == 1 then
	      MonsterID = 952        
	  elseif radID == 2 then
	      MonsterID = 805                          
	  elseif radID == 3 then                    
	      MonsterID = 807                           
	  elseif radID == 4 then                    
	      MonsterID = 786      
	  elseif radID == 5 then
	      MonsterID = 788                           
	  end
	       
	       if MonsterID == 952 then 
	          Refresh = 10900000
	          life = 10800000
	       else
		  Refresh = 7300000     			        --重生时间，秒单位
		  life = 7200000					--生命时间，毫秒单位
	       end
	          local new = CreateChaX( MonsterID , x , y , 145 , Refresh ,role)
		SetChaLifeTime( new, life )
end

--------------------邪恶发生器Lv5
--function ItemUse_FaSheng5(role,Item)
--local Cha_Boat = 0
--	Cha_Boat = GetCtrlBoat ( role )
--	if Cha_Boat ~=  nil then
--		SystemNotice( role , "出海时不可使用" )
--		UseItemFailed ( role )
--		return
--	end
--        local reg = 0
--	      reg =IsChaInRegion( role, 2 )
--	if reg == 1 then	
--	      SystemNotice( role , "想在安全区召唤强悍的怪物？做人要厚道！" )
--	      UseItemFailed ( role )
--	return
--	end
--	local radID = math.random ( 1,30 )
--	local MonsterID = 0
--	local Refresh = 0
--	local life = 0
--	local Monster_GetID = {}
--		Monster_GetID[1] = 229 
--		Monster_GetID[2] = 211
--		Monster_GetID[3] = 99
--		Monster_GetID[4] = 673
--		Monster_GetID[5] = 786
--		Monster_GetID[6] = 757
--		Monster_GetID[7] = 263
--		Monster_GetID[8] = math.random ( 678 , 679 )
--                Monster_GetID[9] = math.random ( 841 , 852 )
--		Monster_GetID[10] = math.random ( 690 , 693 )
--		Monster_GetID[11] = math.random ( 706, 708 )
--		Monster_GetID[12] = 952
--		Monster_GetID[13] = 805
--		Monster_GetID[14] = 807
--		
--                local x, y = GetChaPos(role)
--		local x_move=5
--		local y_move=5
--		x=x_move+x
--		y=y_move+y
--	  if radID == 1 or  radID ==2 then
--	      MonsterID = Monster_GetID[8]        ----------5%
--	  elseif radID == 3 or  radID ==4 then
--	      MonsterID = 786                          
--	  elseif radID == 5 or  radID ==6 then                    
--	      MonsterID = 673                           
--	  elseif radID == 7 or  radID ==8 then                    
--	      MonsterID = 757      
--	  elseif radID == 9 or  radID ==10 then
--	      MonsterID = 263                           ----------10%
--          elseif radID == 11 or  radID ==12 then
--	      MonsterID = 211                           
--          elseif radID == 13 or  radID ==14 then
--	      MonsterID = 99
--	  elseif radID == 15 or  radID ==16 then
--	      MonsterID = 229
--	  elseif radID == 17 or  radID ==18 or  radID ==19 then            ----------15%
--              MonsterID = Monster_GetID[9]
--	  elseif radID == 20 or  radID ==21 then
--	      MonsterID = Monster_GetID[10]
--          elseif radID == 22 or radID ==23 or radID ==24 then
--	      MonsterID = Monster_GetID[11]
--	  elseif radID == 25 or  radID ==26 then
--	      MonsterID = Monster_GetID[12]
--	  elseif radID == 27 or  radID ==28 then
--	      MonsterID = Monster_GetID[13]
--          elseif radID == 29 or  radID ==30 then
--	      MonsterID = Monster_GetID[14]
--	  end
--	       
--	       if MonsterID == Monster_GetID[12] then 
--	          Refresh = 10900000
--	          life = 10800000
--	       else
--		  Refresh = 7300000     			        --重生时间，秒单位
--		  life = 7200000					--生命时间，毫秒单位
--	       end
--	          local new = CreateChaX( MonsterID , x , y , 145 , Refresh ,role)
--		SetChaLifeTime( new, life )
--end

--水雷LV1-----------------------------------------------------------

function ItemUse_SL1 ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ==  nil then
		CALCULATE_ITEMEFFECT_LUA_000266 = GetResString("CALCULATE_ITEMEFFECT_LUA_000266")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000266 )
		UseItemFailed ( role )
		return
	end
	local reg = 0
	      reg =IsChaInRegion( role, 2 )
	if reg == 1 then
		CALCULATE_ITEMEFFECT_LUA_000024 = GetResString("CALCULATE_ITEMEFFECT_LUA_000024")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000024 )
		UseItemFailed ( role )
                return
	end
	local x,y = GetChaPos(Cha_Boat)
	local x_move=0
	local y_move=0
        local fx_move = math.random ( 1,8 )
	   if  fx_move == 1 then
	       x_move = 1200
	       y_move = 0
	 elseif fx_move == 2 then
	       x_move=1200
	       y_move=-1200
	 elseif fx_move == 3 then
	       x_move=0
	       y_move=-1000
	 elseif fx_move == 4 then
	       x_move=-1000
	       y_move=-1000
	 elseif fx_move == 5 then
	       x_move=1000
	       y_move=0
	 elseif fx_move == 6 then
	       x_move=-1000
	       y_move=1000
	 elseif fx_move == 7 then
	       x_move=0
	       y_move=1000
	 else  x_move=1000
	       y_move=1000
	 end
	      x =x_move + x
	      y =y_move + y

	local MonsterID = 942
	local Refresh = 700000					--重生时间，秒单位
	local life = 600000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh,Cha_Boat )
	SetChaLifeTime( new, life )
end
--水雷LV2-----------------------------------------------------------

function ItemUse_SL2 ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ==  nil then
		CALCULATE_ITEMEFFECT_LUA_000266 = GetResString("CALCULATE_ITEMEFFECT_LUA_000266")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000266 )
		UseItemFailed ( role )
		return
	end
	local reg = 0
	      reg =IsChaInRegion( role, 2 )
	if reg == 1 then
		CALCULATE_ITEMEFFECT_LUA_000024 = GetResString("CALCULATE_ITEMEFFECT_LUA_000024")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000024 )
		UseItemFailed ( role )
                return
	end
	local x,y = GetChaPos(Cha_Boat)
	local x_move=0
	local y_move=0
        local fx_move = math.random ( 1,8 )
	   if  fx_move == 1 then
	       x_move = 1200
	       y_move = 0
	 elseif fx_move == 2 then
	       x_move=1200
	       y_move=-1200
	 elseif fx_move == 3 then
	       x_move=0
	       y_move=-1000
	 elseif fx_move == 4 then
	       x_move=-1000
	       y_move=-1000
	 elseif fx_move == 5 then
	       x_move=1000
	       y_move=0
	 elseif fx_move == 6 then
	       x_move=-1000
	       y_move=1000
	 elseif fx_move == 7 then
	       x_move=0
	       y_move=1000
	 else  x_move=1000
	       y_move=1000
	 end
	      x =x_move + x
	      y =y_move + y
	local MonsterID = 943
	local Refresh = 700000					--重生时间，秒单位
	local life = 600000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh,Cha_Boat )
	SetChaLifeTime( new, life )
end
--水雷LV3-----------------------------------------------------------

function ItemUse_SL3 ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ==  nil then
		CALCULATE_ITEMEFFECT_LUA_000266 = GetResString("CALCULATE_ITEMEFFECT_LUA_000266")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000266 )
		UseItemFailed ( role )
		return
	end
	local reg = 0
	      reg =IsChaInRegion( role, 2 )
	if reg == 1 then
		CALCULATE_ITEMEFFECT_LUA_000024 = GetResString("CALCULATE_ITEMEFFECT_LUA_000024")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000024 )
		UseItemFailed ( role )
                return
	end
	local x,y = GetChaPos(Cha_Boat)
	local x_move=0
	local y_move=0
        local fx_move = math.random ( 1,8 )
	   if  fx_move == 1 then
	       x_move = 1200
	       y_move = 0
	 elseif fx_move == 2 then
	       x_move=1200
	       y_move=-1200
	 elseif fx_move == 3 then
	       x_move=0
	       y_move=-1000
	 elseif fx_move == 4 then
	       x_move=-1000
	       y_move=-1000
	 elseif fx_move == 5 then
	       x_move=1000
	       y_move=0
	 elseif fx_move == 6 then
	       x_move=-1000
	       y_move=1000
	 elseif fx_move == 7 then
	       x_move=0
	       y_move=1000
	 else  x_move=1000
	       y_move=1000
	 end
	      x =x_move + x
	      y =y_move + y
	local MonsterID = 944
	local Refresh = 700000					--重生时间，秒单位
	local life = 600000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh,Cha_Boat )
	SetChaLifeTime( new, life )
end
--水雷LV4-----------------------------------------------------------

function ItemUse_SL4 ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ==  nil then
		CALCULATE_ITEMEFFECT_LUA_000266 = GetResString("CALCULATE_ITEMEFFECT_LUA_000266")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000266 )
		UseItemFailed ( role )
		return
	end
	local reg = 0
	      reg =IsChaInRegion( role, 2 )
	if reg == 1 then
		CALCULATE_ITEMEFFECT_LUA_000024 = GetResString("CALCULATE_ITEMEFFECT_LUA_000024")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000024 )
		UseItemFailed ( role )
                return
	end
	local x,y = GetChaPos(Cha_Boat)
	local x_move=0
	local y_move=0
        local fx_move = math.random ( 1,8 )
	   if  fx_move == 1 then
	       x_move = 1200
	       y_move = 0
	 elseif fx_move == 2 then
	       x_move=1200
	       y_move=-1200
	 elseif fx_move == 3 then
	       x_move=0
	       y_move=-1000
	 elseif fx_move == 4 then
	       x_move=-1000
	       y_move=-1000
	 elseif fx_move == 5 then
	       x_move=1000
	       y_move=0
	 elseif fx_move == 6 then
	       x_move=-1000
	       y_move=1000
	 elseif fx_move == 7 then
	       x_move=0
	       y_move=1000
	 else  x_move=1000
	       y_move=1000
	 end
	      x =x_move + x
	      y =y_move + y

	local MonsterID = 945
	local Refresh = 700000					--重生时间，秒单位
	local life = 600000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh,Cha_Boat )
	SetChaLifeTime( new, life )
end
--水雷LV5-----------------------------------------------------------

function ItemUse_SL5 ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ==  nil then
		CALCULATE_ITEMEFFECT_LUA_000266 = GetResString("CALCULATE_ITEMEFFECT_LUA_000266")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000266 )
		UseItemFailed ( role )
		return
	end
	local reg = 0
	      reg =IsChaInRegion( role, 2 )
	if reg == 1 then
		CALCULATE_ITEMEFFECT_LUA_000024 = GetResString("CALCULATE_ITEMEFFECT_LUA_000024")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000024 )
		UseItemFailed ( role )
                return
	end
	local x,y = GetChaPos(Cha_Boat)
	local x_move=0
	local y_move=0
        local fx_move = math.random ( 1,8 )
	   if  fx_move == 1 then
	       x_move = 1200
	       y_move = 0
	 elseif fx_move == 2 then
	       x_move=1200
	       y_move=-1200
	 elseif fx_move == 3 then
	       x_move=0
	       y_move=-1000
	 elseif fx_move == 4 then
	       x_move=-1000
	       y_move=-1000
	 elseif fx_move == 5 then
	       x_move=1000
	       y_move=0
	 elseif fx_move == 6 then
	       x_move=-1000
	       y_move=1000
	 elseif fx_move == 7 then
	       x_move=0
	       y_move=1000
	 else  x_move=1000
	       y_move=1000
	 end
	      x =x_move + x
	      y =y_move + y

	local MonsterID = 946
	local Refresh = 700000					--重生时间，秒单位
	local life = 600000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh,Cha_Boat )

	SetChaLifeTime( new, life )
end

--自爆绵羊LV1-----------------------------------------------------------

function ItemUse_ZBML1 ( role , Item  )
 
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000023 = GetResString("CALCULATE_ITEMEFFECT_LUA_000023")
		SystemNotice( Cha_Boat , CALCULATE_ITEMEFFECT_LUA_000023 )
		UseItemFailed ( Cha_Boat )
		return
	end
	local reg = 0
	      reg =IsChaInRegion( role, 2 )
	if reg == 1 then
		CALCULATE_ITEMEFFECT_LUA_000024 = GetResString("CALCULATE_ITEMEFFECT_LUA_000024")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000024 )
		UseItemFailed ( role )
                return
	end
	
	local x,y = GetChaPos(role)
	local x_move=0
	local y_move=0
        local fx_move = math.random ( 1,8 )
	   if  fx_move == 1 then
	       x_move = 800
	       y_move = 0
	 elseif fx_move == 2 then
	       x_move=800
	       y_move=-800
	 elseif fx_move == 3 then
	       x_move=0
	       y_move=-800
	 elseif fx_move == 4 then
	       x_move=-800
	       y_move=-800
	 elseif fx_move == 5 then
	       x_move=800
	       y_move=0
	 elseif fx_move == 6 then
	       x_move=-800
	       y_move=800
	 elseif fx_move == 7 then
	       x_move=0
	       y_move=800
	 else  x_move=800
	       y_move=800
	 end
	      x =x_move + x
	      y =y_move + y
	local MonsterID = 947
	local Refresh = 700000					--重生时间，秒单位
	local life = 600000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh,role )
	SetChaLifeTime( new, life )
end
--自爆绵羊LV2-----------------------------------------------------------

function ItemUse_ZBML2 ( role , Item  )
 
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000023 = GetResString("CALCULATE_ITEMEFFECT_LUA_000023")
		SystemNotice( Cha_Boat , CALCULATE_ITEMEFFECT_LUA_000023 )
		UseItemFailed ( Cha_Boat )
		return
	end
	local reg = 0
	      reg =IsChaInRegion( role, 2 )
	if reg == 1 then
		CALCULATE_ITEMEFFECT_LUA_000024 = GetResString("CALCULATE_ITEMEFFECT_LUA_000024")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000024 )
		UseItemFailed ( role )
                return
	end
	
	local x,y = GetChaPos(role)
	local x_move=0
	local y_move=0
        local fx_move = math.random ( 1,8 )
	   if  fx_move == 1 then
	       x_move = 800
	       y_move = 0
	 elseif fx_move == 2 then
	       x_move=800
	       y_move=-800
	 elseif fx_move == 3 then
	       x_move=0
	       y_move=-800
	 elseif fx_move == 4 then
	       x_move=-800
	       y_move=-800
	 elseif fx_move == 5 then
	       x_move=800
	       y_move=0
	 elseif fx_move == 6 then
	       x_move=-800
	       y_move=800
	 elseif fx_move == 7 then
	       x_move=0
	       y_move=800
	 else  x_move=800
	       y_move=800
	 end
	      x =x_move + x
	      y =y_move + y
	local MonsterID = 948
	local Refresh = 700000					--重生时间，秒单位
	local life = 600000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh,role )
	SetChaLifeTime( new, life )
end
--自爆绵羊LV3-----------------------------------------------------------

function ItemUse_ZBML3 ( role , Item  )
 
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000023 = GetResString("CALCULATE_ITEMEFFECT_LUA_000023")
		SystemNotice( Cha_Boat , CALCULATE_ITEMEFFECT_LUA_000023 )
		UseItemFailed ( Cha_Boat )
		return
	end
	local reg = 0
	      reg =IsChaInRegion( role, 2 )
	if reg == 1 then
		CALCULATE_ITEMEFFECT_LUA_000024 = GetResString("CALCULATE_ITEMEFFECT_LUA_000024")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000024 )
		UseItemFailed ( role )
                return
	end
	
	local x,y = GetChaPos(role)
	local x_move=0
	local y_move=0
        local fx_move = math.random ( 1,8 )
	   if  fx_move == 1 then
	       x_move = 800
	       y_move = 0
	 elseif fx_move == 2 then
	       x_move=800
	       y_move=-800
	 elseif fx_move == 3 then
	       x_move=0
	       y_move=-800
	 elseif fx_move == 4 then
	       x_move=-800
	       y_move=-800
	 elseif fx_move == 5 then
	       x_move=800
	       y_move=0
	 elseif fx_move == 6 then
	       x_move=-800
	       y_move=800
	 elseif fx_move == 7 then
	       x_move=0
	       y_move=800
	 else  x_move=800
	       y_move=800
	 end
	      x =x_move + x
	      y =y_move + y
	local MonsterID = 949
	local Refresh = 700000					--重生时间，秒单位
	local life = 600000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh,role )
	SetChaLifeTime( new, life )
end
--自爆绵羊LV4-----------------------------------------------------------

function ItemUse_ZBML4 ( role , Item  )
 
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000023 = GetResString("CALCULATE_ITEMEFFECT_LUA_000023")
		SystemNotice( Cha_Boat , CALCULATE_ITEMEFFECT_LUA_000023 )
		UseItemFailed ( Cha_Boat )
		return
	end
	local reg = 0
	      reg =IsChaInRegion( role, 2 )
	if reg == 1 then
		CALCULATE_ITEMEFFECT_LUA_000024 = GetResString("CALCULATE_ITEMEFFECT_LUA_000024")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000024 )
		UseItemFailed ( role )
                return
	end
	
	local x,y = GetChaPos(role)
	local x_move=0
	local y_move=0
        local fx_move = math.random ( 1,8 )
	   if  fx_move == 1 then
	       x_move = 800
	       y_move = 0
	 elseif fx_move == 2 then
	       x_move=800
	       y_move=-800
	 elseif fx_move == 3 then
	       x_move=0
	       y_move=-800
	 elseif fx_move == 4 then
	       x_move=-800
	       y_move=-800
	 elseif fx_move == 5 then
	       x_move=800
	       y_move=0
	 elseif fx_move == 6 then
	       x_move=-800
	       y_move=800
	 elseif fx_move == 7 then
	       x_move=0
	       y_move=800
	 else  x_move=800
	       y_move=800
	 end
	      x =x_move + x
	      y =y_move + y
	local MonsterID = 950
	local Refresh = 700000					--重生时间，秒单位
	local life = 600000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh,role )
	SetChaLifeTime( new, life )
end
--自爆绵羊LV5-----------------------------------------------------------

function ItemUse_ZBML5 ( role , Item  )
 
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000023 = GetResString("CALCULATE_ITEMEFFECT_LUA_000023")
		SystemNotice( Cha_Boat , CALCULATE_ITEMEFFECT_LUA_000023 )
		UseItemFailed ( Cha_Boat )
		return
	end
	local reg = 0
	      reg =IsChaInRegion( role, 2 )
	if reg == 1 then
		CALCULATE_ITEMEFFECT_LUA_000024 = GetResString("CALCULATE_ITEMEFFECT_LUA_000024")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000024 )
		UseItemFailed ( role )
                return
	end
	
	local x,y = GetChaPos(role)
	local x_move=0
	local y_move=0
        local fx_move = math.random ( 1,8 )
	   if  fx_move == 1 then
	       x_move = 800
	       y_move = 0
	 elseif fx_move == 2 then
	       x_move=800
	       y_move=-800
	 elseif fx_move == 3 then
	       x_move=0
	       y_move=-800
	 elseif fx_move == 4 then
	       x_move=-800
	       y_move=-800
	 elseif fx_move == 5 then
	       x_move=800
	       y_move=0
	 elseif fx_move == 6 then
	       x_move=-800
	       y_move=800
	 elseif fx_move == 7 then
	       x_move=0
	       y_move=800
	 else  x_move=800
	       y_move=800
	 end
	      x =x_move + x
	      y =y_move + y
	local MonsterID = 951
	local Refresh = 700000					--重生时间，秒单位
	local life = 600000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh,role )
	SetChaLifeTime( new, life )
end

----------------------------------情缘宝盒
function ItemUse_LoveBox( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000267 = GetResString("CALCULATE_ITEMEFFECT_LUA_000267")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000267)
		UseItemFailed ( role )
		return
	end
	local cha_type = GetChaTypeID ( role ) 
	local count = 0
	if cha_type == 3 or cha_type == 4 then 
	       count =1
	end
	if cha_type == 1 or cha_type == 2 then
	       count =2
	end
	local el = math.random ( 1, 35 )
	if   count == 1 then
		if el==35 then
			local r1 = 0
			local r2 = 0	
			r1,r2 =MakeItem ( role , 2902  , 1 , 4 )
			local Item_girl = GetChaItem ( role , 2 , r2 )			--取女性道具指针
			local new_el=math.random ( 1, 200 )
			SetItemAttr ( Item_girl , ITEMATTR_VAL_STR , new_el )	
		else
			local el1 = math.random ( 1, 12 )
			if el1==1  then
				GiveItem ( role , 0 , 3343  , 1 , 4 ) ---------------玫瑰花
			elseif el1==2 then
				GiveItem ( role , 0 , 3077  , 1 , 4 )------------甜蜜巧克力	
			else
				local EID = math.random ( 4264, 4273 )----------10个表情
				GiveItem ( role , 0 , EID  , 1 , 4 )
			end
		end
	end
	local el2= math.random ( 1, 7 )
	if   count == 2 then
			--SystemNotice(role ,"count=="..count)
		if el2==7 then
			local r1 = 0
			local r2 = 0	
				r1,r2 =MakeItem ( role , 2903  , 1 , 4 )
			local Item_boy = GetChaItem ( role , 2 , r2 )			--取男性道具指针
			local new_el=math.random ( 1, 1000 )
			--SystemNotice(role ,"new_el=="..new_el)
			SetItemAttr( Item_boy , ITEMATTR_VAL_STR , new_el )
		else
			local el3 = math.random ( 1, 12 )
			if el3==1  then
				GiveItem ( role , 0 , 3343  , 1 , 4 ) ---------------玫瑰花
			elseif el3==2 then
				GiveItem ( role , 0 , 3077  , 1 , 4 )------------甜蜜巧克力	
			else
				local EID = math.random ( 4264, 4273 )----------10个表情
				GiveItem ( role , 0 , EID  , 1 , 4 )
			end
		end
	end
end


------------------------礼服宝箱：双击，根据角色给予道具

function ItemUse_MarryBox ( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 4 then
		SystemNotice(role ,"使用该宝箱最少需要4个空位")
		UseItemFailed ( role )
		return
	end
	local cha_type = GetChaTypeID ( role ) 
	-- if cha_type == 3  then 
	       -- GiveItem ( role , 0 , 5244  , 1 , 4 )
	       -- GiveItem ( role , 0 , 5245  , 1 , 4 )
	       -- GiveItem ( role , 0 , 5246  , 1 , 4 )
	       -- GiveItem ( role , 0 , 5247  , 1 , 4 )
	-- elseif cha_type == 4  then 
	       -- GiveItem ( role , 0 , 5252  , 1 , 4 )
	       -- GiveItem ( role , 0 , 5253  , 1 , 4 )
	       -- GiveItem ( role , 0 , 5254  , 1 , 4 )
	       -- GiveItem ( role , 0 , 5255  , 1 , 4 )
	-- elseif cha_type == 1 then 
	       -- GiveItem ( role , 0 , 5221  , 1 , 4 )
	       -- GiveItem ( role , 0 , 5222  , 1 , 4 )
	       -- GiveItem ( role , 0 , 5223  , 1 , 4 )
	-- elseif cha_type == 2 then 
	       -- GiveItem ( role , 0 , 5238  , 1 , 4 )
	       -- GiveItem ( role , 0 , 5239  , 1 , 4 )
	       -- GiveItem ( role , 0 , 5240  , 1 , 4 )
	-- end
	local getrandom = math.random ( 1, 8005 )
	if getrandom<=2000 and cha_type == 3  then 
	       GiveItem ( role , 0 , 5244  , 1 , 4 )
	       GiveItem ( role , 0 , 5245  , 1 , 4 )
	       GiveItem ( role , 0 , 5246  , 1 , 4 )
	       GiveItem ( role , 0 , 5247  , 1 , 4 )
	elseif getrandom<=2000 and cha_type == 4  then 
	       GiveItem ( role , 0 , 5252  , 1 , 4 )
	       GiveItem ( role , 0 , 5253  , 1 , 4 )
	       GiveItem ( role , 0 , 5254  , 1 , 4 )
	       GiveItem ( role , 0 , 5255  , 1 , 4 )
	elseif getrandom<=2000 and	cha_type == 1 then 
	       GiveItem ( role , 0 , 5221  , 1 , 4 )
	       GiveItem ( role , 0 , 5222  , 1 , 4 )
	       GiveItem ( role , 0 , 5223  , 1 , 4 )
	elseif getrandom<=2000 and cha_type == 2 then 
	       GiveItem ( role , 0 , 5238  , 1 , 4 )
	       GiveItem ( role , 0 , 5239  , 1 , 4 )
	       GiveItem ( role , 0 , 5240  , 1 , 4 )
	elseif getrandom>2000 and getrandom<=8000 then
	     GiveItem ( role , 0 , 3357  , 5 , 31 )
		 GiveItem ( role , 0 , 3358  , 5 , 31 )
		 GiveItem ( role , 0 , 3359  , 5 , 31 )
	else 
		 GiveItem ( role , 0 , 7056  , 3 , 41 )
	end
end
		----------------------------------佳人动情礼盒
function ItemUse_JRDQBox( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 10 then
		CALCULATE_ITEMEFFECT_LUA_000269 = GetResString("CALCULATE_ITEMEFFECT_LUA_000269")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000269)
		UseItemFailed ( role )
		return
	end
	local cha_type = GetChaTypeID ( role ) 
	 if cha_type ==1 or cha_type ==2 then
	 CALCULATE_ITEMEFFECT_LUA_000270 = GetResString("CALCULATE_ITEMEFFECT_LUA_000270")
	 SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000270)
	UseItemFailed ( role )
		return
	end 
	
	local el = math.random ( 1, 100 )
	if  el>=1 and el<=20 then
	GiveItem ( role , 0 , 3343  , 1 , 4 )----------玫瑰花
	elseif  el>=21 and el<=40 then
	GiveItem ( role , 0 , 3354  , 1 , 4 )
	GiveItem ( role , 0 , 3355  , 1 , 4 )
	GiveItem ( role , 0 , 3356  , 1 , 4 )
	GiveItem ( role , 0 , 3357  , 1 , 4 )
	GiveItem ( role , 0 , 3358  , 1 , 4 )
	GiveItem ( role , 0 , 3359  , 1 , 4 )----------心型礼花 
	elseif el>=41 and el<=45 then
	GiveItem ( role , 0 , 937  , 1 , 4 ) -----------天使之翼
	elseif el>=46 and el<=65 then
	GiveItem ( role , 0 , 4264  , 1 , 4 )
	GiveItem ( role , 0 , 4265  , 1 , 4 )
	GiveItem ( role , 0 , 4266  , 1 , 4 )
	GiveItem ( role , 0 , 4267  , 1 , 4 )
	GiveItem ( role , 0 , 4268  , 1 , 4 )
	GiveItem ( role , 0 , 4269  , 1 , 4 )
	GiveItem ( role , 0 , 4270  , 1 , 4 )
	GiveItem ( role , 0 , 4271  , 1 , 4 )
	GiveItem ( role , 0 , 4272  , 1 , 4 )
	GiveItem ( role , 0 , 4273  , 1 , 4 )---------------10个表情
	elseif el>=66 and el<=75 then
	GiveItem ( role , 0 , 3094  , 3 , 4 )------------双倍经验增幅器3个
	elseif el>=76 and el<=85 then
	GiveItem ( role , 0 , 855  , 10 , 4 ) -----------精灵硬币
	elseif el>=86 and el<87 then
	GiveItem ( role , 0 , 1012  , 1 , 4 ) -----------加纳之神1个
	elseif el>=87 and el<89 and cha_type == 3  then 
	GiveItem ( role , 0 , 5244  , 1 , 4 )
	GiveItem ( role , 0 , 5245  , 1 , 4 )
	GiveItem ( role , 0 , 5246  , 1 , 4 )
	GiveItem ( role , 0 , 5247  , 1 , 4 ) -----------新娘装
	elseif el>=89 and el<=90 and cha_type == 4 then
	GiveItem ( role , 0 , 5252  , 1 , 4 )
	GiveItem ( role , 0 , 5253  , 1 , 4 )
	GiveItem ( role , 0 , 5254  , 1 , 4 )
	GiveItem ( role , 0 , 5255  , 1 , 4 ) -----------婚娘装
	else
	local EID = math.random ( 1808, 1811 )----------发型书
	GiveItem ( role , 0 , EID  , 1 , 4 )
	end
end


----------------------------------才俊动情礼盒
function ItemUse_CJDQBox( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 10 then
		CALCULATE_ITEMEFFECT_LUA_000271 = GetResString("CALCULATE_ITEMEFFECT_LUA_000271")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000271)
		UseItemFailed ( role )
		return
	end
	local cha_type = GetChaTypeID ( role ) 
	 if cha_type ==3 or cha_type ==4 then
		CALCULATE_ITEMEFFECT_LUA_000272 = GetResString("CALCULATE_ITEMEFFECT_LUA_000272")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000272)
		UseItemFailed ( role )
		return
	end
	local el = math.random ( 1, 100 )
	if  el>=1 and el<=20 then
	GiveItem ( role , 0 , 3077  , 1 , 4 )----------甜蜜巧克力
	elseif  el>=21 and el<=40 then
	GiveItem ( role , 0 , 3354  , 1 , 4 )
	GiveItem ( role , 0 , 3355  , 1 , 4 )
	GiveItem ( role , 0 , 3356  , 1 , 4 )
	GiveItem ( role , 0 , 3357  , 1 , 4 )
	GiveItem ( role , 0 , 3358  , 1 , 4 )
	GiveItem ( role , 0 , 3359  , 1 , 4 )----------心型礼花 
	elseif el>=41 and el<=45 then
	GiveItem ( role , 0 , 0936  , 1 , 4 ) -----------蝶翼
	elseif el>=46 and el<=65 then
	GiveItem ( role , 0 , 4264  , 1 , 4 )
	GiveItem ( role , 0 , 4265  , 1 , 4 )
	GiveItem ( role , 0 , 4266  , 1 , 4 )
	GiveItem ( role , 0 , 4267  , 1 , 4 )
	GiveItem ( role , 0 , 4268  , 1 , 4 )
	GiveItem ( role , 0 , 4269  , 1 , 4 )
	GiveItem ( role , 0 , 4270  , 1 , 4 )
	GiveItem ( role , 0 , 4271  , 1 , 4 )
	GiveItem ( role , 0 , 4272  , 1 , 4 )
	GiveItem ( role , 0 , 4273  , 1 , 4 )---------------10个表情
	elseif el>=66 and el<=75 then
	GiveItem ( role , 0 , 3094  , 3 , 4 )------------双倍经验增幅器3个
	elseif el>=76 and el<=85 then
	GiveItem ( role , 0 , 855  , 10 , 4 ) -----------精灵硬币
	elseif el>=86 and el<87 then
	GiveItem ( role , 0 , 0862  , 1 , 4 ) -----------岩玉1个
	elseif el>=87 and el<89 and cha_type == 1  then 
	GiveItem ( role , 0 , 5221  , 1 , 4 )
	GiveItem ( role , 0 , 5222  , 1 , 4 )
	GiveItem ( role , 0 , 5223  , 1 , 4 ) -----------夜贵族装
	elseif el>=89 and el<=90 and cha_type == 2 then
	GiveItem ( role , 0 , 5238  , 1 , 4 )
	GiveItem ( role , 0 , 5239  , 1 , 4 )
	GiveItem ( role , 0 , 5240  , 1 , 4 )-----------黑金装
	else
	local EID = math.random ( 1808, 1811 )----------发型书
	GiveItem ( role , 0 , EID  , 1 , 4 )
	end
end
---------------------------------喜糖
function ItemUse_XTBOX ( role , Item )

	local item_type = BoxXiang_BaoZhaBOX
	local item_type_rad = BoxXiang_BaoZhaBOX_Rad
	local item_type_count = BoxXiang_BaoZhaBOX_Count
	local maxitem = BoxXiang_baozhabao_Mxcount						-- 终结编号
	local item_quality = BoxXiang_baozhabao_Qua
	local General = 0  
	local ItemId = 0 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
		
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000273 = GetResString("CALCULATE_ITEMEFFECT_LUA_000273")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000273)
		UseItemFailed ( role )
		return
	end
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号
		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k
			break		
		end 
		b = d 
	end 
	if c == -1 then 
		ItemId = 3124 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 

	GiveItem ( role , 0 , ItemId , ItemCount , item_quality )
	local GoodItem = {}
	GoodItem[0] = 3111
	GoodItem[1] = 3110
	GoodItem[2] = 3112
	GoodItem[3] = 3886
	GoodItem[4] = 3093
	GoodItem[5] = 3090
	GoodItem[6] = 430
	GoodItem[7] = 179
	GoodItem[8] =3084
	GoodItem[9] =3085
	GoodItem[10] =0244
	GoodItem[11] =0250
	GoodItem[12] =0253
	GoodItem[13] =0260
	GoodItem[14] =0860
	GoodItem[15] =0861
	GoodItem[16] =0862
	GoodItem[17] =3458
	GoodItem[18] =0247
	GoodItem[19] =0271
	local Good_C = 0
	for Good_C = 0 , 19 , 1 do
		if ItemId == GoodItem[Good_C] then
			local itemname = GetItemName ( ItemId ) 
			local cha_name = GetChaDefaultName ( role ) 
			CALCULATE_ITEMEFFECT_LUA_000274 = GetResString("CALCULATE_ITEMEFFECT_LUA_000274")
			local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000274..itemname  
			Notice ( message )
		end
	end
end

-------------------婚庆大礼盒
function ItemUse_HQBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 4 then
		CALCULATE_ITEMEFFECT_LUA_000275 = GetResString("CALCULATE_ITEMEFFECT_LUA_000275")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000275)
		UseItemFailed ( role )
		return
	end
	local el = math.random ( 1, 100 )
	if  el>=1 and el<=20 then
	GiveItem ( role , 0 , 1012  , 1 , 4 ) -------------加纳之神
	elseif el>=21 and el<=40 then
	GiveItem ( role , 0 , 1016  , 1 , 4 ) ---------------女神小包
	elseif el>=41 and el<60 then
	GiveItem ( role , 0 , 0333  , 1 , 4 ) ----------------高级宝石兑换券
	elseif el>=61 and el<=100 then
	GiveItem ( role , 0 , 0273  , 1 , 4 )-----------------一等奖	
	end
end

-----------------------------------幸运猪宝箱：岩玉、炎玉、鹰眼石、凤灵石、加纳之神、女神小包

function ItemUse_XYPIGBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000276 = GetResString("CALCULATE_ITEMEFFECT_LUA_000276")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000276)
		UseItemFailed ( role )
		return
	end
	local el = math.random ( 1, 100 )
	if  el>=1 and el<=4 then
	GiveItem ( role , 0 , 1012  , 1 , 4 ) -------------加纳之神
	elseif el==5  then
	GiveItem ( role , 0 , 1016  , 1 , 4 ) ---------------女神小包
	elseif el>=6 and el<=30 then
	GiveItem ( role , 0 , 0861  , 1 , 4 ) ----------------鹰眼石
	elseif el>=31 and el<=60 then
	GiveItem ( role , 0 , 885  , 1 , 4 )-----------------精炼石
	elseif el>=61 and el<=75 then
	GiveItem ( role , 0 , 0860  , 1 , 4 ) ---------------凤灵石
	elseif el>=76 and el<=88 then
	GiveItem ( role , 0 , 0862  , 1 , 4 ) ----------------岩玉
	elseif el>=89 and el<=100 then
	GiveItem ( role , 0 , 0863  , 1 , 4 )-----------------炎玉
	end
end


-----------------------------压岁包：压岁包只有在除夕夜（2月17日晚23:00--2月18日凌晨１点）打开才会有效
----------------------------------------------------------------------------------压岁包
function ItemUse_YSB( role , Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000277 = GetResString("CALCULATE_ITEMEFFECT_LUA_000277")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000277)
		UseItemFailed ( role )
		return
	end
	local Now_Day = os.date("%d")
	local Now_Month = os.date("%m")
	local Now_Time = os.date("%H")
	local NowTimeNum = tonumber(Now_Time)
	local NowDayNum = tonumber(Now_Day)
	local NowMonthNum = tonumber(Now_Month)
	local CheckDateNum = NowMonthNum * 10000 + NowDayNum * 100 + NowTimeNum
	local star = 0
	if CheckDateNum >= 21723  and CheckDateNum <= 21801 then
		ItemUse_YSBOX ( role , Item )
	else 
		CALCULATE_ITEMEFFECT_LUA_000278 = GetResString("CALCULATE_ITEMEFFECT_LUA_000278")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000278)
		UseItemFailed ( role )
		return
	end
end
function ItemUse_YSBOX ( role , Item )

	local el = math.random ( 1, 1000 )
	if  el>=1 and el<=5 then
		GiveItem ( role , 0 , 1012  , 1 , 4 ) -------------加纳之神        0.5
	elseif el>=6 and el<=10 then
		GiveItem ( role , 0 , 1016  , 1 , 4 ) ---------------女神小包       0.5
	elseif el>=11 and el<=20 then
		GiveItem ( role , 0 , 0860  , 1 , 4 ) ---------------风灵         1
	elseif el>=21 and el<=30 then
		GiveItem ( role , 0 , 0861  , 1 , 4 ) ----------------鹰眼石     1
	elseif el>=31 and el<40 then
		GiveItem ( role , 0 , 0862  , 1 , 4 ) ----------------岩玉       1
	elseif el>=41 and el<=50 then
		GiveItem ( role , 0 , 0863  , 1 , 4 )-----------------炎玉       1
	elseif el>=51 and el<=270 then
		GiveItem ( role , 0 , 855  , 99 , 4 )-----------------精灵硬币       22
	elseif el>=271 and el<=500 then
		GiveItem ( role , 0 , 0227  , 5 , 4 )-----------------初级精灵饲料    23
	elseif el>=501 and el<=750 then
		GiveItem ( role , 0 , 3096  , 3 , 4 )-----------------双倍掉料增幅器3个   25
	elseif el>=751 and el<=1000 then
		GiveItem ( role , 0 , 3094  , 3 , 4 )-----------------双倍经验增幅器3个   25
	end
end
function ItemUse_Hadisi( role , Item )		----------哈迪斯遗物

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 4 then
		CALCULATE_ITEMEFFECT_LUA_000279 = GetResString("CALCULATE_ITEMEFFECT_LUA_000279")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000279)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 2817  , 1 , 4 )
	GiveItem ( role , 0 , 2818  , 1 , 4 )
	GiveItem ( role , 0 , 2819  , 1 , 4 )
end
function ItemUse_Anhei( role , Item )		----------暗黑盒子

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 4 then
		CALCULATE_ITEMEFFECT_LUA_000280 = GetResString("CALCULATE_ITEMEFFECT_LUA_000280")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000280)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 2820  , 1 , 4 )
	GiveItem ( role , 0 , 2821  , 1 , 4 )
	GiveItem ( role , 0 , 2822  , 1 , 4 )
end
function ItemUse_Diyu( role , Item )		----------地狱包袱

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 4 then
		CALCULATE_ITEMEFFECT_LUA_000281 = GetResString("CALCULATE_ITEMEFFECT_LUA_000281")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000281)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 2823  , 1 , 4 )
	GiveItem ( role , 0 , 2824  , 1 , 4 )
	GiveItem ( role , 0 , 2825  , 1 , 4 )
end
function ItemUse_Xiuluo( role , Item )		----------修罗箱子

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 4 then
		CALCULATE_ITEMEFFECT_LUA_000282 = GetResString("CALCULATE_ITEMEFFECT_LUA_000282")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000282)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 2826  , 1 , 4 )
	GiveItem ( role , 0 , 2827  , 1 , 4 )
	GiveItem ( role , 0 , 2828  , 1 , 4 )
end
function ItemUse_Youming( role , Item )	----------幽冥宝藏

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 4 then
		CALCULATE_ITEMEFFECT_LUA_000283 = GetResString("CALCULATE_ITEMEFFECT_LUA_000283")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000283)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 2829  , 1 , 4 )
	GiveItem ( role , 0 , 2830  , 1 , 4 )
	GiveItem ( role , 0 , 2831  , 1 , 4 )
end
function ItemUse_Minghe( role , Item )		----------冥河小包

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 4 then
		CALCULATE_ITEMEFFECT_LUA_000284 = GetResString("CALCULATE_ITEMEFFECT_LUA_000284")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000284)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 2832  , 1 , 4 )
	GiveItem ( role , 0 , 2833  , 1 , 4 )
	GiveItem ( role , 0 , 2834  , 1 , 4 )
end
function ItemUse_Sishen( role , Item )		----------死神藏尸处

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 2 then
		CALCULATE_ITEMEFFECT_LUA_000285 = GetResString("CALCULATE_ITEMEFFECT_LUA_000285")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000285)
		UseItemFailed ( role )
		return
	end
	local job = GetChaAttr(role, ATTR_JOB)
	local lv = GetChaAttr(role, ATTR_LV) 
	local star_rad=math.random ( 1, 2 )
	if lv < 40 then
		CALCULATE_ITEMEFFECT_LUA_000115 = GetResString("CALCULATE_ITEMEFFECT_LUA_000115")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000115)
		UseItemFailed ( role )	
	elseif job == 9 then 
		if star_rad==1 then
			GiveItem ( role , 0 , 2331  , 1 , 4 ) 
		else
			GiveItem ( role , 0 , 2332  , 1 , 4 ) 
		end
	elseif job == 8 then   
		if star_rad==1 then
			GiveItem ( role , 0 , 2333  , 1 , 4 ) 
		else
			GiveItem ( role , 0 , 2334  , 1 , 4 ) 
		end
	elseif job == 12 then 
		local eleven_rad=math.random ( 1, 4 )
		if eleven_rad==1 then
			GiveItem ( role , 0 , 2337  , 1 , 4 ) 
		elseif eleven_rad==2 then
			GiveItem ( role , 0 , 2338  , 1 , 4 ) 
		elseif eleven_rad==3 then
			GiveItem ( role , 0 , 2339  , 1 , 4 ) 
		else
			GiveItem ( role , 0 , 2340  , 1 , 4 ) 
		end
	elseif job == 16 then 
		if star_rad==1 then
			GiveItem ( role , 0 , 2335  , 1 , 4 ) 
		else
			GiveItem ( role , 0 , 2336  , 1 , 4 ) 
		end
	elseif job == 13 then    
		if star_rad==1 then
			GiveItem ( role , 0 , 2341  , 1 , 4 ) 
		else
			GiveItem ( role , 0 , 2342  , 1 , 4 ) 
		end
	elseif job == 14 then    
		if star_rad==1 then
			GiveItem ( role , 0 , 2343  , 1 , 4 ) 
		else
			GiveItem ( role , 0 , 2344  , 1 , 4 ) 
		end
	else 
		CALCULATE_ITEMEFFECT_LUA_000116 = GetResString("CALCULATE_ITEMEFFECT_LUA_000116")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000116)
		UseItemFailed ( role )	
	end
end
function ItemUse_Zhenheilong( role , Item )	----------真黑龙宝箱

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 5 then
		CALCULATE_ITEMEFFECT_LUA_000286 = GetResString("CALCULATE_ITEMEFFECT_LUA_000286")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000286)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 2367  , 1 , 16 ) 
	GiveItem ( role , 0 , 2368  , 1 , 16 ) 
	GiveItem ( role , 0 , 2369  , 1 , 16 )
        local cha_type = GetChaTypeID ( role )
	if cha_type == 4 then 
		GiveItem ( role , 0 , 2370  , 1 , 16 )		
	end
end
--地狱四层机票
function Jz_Script_4thDy(role, Item )

	local i = CheckBagItem(role,2844)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )
	if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,2844,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000049 = GetResString("BIRTH_BIRTH_CONF_LUA_000049")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000049)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end
--死神的行囊A
function ItemUse_DathBagA(role, Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 2 then
		CALCULATE_ITEMEFFECT_LUA_000287 = GetResString("CALCULATE_ITEMEFFECT_LUA_000287")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000287)
		UseItemFailed ( role )
		return
	end
	local star_rad=math.random ( 1, 4 )
	if star_rad==4 then
		GiveItem ( role , 0 , 2846  , 1 , 16 ) 
	else
		GiveItem ( role , 0 , 2928  , 1 , 16 ) 
	end
end
--死神的行囊B
function ItemUse_DathBagB(role, Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 2 then
		CALCULATE_ITEMEFFECT_LUA_000287 = GetResString("CALCULATE_ITEMEFFECT_LUA_000287")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000287)
		UseItemFailed ( role )
		return
	end
	local star_rad=math.random ( 1, 4 )
	if star_rad==4 then
		GiveItem ( role , 0 , 2847  , 1 , 16 ) 
	else
		GiveItem ( role , 0 , 2929  , 1 , 16 ) 
	end
end
--死神的行囊C
function ItemUse_DathBagC(role, Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 2 then
		CALCULATE_ITEMEFFECT_LUA_000287 = GetResString("CALCULATE_ITEMEFFECT_LUA_000287")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000287)
		UseItemFailed ( role )
		return
	end
	local star_rad=math.random ( 1, 4 )
	if star_rad==4 then
		GiveItem ( role , 0 , 2848  , 1 , 16 ) 
	else
		GiveItem ( role , 0 , 2927  , 1 , 16 ) 
	end
end
--死神的行囊D
function ItemUse_DathBagD(role, Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 2 then
		CALCULATE_ITEMEFFECT_LUA_000287 = GetResString("CALCULATE_ITEMEFFECT_LUA_000287")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000287)
		UseItemFailed ( role )
		return
	end
	local star_rad=math.random ( 1, 4 )
	if star_rad==4 then
		GiveItem ( role , 0 , 2849  , 1 , 16 ) 
	else
		GiveItem ( role , 0 , 2927  , 1 , 16 ) 
	end
end
--死神的行囊E
function ItemUse_DathBagE(role, Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 2 then
		CALCULATE_ITEMEFFECT_LUA_000287 = GetResString("CALCULATE_ITEMEFFECT_LUA_000287")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000287)
		UseItemFailed ( role )
		return
	end
	local star_rad=math.random ( 1, 4 )
	if star_rad==4 then
		GiveItem ( role , 0 , 2850  , 1 , 16 ) 
	else
		GiveItem ( role , 0 , 2929  , 1 , 16 ) 
	end
end
--死神的行囊F
function ItemUse_DathBagF(role, Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 2 then
		CALCULATE_ITEMEFFECT_LUA_000287 = GetResString("CALCULATE_ITEMEFFECT_LUA_000287")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000287)
		UseItemFailed ( role )
		return
	end
	local star_rad=math.random ( 1, 4 )
	if star_rad==4 then
		GiveItem ( role , 0 , 2851  , 1 , 16 ) 
	else
		GiveItem ( role , 0 , 2931  , 1 , 16 ) 
	end
end
--死神的行囊G
function ItemUse_DathBagG(role, Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 2 then
		CALCULATE_ITEMEFFECT_LUA_000287 = GetResString("CALCULATE_ITEMEFFECT_LUA_000287")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000287)
		UseItemFailed ( role )
		return
	end
	local star_rad=math.random ( 1, 4 )
	if star_rad==4 then
		GiveItem ( role , 0 , 2852  , 1 , 16 ) 
	else
		GiveItem ( role , 0 , 2932  , 1 , 16 ) 
	end
end
--死神的行囊H
function ItemUse_DathBagH(role, Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 2 then
		CALCULATE_ITEMEFFECT_LUA_000287 = GetResString("CALCULATE_ITEMEFFECT_LUA_000287")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000287)
		UseItemFailed ( role )
		return
	end
	local star_rad=math.random ( 1, 4 )
	if star_rad==4 then
		GiveItem ( role , 0 , 2930  , 1 , 16 ) 
	else
		GiveItem ( role , 0 , 2930  , 1 , 16 ) 
	end
end
----转生卡
function ItemUse_ZSCard(role, Item )

	local i = CheckBagItem(role,2941)
	local k = ChaIsBoat(role)
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000288 = GetResString("CALCULATE_ITEMEFFECT_LUA_000288")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000288)
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,2941,1)
			if j == 1 then
				CALCULATE_ITEMEFFECT_LUA_000289 = GetResString("CALCULATE_ITEMEFFECT_LUA_000289")
				SystemNotice(role, CALCULATE_ITEMEFFECT_LUA_000289)
				GiveItem ( role , 0 , 2235 , 1 , 42)
				GoTo( role,  1750 , 909 , "jialebi")
				return
			end
		end
	else
		UseItemsFailed ( role )
	end
		
end
-----------海军海盗守护神召唤券--------------------
function ItemUse_SummonBigBOSS(role, Item )

local map_name_role = GetChaMapName ( role )
local Cha_Boat = 0
      Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000023 = GetResString("CALCULATE_ITEMEFFECT_LUA_000023")
		SystemNotice( Cha_Boat , CALCULATE_ITEMEFFECT_LUA_000023 )
		UseItemFailed ( Cha_Boat )
		return
	end
	local reg = 0
	      reg =IsChaInRegion( role, 2 )
	if reg == 1 then
		CALCULATE_ITEMEFFECT_LUA_000024 = GetResString("CALCULATE_ITEMEFFECT_LUA_000024")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000024 )
		UseItemFailed ( role )
                return
	end
   if  map_name_role == "guildwar" then
	local x,y = GetChaPos(role)
	if GetChaGuildID(role) <= 100 and GetChaGuildID(role) > 0 then
	local MonsterID = 1007
	local Refresh = 1300					--重生时间，秒单位
	local life = 1200000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh,role )
	SetChaLifeTime( new, life )
	SetChaSideID(new,1)
	end

	if GetChaGuildID(role) > 100 and GetChaGuildID(role) <= 200 then
	local MonsterID = 1008
	local Refresh = 1300					--重生时间，秒单位
	local life = 1200000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh,role )
	SetChaLifeTime( new, life )
	SetChaSideID(new,2)
	end
   elseif map_name_role == "guildwar2" then 

    local x,y = GetChaPos(role)
	if GetChaGuildID(role) <= 100 and GetChaGuildID(role) > 0 then
	local MonsterID = 1007
	local Refresh = 1300					--重生时间，秒单位
	local life = 1200000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh,role )
	SetChaLifeTime( new, life )
	SetChaSideID(new,1)
	end

	if GetChaGuildID(role) > 100 and GetChaGuildID(role) <= 200 then
	local MonsterID = 1008
	local Refresh = 1300					--重生时间，秒单位
	local life = 1200000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh,role )
	SetChaLifeTime( new, life )
	SetChaSideID(new,2)
	end
    else 
        CALCULATE_ITEMEFFECT_LUA_000290 = GetResString("CALCULATE_ITEMEFFECT_LUA_000290")
        SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000290 )
        UseItemFailed ( role )
        return
    end

end


----------------------雕像机票---------------------
function ItemUse_moveDX(role, Item)

local i = CheckBagItem(role,2986)
--local k = ChaIsBoat(role)
 local Cha_Boat = 0
       Cha_Boat = GetCtrlBoat ( role )
	 if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000023 = GetResString("CALCULATE_ITEMEFFECT_LUA_000023")
		SystemNotice( Cha_Boat , CALCULATE_ITEMEFFECT_LUA_000023 )
		UseItemFailed ( Cha_Boat )
		return
	 end
	 local reg = 0
	      reg =IsChaInRegion( role, 2 )
	 if reg == 1 then
		CALCULATE_ITEMEFFECT_LUA_000024 = GetResString("CALCULATE_ITEMEFFECT_LUA_000024")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000024 )
		UseItemFailed ( role )
                return
	 end


 if GetChaGuildID(role) == 0 then
    CALCULATE_ITEMEFFECT_LUA_000291 = GetResString("CALCULATE_ITEMEFFECT_LUA_000291")
    SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000291 )
    UseItemFailed ( role )
    return
 end

local map_name_role = GetChaMapName ( role )
if map_name_role =="guildwar" then
	 if GetChaGuildID(role) <= 100 and GetChaGuildID(role) > 0 and map_name_role =="guildwar" then
			if i > 0 then
				local j = DelBagItem(role,2986,1)
				if j == 1 then
					MoveTo( role,  305, 87,  "guildwar" )
					return
				end
			end
								 

	 elseif GetChaGuildID(role) > 100 and GetChaGuildID(role) <= 200 and map_name_role =="guildwar" then
			 if i > 0 then
				local j = DelBagItem(role,2986,1)
				if j == 1 then
					MoveTo( role,  309, 539,  "guildwar" )
					return
				end
			end
	 
	 else
			UseItemFailed ( role )
			    
	 end

elseif map_name_role =="guildwar2" then

	 if GetChaGuildID(role) <= 100 and GetChaGuildID(role) > 0 and map_name_role =="guildwar2"  then
		       if i > 0 then
				local j = DelBagItem(role,2986,1)
				if j == 1 then
					MoveTo( role,  305, 87,  "guildwar2" )
					return
				end
			end
			
	 elseif GetChaGuildID(role) > 100 and GetChaGuildID(role) <= 200 and map_name_role =="guildwar2"  then
			 if i > 0 then
				local j = DelBagItem(role,2986,1)
				if j == 1 then
					 MoveTo( role,  309, 539,  "guildwar2" )
					return
				end
			end
	 
	 else
			UseItemFailed ( role )
		
   
         end

else
        CALCULATE_ITEMEFFECT_LUA_000292 = GetResString("CALCULATE_ITEMEFFECT_LUA_000292")
        SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000292 )
        UseItemFailed ( role )
        return
   end        
end


------------------------白羊船长宝箱：双击，根据角色给予道具

function ItemUse_CZBox ( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 4 then
		CALCULATE_ITEMEFFECT_LUA_000293 = GetResString("CALCULATE_ITEMEFFECT_LUA_000293")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000293)
		UseItemFailed ( role )
		return
	end
	local cha_type = GetChaTypeID ( role ) 
	if cha_type == 3  then 
	     
	       GiveItem ( role , 0 , 5349  , 1 , 4 )
	       GiveItem ( role , 0 , 5350  , 1 , 4 )
	       GiveItem ( role , 0 , 5351  , 1 , 4 )
	elseif cha_type == 4  then 
	       GiveItem ( role , 0 , 5352  , 1 , 4 )
	       GiveItem ( role , 0 , 5353  , 1 , 4 )
	       GiveItem ( role , 0 , 5354  , 1 , 4 )
	       GiveItem ( role , 0 , 5355  , 1 , 4 )
	elseif cha_type == 1 then 
	      
	       GiveItem ( role , 0 , 5341  , 1 , 4 )
	       GiveItem ( role , 0 , 5342  , 1 , 4 )
	       GiveItem ( role , 0 , 5343  , 1 , 4 )
	elseif cha_type == 2 then 
	       
	       GiveItem ( role , 0 , 5345  , 1 , 4 )
	       GiveItem ( role , 0 , 5346  , 1 , 4 )
	       GiveItem ( role , 0 , 5347  , 1 , 4 )
	end
end


------------------------愚人节礼物----------2953----------itemeffect
function ItemUse_Foolish ( role , Item )

	local charLv=Lv ( role )
	local Cha_Boat = 0
		Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Exp_el=GetChaAttr (  role , ATTR_CEXP )----------当前等级经验
	local dif_exp_thalf_c = (DEXP[charLv+1] - DEXP[charLv])*0.03+Exp_el ----------------
		SetChaAttrI( role , ATTR_CEXP , dif_exp_thalf_c )-------------
		--SystemNotice( role , "使用愚人节的礼物加3%%经验值" )--------------
end
---------------------------召唤白羊守护者
function ItemUse_BYSHJZ ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local star = 0
	star =IsChaInRegion( role, 2 )
	if star == 1 then
		CALCULATE_ITEMEFFECT_LUA_000234 = GetResString("CALCULATE_ITEMEFFECT_LUA_000234")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000234 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	local MonsterID = 1009
	local Refresh = 3700					--重生时间，秒单位
	local life = 3600000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaLifeTime( new, life )
end

--------双剑士转职技能书
function Sk_Script_Wyz ( role , Item ) 	
										
	local sk_add = SK_WYZ 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv >= 1  then 
		UseItemFailed ( role )  
		return 
	end
	local zs_exp = GetChaAttr ( role , ATTR_CSAILEXP )
	if zs_exp <= 0 then
		UseItemFailed ( role )  
		return 
	end
	a = AddChaSkill ( role , sk_add, 1 , 1 , 0 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 

--------巨剑士转职技能书
function Sk_Script_Bsj ( role , Item ) 
											
	local sk_add = SK_BSJ 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv >= 1  then 
		UseItemFailed ( role )  
		return 
	end
	local zs_exp = GetChaAttr ( role , ATTR_CSAILEXP )
	if zs_exp <= 0 then
		UseItemFailed ( role )  
		return 
	end
	a = AddChaSkill ( role , sk_add, 1 , 1 , 0 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 

--------封印师转职技能书
function Sk_Script_Emzz ( role , Item ) 
											
	local sk_add = SK_EMZZ 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv >= 1  then 
		UseItemFailed ( role )  
		return 
	end 
	local zs_exp = GetChaAttr ( role , ATTR_CSAILEXP )
	if zs_exp <= 0 then
		UseItemFailed ( role )  
		return 
	end
	a = AddChaSkill ( role , sk_add, 1 , 1 , 0 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 
--------圣职者转职技能书
function Sk_Script_Sssp ( role , Item ) 	
										
	local sk_add = SK_SSSP 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv >= 1  then 
		UseItemFailed ( role )  
		return 
	end
	local zs_exp = GetChaAttr ( role , ATTR_CSAILEXP )
	if zs_exp <= 0 then
		UseItemFailed ( role )  
		return 
	end
	local zs_exp = GetChaAttr ( role , ATTR_CSAILEXP )
	if zs_exp <= 0 then
		UseItemFailed ( role )  
		return 
	end
	a = AddChaSkill ( role , sk_add, 1 , 1 , 0 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 

--------航海士转职技能书
function Sk_Script_Cyn ( role , Item ) 	
										
	local sk_add = SK_CYN 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv >= 1  then 
		UseItemFailed ( role )  
		return 
	end 
	local zs_exp = GetChaAttr ( role , ATTR_CSAILEXP )
	if zs_exp <= 0 then
		UseItemFailed ( role )  
		return 
	end
	a = AddChaSkill ( role , sk_add, 1 , 1 , 0 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 

--------狙击手转职技能书
function Sk_Script_Hlp ( role , Item ) 
											
	local sk_add = SK_HLP 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv >= 1  then 
		UseItemFailed ( role )  
		return 
	end 
	local zs_exp = GetChaAttr ( role , ATTR_CSAILEXP )
	if zs_exp <= 0 then
		UseItemFailed ( role )  
		return 
	end
	a = AddChaSkill ( role , sk_add, 1 , 1 , 0 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 
-------------------------品牌蛋糕
function ItemUse_NiceCake (role, Item )
	local HonorBook_Num = 0
	local HonorBook_Num = CheckBagItem( role,3849 )
		if HonorBook_Num < 1 then
		CALCULATE_FUNCTIONS_LUA_000169 = GetResString("CALCULATE_FUNCTIONS_LUA_000169")
		SystemNotice( role , CALCULATE_FUNCTIONS_LUA_000169)
		UseItemFailed ( role )
		return 0
		end
	local Book2 =  GetChaItem2 ( role , 2 , 3849 )
	local HonorPoint=GetItemAttr ( Book2 , ITEMATTR_VAL_STR)
	local el_fame = GetChaAttr(role, ATTR_FAME)
	
		if HonorPoint < 27000 and el_fame < 99990001 then
		local HonorPoint_X=HonorPoint+3000
		SetItemAttr ( Book2 , ITEMATTR_VAL_STR,HonorPoint_X)
		
		local fame_resume = 9999
		el_fame = el_fame + fame_resume
		SetCharaAttr(el_fame, role, ATTR_FAME) 

		else 
		CALCULATE_ITEMEFFECT_LUA_000294 = GetResString("CALCULATE_ITEMEFFECT_LUA_000294")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000294)
		UseItemFailed ( role )
		end
end



-------------------QQ宝箱
--function ItemUse_QQBOX( role , Item )
	
	--local cha_name = GetChaDefaultName ( role )
	--local cha_num = GetActName(role)	
	--local lv = GetChaAttr(role, ATTR_LV)
	--local Item_CanGet = GetChaFreeBagGridNum ( role )
	--if lv < 40 then
		--SystemNotice( role ,"当前级别低于40级，道具使用失败！")
		--UseItemFailed ( role )	
	--return
	--end
	
	--local BorG = 0 
	--local cha_type = GetChaTypeID ( role ) 
	--if cha_type == 1  or cha_type == 2 then 
		--BorG=1
	--elseif cha_type == 3  or cha_type == 4 then
		--BorG=2
	--end
	
	--LG( "QQ" , "玩家"..cha_name.."打开QQ宝箱", "是"..BorG.."号角色","账号是"..cha_num)
--end

----------------------------------------------嘉宾宝箱
--function ItemUse_JBBOX( role , Item )
--	local Item_CanGet = GetChaFreeBagGridNum ( role )
--	if Item_CanGet <1 then
--		SystemNotice(role ,"要打开宝箱需要背包里至少有1个空位")
--		UseItemFailed ( role )
--		return
--	end
--	local r1,r2 =MakeItem ( role , 3078  , 1 , 4 )-------请柬
--	local Item_el = GetChaItem ( role , 2 , r2 )			--取新精灵道具指针
--
--	local item_old = GetChaItem2 ( role , 2 , 3066 )---------教堂使用证书
--
--	local old_month = GetItemAttr(item_old, ITEMATTR_VAL_STA)		-------------月 	
--	local old_day = GetItemAttr(item_old, ITEMATTR_VAL_STR)			-------------日  
--	local old_hour = GetItemAttr(item_old, ITEMATTR_VAL_CON)			-------------时   
--	local old_miniute = GetItemAttr(item_old, ITEMATTR_VAL_DEX)		-------------分   
--	
--	--SystemNotice ( role , "old_month=="..old_month )
--	--SystemNotice ( role , "old_day=="..old_day )       
--	--SystemNotice ( role , "old_hour=="..old_hour )    
--	--SystemNotice ( role , "old_miniute=="..old_miniute)
--
--	SetItemAttr(Item_el, ITEMATTR_VAL_STA, old_month )	-------------月 	
--	SetItemAttr(Item_el, ITEMATTR_VAL_STR, old_day )		-------------日  
--	SetItemAttr(Item_el, ITEMATTR_VAL_CON, old_hour )		-------------时 
--	SetItemAttr(Item_el, ITEMATTR_VAL_DEX, old_miniute )	-------------分
--
--	local old_month2 = GetItemAttr(Item_el, ITEMATTR_VAL_STA)		-------------月 	
--	local old_day2 = GetItemAttr(Item_el, ITEMATTR_VAL_STR)			-------------日  
--	local old_hour2 = GetItemAttr(Item_el, ITEMATTR_VAL_CON)			-------------时   
--	local old_miniute2 = GetItemAttr(Item_el, ITEMATTR_VAL_DEX)		-------------分 
--
--	--SystemNotice ( role , "old_month2=="..old_month2 )
--	--SystemNotice ( role , "old_day2=="..old_day2 )       
--	--SystemNotice ( role , "old_hour2=="..old_hour2 )    
--	--SystemNotice ( role , "old_miniute2=="..old_miniute2)
--
--	SynChaKitbag(role,13)
--
--end
--
--
--------------------浪漫烟花
--function ItemUse_LMYH ( role , Item )
--	local Cha_Boat = GetCtrlBoat ( role )
--	if Cha_Boat ~=  nil then
--		SystemNotice( role , "出海时不可使用" )
--		UseItemFailed ( role )
--		return
--	end
--end
--
--------------------巨响烟花
--function ItemUse_JXYH ( role , Item )
--	local Cha_Boat = GetCtrlBoat ( role )
--	if Cha_Boat ~=  nil then
--		SystemNotice( role , "出海时不可使用" )
--		UseItemFailed ( role )
--		return
--	end
--end
--
--------------------豪华烟花
--function ItemUse_HHLH ( role , Item )
--	local Cha_Boat = GetCtrlBoat ( role )
--	if Cha_Boat ~=  nil then
--		SystemNotice( role , "出海时不可使用" )
--		UseItemFailed ( role )
--		return
--	end
--end
--
---------教堂使用证书
--function Jz_Script_jtsyzs (role, Item )
--	--SystemNotice ( role , "请柬请柬请柬" )
--	local Now_Day = os.date("%d")
--	local Now_Month = os.date("%m")
--	local Now_Time = os.date("%H")
--	--SystemNotice ( role , "娃哈哈" )
--	local NowMniuteNum= os.date("%M")	-------------分
--	local NowMiniuteNum= tonumber(Now_Miniute)	 	-------------分
--	local NowTimeNum = tonumber(Now_Time)
--	--SystemNotice ( role , "嘿嘿嘿嘿" )
--	local NowDayNum = tonumber(Now_Day)
--	--SystemNotice ( role , "嘻嘻嘻嘻" )
--	local NowMonthNum = tonumber(Now_Month)
--	--SystemNotice ( role , "呵呵呵呵" )
--	local CheckDateNum = NowMonthNum * 1000000 + NowDayNum * 10000 + NowTimeNum*100+NowMniuteNum
--	--SystemNotice ( role , "现在时刻"..CheckDateNum)
--	--local old_type = GetItemAttr(item_old, ITEMATTR_MAXENERGY)	----------------法式教堂
--
--	local item_old = GetChaItem2 ( role , 2 , 3078 )---------请柬
--	local old_month = GetItemAttr(item_old, ITEMATTR_VAL_STA)		-------------月 	
--	local old_day = GetItemAttr(item_old, ITEMATTR_VAL_STR)			-------------日  
--	local old_hour = GetItemAttr(item_old, ITEMATTR_VAL_CON)			-------------时 
--	local old_miniute = GetItemAttr(item_old, ITEMATTR_VAL_DEX)  
--	 
--
--	local CheckBook1Num = old_month * 1000000 + old_day * 10000 + old_hour*100+old_miniute
--	--SystemNotice ( role , "CheckBook1Num"..CheckBook1Num)
--	local CheckBook2Num = old_month * 1000000 + old_day * 10000 + (old_hour+2)*100+old_miniute
--	--SystemNotice ( role , "CheckBook2Num"..CheckBook2Num)
--	
--	if CheckDateNum < CheckBook1Num then
--		SystemNotice ( role , "不要着急哦，教堂还没开门，请根据标注的时间使用哦" )
--		UseItemFailed ( role )
--		return
--	end
--	--SystemNotice ( role , "妈妈")
--	if CheckDateNum > CheckBook2Num then
--		SystemNotice ( role , "你要参加的典礼已经结束了，好可惜哦" )
--		UseItemFailed ( role )
--		return
--	end
--	--SystemNotice ( role , "爸爸")
--
--	local i = CheckBagItem(role,3066)----教堂使用证书
--	local k = ChaIsBoat(role)
--	local hp = Hp(role)
--	local mxhp = Mxhp(role)
--	local sp = Sp(role)
--	local mxsp = Mxsp(role)
--	if sp < mxsp or hp < mxhp then 
--		SystemNotice (role, "参观教堂是件很累的事情，请保持100％的hp和sp哦")
--		UseItemFailed ( role )
--		return
--	end 
--	if k == 0 then
--		if i > 0 then
--			local j = DelBagItem(role,3066,1)-------教堂使用证书
--			--if j == 1 and old_type=1 then
--				--MoveCity(role,"法式教堂")
--			--elseif	j == 1 and old_type=2 then
--				--MoveCity(role,"中式教堂")
--			if j == 1 then-------------elseif	j == 1 and old_type=3 then
--				MoveCity(role,"伊式教堂")
--				--SystemNotice ( role , "爷爷")
--			--elseif	j == 1 and old_type=4 then
--				--MoveCity(role,"地式教堂")
--			end
--		end
--	else
--		UseItemFailed ( role )
--	end
--	--SystemNotice ( role , "奶奶")	
--end
--
--
--------------请柬
--function Jz_Script_qj (role, Item )
--	--SystemNotice ( role , "请柬请柬请柬" )
--	local Now_Day = os.date("%d")
--	local Now_Month = os.date("%m")
--	local Now_Time = os.date("%H")
--	--SystemNotice ( role , "娃哈哈" )
--	local NowMniuteNum= os.date("%M")	-------------分
--	local NowMiniuteNum= tonumber(Now_Miniute)	 	-------------分
--	local NowTimeNum = tonumber(Now_Time)
--	--SystemNotice ( role , "嘿嘿嘿嘿" )
--	local NowDayNum = tonumber(Now_Day)
--	--SystemNotice ( role , "嘻嘻嘻嘻" )
--	local NowMonthNum = tonumber(Now_Month)
--	--SystemNotice ( role , "呵呵呵呵" )
--	local CheckDateNum = NowMonthNum * 1000000 + NowDayNum * 10000 + NowTimeNum*100+NowMniuteNum
--	--SystemNotice ( role , "现在时刻"..CheckDateNum)
--	--local old_type = GetItemAttr(item_old, ITEMATTR_MAXENERGY)	----------------法式教堂
--
--	local item_old = GetChaItem2 ( role , 2 , 3078 )-----请柬
--	local old_month = GetItemAttr(item_old, ITEMATTR_VAL_STA)		-------------月 	
--	local old_day = GetItemAttr(item_old, ITEMATTR_VAL_STR)			-------------日  
--	local old_hour = GetItemAttr(item_old, ITEMATTR_VAL_CON)			-------------时 
--	local old_miniute = GetItemAttr(item_old, ITEMATTR_VAL_DEX)  
--	 
--
--	local CheckBook1Num = old_month * 1000000 + old_day * 10000 + old_hour*100+old_miniute
--	--SystemNotice ( role , "CheckBook1Num"..CheckBook1Num)
--	local CheckBook2Num = old_month * 1000000 + old_day * 10000 + (old_hour+2)*100+old_miniute
--	--SystemNotice ( role , "CheckBook2Num"..CheckBook2Num)
--	
--	if CheckDateNum < CheckBook1Num then
--		SystemNotice ( role , "不要着急哦，教堂还没开门，请根据标注的时间使用哦" )
--		UseItemFailed ( role )
--		return
--	end
--	--SystemNotice ( role , "妈妈")
--	if CheckDateNum > CheckBook2Num then
--		SystemNotice ( role , "你要参加的典礼已经结束了，好可惜哦" )
--		UseItemFailed ( role )
--		return
--	end
--	--SystemNotice ( role , "爸爸")
--
--	local i = CheckBagItem(role,3078)
--	local k = ChaIsBoat(role)
--	local hp = Hp(role)
--	local mxhp = Mxhp(role)
--	local sp = Sp(role)
--	local mxsp = Mxsp(role)
--	if sp < mxsp or hp < mxhp then 
--		SystemNotice (role, "参观教堂是件很累的事情，请保持100％的hp和sp哦")
--		UseItemFailed ( role )
--		return
--	end 
--	if k == 0 then
--		if i > 0 then
--			local j = DelBagItem(role,3078,1)
--			--if j == 1 and old_type=1 then
--				--MoveCity(role,"法式教堂")
--			--elseif	j == 1 and old_type=2 then
--				--MoveCity(role,"中式教堂")
--			if j == 1 then-------------elseif	j == 1 and old_type=3 then
--				MoveCity(role,"伊式教堂")
--				--SystemNotice ( role , "爷爷")
--			--elseif	j == 1 and old_type=4 then
--				--MoveCity(role,"地式教堂")
--			end
--		end
--	else
--		UseItemFailed ( role )
--	end
--	--SystemNotice ( role , "奶奶")	
--end
-----------------------------召唤婚礼淘气鬼
--function ItemUse_FLOWER ( role , Item  )
--	local Cha_Boat = 0
--	Cha_Boat = GetCtrlBoat ( role )
--	if Cha_Boat ~=  nil then
--		SystemNotice( role , "出海时不可使用" )
--		UseItemFailed ( role )
--		return
--	end
--
--	local el = 0
--	el =IsChaInRegion( role, 2 )
--	if el == 1 then
--		SystemNotice( role , "角色当前处于安全区不可以召唤怪物" )
--		UseItemFailed ( role )
--		return
--	end
--	local x, y = GetChaPos(role)
--	local MonsterID = 1037
--	local Refresh = 7300					--重生时间，秒单位
--	local life = 7200000					--生命时间，毫秒单位
--	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
--	SetChaLifeTime( new, life )
--end
--
--
-----------------------------气球游戏券
--function ItemUse_QQ ( role , Item  )
--	local Cha_Boat = 0
--	Cha_Boat = GetCtrlBoat ( role )
--	if Cha_Boat ~=  nil then
--		SystemNotice( role , "出海时不可使用" )
--		UseItemFailed ( role )
--		return
--	end
--
--	local el = 0
--	el =IsChaInRegion( role, 2 )
--	if el == 1 then
--		SystemNotice( role , "角色当前处于安全区不可以召唤怪物" )
--		UseItemFailed ( role )
--		return
--	end
--	local x, y = GetChaPos(role)
--	local MonsterID = 1036
--	local Refresh = 60					--重生时间，秒单位
--	local life = 7200000					--生命时间，毫秒单位
--	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
--	SetChaLifeTime( new, life )
--end
----伊式教堂参观门票
--function Jz_Script_yszs (role, Item )
--	
--	local Now_Week = os.date("%w")
--	local Now_WeekNum = tonumber(Now_Week)
--	local Now_Time = os.date("%H")
--	local Now_TimeNum = tonumber(Now_Time)
--	local Now_Miniute= os.date("%M")	
--	local Now_Miniute= tonumber(Now_Miniute)
--	local CheckDateNum = Now_WeekNum * 10000 + Now_TimeNum * 100+Now_Miniute
--
--	if CheckDateNum < 11700  then
--		SystemNotice ( role , "不要着急哦，教堂还没开门，请在每星期一晚上17点到17点30分之间使用哦" )
--		UseItemFailed ( role )
--		return
--	end
--	
--	if CheckDateNum > 11730 then
--		SystemNotice ( role , "教堂已经关门了，看来只有等待下个星期一的晚上了" )
--		UseItemFailed ( role )
--		return
--	end
--
--	local i = CheckBagItem(role,3024)
--	local k = ChaIsBoat(role)
--	local hp = Hp(role)
--	local mxhp = Mxhp(role)
--	local sp = Sp(role)
--	local mxsp = Mxsp(role)
--	if sp < mxsp or hp < mxhp then 
--		SystemNotice (role, "参观教堂是件很累的事情，请保持100％的hp和sp哦")
--		UseItemFailed ( role )
--		return
--	end 
--	if k == 0 then
--		if i > 0 then
--			local j = DelBagItem(role,3024,1)
--			if j == 1 then
--				MoveCity(role,"伊式教堂")
--				return
--			end
--		end
--	else
--		UseItemFailed ( role )
--	end
--		
--end
-------------------------------红包：红包只有在（每周六\日晚18:00--22：10）打开才会有效
--
--function ItemUse_RedBox( role , Item )
--	local Cha_Boat = GetCtrlBoat ( role )
--	if Cha_Boat ~=  nil then
--		SystemNotice( role , "出海时不可使用" )
--		UseItemFailed ( role )
--		return
--	end
--	local Item_CanGet = GetChaFreeBagGridNum ( role )
--	 if Item_CanGet < 1 then
--		SystemNotice(role ,"打开压岁包最少需要1个空位")
--		UseItemFailed ( role )
--		return
--	end
--	local now_week= os.date("%w")		-------------星期几（十进制） 
--	local now_hour= os.date("%H")		-------------时 
--	local now_miniute= os.date("%M")	-------------分
--	now_week= tonumber(now_week)
--	now_hour= tonumber(now_hour)		
--	now_miniute= tonumber(now_miniute)
--	local CheckDateNum = now_hour*100 +now_miniute
--	--Notice("CheckDateNum = "..CheckDateNum)
--      if now_week==6 or now_week==0 then
--		
--		if 1800<=CheckDateNum and  CheckDateNum<=2210 then
--		--SystemNotice( role , "使用YSBOX" )
--		ItemUse_YSBOX ( role , Item )
--		else 
--		SystemNotice(role ,"还没到时间,现在使用很亏的哦!")
--		UseItemFailed ( role )
--		return
--		end
--	end
--end

------------------------升级推进器(kokora对statelv进行重新调制过)
function ItemUse_TJQ ( role , Item )
	
	local lv= GetChaAttr(role, ATTR_LV) 
	if lv >70 then
		CALCULATE_ITEMEFFECT_LUA_000295 = GetResString("CALCULATE_ITEMEFFECT_LUA_000295")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000295 )
		UseItemFailed ( role )
		return	
	end
	local statelv = 7
	local statetime = 1800
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ==  nil then
		local ret = UseAexpItem(role,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
end

------------------------金牛船长宝箱：双击，根据角色给予道具

function ItemUse_JNCZBox ( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 4 then
		CALCULATE_ITEMEFFECT_LUA_000296 = GetResString("CALCULATE_ITEMEFFECT_LUA_000296")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000296)
		UseItemFailed ( role )
		return
	end
	local cha_type = GetChaTypeID ( role ) 
	if cha_type == 3  then 
	     
	       GiveItem ( role , 0 , 5364  , 1 , 4 )
	       GiveItem ( role , 0 , 5365  , 1 , 4 )
	       GiveItem ( role , 0 , 5366  , 1 , 4 )
	       GiveItem ( role , 0 , 5367  , 1 , 4 )
	elseif cha_type == 4  then 

	       GiveItem ( role , 0 , 5368  , 1 , 4 )
	       GiveItem ( role , 0 , 5369  , 1 , 4 )
	       GiveItem ( role , 0 , 5370  , 1 , 4 )
	       GiveItem ( role , 0 , 5371  , 1 , 4 )
	elseif cha_type == 1 then 
	      
	       GiveItem ( role , 0 , 5356  , 1 , 4 )
	       GiveItem ( role , 0 , 5357  , 1 , 4 )
	       GiveItem ( role , 0 , 5358  , 1 , 4 )
	       GiveItem ( role , 0 , 5359  , 1 , 4 )
	elseif cha_type == 2 then 

	       GiveItem ( role , 0 , 5360  , 1 , 4 )
	       GiveItem ( role , 0 , 5361  , 1 , 4 )
	       GiveItem ( role , 0 , 5362  , 1 , 4 )
	       GiveItem ( role , 0 , 5363  , 1 , 4 )
	end
end


---------------------------召唤金牛守护者
function ItemUse_JNSHZ ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local el = 0
	el =IsChaInRegion( role, 2 )
	if el == 1 then
		CALCULATE_ITEMEFFECT_LUA_000234 = GetResString("CALCULATE_ITEMEFFECT_LUA_000234")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000234 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	local MonsterID = 1038
	local Refresh = 10900					--重生时间，秒单位
	local life = 3600000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaLifeTime( new, life )
end

--糯米粽
function ItemUse_NMZ ( role , Item )

	CALCULATE_ITEMEFFECT_LUA_000162 = GetResString("CALCULATE_ITEMEFFECT_LUA_000162")
	SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000162)
  	--local hp = GetChaAttr(role, ATTR_HP) 
	--local mxhp = GetChaAttr(role,ATTR_MXHP) 	
	--hp = hp + 0.35*mxhp 

	--if hp > mxhp then 
		--hp = mxhp 
	--end 
	--SetCharaAttr(hp, role, ATTR_HP)

end


------------------------------豆沙粽：行走速度在15分钟内有较大提升效果
function ItemUse_DSZ ( role , Item )

	CALCULATE_ITEMEFFECT_LUA_000162 = GetResString("CALCULATE_ITEMEFFECT_LUA_000162")
	SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000162)
	--local statelv = 1
	--local statetime = 900
	--local Cha_Boat = 0
	--Cha_Boat = GetCtrlBoat ( role )
	--if Cha_Boat ==  nil then
		--Rem_State_StarUnnormal ( role )----------
		--AddState( role , role , STATE_DSZ , statelv , statetime )
	--else
		--SystemNotice( role , "出海时不可使用" )
		--UseItemFailed ( role )
		--return
	--end
end

-------------------------------蛋黄粽: 防御力在10分钟内提升60点
function ItemUse_DHZ ( role , Item )

	CALCULATE_ITEMEFFECT_LUA_000162 = GetResString("CALCULATE_ITEMEFFECT_LUA_000162")
	SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000162)
	--local statelv = 1
	--local statetime = 600
	--local Cha_Boat = 0
	--Cha_Boat = GetCtrlBoat ( role )

	--if Cha_Boat ==  nil then
		--AddState( role , role , STATE_DHZ , statelv , statetime )
	--else
		--SystemNotice( role , "出海时不可使用" )
		--UseItemFailed ( role )
		--return
	--end
end
----------------------------温情粽子
function ItemUse_WQZZ ( role , Item )

	CALCULATE_ITEMEFFECT_LUA_000162 = GetResString("CALCULATE_ITEMEFFECT_LUA_000162")
	SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000162)
	--local el_exp = GetChaAttr(role, ATTR_CEXP)
	--local exp1=el_exp
	--local charLv=Lv ( role )
	--local exp_resume = 50
	--local	exp_resume_1= 1
	--el_exp = el_exp + exp_resume
	-- if charLv>=80 then	
		--el_exp = exp1 + exp_resume_1
	--end
	--SetCharaAttr(el_exp, role, ATTR_CEXP) 
end 

---------------------------召唤黑龙幻体
function ItemUse_HLHT ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local el = 0
	el =IsChaInRegion( role, 2 )
	if el == 1 then
		CALCULATE_ITEMEFFECT_LUA_000234 = GetResString("CALCULATE_ITEMEFFECT_LUA_000234")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000234 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	local MonsterID = 952---------黑龙幻影
	local Refresh = 9000					--重生时间，秒单位
	local life =9000000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaLifeTime( new, life )
end

---------------------------召唤蜥蜴战士统领
function ItemUse_XYZSTL ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local el = 0
	el =IsChaInRegion( role, 2 )
	if el == 1 then
		CALCULATE_ITEMEFFECT_LUA_000234 = GetResString("CALCULATE_ITEMEFFECT_LUA_000234")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000234 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	local MonsterID = 786---------蜥蜴战士统领
	local Refresh = 9000					--重生时间，秒单位
	local life = 9000000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaLifeTime( new, life )
end

---------------------------召唤邪恶的土著酋长
function ItemUse_XETZQZ ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local el = 0
	el =IsChaInRegion( role, 2 )
	if el == 1 then
		CALCULATE_ITEMEFFECT_LUA_000234 = GetResString("CALCULATE_ITEMEFFECT_LUA_000234")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000234 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	local MonsterID = 788---------邪恶的土著酋长
	local Refresh = 9000					--重生时间，秒单位
	local life = 9000000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaLifeTime( new, life )
end

---------------------------召唤海盗船长零零发
function ItemUse_HDCZ ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local el = 0
	el =IsChaInRegion( role, 2 )
	if el == 1 then
		CALCULATE_ITEMEFFECT_LUA_000234 = GetResString("CALCULATE_ITEMEFFECT_LUA_000234")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000234 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	local MonsterID = 757---------海盗船长零零发
	local Refresh = 9000					--重生时间，秒单位
	local life = 9000000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaLifeTime( new, life )
end

---------------------------召唤狐妖
function ItemUse_HY ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local el = 0
	el =IsChaInRegion( role, 2 )
	if el == 1 then
		CALCULATE_ITEMEFFECT_LUA_000234 = GetResString("CALCULATE_ITEMEFFECT_LUA_000234")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000234 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	local MonsterID = 761---------狐妖
	local Refresh = 9000					--重生时间，秒单位
	local life = 9000000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaLifeTime( new, life )
end
----------幸运字母卡宝箱
function ItemUse_XingYunBox( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000242 = GetResString("CALCULATE_ITEMEFFECT_LUA_000242")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000242)
		UseItemFailed ( role )
		return
	end
	local el=math.random ( 1, 241920 )
	if el==1 then
		GiveItem ( role , 0 , 0961, 1 , 4  ) -------------c	
	elseif el==2 then
		GiveItem ( role , 0 , 0969, 1 , 4  ) -----------k		
	elseif el>=3 and el<=4 then
		GiveItem ( role , 0 , 0973, 1 , 4  )	-------------p	
	elseif el>=5 and el<=6 then
		GiveItem ( role , 0 , 0980, 1 , 4  )	-------------v
	elseif el>=7 and el<=8 then
		GiveItem ( role , 0 , 0979, 1 , 4  )	-------------u
	else
		local el=math.random ( 0959, 0984 )
		if el==0961 or el==0969 or el==0973 or el==0980 or el==0979 then
			GiveItem ( role , 0 , 0959  , 1 , 4  ) 
		else 
			GiveItem ( role , 0 , el , 1 , 4  ) 			
		end
	end
end

------------------------超级助推器(对statelv进行了调整kokora)
function ItemUse_CJZTQ ( role , Item )

	local lv= GetChaAttr(role, ATTR_LV) 
	if lv >49 then
		CALCULATE_ITEMEFFECT_LUA_000297 = GetResString("CALCULATE_ITEMEFFECT_LUA_000297")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000297 )
		UseItemFailed ( role )
		return	
	end
	local statelv = 7
	local statetime = 900
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ==  nil then
		local ret = UseAexpItem(role,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
end

----------世纪辉煌彩票
function ItemUse_SJHHCP( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000242 = GetResString("CALCULATE_ITEMEFFECT_LUA_000242")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000242)
		UseItemFailed ( role )
		return
	end
	local star=math.random ( 1, 1000000 )
	local el=math.random ( 1, 100 )

	--SystemNotice(role ,"star=="..star)
	--SystemNotice(role ,"el=="..el)
	if  star==1 then
		if el>=1 and el<=40 then
		GiveItem ( role , 0 , 1115  , 1 , 4  )
		elseif el>=41 and el<=65 then
		GiveItem ( role , 0 , 1117  , 1 , 4  )
		elseif el>=65 and el<=90 then
		GiveItem ( role , 0 , 1118  , 1 , 4  )
		elseif el>=91 and el<=100 then
		GiveItem ( role , 0 , 1116  , 1 , 4  ) 
		end
	elseif star>1 and star<=9999 then
		GiveItem ( role , 0 , 0273, 1 , 4  ) 
	elseif star>=10000 and star<170000 then
		GiveItem ( role , 0 , 2312, 30 , 4  ) 
	elseif star>=170000 and star<=1000000 then
		GiveItem ( role , 0 , 3877, 1 , 4  ) 
	end
end


----------至尊年兽彩票
function ItemUse_ZZNSCP( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000242 = GetResString("CALCULATE_ITEMEFFECT_LUA_000242")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000242)
		UseItemFailed ( role )
		return
	end
	local star=math.random ( 1, 1000000 )
	local el=math.random ( 1, 100 )

	--SystemNotice(role ,"star=="..star)
	--SystemNotice(role ,"el=="..el)
	if  star==1 then
		if el>=1 and el<=40 then
		GiveItem ( role , 0 , 2552  , 1 , 4  )
		elseif el>=41 and el<=65 then
		GiveItem ( role , 0 , 2550  , 1 , 4  )
		elseif el>=65 and el<=90 then
		GiveItem ( role , 0 , 2551  , 1 , 4  )
		elseif el>=91 and el<=100 then
		GiveItem ( role , 0 , 2549  , 1 , 4  ) 
		end
	elseif star>1 and star<=9999 then
		GiveItem ( role , 0 , 0273, 1 , 4  ) 
	elseif star>=10000 and star<170000 then
		GiveItem ( role , 0 , 2312, 30 , 4  ) 
	elseif star>=170000 and star<=1000000 then
		GiveItem ( role , 0 , 3877, 1 , 4  ) 
	end
end

----------真·黑龙彩票
function ItemUse_ZHLCP( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000242 = GetResString("CALCULATE_ITEMEFFECT_LUA_000242")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000242)
		UseItemFailed ( role )
		return
	end
	local star=math.random ( 1, 1000000 )
	local el=math.random ( 1, 100 )

	--SystemNotice(role ,"star=="..star)
	--SystemNotice(role ,"el=="..el)
	if  star==1 then
		if el>=1 and el<=40 then
		GiveItem ( role , 0 , 2370  , 1 , 4  )
		elseif el>=41 and el<=65 then
		GiveItem ( role , 0 , 2368  , 1 , 4  )
		elseif el>=65 and el<=90 then
		GiveItem ( role , 0 , 2369  , 1 , 4  )
		elseif el>=91 and el<=100 then
		GiveItem ( role , 0 , 2367  , 1 , 4  ) 
		end
	elseif star>1 and star<=9999 then
		GiveItem ( role , 0 , 0273, 1 , 4  ) 
	elseif star>=10000 and star<170000 then
		GiveItem ( role , 0 , 2312, 30 , 4  ) 
	elseif star>=170000 and star<=1000000 then
		GiveItem ( role , 0 , 3877, 1 , 4  ) 
	end
end




----------惊世转生彩票------rock要的
function ItemUse_JSZSCP( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000242 = GetResString("CALCULATE_ITEMEFFECT_LUA_000242")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000242)
		UseItemFailed ( role )
		return
	end
	local star=math.random ( 1, 1000 )

	if  star==1 then
		GiveItem ( role , 0 , 2941, 1 , 4  ) 
		local cha_name = GetChaDefaultName ( role ) 
		CALCULATE_ITEMEFFECT_LUA_000298 = GetResString("CALCULATE_ITEMEFFECT_LUA_000298")
		CALCULATE_EXP_AND_LEVEL_LUA_000040 = GetResString("CALCULATE_EXP_AND_LEVEL_LUA_000040")
		local message = CALCULATE_EXP_AND_LEVEL_LUA_000040..cha_name..CALCULATE_ITEMEFFECT_LUA_000298 
		Notice ( message )
	elseif star>1 and star<=10 then
		GiveItem ( role , 0 , 3016, 1 , 4  ) 
		local cha_name = GetChaDefaultName ( role ) 
		CALCULATE_ITEMEFFECT_LUA_000299 = GetResString("CALCULATE_ITEMEFFECT_LUA_000299")
		CALCULATE_EXP_AND_LEVEL_LUA_000040 = GetResString("CALCULATE_EXP_AND_LEVEL_LUA_000040")
		local message = CALCULATE_EXP_AND_LEVEL_LUA_000040..cha_name..CALCULATE_ITEMEFFECT_LUA_000299 
		Notice ( message )
	elseif star>=11 and star<190 then
		GiveItem ( role , 0 , 0992, 1 , 4  ) 
	elseif star>=190 and star<=1000 then
		GiveItem ( role , 0 , 3885, 1 , 4  ) 
	end
end
-------------------祝福宝珠
function ItemUse_ZFBZ( role , Item )

	local statelv = 1
	local statetime = 15
	AddState( role , role , STATE_CZZX , statelv , statetime )
end
------------------------成长快餐
function ItemUse_CZKC ( role , Item )

	local Cha_Boat = 0
	local charLv=Lv ( role )
	local Exp_star=GetChaAttr (  role , ATTR_CEXP )----------当前等级经验
	local dif_exp_thalf_c = (DEXP[charLv+1] - DEXP[charLv])*0.01+Exp_star
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	if charLv<86 or charLv>100 then
		CALCULATE_ITEMEFFECT_LUA_000300 = GetResString("CALCULATE_ITEMEFFECT_LUA_000300")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000300 )
		UseItemFailed ( role )
		return
	end
	if charLv>=86 and charLv<=100 then
		SetChaAttrI( role , ATTR_CEXP , dif_exp_thalf_c )
        end
end
------------------------双子船长宝箱：双击，根据角色给予道具

function ItemUse_SZCZBox ( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 4 then
		CALCULATE_ITEMEFFECT_LUA_000301 = GetResString("CALCULATE_ITEMEFFECT_LUA_000301")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000301)
		UseItemFailed ( role )
		return
	end
	local cha_type = GetChaTypeID ( role ) 
	if cha_type == 3  then 
	     
	       GiveItem ( role , 0 , 5380  , 1 , 4 )
	       GiveItem ( role , 0 , 5381  , 1 , 4 )
	       GiveItem ( role , 0 , 5382  , 1 , 4 )
	       GiveItem ( role , 0 , 5383  , 1 , 4 )
	elseif cha_type == 4  then 

	       GiveItem ( role , 0 , 5384  , 1 , 4 )
	       GiveItem ( role , 0 , 5385  , 1 , 4 )
	       GiveItem ( role , 0 , 5386  , 1 , 4 )
	       GiveItem ( role , 0 , 5387  , 1 , 4 )
	elseif cha_type == 1 then 
	      
	       GiveItem ( role , 0 , 5372  , 1 , 4 )
	       GiveItem ( role , 0 , 5373  , 1 , 4 )
	       GiveItem ( role , 0 , 5374  , 1 , 4 )
	       GiveItem ( role , 0 , 5375  , 1 , 4 )
	elseif cha_type == 2 then 

	       GiveItem ( role , 0 , 5376  , 1 , 4 )
	       GiveItem ( role , 0 , 5377  , 1 , 4 )
	       GiveItem ( role , 0 , 5378  , 1 , 4 )
	       GiveItem ( role , 0 , 5379  , 1 , 4 )
	end
end



---------------------------召唤双子守护者
function ItemUse_SZSHZ ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local el = 0
	el =IsChaInRegion( role, 2 )
	if el == 1 then
		CALCULATE_ITEMEFFECT_LUA_000234 = GetResString("CALCULATE_ITEMEFFECT_LUA_000234")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000234 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	local MonsterID = 1039
	local Refresh = 10900					--重生时间，秒单位
	local life = 3600000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaLifeTime( new, life )
end


----------毕业证书使用
function ItemUse_byzm ( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000242 = GetResString("CALCULATE_ITEMEFFECT_LUA_000242")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000242)
		UseItemFailed ( role )
		return
	end
	local cha_name = GetChaDefaultName ( role ) 
	local star=math.random ( 1, 100 )
	SystemNotice(role ,"star=="..star)
	if star<=5 then
		GiveItem ( role , 0 , 1028  , 1 , 4  )
		CALCULATE_ITEMEFFECT_LUA_000302 = GetResString("CALCULATE_ITEMEFFECT_LUA_000302")
		local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000302 
		Notice ( message )
	elseif star>=6 and star<=20 then
		GiveItem ( role , 0 , 885, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000303 = GetResString("CALCULATE_ITEMEFFECT_LUA_000303")
		local message1 = cha_name..CALCULATE_ITEMEFFECT_LUA_000303 
		Notice ( message1 )
	elseif star>=21 and star<=50 then
		GiveItem ( role , 0 , 3039, 5 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000304 = GetResString("CALCULATE_ITEMEFFECT_LUA_000304")
		local message2 = cha_name..CALCULATE_ITEMEFFECT_LUA_000304 
		Notice ( message2 )
	else
		GiveItem ( role , 0 , 227, 10 , 4  )
		CALCULATE_ITEMEFFECT_LUA_000305 = GetResString("CALCULATE_ITEMEFFECT_LUA_000305")
		local message3 = cha_name..CALCULATE_ITEMEFFECT_LUA_000305 
		Notice ( message3 )
	end
end
------------------------开学大礼包：双击，根据角色给予道具

function ItemUse_kxdlb ( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 4 then
		CALCULATE_ITEMEFFECT_LUA_000306 = GetResString("CALCULATE_ITEMEFFECT_LUA_000306")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000306)
		UseItemFailed ( role )
		return
	end
	local cha_type = GetChaTypeID ( role ) 
	if cha_type == 3  then 
	       GiveItem ( role , 0 , 5396  , 1 , 4 )
	       GiveItem ( role , 0 , 5397  , 1 , 4 )
	       GiveItem ( role , 0 , 5398  , 1 , 4 )
	       GiveItem ( role , 0 , 5399  , 1 , 4 )
	elseif cha_type == 4  then 
	       GiveItem ( role , 0 , 5400  , 1 , 4 )
	       GiveItem ( role , 0 , 5401  , 1 , 4 )
	       GiveItem ( role , 0 , 5402  , 1 , 4 )
	       GiveItem ( role , 0 , 5403  , 1 , 4 )
	elseif cha_type == 1 then 
	       GiveItem ( role , 0 , 5388  , 1 , 4 )
	       GiveItem ( role , 0 , 5389  , 1 , 4 )
	       GiveItem ( role , 0 , 5390  , 1 , 4 )
	       GiveItem ( role , 0 , 5391  , 1 , 4 )
	elseif cha_type == 2 then 
	       GiveItem ( role , 0 , 5392  , 1 , 4 )
	       GiveItem ( role , 0 , 5393  , 1 , 4 )
	       GiveItem ( role , 0 , 5394  , 1 , 4 )
	       GiveItem ( role , 0 , 5395  , 1 , 4 )
	end
end


-------------------------------胜利宝箱
function ItemUse_SLBox ( role , Item )

	local a = math.random ( 1 , 100 )
	local Item_ID = 0
	if a >= 1 and a <= 50 then
		Item_ID = 1012
	elseif a > 50 and a <= 80 then
		Item_ID = 271
	else
		Item_ID = 885
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000307 = GetResString("CALCULATE_ITEMEFFECT_LUA_000307")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000307)
		UseItemFailed ( role )
		return
	else
		GiveItem ( role , 0 , Item_ID , 1 , 4 )
	end
end

--------------------------------65BOSS装备箱
function ItemUse_65BBBox ( role , Item )

	local job = GetChaAttr( role, ATTR_JOB) --取职业
        local cha_type = GetChaTypeID ( role )
	if job == 0 then
		CALCULATE_ITEMEFFECT_LUA_000308 = GetResString("CALCULATE_ITEMEFFECT_LUA_000308")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000308)
		UseItemFailed ( role )
		return
	else
		if job == 12 or job == 2 then		--猎人或狙击
			GiveItem( role , 0 , 780  , 1 , 4 )
		elseif job == 9	then			--双剑
			GiveItem( role , 0 , 769  , 1 , 4 )
		elseif job == 16 or job == 4 then	--冒险或航海
			GiveItem( role , 0 , 806  , 1 , 4 )
		elseif job == 8	then			--巨剑
			GiveItem( role , 0 , 766  , 1 , 4 )
		elseif job == 13 or job == 5 then	--圣职或药师
			GiveItem( role , 0 ,792  , 1 , 4 )
		elseif job == 14 then			--封印
			GiveItem( role , 0 , 798  , 1 , 4 )
		elseif job == 1 then
			if cha_type == 1 then
				GiveItem( role , 0 , 769  , 1 , 4 )
			elseif cha_type == 2 then
				GiveItem( role , 0 , 766  , 1 , 4 )
			elseif cha_type == 3 then
				GiveItem( role , 0 , 769  , 1 , 4 )
			end
		end
	
	end
end


---------------------巨蟹船长宝箱：双击，根据角色给予道具

function ItemUse_JXBox ( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 4 then
		CALCULATE_ITEMEFFECT_LUA_000309 = GetResString("CALCULATE_ITEMEFFECT_LUA_000309")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000309)
		UseItemFailed ( role )
		return
	end
	local cha_type = GetChaTypeID ( role ) 
	if cha_type == 3  then 
	     
	       GiveItem ( role , 0 , 5464  , 1 , 4 )
	       GiveItem ( role , 0 , 5465  , 1 , 4 )
	       GiveItem ( role , 0 , 5466  , 1 , 4 )
	       GiveItem ( role , 0 , 5467  , 1 , 4 )
	elseif cha_type == 4  then 

	       GiveItem ( role , 0 , 5468  , 1 , 4 )
	       GiveItem ( role , 0 , 5469  , 1 , 4 )
	       GiveItem ( role , 0 , 5470  , 1 , 4 )
	       GiveItem ( role , 0 , 5471  , 1 , 4 )
	elseif cha_type == 1 then 
	      
	       GiveItem ( role , 0 , 5456  , 1 , 4 )
	       GiveItem ( role , 0 , 5457  , 1 , 4 )
	       GiveItem ( role , 0 , 5458  , 1 , 4 )
	       GiveItem ( role , 0 , 5459  , 1 , 4 )
	elseif cha_type == 2 then 

	       GiveItem ( role , 0 , 5460  , 1 , 4 )
	       GiveItem ( role , 0 , 5461  , 1 , 4 )
	       GiveItem ( role , 0 , 5462  , 1 , 4 )
	       GiveItem ( role , 0 , 5463  , 1 , 4 )
	end
end

---------------------------召唤巨蟹守护者
function ItemUse_JXSHZ ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local el = 0
	el =IsChaInRegion( role, 2 )
	if el == 1 then
		CALCULATE_ITEMEFFECT_LUA_000234 = GetResString("CALCULATE_ITEMEFFECT_LUA_000234")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000234 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	local MonsterID = 1040
	local Refresh = 10900					--重生时间，秒单位
	local life = 3600000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaLifeTime( new, life )
end


--------------------------------------------------kokora--------------------------------------------------
--------------------------------金秋十月活动之毛蟹食用效果(对statelv进行了调整)
function ItemUse_littlecrab ( role , Item )

	local lv= GetChaAttr(role, ATTR_LV) 
	if lv >86 then
		CALCULATE_ITEMEFFECT_LUA_000310 = GetResString("CALCULATE_ITEMEFFECT_LUA_000310")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000310 )
		UseItemFailed ( role )
		return	
	end

	local statelv = 7
	local statetime = 120
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ==  nil then
		local ret = UseAexpItem(role,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	else
		local ret = UseAexpItem(Cha_Boat,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	end
	CALCULATE_ITEMEFFECT_LUA_000311 = GetResString("CALCULATE_ITEMEFFECT_LUA_000311")
	SystemNotice ( role ,CALCULATE_ITEMEFFECT_LUA_000311 )
end


--------------------------------金秋十月活动之大闸蟹食用效果(对statelv进行了调整)
function ItemUse_bigcrab ( role , Item )

	local lv= GetChaAttr(role, ATTR_LV) 
	if lv >86 then
		CALCULATE_ITEMEFFECT_LUA_000310 = GetResString("CALCULATE_ITEMEFFECT_LUA_000310")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000310 )
		UseItemFailed ( role )
		return	
	end

	local statelv = 10
	local statetime = 120
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ==  nil then
		local ret = UseAexpItem(role,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	else
		local ret = UseAexpItem(Cha_Boat,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	end
	CALCULATE_ITEMEFFECT_LUA_000312 = GetResString("CALCULATE_ITEMEFFECT_LUA_000312")
	SystemNotice ( role ,CALCULATE_ITEMEFFECT_LUA_000312 )
end

--------------------------------金秋十月活动之蟹苗食用效果
function ItemUse_babycrab ( role , Item )  

	local el_exp = GetChaAttr(role, ATTR_CEXP)
	local exp1=el_exp
	local charLv=Lv ( role )
	local exp_resume = 1000
	local	exp_resume_1= 20
	el_exp = el_exp + exp_resume
	 if charLv>=80 then	
		el_exp = exp1 + exp_resume_1
	end
	SetCharaAttr(el_exp, role, ATTR_CEXP) 
end 
--------------------------------金秋十月活动之蟹王食用效果
function ItemUse_kingcrab ( role , Item )

	local Cha_Boat = 0
	local charLv=Lv ( role )
	local dif_exp_one = DEXP[charLv+1]
	local dif_exp_three = DEXP[charLv+3]
	local dif_exp_five = DEXP[charLv+5]
	local Exp_star=GetChaAttr (  role , ATTR_CEXP )----------当前等级经验
	local dif_exp_half = (DEXP[charLv+1] - DEXP[charLv])*0.5 +  Exp_star +10
	local dif_exp_thalf = (DEXP[charLv+1] - DEXP[charLv])*0.3  +  Exp_star + 10
	local dif_exp_thalf_b = dif_exp_thalf - DEXP[charLv+1]
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	elseif charLv>=1 and charLv<=9 then
		SetChaAttrI( role , ATTR_CEXP , dif_exp_five )
	elseif charLv>=10 and charLv<=29 then
			SetChaAttrI( role , ATTR_CEXP , dif_exp_three )
	elseif charLv>=30 and charLv<=59 then
			SetChaAttrI( role , ATTR_CEXP , dif_exp_one )
	elseif charLv>=60 and charLv<=75 then
			SetChaAttrI( role , ATTR_CEXP , dif_exp_half )
	elseif charLv>=76 and charLv<=85 and charLv~=79  then
			SetChaAttrI( role , ATTR_CEXP , dif_exp_thalf )
	elseif charLv==79 and dif_exp_thalf_b<=0 then 
			SetChaAttrI( role , ATTR_CEXP , dif_exp_thalf )
	elseif charLv==79 and dif_exp_thalf_b>0 then 
			dif_exp_thalf = dif_exp_thalf_b*0.02 + DEXP[charLv+1]
			SetChaAttrI( role , ATTR_CEXP , dif_exp_thalf )
	elseif charLv>=86 then
		CALCULATE_ITEMEFFECT_LUA_000073 = GetResString("CALCULATE_ITEMEFFECT_LUA_000073")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000073 )
		UseItemFailed ( role )
		return
	end
end


------------------------------------------------kokora--------------------------------------------------
----------天使宝藏
function ItemUse_TSBox( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000242 = GetResString("CALCULATE_ITEMEFFECT_LUA_000242")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000242)
		UseItemFailed ( role )
		return
	end
	local cha_name = GetChaDefaultName ( role ) 
	local star=math.random ( 1, 100 )
	--SystemNotice(role ,"star=="..star)
	if star<=40 then
		GiveItem ( role , 0 , 5641  , 3 , 4  )
		CALCULATE_ITEMEFFECT_LUA_000313 = GetResString("CALCULATE_ITEMEFFECT_LUA_000313")
		local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000313 
		Notice ( message )
	elseif star>=41 and star<=55 then
		GiveItem ( role , 0 ,6205, 10 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000314 = GetResString("CALCULATE_ITEMEFFECT_LUA_000314")
		local message1 = cha_name..CALCULATE_ITEMEFFECT_LUA_000314 
		Notice ( message1 )
	else
		GiveItem ( role , 0 , 0271, 10 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000315 = GetResString("CALCULATE_ITEMEFFECT_LUA_000315")
		local message2 = cha_name..CALCULATE_ITEMEFFECT_LUA_000315 
		Notice ( message2 )
	end
end


----------黄金圣斗士宝藏
function ItemUse_SDSBox( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000242 = GetResString("CALCULATE_ITEMEFFECT_LUA_000242")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000242)
		UseItemFailed ( role )
		return
	end
	local cha_name = GetChaDefaultName ( role ) 
	local star=math.random ( 1, 100 )
	--SystemNotice(role ,"star=="..star)
	if star<=25 then
		GiveItem ( role , 0 , 2955  , 1 , 4  )
		CALCULATE_ITEMEFFECT_LUA_000316 = GetResString("CALCULATE_ITEMEFFECT_LUA_000316")
		local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000316 
		Notice ( message )
	elseif star>=26 and star<=50 then
		GiveItem ( role , 0 ,3035, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000317 = GetResString("CALCULATE_ITEMEFFECT_LUA_000317")
		local message1 = cha_name..CALCULATE_ITEMEFFECT_LUA_000317 
		Notice ( message1 )
	elseif star>=51 and star<=75 then
		GiveItem ( role , 0 ,1881, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000318 = GetResString("CALCULATE_ITEMEFFECT_LUA_000318")
		local message2 = cha_name..CALCULATE_ITEMEFFECT_LUA_000318 
		Notice ( message2 )
	else
		GiveItem ( role , 0 , 2575, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000319 = GetResString("CALCULATE_ITEMEFFECT_LUA_000319")
		local message3 = cha_name..CALCULATE_ITEMEFFECT_LUA_000319 
		Notice ( message3 )
	end
end


----------神龙宝藏
function ItemUse_ShenLongBox( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000242 = GetResString("CALCULATE_ITEMEFFECT_LUA_000242")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000242)
		UseItemFailed ( role )
		return
	end
	local cha_name = GetChaDefaultName ( role ) 
	local star=math.random ( 1, 100 )
	--SystemNotice(role ,"star=="..star)
	if star<=40 then
		GiveItem ( role , 0 , 0864  , 1 , 4  )
		CALCULATE_ITEMEFFECT_LUA_000320 = GetResString("CALCULATE_ITEMEFFECT_LUA_000320")
		local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000320 
		Notice ( message )
	elseif star>=41 and star<=60 then
		GiveItem ( role , 0 ,0865, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000321 = GetResString("CALCULATE_ITEMEFFECT_LUA_000321")
		local message1 = cha_name..CALCULATE_ITEMEFFECT_LUA_000321 
		Notice ( message1 )
	elseif star>=61 and star<=100 then
		GiveItem ( role , 0 ,0866, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000322 = GetResString("CALCULATE_ITEMEFFECT_LUA_000322")
		local message2 = cha_name..CALCULATE_ITEMEFFECT_LUA_000322 
		Notice ( message2 )
	end
end


----------极速宝藏
function ItemUse_JSBox( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000242 = GetResString("CALCULATE_ITEMEFFECT_LUA_000242")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000242)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 0992 , 99 , 4) 			
	local itemname = GetItemName (0992) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000323 = GetResString("CALCULATE_ITEMEFFECT_LUA_000323")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000323..itemname  
	Notice ( message )
end

----------恶魔宝藏
function ItemUse_EMBox( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000242 = GetResString("CALCULATE_ITEMEFFECT_LUA_000242")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000242)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 2842 , 1 , 4) 			
	local itemname = GetItemName (2842) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000324 = GetResString("CALCULATE_ITEMEFFECT_LUA_000324")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000324..itemname  
	Notice ( message )
end

----------年兽宝藏
function ItemUse_NSBox( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000242 = GetResString("CALCULATE_ITEMEFFECT_LUA_000242")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000242)
		UseItemFailed ( role )
		return
	end
	local itemname = GetItemName (0192) 
	local cha_name = GetChaDefaultName ( role ) 
	local star=math.random ( 1, 100 )
	--SystemNotice(role ,"star=="..star)
	if star<=95 then
		GiveItem ( role , 0 , 0192 , 1 , 4) 
		CALCULATE_ITEMEFFECT_LUA_000325 = GetResString("CALCULATE_ITEMEFFECT_LUA_000325")
		local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000325..itemname  
		Notice ( message )
	else 
		GiveItem ( role , 0 ,2403, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000326 = GetResString("CALCULATE_ITEMEFFECT_LUA_000326")
		local message1 = cha_name..CALCULATE_ITEMEFFECT_LUA_000326 
		Notice ( message1 )
	end
end

--------------------------------死神宝藏
function ItemUse_SSBox ( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000242 = GetResString("CALCULATE_ITEMEFFECT_LUA_000242")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000242)
		UseItemFailed ( role )
		return
	end
	local job = GetChaAttr( role, ATTR_JOB) --取职业
        local cha_type = GetChaTypeID ( role )
	if job == 0 or job ==1   or job ==2  or job ==4   or job ==5  then
		CALCULATE_ITEMEFFECT_LUA_000327 = GetResString("CALCULATE_ITEMEFFECT_LUA_000327")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000327)
		UseItemFailed ( role )
		return
	else
		if job == 12 then			--狙击
			GiveItem( role , 0 , 2838  , 1 , 4 )
			local cha_name = GetChaDefaultName ( role ) 
			CALCULATE_ITEMEFFECT_LUA_000328 = GetResString("CALCULATE_ITEMEFFECT_LUA_000328")
			local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000328  
			Notice ( message )
		elseif job == 9	then			--双剑
			GiveItem( role , 0 , 2837  , 1 , 4 )
			local cha_name = GetChaDefaultName ( role ) 
			CALCULATE_ITEMEFFECT_LUA_000329 = GetResString("CALCULATE_ITEMEFFECT_LUA_000329")
			local message1 = cha_name..CALCULATE_ITEMEFFECT_LUA_000329  
			Notice ( message1 )
		elseif job == 16 then			--航海
			GiveItem( role , 0 , 2839  , 1 , 4 )
			local cha_name = GetChaDefaultName ( role ) 
			CALCULATE_ITEMEFFECT_LUA_000330 = GetResString("CALCULATE_ITEMEFFECT_LUA_000330")
			local message2 = cha_name..CALCULATE_ITEMEFFECT_LUA_000330  
			Notice ( message2 )
		elseif job == 8	then			--巨剑
			GiveItem( role , 0 , 2836  , 1 , 4 )
			local cha_name = GetChaDefaultName ( role ) 
			CALCULATE_ITEMEFFECT_LUA_000331 = GetResString("CALCULATE_ITEMEFFECT_LUA_000331")
			local message3 = cha_name..CALCULATE_ITEMEFFECT_LUA_000331  
			Notice ( message3 )
		elseif job == 13 then			--圣职
			GiveItem( role , 0 ,2840  , 1 , 4 )
			local cha_name = GetChaDefaultName ( role ) 
			CALCULATE_ITEMEFFECT_LUA_000332 = GetResString("CALCULATE_ITEMEFFECT_LUA_000332")
			local message4 = cha_name..CALCULATE_ITEMEFFECT_LUA_000332  
			Notice ( message4 )
		elseif job == 14 then			--封印
			GiveItem( role , 0 , 2841  , 1 , 4 )
			local cha_name = GetChaDefaultName ( role ) 
			CALCULATE_ITEMEFFECT_LUA_000333 = GetResString("CALCULATE_ITEMEFFECT_LUA_000333")
			local message5 = cha_name..CALCULATE_ITEMEFFECT_LUA_000333  
			Notice ( message5 )
		
		end
	
	end
end

--洛克藏宝图 

function ItemUse_Map_LK ( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000058 = GetResString("CALCULATE_ITEMEFFECT_LUA_000058")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000058)
		UseItemFailed ( role )
		return
	end 
	local Has_GoldenMap = CheckBagItem ( role , 2998 )
	if Has_GoldenMap >= 1 then
		CALCULATE_ITEMEFFECT_LUA_000334 = GetResString("CALCULATE_ITEMEFFECT_LUA_000334")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000334 )
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 2998 , 1 , 0 )
end


-- 海盗罗盘


function ItemUse_HDLP ( role , Item )

	CALCULATE_ITEMEFFECT_LUA_000335 = GetResString("CALCULATE_ITEMEFFECT_LUA_000335")
	SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000335)
 	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000058 = GetResString("CALCULATE_ITEMEFFECT_LUA_000058")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000058)
		UseItemFailed ( role )
		return
	end 
	local Has_GoldenMap = CheckBagItem ( role , 2998 )
	if Has_GoldenMap >= 2 then
		CALCULATE_ITEMEFFECT_LUA_000336 = GetResString("CALCULATE_ITEMEFFECT_LUA_000336")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000336 )
		UseItemFailed ( role )
		return
	end
	local Item = GetChaItem2 ( role , 2 , 2998 )
	local Item_MAXURE = GetItemAttr ( Item , ITEMATTR_MAXURE )
	local Item_URE = GetItemAttr ( Item , ITEMATTR_URE )
	local Item_MAXENERGY = GetItemAttr ( Item , ITEMATTR_MAXENERGY )
	local pos_x = Item_MAXURE
	local pos_y = Item_MAXENERGY
	local Themap = Item_URE
--	SystemNotice ( role , "pos_x"..pos_x )
--	SystemNotice ( role , "pos_y"..pos_y )
--	SystemNotice ( role , "Themap"..Themap )
	
	local MapList = { }
	
	MapList [0] = "NoMap"
	MapList [1] = "garner"
	MapList [2] = "magicsea"
	MapList [3] = "darkblue"

	local MapNameList = { }
	
	CALCULATE_ITEMEFFECT_LUA_000062 = GetResString("CALCULATE_ITEMEFFECT_LUA_000062")
	MapNameList [0] = CALCULATE_ITEMEFFECT_LUA_000062
	CALCULATE_ITEMEFFECT_LUA_000063 = GetResString("CALCULATE_ITEMEFFECT_LUA_000063")
	MapNameList [1] = CALCULATE_ITEMEFFECT_LUA_000063
	CALCULATE_ITEMEFFECT_LUA_000064 = GetResString("CALCULATE_ITEMEFFECT_LUA_000064")
	MapNameList [2] = CALCULATE_ITEMEFFECT_LUA_000064
	CALCULATE_ITEMEFFECT_LUA_000065 = GetResString("CALCULATE_ITEMEFFECT_LUA_000065")
	MapNameList [3] = CALCULATE_ITEMEFFECT_LUA_000065
	if pos_x == 0 or pos_y == 0 or Themap == 0 then
		pos_x , pos_y , Themap = GetTheMapPos ( role , 1 )		
--		pos_x,pos_y,Themap = GetMapRanPos ( role )
		Item_MAXURE = pos_x
		Item_URE = Themap
		Item_MAXENERGY = pos_y
		
		SetItemAttr ( Item , ITEMATTR_MAXENERGY , Item_MAXENERGY )
		SetItemAttr ( Item , ITEMATTR_MAXURE , Item_MAXURE )
		SetItemAttr ( Item , ITEMATTR_URE , Item_URE )
--		SystemNotice ( role , "Themap"..Themap )
--		Item_MAXENERGY = GetItemAttr ( Item , ITEMATTR_MAXENERGY )
--		SystemNotice ( role , "Item_MAXENERGY"..Item_MAXENERGY )
	end
	local GetPos = CheckGetMapPos ( role , pos_x , pos_y , MapList[Themap] )
--	SystemNotice ( role , "CheckPosOver"..GetPos ) 
	if GetPos == 0 then
		CALCULATE_ITEMEFFECT_LUA_000066 = GetResString("CALCULATE_ITEMEFFECT_LUA_000066")
		CALCULATE_ITEMEFFECT_LUA_000067 = GetResString("CALCULATE_ITEMEFFECT_LUA_000067")
		CALCULATE_ITEMEFFECT_LUA_000068 = GetResString("CALCULATE_ITEMEFFECT_LUA_000068")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000068..MapNameList[Themap]..CALCULATE_ITEMEFFECT_LUA_000067..pos_x..","..pos_y..CALCULATE_ITEMEFFECT_LUA_000066 )
		UseItemFailed ( role )
		return
	elseif GetPos == 1 then
		local getrandom = math.random ( 1 , 3 )
		if getrandom==1 then
			GiveZNZItem ( role )
		else
			CALCULATE_ITEMEFFECT_LUA_000337 = GetResString("CALCULATE_ITEMEFFECT_LUA_000337")
			SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000337 )
			UseItemFailed ( role )
			return
		end
	end
end

function Sk_Script_DS	( role , Item ) 

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 1 then
		UseItemFailed ( role ) 
		CALCULATE_ITEMEFFECT_LUA_000338 = GetResString("CALCULATE_ITEMEFFECT_LUA_000338")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000338)
		return 
	end 
	local sk_add = SK_DS  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 				--学会技能
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
	
	local r1 = 0
	local r2 = 0
	r1, r2 = MakeItem ( role , 3289 , 1 , 4 )				--给学生证
	local Itemnew = GetChaItem ( role , 2 , r2 )

	SetItemAttr(Itemnew, ITEMATTR_MAXENERGY , 120)           --设置最高存储经验
	SetItemAttr(Itemnew, ITEMATTR_ENERGY , 0 )              				 --设置当前存储经验
	SetItemAttr(Itemnew, ITEMATTR_URE,0)								 --设置当前存储学分
	SetItemAttr(Itemnew, ITEMATTR_MAXURE,150)						--设置当前最大学分，该值在每次升级考试后会变化
	SetItemAttr(Itemnew, ITEMATTR_FORGE,0)								--设置学历
	
	LiveSkillLearnLog(role, 461)
end 

function ItemUse_WisdomApple( role , Item )		-------智慧果使用效果

	local Lv = Lv( role )
	if Lv < 40 then
		CALCULATE_ITEMEFFECT_LUA_000030 = GetResString("CALCULATE_ITEMEFFECT_LUA_000030")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000030)
		UseItemFailed ( role )
		return
	end

	local statelv = 1
	local ChaStateLv = GetChaStateLv ( role , STATE_APPLE )
	
	if ChaStateLv > statelv then
		CALCULATE_FUNCTIONS_LUA_000113 = GetResString("CALCULATE_FUNCTIONS_LUA_000113")
		SystemNotice ( role , CALCULATE_FUNCTIONS_LUA_000113 )
		UseItemFailed ( role )
		return
	end

	local statetime = 1800
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		AddState( role , role , STATE_APPLE , statelv , statetime )
	else
		UseItemFailed ( role )
		CALCULATE_ITEMEFFECT_LUA_000339 = GetResString("CALCULATE_ITEMEFFECT_LUA_000339")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000339)
	end
end

function ItemUse_GoldApple ( role , Item )

	local Lv = Lv( role )
	if Lv < 60 then
		CALCULATE_ITEMEFFECT_LUA_000033 = GetResString("CALCULATE_ITEMEFFECT_LUA_000033")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000033)
		UseItemFailed ( role )
		return
	end

	local statelv = 2
	local ChaStateLv = GetChaStateLv ( role , STATE_APPLE )
	
	if ChaStateLv > statelv then
		CALCULATE_FUNCTIONS_LUA_000113 = GetResString("CALCULATE_FUNCTIONS_LUA_000113")
		SystemNotice ( role , CALCULATE_FUNCTIONS_LUA_000113 )
		UseItemFailed ( role )
		return
	end

	local statetime = 1800
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		AddState( role , role , STATE_APPLE , statelv , statetime )
	else
		UseItemFailed ( role )
		CALCULATE_ITEMEFFECT_LUA_000340 = GetResString("CALCULATE_ITEMEFFECT_LUA_000340")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000340)
	end
end


--------------------------------------------嘉宾宝箱
function ItemUse_JBBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local r1,r2 =MakeItem ( role , 3078  , 1 , 4 )
	local Item_el = GetChaItem ( role , 2 , r2 )			--取新精灵道具指针

	local item_old = GetChaItem2 ( role , 2 , 3066 )

	local old_month = GetItemAttr(item_old, ITEMATTR_VAL_STA)		-------------月 	
	local old_day = GetItemAttr(item_old, ITEMATTR_VAL_STR)			-------------日  
	local old_hour = GetItemAttr(item_old, ITEMATTR_VAL_CON)			-------------时   
	local old_miniute = GetItemAttr(item_old, ITEMATTR_VAL_DEX)		-------------分   
	
	--SystemNotice ( role , "old_month=="..old_month )
	--SystemNotice ( role , "old_day=="..old_day )       
	--SystemNotice ( role , "old_hour=="..old_hour )    
	--SystemNotice ( role , "old_miniute=="..old_miniute)

	SetItemAttr(Item_el, ITEMATTR_VAL_STA, old_month )	-------------月 	
	SetItemAttr(Item_el, ITEMATTR_VAL_STR, old_day )		-------------日  
	SetItemAttr(Item_el, ITEMATTR_VAL_CON, old_hour )		-------------时 
	SetItemAttr(Item_el, ITEMATTR_VAL_DEX, old_miniute )	-------------分

	local old_month2 = GetItemAttr(Item_el, ITEMATTR_VAL_STA)		-------------月 	
	local old_day2 = GetItemAttr(Item_el, ITEMATTR_VAL_STR)			-------------日  
	local old_hour2 = GetItemAttr(Item_el, ITEMATTR_VAL_CON)			-------------时   
	local old_miniute2 = GetItemAttr(Item_el, ITEMATTR_VAL_DEX)		-------------分 

	--SystemNotice ( role , "old_month2=="..old_month2 )
	--SystemNotice ( role , "old_day2=="..old_day2 )       
	--SystemNotice ( role , "old_hour2=="..old_hour2 )    
	--SystemNotice ( role , "old_miniute2=="..old_miniute2)

	SynChaKitbag(role,13)

end


------------------浪漫烟花
function ItemUse_LMYH ( role , Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
end

------------------巨响烟花
function ItemUse_JXYH ( role , Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
end

------------------豪华烟花
function ItemUse_HHLH ( role , Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
end

---------教堂使用证书
function Jz_Script_jtsyzs (role, Item )
	
	local Now_Day = os.date("%d")
	local Now_Month = os.date("%m")
	local Now_Time = os.date("%H")
	local NowMniuteNum= os.date("%M")	
	local NowMiniuteNum= tonumber(Now_Miniute)	 	
	local NowTimeNum = tonumber(Now_Time)
	local NowDayNum = tonumber(Now_Day)
	local NowMonthNum = tonumber(Now_Month)
	local CheckDateNum = NowMonthNum * 1000000 + NowDayNum * 10000 + NowTimeNum*100+NowMniuteNum
	--SystemNotice ( role , "现在时刻"..CheckDateNum)

	local item_old = GetChaItem2 ( role , 2 , 3066 )----教堂使用证
	local old_month = GetItemAttr(item_old, ITEMATTR_VAL_STA)			
	local old_day = GetItemAttr(item_old, ITEMATTR_VAL_STR)			  
	local old_hour = GetItemAttr(item_old, ITEMATTR_VAL_CON)			 
	local old_miniute = GetItemAttr(item_old, ITEMATTR_VAL_DEX)  
	 
	local CheckBook1Num = old_month * 1000000 + old_day * 10000 + old_hour*100+old_miniute
	--SystemNotice ( role , "CheckBook1Num"..CheckBook1Num)
	local CheckBook2Num = old_month * 1000000 + old_day * 10000 + (old_hour+2)*100+old_miniute
	--SystemNotice ( role , "CheckBook2Num"..CheckBook2Num)
	
	local i = CheckBagItem(role,3066)
	local k = ChaIsBoat(role)
	if CheckDateNum >= CheckBook1Num  and CheckDateNum <= CheckBook2Num and k ==0 and  i >0 then
		 DelBagItem(role,3066,1)
		BIRTH_BIRTH_CONF_LUA_000051 = GetResString("BIRTH_BIRTH_CONF_LUA_000051")
		MoveCity(role,BIRTH_BIRTH_CONF_LUA_000051)	
	else
		CALCULATE_ITEMEFFECT_LUA_000341 = GetResString("CALCULATE_ITEMEFFECT_LUA_000341")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000341)
		UseItemFailed ( role )
	end
end

------------请柬
function Jz_Script_qj (role, Item )
	--SystemNotice ( role , "请柬请柬请柬" )
	
	local Now_Day = os.date("%d")
	local Now_Month = os.date("%m")
	local Now_Time = os.date("%H")
	--SystemNotice ( role , "娃哈哈" )
	local NowMniuteNum= os.date("%M")	-------------分
	local NowMiniuteNum= tonumber(Now_Miniute)	 	-------------分
	local NowTimeNum = tonumber(Now_Time)
	--SystemNotice ( role , "嘿嘿嘿嘿" )
	local NowDayNum = tonumber(Now_Day)
	--SystemNotice ( role , "嘻嘻嘻嘻" )
	local NowMonthNum = tonumber(Now_Month)
	--SystemNotice ( role , "呵呵呵呵" )
	local CheckDateNum = NowMonthNum * 1000000 + NowDayNum * 10000 + NowTimeNum*100+NowMniuteNum
	--SystemNotice ( role , "现在时刻"..CheckDateNum)
	--local old_type = GetItemAttr(item_old, ITEMATTR_MAXENERGY)	----------------法式教堂

	local item_old = GetChaItem2 ( role , 2 , 3078 )
	local old_month = GetItemAttr(item_old, ITEMATTR_VAL_STA)		-------------月 	
	local old_day = GetItemAttr(item_old, ITEMATTR_VAL_STR)			-------------日  
	local old_hour = GetItemAttr(item_old, ITEMATTR_VAL_CON)			-------------时 
	local old_miniute = GetItemAttr(item_old, ITEMATTR_VAL_DEX)  
	 

	local CheckBook1Num = old_month * 1000000 + old_day * 10000 + old_hour*100+old_miniute
	--SystemNotice ( role , "CheckBook1Num"..CheckBook1Num)
	local CheckBook2Num = old_month * 1000000 + old_day * 10000 + (old_hour+2)*100+old_miniute
	--SystemNotice ( role , "CheckBook2Num"..CheckBook2Num)
	
	if CheckDateNum < CheckBook1Num then
		CALCULATE_ITEMEFFECT_LUA_000342 = GetResString("CALCULATE_ITEMEFFECT_LUA_000342")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000342 )
		UseItemFailed ( role )
		return
	end
	--SystemNotice ( role , "妈妈")
	if CheckDateNum > CheckBook2Num then
		CALCULATE_ITEMEFFECT_LUA_000343 = GetResString("CALCULATE_ITEMEFFECT_LUA_000343")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000343 )
		UseItemFailed ( role )
		return
	end
	--SystemNotice ( role , "爸爸")

	local i = CheckBagItem(role,3078)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000344 = GetResString("CALCULATE_ITEMEFFECT_LUA_000344")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000344)
		UseItemFailed ( role )
		return
	end 
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3078,1)
			--if j == 1 and old_type=1 then
				--MoveCity(role,"法式教堂")
			--elseif	j == 1 and old_type=2 then
				--MoveCity(role,"中式教堂")
			if j == 1 then-------------elseif	j == 1 and old_type=3 then
				BIRTH_BIRTH_CONF_LUA_000051 = GetResString("BIRTH_BIRTH_CONF_LUA_000051")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000051)
				--SystemNotice ( role , "爷爷")
			--elseif	j == 1 and old_type=4 then
				--MoveCity(role,"地式教堂")
			end
		end
	else
		UseItemFailed ( role )
	end
	--SystemNotice ( role , "奶奶")	
end
---------------------------召唤婚礼淘气鬼
function ItemUse_FLOWER ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end

	local el = 0
	el =IsChaInRegion( role, 2 )
	if el == 1 then
		CALCULATE_ITEMEFFECT_LUA_000234 = GetResString("CALCULATE_ITEMEFFECT_LUA_000234")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000234 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	local MonsterID = 1037
	local Refresh = 7300					--重生时间，秒单位
	local life = 7200000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaLifeTime( new, life )
end


---------------------------气球游戏券
function ItemUse_QQ ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end

	local el = 0
	el =IsChaInRegion( role, 2 )
	if el == 1 then
		CALCULATE_ITEMEFFECT_LUA_000234 = GetResString("CALCULATE_ITEMEFFECT_LUA_000234")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000234 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	local MonsterID = 1036
	local Refresh = 60					--重生时间，秒单位
	local life = 7200000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaLifeTime( new, life )
end
--伊式教堂参观门票
function Jz_Script_yszs (role, Item )
	
	local Now_Week = os.date("%w")
	local Now_WeekNum = tonumber(Now_Week)
	local Now_Time = os.date("%H")
	local Now_TimeNum = tonumber(Now_Time)
	local Now_Miniute= os.date("%M")	
	local Now_Miniute= tonumber(Now_Miniute)
	local CheckDateNum = Now_WeekNum * 10000 + Now_TimeNum * 100+Now_Miniute

	if CheckDateNum < 11700  then
		CALCULATE_ITEMEFFECT_LUA_000345 = GetResString("CALCULATE_ITEMEFFECT_LUA_000345")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000345 )
		UseItemFailed ( role )
		return
	end
	
	if CheckDateNum > 11710 then
		CALCULATE_ITEMEFFECT_LUA_000346 = GetResString("CALCULATE_ITEMEFFECT_LUA_000346")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000346 )
		UseItemFailed ( role )
		return
	end

	local i = CheckBagItem(role,3024)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000344 = GetResString("CALCULATE_ITEMEFFECT_LUA_000344")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000344)
		UseItemFailed ( role )
		return
	end 
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,3024,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000051 = GetResString("BIRTH_BIRTH_CONF_LUA_000051")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000051)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end
-----------------------------红包：红包只有在（每周六\日晚18:00--22：10）打开才会有效

function ItemUse_RedBox( role , Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000347 = GetResString("CALCULATE_ITEMEFFECT_LUA_000347")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000347)
		UseItemFailed ( role )
		return
	end
	local now_week= os.date("%w")		-------------星期几（十进制） 
	local now_hour= os.date("%H")		-------------时 
	local now_miniute= os.date("%M")	-------------分
	now_week= tonumber(now_week)
	now_hour= tonumber(now_hour)		
	now_miniute= tonumber(now_miniute)
	local CheckDateNum = now_hour*100 +now_miniute
	local flag=0
      if now_week==6 or now_week==0 then
		flag=1
      end
	if 1800<=CheckDateNum and  CheckDateNum<=2210 and flag==1 then
		ItemUse_hongbaoBOX ( role , Item )
	else 
		CALCULATE_ITEMEFFECT_LUA_000278 = GetResString("CALCULATE_ITEMEFFECT_LUA_000278")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000278)
		UseItemFailed ( role )
		return
	end
end

function ItemUse_hongbaoBOX ( role , Item )
	local ChaName = GetChaDefaultName ( role )

	local el = math.random ( 1, 1000 )
	if  el>=1 and el<=5 then
		GiveItem ( role , 0 , 1012  , 1 , 4 ) -------------加纳之神        0.5
			CALCULATE_ITEMEFFECT_LUA_000348 = GetResString("CALCULATE_ITEMEFFECT_LUA_000348")
			CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
			local message =CALCULATE_ITEMEFFECT_LUA_000349 ..ChaName..CALCULATE_ITEMEFFECT_LUA_000348 
			Notice ( message )
	elseif el>=6 and el<=10 then
		GiveItem ( role , 0 , 1016  , 1 , 4 ) ---------------女神小包       0.5
			CALCULATE_ITEMEFFECT_LUA_000350 = GetResString("CALCULATE_ITEMEFFECT_LUA_000350")
			CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
			local message1 =CALCULATE_ITEMEFFECT_LUA_000349 ..ChaName..CALCULATE_ITEMEFFECT_LUA_000350 
			Notice ( message1 )
	elseif el>=11 and el<=20 then
		GiveItem ( role , 0 , 0860  , 1 , 4 ) ---------------风灵         1
			CALCULATE_ITEMEFFECT_LUA_000351 = GetResString("CALCULATE_ITEMEFFECT_LUA_000351")
			CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
			local message2 =CALCULATE_ITEMEFFECT_LUA_000349 ..ChaName..CALCULATE_ITEMEFFECT_LUA_000351 
			Notice ( message2 )
	elseif el>=21 and el<=30 then
		GiveItem ( role , 0 , 0861  , 1 , 4 ) ----------------鹰眼石     1
			CALCULATE_ITEMEFFECT_LUA_000352 = GetResString("CALCULATE_ITEMEFFECT_LUA_000352")
			CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
			local message3 =CALCULATE_ITEMEFFECT_LUA_000349 ..ChaName..CALCULATE_ITEMEFFECT_LUA_000352 
			Notice ( message3 )
	elseif el>=31 and el<40 then
		GiveItem ( role , 0 , 0862  , 1 , 4 ) ----------------岩玉       1
			CALCULATE_ITEMEFFECT_LUA_000353 = GetResString("CALCULATE_ITEMEFFECT_LUA_000353")
			CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
			local message4 =CALCULATE_ITEMEFFECT_LUA_000349 ..ChaName..CALCULATE_ITEMEFFECT_LUA_000353 
			Notice ( message4 )
	elseif el>=41 and el<=50 then
		GiveItem ( role , 0 , 0863  , 1 , 4 )-----------------炎玉       1
			CALCULATE_ITEMEFFECT_LUA_000354 = GetResString("CALCULATE_ITEMEFFECT_LUA_000354")
			CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
			local message5 =CALCULATE_ITEMEFFECT_LUA_000349 ..ChaName..CALCULATE_ITEMEFFECT_LUA_000354 
			Notice ( message5 )
	elseif el>=51 and el<=270 then
		GiveItem ( role , 0 , 855  , 99 , 4 )-----------------精灵硬币       22
	elseif el>=271 and el<=500 then
		GiveItem ( role , 0 , 0227  , 5 , 4 )-----------------初级精灵饲料    23
	elseif el>=501 and el<=750 then
		GiveItem ( role , 0 , 3096  , 3 , 4 )-----------------双倍掉料增幅器3个   25
	elseif el>=751 and el<=1000 then
		GiveItem ( role , 0 , 3094  , 3 , 4 )-----------------双倍经验增幅器3个   25
	end
end
------------------------------------------------可疑藏宝图(kokora)---------------------------------
function ItemUse_KYCBT (role, Item)

	local	sc = math.random ( 1,100 )
	if  sc <=50 then
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000355 = GetResString("CALCULATE_ITEMEFFECT_LUA_000355")
	local message1= cha_name..CALCULATE_ITEMEFFECT_LUA_000355 
		Notice ( message1 )
	else 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000355 = GetResString("CALCULATE_ITEMEFFECT_LUA_000355")
	local message2 = cha_name..CALCULATE_ITEMEFFECT_LUA_000355 
		Notice ( message2 )
	end
end
-----------------------------------------------------------kokora---------------------------------------------------------
------------------------------------------------兑换神泣宝箱(kokora)---------------------------------
function ItemUse_goddessBOX (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000356 = GetResString("CALCULATE_ITEMEFFECT_LUA_000356")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000356 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000357 = GetResString("CALCULATE_ITEMEFFECT_LUA_000357")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000357)
		UseItemFailed ( role )
		return
	end
	local	sc = math.random ( 1, 43 )
	local ItemId = 0
	
	if sc <=14 then	
		local GoodItem = {}
		GoodItem[0] = 0111                                       -------------降魔杵          获得机率14%
		GoodItem[1] = 0150                                       -------------鱼肠             获得机率14%
	
		local Good_C = math.random ( 1, 2 )-1
		ItemId = GoodItem[Good_C]
	elseif sc <=26 then		
		local GoodItem = {}
		GoodItem[0] = 0109                                       -------------如意宝杖       获得机率12%
		GoodItem[1] = 0115                                       -------------裂岩             获得机率12%
		GoodItem[2] = 0117                                       -------------飞虹             获得机率12%
		GoodItem[3] = 0119                                       -------------流星火珠       获得机率12%
	
		local Good_C = math.random ( 1, 4 )-1
		ItemId = GoodItem[Good_C]
	elseif sc <=36 then
		ItemId = 0113                                       -------------龙泉          获得机率10%
	else  local GoodItem = {}
		GoodItem[0] = 0861                                       -------------鹰眼石          获得机率7%
		GoodItem[1] = 0860                                       -------------风灵石          获得机率7%
	
		local Good_C = math.random ( 1, 2 )-1
		ItemId = GoodItem[Good_C]
	end
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	GiveItem ( role , 0 , ItemId , 1 , 94 )
	CALCULATE_ITEMEFFECT_LUA_000358 = GetResString("CALCULATE_ITEMEFFECT_LUA_000358")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	local message = CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000358..itemname  
	Notice ( message )
end
-----------------------------------------------------------kokora---------------------------------------------------------

------------------------------------------------兑换霸王宝箱(kokora)---------------------------------
function ItemUse_overlordBOX (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000359 = GetResString("CALCULATE_ITEMEFFECT_LUA_000359")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000359 )
		UseItemFailed ( role )
		return
	end
	local job = GetChaAttr( role, ATTR_JOB)				----取职业
	if job == 0 or job == 1 or job == 2 or job == 4 or job == 5 then
		CALCULATE_ITEMEFFECT_LUA_000360 = GetResString("CALCULATE_ITEMEFFECT_LUA_000360")
		SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_000360)
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000361 = GetResString("CALCULATE_ITEMEFFECT_LUA_000361")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000361)
		UseItemFailed ( role )
		return
	end

	if job == 8 then
		GiveItem ( role , 0 , 116 , 1 , 4 )
	elseif job == 9 then
		GiveItem ( role , 0 , 114 , 1 , 4 )	
	elseif job == 12 then
		local b = math.random(1,2)
		if b == 1 then
		GiveItem ( role , 0 , 118 , 1 , 4 )
		--GiveItem ( role , 0 , 861 , 1 , 94 )
		else
		GiveItem ( role , 0 , 120 , 1 , 4 )
		--GiveItem ( role , 0 , 861 , 1 , 94 )
		end
	elseif job == 13 then
		GiveItem ( role , 0 , 110 , 1 , 4 )
		--GiveItem ( role , 0 , 1012 , 1 , 94 )
	elseif job == 14 then
		GiveItem ( role , 0 , 112 , 1 , 4 )
		--GiveItem ( role , 0 , 1012 , 1 , 94 )
	elseif job == 16 then
		--GiveItem ( role , 0 , 1012 , 1 , 94 )
		GiveItem ( role , 0 , 151 , 1 , 4 )
	end
	--GiveItem ( role , 0 , 862 , 1 , 94 )
end
-----------------------------------------------------------kokora---------------------------------------------------------
function ItemUse_XiDianBook ( role , item )

	local zsskill_lv  = {} 							----取角色转生技能等级
	 zsskill_lv [0] = GetSkillLv ( role, 453 )
	 zsskill_lv [1] = GetSkillLv ( role, 454 )
	 zsskill_lv [2] = GetSkillLv ( role, 455 )
	 zsskill_lv [3] = GetSkillLv ( role, 456 )
	 zsskill_lv [4] = GetSkillLv ( role, 457 )
	 zsskill_lv [5] = GetSkillLv ( role, 458 )
	local n = 0
	local item_canget = GetChaFreeBagGridNum ( role )
	--情人节戒指技能判断---JACK
	local QLZX= GetSkillLv ( role, SK_QLZX )
	--判断结束
	if item_canget < 2 then
		CALCULATE_ITEMEFFECT_LUA_000362 = GetResString("CALCULATE_ITEMEFFECT_LUA_000362")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000362)
		UseItemFailed ( role )
	else
		for i = 0, 5, 1 do
			if zsskill_lv [i] >= 1 then
				n = n+1
			end
		end
		local cha_skill_num=GetChaAttr(role, ATTR_TP  )				----取角色当前剩余战斗技能点
		local clear_skill_num=ClearFightSkill(role)				----取清除技能点
		cha_skill_num=cha_skill_num+clear_skill_num
		if n > 0 then							----有转生技能
			local job = GetChaAttr( role, ATTR_JOB)				----取职业
			local item_id = {}
			item_id [8] = 2957
			item_id [9] = 2956
			item_id [12] = 2961
			item_id [13] = 2959
			item_id [14] = 2958
			item_id [16] = 2960
			GiveItem ( role, 0, item_id [job] , 1, 4)
			GiveItem ( role, 0, 1572, 1, 4)
			cha_skill_num = cha_skill_num - 2
		end
		--情人节戒指技能处理---JACK
		if QLZX == 1 then
			cha_skill_num = cha_skill_num - 1
			AddChaSkill ( role , SK_QLZX , 1 , 1 , 0 )
		end
		--情人节戒指技能处理结束
		SetChaAttr(role, ATTR_TP ,cha_skill_num ) 
	end
end

function Sk_Script_ZSSL( role , item )
	local sk_add = SK_ZSSL 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv >= 1  then 
		UseItemFailed ( role )  
		return 
	end 
	local zs_exp = GetChaAttr ( role , ATTR_CSAILEXP )
	if zs_exp <= 0 then
		UseItemFailed ( role )  
		return 
	end
	a = AddChaSkill ( role , sk_add, 1 , 1 , 0 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 

------------------------精灵硬币宝箱
function ItemUse_YingbiBox ( role , Item )

	local map_name_role = GetChaMapName ( role )
	if map_name_role == "darkblue" then
		local lv = GetChaAttr ( role , ATTR_LV )
		if lv >= 10 then
			local Item_CanGet = GetChaFreeBagGridNum ( role )
			if Item_CanGet < 4 then
				CALCULATE_ITEMEFFECT_LUA_000363 = GetResString("CALCULATE_ITEMEFFECT_LUA_000363")
				SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000363)
				UseItemFailed ( role )
				return
			end
			local ChaName = GetChaDefaultName(role)
			if PlayUseBox1[ChaName] == nil then
				PlayUseBox1[ChaName] = 0
			end
			local Use_Num = PlayUseBox1[ChaName]
			local now_day= os.date("%d")		-------------日   
			local now_month= os.date("%m")		-------------月
			now_month= tonumber(now_month)		-------------月     
			now_day = tonumber(now_day)		-------------日
			local Date = JNSTime_Flag[now_month]+now_day
			local Yingbi_Num = 0
			if Use_Num == 0 then
				local Time = 1
				Use_Num = Date * 10 + Time
				Yingbi_Num = 20
				local j = TakeItem ( role , 0 , 855 , Yingbi_Num )
					if j == 1 then 
						PlayUseBox1[ChaName] = Use_Num
						GiveBragiItem ( role , 1 )
						GiveItem ( role , 0 , 1872 , 1 , 4 )
					else
						UseItemFailed ( role )
						CALCULATE_ITEMEFFECT_LUA_000364 = GetResString("CALCULATE_ITEMEFFECT_LUA_000364")
						SystemNotice( role, CALCULATE_ITEMEFFECT_LUA_000364)
					end
			else
				local Date_Box = math.floor ( Use_Num / 10 )
				local a = Date - Date_Box
				local Time = Use_Num - Date_Box * 10
				--SystemNotice ( role , "a="..a)
				if a == 0 then
					Use_Num = Use_Num +1
					local time_new = Time + 1
					if time_new >= 1 and time_new <= 3 then
						Yingbi_Num = (time_new*5) + 15
						--SystemNotice ( role  , "第"..time_new.."次开箱子，花费"..Yingbi_Num.."个硬币，品质为1")
						local j = TakeItem ( role , 0 , 855 , Yingbi_Num )
						if j == 1 then
							GiveBragiItem ( role , 1 )
							PlayUseBox1[ChaName] = Use_Num
							GiveItem ( role , 0 , 1872 , 1 , 4 )
						else
							UseItemFailed ( role )
							CALCULATE_ITEMEFFECT_LUA_000364 = GetResString("CALCULATE_ITEMEFFECT_LUA_000364")
							SystemNotice( role, CALCULATE_ITEMEFFECT_LUA_000364)
						end
					elseif time_new >= 4 and time_new <= 6 then
						Yingbi_Num = Time * 15
						--SystemNotice ( role  , "第"..time_new.."次开箱子，花费"..Yingbi_Num.."个硬币，品质为2")
						local j = TakeItem ( role , 0 , 855 , Yingbi_Num )
						if j == 1 then
							GiveBragiItem ( role , 2 )
							PlayUseBox1[ChaName] = Use_Num
							GiveItem ( role , 0 , 1872 , 1 , 4 )
						else
							UseItemFailed ( role )
							CALCULATE_ITEMEFFECT_LUA_000364 = GetResString("CALCULATE_ITEMEFFECT_LUA_000364")
							SystemNotice( role, CALCULATE_ITEMEFFECT_LUA_000364)
						end
					else
						Yingbi_Num = 99
						--SystemNotice ( role  , "第"..time_new.."次开箱子，花费"..Yingbi_Num.."个硬币，品质为3")
						local j = TakeItem ( role , 0 , 855 , Yingbi_Num )
						if j == 1 then
							GiveBragiItem ( role , 3 )
							PlayUseBox1[ChaName] = Use_Num
							GiveItem ( role , 0 , 1872 , 1 , 4 )
						else
							UseItemFailed ( role )
							CALCULATE_ITEMEFFECT_LUA_000364 = GetResString("CALCULATE_ITEMEFFECT_LUA_000364")
							SystemNotice( role, CALCULATE_ITEMEFFECT_LUA_000364)
						end
					end
				elseif a == -1 then
					UseItemFailed ( role )
					CALCULATE_ITEMEFFECT_LUA_000365 = GetResString("CALCULATE_ITEMEFFECT_LUA_000365")
					SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000365)
				else
					local Time = 1
					Use_Num = Date * 10 + Time
					Yingbi_Num = 20
					--SystemNotice ( role  , "第"..Time.."开箱子，花费"..Yingbi_Num.."个硬币")
					local j = TakeItem ( role , 0 , 855 , Yingbi_Num )
					if j == 1 then
						PlayUseBox1[ChaName] = Use_Num
						GiveBragiItem ( role )
						GiveItem ( role , 0 , 1872 , 1 , 4 )
					else
						UseItemFailed ( role )
						CALCULATE_ITEMEFFECT_LUA_000364 = GetResString("CALCULATE_ITEMEFFECT_LUA_000364")
						SystemNotice( role, CALCULATE_ITEMEFFECT_LUA_000364)
					end
				end
			end
		else
			CALCULATE_ITEMEFFECT_LUA_000366 = GetResString("CALCULATE_ITEMEFFECT_LUA_000366")
			SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000366)
			UseItemFailed ( role )
		end
	else
		CALCULATE_ITEMEFFECT_LUA_000367 = GetResString("CALCULATE_ITEMEFFECT_LUA_000367")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000367)
		UseItemFailed ( role )
	end
end

------------------------------------精灵辉印宝箱
function ItemUse_HuiYinBox ( role, Item )

	local map_name_role = GetChaMapName ( role )
	if map_name_role == "darkblue" then
		local lv = GetChaAttr ( role , ATTR_LV )
		if lv >= 60 then
			local Item_CanGet = GetChaFreeBagGridNum ( role )
			if Item_CanGet < 2 then
				CALCULATE_ITEMEFFECT_LUA_000368 = GetResString("CALCULATE_ITEMEFFECT_LUA_000368")
				SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000368)
				UseItemFailed ( role )
				return
			end
			local ChaName = GetChaDefaultName(role)
			if PlayUseBox2[ChaName] == nil then
				PlayUseBox2[ChaName] = 0
			end
			local Use_Num = PlayUseBox2[ChaName]
			local now_day= os.date("%d")		-------------日   
			local now_month= os.date("%m")		-------------月
			now_month= tonumber(now_month)		-------------月     
			now_day = tonumber(now_day)		-------------日
			local Date = JNSTime_Flag[now_month]+now_day
			if Use_Num == 0 then
				local Time = 1
				Use_Num = Date * 10 + Time
				local j = TakeItem ( role , 0 , 2588 , 10 )
				if j == 1 then 
					PlayUseBox2[ChaName] = Use_Num
					GiveItem ( role , 0 , 3107 , 1 , 4 )
					GiveItem ( role , 0 , 1570 , 1 , 4 )
				else
					UseItemFailed ( role )
					CALCULATE_ITEMEFFECT_LUA_000369 = GetResString("CALCULATE_ITEMEFFECT_LUA_000369")
					SystemNotice( role, CALCULATE_ITEMEFFECT_LUA_000369)
				end
			else
				local Date_Box = math.floor ( Use_Num / 10 )
				local a = Date - Date_Box
				local Time = Use_Num - Date_Box * 10
				if a == 0 then
					local time_new = Time + 1
					if time_new == 1 then
						Use_Num = Use_Num + 1
						local j = TakeItem ( role , 0 , 2588 , 10 )
						if j == 1 then 
							PlayUseBox2[ChaName] = Use_Num
							GiveItem ( role , 0 , 3107 , 1 , 4 )
							GiveItem ( role , 0 , 1570 , 1 , 4 )
						else
							UseItemFailed ( role )
							CALCULATE_ITEMEFFECT_LUA_000369 = GetResString("CALCULATE_ITEMEFFECT_LUA_000369")
							SystemNotice( role, CALCULATE_ITEMEFFECT_LUA_000369)
						end
					elseif time_new == 2 then
						Use_Num = Use_Num + 1
						local j = TakeItem ( role , 0 , 2588 , 20 )
						if j == 1 then 
							PlayUseBox2[ChaName] = Use_Num
							XSAddExpAll ( role , 5 , 5, 2)
							GiveItem ( role , 0 , 1570 , 1 , 4 )
						else
							UseItemFailed ( role )
							CALCULATE_ITEMEFFECT_LUA_000369 = GetResString("CALCULATE_ITEMEFFECT_LUA_000369")
							SystemNotice( role, CALCULATE_ITEMEFFECT_LUA_000369)
						end
					elseif time_new == 3 then
						Use_Num = Use_Num + 1
						local j = TakeItem ( role , 0 , 2588 , 30 )
						if j == 1 then 
							PlayUseBox2[ChaName] = Use_Num
							GiveItem ( role , 0 , 850 , 1 , 4 )
							GiveItem ( role , 0 , 1570 , 1 , 4 )
						else
							UseItemFailed ( role )
							CALCULATE_ITEMEFFECT_LUA_000369 = GetResString("CALCULATE_ITEMEFFECT_LUA_000369")
							SystemNotice( role, CALCULATE_ITEMEFFECT_LUA_000369)
						end
					elseif time_new == 4 then
						Use_Num = Use_Num + 1
						local j = TakeItem ( role , 0 , 2588 , 40 )
						if j == 1 then 
							PlayUseBox2[ChaName] = Use_Num
							GiveItem ( role , 0 , 852 , 1 , 4 )
							GiveItem ( role , 0 , 1570 , 1 , 4 )
						else
							UseItemFailed ( role )
							CALCULATE_ITEMEFFECT_LUA_000369 = GetResString("CALCULATE_ITEMEFFECT_LUA_000369")
							SystemNotice( role, CALCULATE_ITEMEFFECT_LUA_000369)
						end
					elseif time_new == 5 then
						Use_Num = ( Date + 1 )*10
						local j = TakeItem ( role , 0 , 2588 , 50 )
						if j == 1 then 
							PlayUseBox2[ChaName] = Use_Num
							GiveItem ( role , 0 , 851 , 1 , 4 )
							GiveItem ( role , 0 , 1570 , 1 , 4 )
						else
							UseItemFailed ( role )
							CALCULATE_ITEMEFFECT_LUA_000369 = GetResString("CALCULATE_ITEMEFFECT_LUA_000369")
							SystemNotice( role, CALCULATE_ITEMEFFECT_LUA_000369)
						end
					end
				elseif a == -1 then
					UseItemFailed ( role )
					CALCULATE_ITEMEFFECT_LUA_000370 = GetResString("CALCULATE_ITEMEFFECT_LUA_000370")
					SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000370)
				else
					local Time = 1
					Use_Num = Date * 10 + Time
					local j = TakeItem ( role , 0 , 2588 , 10 )
					if j == 1 then
						PlayUseBox2[ChaName] = Use_Num
						GiveItem ( role , 0 , 3107 , 1 , 4 )
						GiveItem ( role , 0 , 1570 , 1 , 4 )
					else
						UseItemFailed ( role )
						CALCULATE_ITEMEFFECT_LUA_000369 = GetResString("CALCULATE_ITEMEFFECT_LUA_000369")
						SystemNotice( role, CALCULATE_ITEMEFFECT_LUA_000369)
					end
				end
			end
		else
			CALCULATE_ITEMEFFECT_LUA_000371 = GetResString("CALCULATE_ITEMEFFECT_LUA_000371")
			SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000371)
			UseItemFailed ( role )
		end
	else
		CALCULATE_ITEMEFFECT_LUA_000367 = GetResString("CALCULATE_ITEMEFFECT_LUA_000367")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000367)
		UseItemFailed ( role )
	end
end

-----------------------------精灵王辉印宝箱
function ItemUse_HuiYinKBox ( role, Item )

	local map_name_role = GetChaMapName ( role )
	if map_name_role == "darkblue" then
		local lv = GetChaAttr ( role , ATTR_LV )
		if lv >= 70 then
			local Item_CanGet = GetChaFreeBagGridNum ( role )
			if Item_CanGet < 2 then
				CALCULATE_ITEMEFFECT_LUA_000372 = GetResString("CALCULATE_ITEMEFFECT_LUA_000372")
				SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000372)
				UseItemFailed ( role )
				return
			end
			local ChaName = GetChaDefaultName(role)
			if PlayUseBox3[ChaName] == nil then
				PlayUseBox3[ChaName] = 0
			end
			local Use_Num = PlayUseBox3[ChaName]
			local now_day= os.date("%d")		-------------日   
			local now_month= os.date("%m")		-------------月
			now_month= tonumber(now_month)		-------------月     
			now_day = tonumber(now_day)		-------------日
			local Date = JNSTime_Flag[now_month]+now_day
			if Use_Num == 0 then
				local Time = 1
				Use_Num = Date * 10 + Time
				local j = TakeItem ( role , 0 , 2589 , 1 )
				if j == 1 then 
					PlayUseBox3[ChaName] = Use_Num
					AddExpAll ( role , 1 , 1, 2 )
					GiveItem ( role , 0 , 1571 , 1 , 4 )
				else
					UseItemFailed ( role )
					CALCULATE_ITEMEFFECT_LUA_000373 = GetResString("CALCULATE_ITEMEFFECT_LUA_000373")
					SystemNotice( role, CALCULATE_ITEMEFFECT_LUA_000373)
				end
			else
				local Date_Box = math.floor ( Use_Num / 10 )
				local a = Date - Date_Box
				local Time = Use_Num - Date_Box * 10
				if a == 0 then
					local time_new = Time + 1
					if time_new == 1 then
						Use_Num = Use_Num + 1
						local j = TakeItem ( role , 0 , 2589 , 1 )
						if j == 1 then 
							PlayUseBox3[ChaName] = Use_Num
							AddExpAll ( role , 1 , 1, 2 )
							GiveItem ( role , 0 , 1571 , 1 , 4 )
						else
							UseItemFailed ( role )
							CALCULATE_ITEMEFFECT_LUA_000373 = GetResString("CALCULATE_ITEMEFFECT_LUA_000373")
							SystemNotice( role, CALCULATE_ITEMEFFECT_LUA_000373)
						end
					elseif time_new == 2 then
						Use_Num = ( Date + 1 ) * 10
						local j = TakeItem ( role ,  0 , 2589 , 2 )
						if j == 1 then 
							PlayUseBox3[ChaName] = Use_Num
							GiveItem ( role , 0 , 3336 , 1 , 4 )
							GiveItem ( role , 0 , 1571 , 1 , 4 )
						else
							UseItemFailed ( role )
							CALCULATE_ITEMEFFECT_LUA_000373 = GetResString("CALCULATE_ITEMEFFECT_LUA_000373")
							SystemNotice( role, CALCULATE_ITEMEFFECT_LUA_000373)
						end
					end
				elseif a == -1 then
					UseItemFailed ( role )
					CALCULATE_ITEMEFFECT_LUA_000374 = GetResString("CALCULATE_ITEMEFFECT_LUA_000374")
					SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000374)
				else
					local Time = 1
					Use_Num = Date * 10 + Time
					local j = TakeItem ( role , 0 , 2589 , 1 )
					if j == 1 then
						PlayUseBox3[ChaName] = Use_Num
						AddExpAll ( role , 1, 1, 2 )
						GiveItem ( role , 0 , 1571 , 1 , 4 )
					else
						UseItemFailed ( role )
						CALCULATE_ITEMEFFECT_LUA_000373 = GetResString("CALCULATE_ITEMEFFECT_LUA_000373")
						SystemNotice( role, CALCULATE_ITEMEFFECT_LUA_000373)
					end
				end
			end
		else
			CALCULATE_ITEMEFFECT_LUA_000375 = GetResString("CALCULATE_ITEMEFFECT_LUA_000375")
			SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000375)
			UseItemFailed ( role )
		end
	else
		CALCULATE_ITEMEFFECT_LUA_000367 = GetResString("CALCULATE_ITEMEFFECT_LUA_000367")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000367)
		UseItemFailed ( role )
	end
end


------------------------黑匣子
function ItemUse_BACKBOX ( role , Item )

	local Cha_Boat = 0
	local charLv=Lv ( role )
	local Exp_star=GetChaAttr (  role , ATTR_CEXP )----------当前等级经验
	local dif_exp_thalf = (DEXP[charLv+1] - DEXP[charLv])*0.15  +  Exp_star + 10
	local dif_exp_thalf_a = (DEXP[charLv+1] - DEXP[charLv])*0.12  +  Exp_star + 10
	local dif_exp_thalf_b = (DEXP[charLv+1] - DEXP[charLv])*0.08  +  Exp_star + 10
	local dif_exp_thalf_c = (DEXP[charLv+1] - DEXP[charLv])*0.05+Exp_star+ 10

	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	if charLv>=100 then
		CALCULATE_ITEMEFFECT_LUA_000376 = GetResString("CALCULATE_ITEMEFFECT_LUA_000376")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000376 )
		UseItemFailed ( role )
		return
	end
	local el = math.random ( 1, 100 )
	if  el>=1 and el<=40 then
		SetChaAttrI( role , ATTR_CEXP , dif_exp_thalf_c )
	elseif el>=41 and el<=70 then
		SetChaAttrI( role , ATTR_CEXP , dif_exp_thalf_b )
	elseif el>=71 and el<=90 then
		SetChaAttrI( role , ATTR_CEXP , dif_exp_thalf_a )
	elseif el>=91 and el<=100 then
		SetChaAttrI( role , ATTR_CEXP , dif_exp_thalf )
        end
end
----------------经验瓶礼包
function ItemUse_jyplb( role , item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000377 = GetResString("CALCULATE_ITEMEFFECT_LUA_000377")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000377)
		UseItemFailed ( role )
		return
	end
	local r1 = 0
	local r2 = 0
	r1,r2 =MakeItem ( role , 171  , 1 , 4 )
	local Item = GetChaItem ( role , 2 , r2 )
	SetItemAttr(Item, ITEMATTR_VAL_PARAM1, 0 )		-------------秒  
	SynChaKitbag(role,13)
end

---------------------------幻之证明（kokora）浩方版本专用
function ItemUse_fancyprove ( role , Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000378 = GetResString("CALCULATE_ITEMEFFECT_LUA_000378")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000378 )
		UseItemFailed ( role )
		return
	end
	 local cha_name = GetChaDefaultName ( role )
	 local lv = GetChaAttr ( role , ATTR_LV )
	 if lv>=20 and lv<=54 then
		SetChaAttrI(role, ATTR_CEXP , 19674240)		
	 CALCULATE_ITEMEFFECT_LUA_000379 = GetResString("CALCULATE_ITEMEFFECT_LUA_000379")
	 CALCULATE_ITEMEFFECT_LUA_000380 = GetResString("CALCULATE_ITEMEFFECT_LUA_000380")
	 CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	 local message = CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000380..lv ..CALCULATE_ITEMEFFECT_LUA_000379 
		Notice ( message )
	 else 
		CALCULATE_ITEMEFFECT_LUA_000381 = GetResString("CALCULATE_ITEMEFFECT_LUA_000381")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000381 )
		UseItemFailed ( role )
	end
	return
end

---------------------------超人宝箱（kokora）浩方版本专用
function ItemUse_superBOX ( role , Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000382 = GetResString("CALCULATE_ITEMEFFECT_LUA_000382")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000382 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000383 = GetResString("CALCULATE_ITEMEFFECT_LUA_000383")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000383)
		UseItemFailed ( role )
		return
	end
	local cha_name = GetChaDefaultName ( role ) 
	local lv = GetChaAttr ( role , ATTR_LV )	
	if lv>=70 then
	GiveItem ( role , 0 , 996 , 1 , 4 )
	CALCULATE_ITEMEFFECT_LUA_000384 = GetResString("CALCULATE_ITEMEFFECT_LUA_000384")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	local message = CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000384
	Notice ( message )
	 else 
		CALCULATE_ITEMEFFECT_LUA_000385 = GetResString("CALCULATE_ITEMEFFECT_LUA_000385")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000385 )
		UseItemFailed ( role )
	end
	return
end

---------------------------超人证明（kokora）浩方版本专用
function ItemUse_superprove ( role , Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000386 = GetResString("CALCULATE_ITEMEFFECT_LUA_000386")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000386 )
		UseItemFailed ( role )
		return
	end
	 local cha_name = GetChaDefaultName ( role ) 
	 local lv = GetChaAttr ( role , ATTR_LV )	
	 if lv>=55 and lv<=59 then
		SetChaAttrI(role, ATTR_CEXP , 37746418)
	 CALCULATE_ITEMEFFECT_LUA_000387 = GetResString("CALCULATE_ITEMEFFECT_LUA_000387")
	 CALCULATE_ITEMEFFECT_LUA_000388 = GetResString("CALCULATE_ITEMEFFECT_LUA_000388")
	 CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	 local message = CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000388..lv ..CALCULATE_ITEMEFFECT_LUA_000387 
		Notice ( message )
	 else 
		CALCULATE_ITEMEFFECT_LUA_000389 = GetResString("CALCULATE_ITEMEFFECT_LUA_000389")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000389 )
		UseItemFailed ( role )
	end
	return
end

---------------------------谜之证明（kokora）浩方版本专用
function ItemUse_riddleprove ( role , Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000390 = GetResString("CALCULATE_ITEMEFFECT_LUA_000390")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000390 )
		UseItemFailed ( role )
		return
	end
	local i= CheckBagItem( role, 3849 )                                                
	if i~=1 then
		CALCULATE_ITEMEFFECT_LUA_000391 = GetResString("CALCULATE_ITEMEFFECT_LUA_000391")
		SystemNotice(  role , CALCULATE_ITEMEFFECT_LUA_000391)
		UseItemFailed ( role )
		return LUA_FALSE
	end

	local credit = GetChaItem2 ( role , 2 , 3849 )
	local creditprove = GetItemAttr (credit , ITEMATTR_VAL_STR)
	if creditprove < 100 then
		CALCULATE_ITEMEFFECT_LUA_000392 = GetResString("CALCULATE_ITEMEFFECT_LUA_000392")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000392 )
		UseItemFailed ( role )
		return LUA_FALSE
	end

	local meleeprove = GetItemAttr (credit , ITEMATTR_MAXENERGY)	
	if meleeprove < 11 then
		CALCULATE_ITEMEFFECT_LUA_000393 = GetResString("CALCULATE_ITEMEFFECT_LUA_000393")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000393 )
		UseItemFailed ( role )
		return LUA_FALSE
	end
															
	 local cha_name = GetChaDefaultName ( role ) 
	 local lv = GetChaAttr ( role , ATTR_LV )	
	 if lv>=60 and lv<=64 then
		SetChaAttrI(role, ATTR_CEXP , 116688304)
	 CALCULATE_ITEMEFFECT_LUA_000394 = GetResString("CALCULATE_ITEMEFFECT_LUA_000394")
	 CALCULATE_ITEMEFFECT_LUA_000395 = GetResString("CALCULATE_ITEMEFFECT_LUA_000395")
	 CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	 local message = CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000395..lv ..CALCULATE_ITEMEFFECT_LUA_000394 
		Notice ( message )
	 else 
		CALCULATE_ITEMEFFECT_LUA_000396 = GetResString("CALCULATE_ITEMEFFECT_LUA_000396")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000396 )
		UseItemFailed ( role )
	end
	return 
end

---------------------------谜之助推器（kokora）浩方版本专用(对statelv进行过重新调整)
function ItemUse_riddleroll ( role , Item )

	local lv= GetChaAttr(role, ATTR_LV) 
	if lv < 65 or lv > 75  then
		CALCULATE_ITEMEFFECT_LUA_000397 = GetResString("CALCULATE_ITEMEFFECT_LUA_000397")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000397 )
		UseItemFailed ( role )
		return	
	end

	local statelv = 9
	local statetime = 1800
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ==  nil then
		local ret = UseAexpItem(role,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	else
		local ret = UseAexpItem(Cha_Boat,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	end
	CALCULATE_ITEMEFFECT_LUA_000398 = GetResString("CALCULATE_ITEMEFFECT_LUA_000398")
	SystemNotice ( role ,CALCULATE_ITEMEFFECT_LUA_000398 )
end

------------------------------------------------兑换百慕大宝箱(kokora)---------------------------------
function ItemUse_baimodabox (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000399 = GetResString("CALCULATE_ITEMEFFECT_LUA_000399")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000399 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000400 = GetResString("CALCULATE_ITEMEFFECT_LUA_000400")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000400)
		UseItemFailed ( role )
		return
	end
	local	sc = math.random ( 1, 100 )
	
	if  sc <=25 then	
		GiveItem ( role , 0 , 1036 , 50 , 4 )                    ---------------魔幻女神卡   获得机率25%
	elseif sc <=50 then		
		GiveItem ( role , 0 , 0578 , 99 , 4 )                    ---------------精灵加速成长果   获得机率25%
	elseif sc <=75 then
		GiveItem ( role , 0 , 0850 , 99 , 4 )                    ---------------轻装药水   获得机率25%
	else   
		GiveItem ( role , 0 , 0852 , 99 , 4 )                    ---------------全身装甲   获得机率25%
	end
end

------------------------------------------------寂寞深处召唤券(kokora)---------------------------------
function ItemUse_monsterbec (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local sc = 0
	sc =IsChaInRegion( role, 2 )
	if sc == 1 then
		CALCULATE_ITEMEFFECT_LUA_000401 = GetResString("CALCULATE_ITEMEFFECT_LUA_000401")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000401 )
		UseItemFailed ( role )
		return
	end

	local Monsterattr = {533,509,531,534,550,557,553,559,50,50}
	local	sc = math.random(1,10)
	local x, y = GetChaPos( role )
	local Refresh = 3700				--重生时间，秒单位
	local life = 3600000					--生命时间，毫秒单位
	local new = CreateChaX( Monsterattr[sc] , x , y , 145 ,  Refresh, role )
	SetChaLifeTime( new, life )
end

------------------------------------------------废灵召唤券(kokora)---------------------------------
function ItemUse_bierbec (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local sc = 0
	sc =IsChaInRegion( role, 2 )
	if sc == 1 then
		CALCULATE_ITEMEFFECT_LUA_000401 = GetResString("CALCULATE_ITEMEFFECT_LUA_000401")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000401 )
		UseItemFailed ( role )
		return
	end
	local Monsterattr = {687,686}
	local	sc = math.random(1,2)
	local x, y = GetChaPos( role )
	local Refresh = 3700				--重生时间，秒单位
	local life = 3600000					--生命时间，毫秒单位
	local new = CreateChaX( Monsterattr[sc] , x , y , 145 ,  Refresh, role )
	SetChaLifeTime( new, life )
end

------------------------------------------------寂寞召唤券(kokora)---------------------------------
function ItemUse_loneybec (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local sc = 0
	sc =IsChaInRegion( role, 2 )
	if sc == 1 then
		CALCULATE_ITEMEFFECT_LUA_000401 = GetResString("CALCULATE_ITEMEFFECT_LUA_000401")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000401 )
		UseItemFailed ( role )
		return
	end

	local Monsterattr = {523,524,525,36,526,527,529,35,532,532}
	local	sc = math.random(1,10)
	local x, y = GetChaPos( role )
	local Refresh = 3700				--重生时间，秒单位
	local life = 3600000					--生命时间，毫秒单位
	local new = CreateChaX( Monsterattr[sc] , x , y , 145 ,  Refresh, role )
	SetChaLifeTime( new, life )
end

------------------------------------------------------圣诞情人烟花
function ItemUse_XmasQRYH ( role , Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000402 = GetResString("CALCULATE_ITEMEFFECT_LUA_000402")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000402)
		UseItemFailed ( role )
		return
	end

	local Now_Day = os.date("%d")
	local Now_Month = os.date("%m")
	local Now_Time = os.date("%H")
	local Now_Year = os.date("%y")
	local NowTimeNum = tonumber(Now_Time)
	local NowDayNum = tonumber(Now_Day)
	local NowMonthNum = tonumber(Now_Month)
	local NowYearNum = tonumber(Now_Year)
	local CheckDateNum = NowYearNum * 1000000 + NowMonthNum * 10000 + NowDayNum * 100 + NowTimeNum

	

	if CheckDateNum >= 8122200 and CheckDateNum <= 9010923 then
		
		local el = math.random ( 1 , 5 )
		local Item_ID = 0
		if el == 1 then
			Item_ID = 3354
		elseif el == 2 then
			Item_ID = 3355
		elseif el == 3 then
			Item_ID = 3356
		elseif el == 4 then
			Item_ID = 3077
		else
			Item_ID = 3343
		end
		GiveItem ( role , 0 , Item_ID , 1 , 4 )
	else
		CALCULATE_ITEMEFFECT_LUA_000403 = GetResString("CALCULATE_ITEMEFFECT_LUA_000403")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000403)
		UseItemFailed ( role )
		return
	end
end

---------------------------------------------------------圣诞狂欢烟花
function ItemUse_XmasKHYH ( role, Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000402 = GetResString("CALCULATE_ITEMEFFECT_LUA_000402")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000402)
		UseItemFailed ( role )
		return
	end
	local Now_Day = os.date("%d")
	local Now_Month = os.date("%m")
	local Now_Time = os.date("%H")
	local Now_Year = os.date("%y")
	local NowTimeNum = tonumber(Now_Time)
	local NowDayNum = tonumber(Now_Day)
	local NowMonthNum = tonumber(Now_Month)
	local NowYearNum = tonumber(Now_Year)
	local CheckDateNum = NowYearNum * 1000000 + NowMonthNum * 10000 + NowDayNum * 100 + NowTimeNum

	

	if CheckDateNum >= 8122200 and CheckDateNum <= 9010923 then

		local el = math.random ( 1 , 100 )
		local Item_ID = 0
		if el >= 1 and el <= 67 then
			Item_ID = 2891
		elseif el >67 and el <= 87 then
			Item_ID = 1019
		elseif el > 87 and el <= 97 then
			Item_ID = 1036
		elseif el == 98 then
			Item_ID = 1870
		elseif el == 99 then
			Item_ID = 5936
		else
			Item_ID = 6294
		end
		GiveItem ( role , 0 , Item_ID , 1 , 4 )
	else
		CALCULATE_ITEMEFFECT_LUA_000403 = GetResString("CALCULATE_ITEMEFFECT_LUA_000403")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000403)
		UseItemFailed ( role )
		return
	end
end

------------------------------------------圣诞老人表情烟花
function ItemUse_SDLRYH ( role , Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000402 = GetResString("CALCULATE_ITEMEFFECT_LUA_000402")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000402)
		UseItemFailed ( role )
		return
	end
	local Now_Day = os.date("%d")
	local Now_Month = os.date("%m")
	local Now_Time = os.date("%H")
	local Now_Year = os.date("%y")
	local NowTimeNum = tonumber(Now_Time)
	local NowDayNum = tonumber(Now_Day)
	local NowMonthNum = tonumber(Now_Month)
	local NowYearNum = tonumber(Now_Year)
	local CheckDateNum = NowYearNum * 1000000 + NowMonthNum * 10000 + NowDayNum * 100 + NowTimeNum

	

	if CheckDateNum >= 8122200 and CheckDateNum <= 9010923 then

		local cha_name = GetChaDefaultName ( role ) 
		local el = math.random ( 1 , 1000 )
		local Item_ID = 0
		local Item_Num = 0
		if el >= 1 and el <= 500 then
			Item_ID = 227
			Item_Num = 5
		elseif el == 501 then
			Item_ID = 1014
			Item_Num = 1
		else
			Item_ID = 3834
			Item_Num = 5
		end
		GiveItem ( role , 0 , Item_ID , Item_Num , 4 )
		CALCULATE_ITEMEFFECT_LUA_000404 = GetResString("CALCULATE_ITEMEFFECT_LUA_000404")
		ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_000404,1)
	else
		CALCULATE_ITEMEFFECT_LUA_000403 = GetResString("CALCULATE_ITEMEFFECT_LUA_000403")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000403)
		UseItemFailed ( role )
		return
	end
end

-------------------------------------merry christmas烟花
function ItemUse_MCYH ( role , Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000402 = GetResString("CALCULATE_ITEMEFFECT_LUA_000402")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000402)
		UseItemFailed ( role )
		return
	end
	local Now_Day = os.date("%d")
	local Now_Month = os.date("%m")
	local Now_Time = os.date("%H")
	local Now_Year = os.date("%y")
	local NowTimeNum = tonumber(Now_Time)
	local NowDayNum = tonumber(Now_Day)
	local NowMonthNum = tonumber(Now_Month)
	local NowYearNum = tonumber(Now_Year)
	local CheckDateNum = NowYearNum * 1000000 + NowMonthNum * 10000 + NowDayNum * 100 + NowTimeNum

	

	if CheckDateNum >= 8122200 and CheckDateNum <= 9010923 then

		local cha_name = GetChaDefaultName ( role ) 
		local el = math.random ( 1 , 100 )
		local Item_ID = 0
		local Item_Num = 0
		if el >= 1 and el <= 25 then
			Item_ID = 2891
			Item_Num = 2
		elseif el > 26 and el <= 50 then
			Item_ID = 2896
			Item_Num = 5
		elseif el > 51 and el <= 61 then
			Item_ID = 3105
			Item_Num = 4
		else
			Item_ID = 3909
			Item_Num = 3
		end
		GiveItem ( role , 0 , Item_ID , Item_Num , 4 )
		CALCULATE_ITEMEFFECT_LUA_000405 = GetResString("CALCULATE_ITEMEFFECT_LUA_000405")
		ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_000405,1)
	else
		CALCULATE_ITEMEFFECT_LUA_000403 = GetResString("CALCULATE_ITEMEFFECT_LUA_000403")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000403)
		UseItemFailed ( role )
		return
	end
end

-----------------------------------------------Happy NewYear烟花
function ItemUse_HNYH ( role , Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000402 = GetResString("CALCULATE_ITEMEFFECT_LUA_000402")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000402)
		UseItemFailed ( role )
		return
	end
	local Now_Day = os.date("%d")
	local Now_Month = os.date("%m")
	local Now_Time = os.date("%H")
	local Now_Year = os.date("%y")
	local NowTimeNum = tonumber(Now_Time)
	local NowDayNum = tonumber(Now_Day)
	local NowMonthNum = tonumber(Now_Month)
	local NowYearNum = tonumber(Now_Year)
	local CheckDateNum = NowYearNum * 1000000 + NowMonthNum * 10000 + NowDayNum * 100 + NowTimeNum

	

	if CheckDateNum >= 8122200 and CheckDateNum <= 9010923 then

		local cha_name = GetChaDefaultName ( role ) 
		local el = math.random ( 1 , 100 )
		local Item_ID = 0
		local Item_Num = 0
		if el >= 1 and el <= 25 then
			Item_ID = 2889
			Item_Num = 2
		elseif el > 26 and el <= 50 then
			Item_ID = 2896
			Item_Num = 4
		elseif el > 51 and el <= 90 then
			Item_ID = 2890
			Item_Num = 5
		else
			Item_ID = 3909
			Item_Num = 1
		end
		GiveItem ( role , 0 , Item_ID , Item_Num , 4 )
		CALCULATE_ITEMEFFECT_LUA_000406 = GetResString("CALCULATE_ITEMEFFECT_LUA_000406")
		ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_000406,1)
	else
		CALCULATE_ITEMEFFECT_LUA_000403 = GetResString("CALCULATE_ITEMEFFECT_LUA_000403")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000403)
		UseItemFailed ( role )
		return
	end
end

--------------------------------------------------圣诞彩袜烟花
function ItemUse_XRBQYH ( role , Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000402 = GetResString("CALCULATE_ITEMEFFECT_LUA_000402")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000402)
		UseItemFailed ( role )
		return
	end

	local Now_Day = os.date("%d")
	local Now_Month = os.date("%m")
	local Now_Time = os.date("%H")
	local Now_Year = os.date("%y")
	local NowTimeNum = tonumber(Now_Time)
	local NowDayNum = tonumber(Now_Day)
	local NowMonthNum = tonumber(Now_Month)
	local NowYearNum = tonumber(Now_Year)
	local CheckDateNum = NowYearNum * 1000000 + NowMonthNum * 10000 + NowDayNum * 100 + NowTimeNum

	

	if CheckDateNum >= 8122200 and CheckDateNum <= 9010923 then

		local el = math.random ( 1 , 100 )
		local Item_ID = 0
		local Item_Num = 0
		if el >= 1 and el <= 50 then
			Item_ID = 3098
			Item_Num = 25
		elseif el == 51 then
			Item_ID = 578
			Item_Num = 3
		elseif el > 51 and el <= 81 then
			Item_ID = 3152
			Item_Num = 15
		elseif el > 81 and el <= 91 then
			Item_ID = 3105
			Item_Num = 10
		else
			Item_ID = 3107
			Item_Num = 5
		end
		GiveItem ( role , 0 , Item_ID , Item_Num , 4 )
	else
		CALCULATE_ITEMEFFECT_LUA_000403 = GetResString("CALCULATE_ITEMEFFECT_LUA_000403")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000403)
		UseItemFailed ( role )
		return
	end
end

--------------------------------------------------圣诞雪橇烟花
function ItemUse_MLBQYH ( role , Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000402 = GetResString("CALCULATE_ITEMEFFECT_LUA_000402")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000402)
		UseItemFailed ( role )
		return
	end

	local Now_Day = os.date("%d")
	local Now_Month = os.date("%m")
	local Now_Time = os.date("%H")
	local Now_Year = os.date("%y")
	local NowTimeNum = tonumber(Now_Time)
	local NowDayNum = tonumber(Now_Day)
	local NowMonthNum = tonumber(Now_Month)
	local NowYearNum = tonumber(Now_Year)
	local CheckDateNum = NowYearNum * 1000000 + NowMonthNum * 10000 + NowDayNum * 100 + NowTimeNum

	

	if CheckDateNum >= 8122200 and CheckDateNum <= 9010923 then

		local el = math.random ( 1 , 1000 )
		local Item_ID = 0
		local Item_Num = 0
		if el >= 1 and el <= 400 then
			Item_ID = 2889
			Item_Num = 15
		elseif el >= 401 and el <= 789 then
			Item_ID = 2890
			Item_Num = 1
		elseif el >= 790 and el <= 839 then
			Item_ID = math.random ( 276 , 280 )
			Item_Num = 1
		elseif el > 840 and el <= 999 then
			Item_ID = 578
			Item_Num = 5
		else
			Item_ID = 333
			Item_Num = 1
		end
		GiveItem ( role , 0 , Item_ID , Item_Num , 4 )
	else
		CALCULATE_ITEMEFFECT_LUA_000403 = GetResString("CALCULATE_ITEMEFFECT_LUA_000403")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000403)
		UseItemFailed ( role )
		return
	end
end

--------------------------------------------------圣诞老人的馈赠
function ItemUse_SDLRKZ ( role , Item )

	local Item_ID = {}
	local Item_Num = {}
	local Item_PZ = {}
	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 3 then
		CALCULATE_ITEMEFFECT_LUA_000047 = GetResString("CALCULATE_ITEMEFFECT_LUA_000047")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000047)
		UseItemFailed ( role )
		return
	end
	local role_job = GetChaAttr ( role, ATTR_JOB)
	if role_job == 0 or role_job == 1 or role_job == 2 or role_job == 4 or role_job == 5 then
		CALCULATE_ITEMEFFECT_LUA_000407 = GetResString("CALCULATE_ITEMEFFECT_LUA_000407")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000407 )
		UseItemFailed ( role )
		return
	end
	local role_type = GetChaTypeID ( role )
	local a = math.random ( 1, 1000)
	if a >= 0 and a <= 300 then
		Item_ID[1] = 2872
		Item_Num[1] = 5
		Item_PZ[1] = 4
	elseif a >= 301 and a <= 600 then
		Item_ID[1] = 2873
		Item_Num [1]= 5
		Item_PZ[1] = 4
	elseif a >= 601 and a <= 650 then
		if role_type == 1 then
			Item_ID[1] = 5264
			Item_ID[2] = 5265
			Item_ID[3] = 5266
			Item_Num[1] = 1
			Item_Num[2] = 1
			Item_Num[3] = 1
			Item_PZ[1] = 4
			Item_PZ[2] = 4
			Item_PZ[3] = 4
		elseif role_type == 2 then
			Item_ID[1] = 5267
			Item_ID[2] = 5268
			Item_ID[3] = 5269
			Item_Num[1] = 1
			Item_Num[2] = 1
			Item_Num[3] = 1
			Item_PZ[1] = 4
			Item_PZ[2] = 4
			Item_PZ[3] = 4
		elseif role_type == 3 then
			Item_ID[1] = 5270
			Item_ID[2] = 5271
			Item_ID[3] = 5272
			Item_Num[1] = 1
			Item_Num[2] = 1
			Item_Num[3] = 1
			Item_PZ[1] = 4
			Item_PZ[2] = 4
			Item_PZ[3] = 4
		elseif role_type == 4 then
			Item_ID[1] = 5273
			Item_ID[2] = 5274
			Item_ID[3] = 5275
			Item_Num[1] = 1
			Item_Num[2] = 1
			Item_Num[3] = 1
			Item_PZ[1] = 4
			Item_PZ[2] = 4
			Item_PZ[3] = 4
		end
	elseif a >= 651 and a <= 700 then
		if role_job == 8 then
			Item_ID[1] = 1375
			Item_Num[1] = 1
			Item_PZ[1] = 22
		elseif role_job == 9 then
			Item_ID[1] = 1394
			Item_Num[1] = 1
			Item_PZ[1] = 22
		elseif role_job == 12 then
			Item_ID[1] = 42
			Item_Num[1] = 1
			Item_PZ[1] = 22
		elseif role_job == 13 then
			Item_ID[1] = 4198
			Item_Num[1] = 1
			Item_PZ[1] = 22
		elseif role_job == 14 then
			Item_ID[1] = 4204
			Item_Num[1] = 1
			Item_PZ[1] = 22
		elseif role_job == 16 then
			Item_ID[1] = 1421
			Item_Num[1] = 1
			Item_PZ[1] = 22
		end
	elseif a >= 701 and a <= 750 then
			Item_ID[1] = 2888
			Item_Num[1] = 3
			Item_PZ[1] = 4
	elseif a >= 751 and a <= 800 then
			Item_ID[1] = 2889
			Item_Num[1] = 3
			Item_PZ[1] = 4
	elseif a >= 801 and a <= 850 then
			Item_ID[1] = 2890
			Item_Num[1] = 3
			Item_PZ[1] = 4
	elseif a >= 851 and a <= 900 then
			Item_ID[1] = 2891
			Item_Num[1] = 3
			Item_PZ[1] = 4
	elseif a >= 901 and a <= 950 then
		if role_job == 8 then
			Item_ID[1] = 4148
			Item_Num[1] = 1
			Item_PZ[1] = 22
		elseif role_job == 9 then
			Item_ID[1] = 4150
			Item_Num[1] = 1
			Item_PZ[1] = 22
		elseif role_job == 12 then
			Item_ID[1] = 4152
			Item_Num[1] = 1
			Item_PZ[1] = 22
		elseif role_job == 13 then
			if role_type == 3 then
				Item_ID[1] = 4159
				Item_Num[1] = 1
				Item_PZ[1] = 22
			else
				Item_ID[1] = 4160
				Item_Num[1] = 1
				Item_PZ[1] = 22
			end
		elseif role_job == 14 then
			if role_type == 4 then
				Item_ID[1] = 4164
				Item_Num[1] = 1
				Item_PZ[1] = 22
			else
				Item_ID[1] = 4163
				Item_Num[1] = 1
				Item_PZ[1] = 22
			end
		elseif role_job == 16 then
			if role_type == 4 then
				Item_ID[1] = 4156
				Item_Num[1] = 1
				Item_PZ[1] = 22
			else
				Item_ID[1] = 4155
				Item_Num[1] = 1
				Item_PZ[1] = 22
			end
		end
	elseif a >= 951 and a <= 975 then
		if role_job == 8 then
			Item_ID[1] = 653
			Item_Num[1] = 1
			Item_PZ[1] = 22
		elseif role_job == 9 then
			Item_ID[1] = 4182
			Item_Num[1] = 1
			Item_PZ[1] = 22
		elseif role_job == 12 then
			Item_ID[1] = 4184
			Item_Num[1] = 1
			Item_PZ[1] = 22
		elseif role_job == 13 then
			if role_type == 3 then
				Item_ID[1] = 4191
				Item_Num[1] = 1
				Item_PZ[1] = 22
			else
				Item_ID[1] = 4192
				Item_Num[1] = 1
				Item_PZ[1] = 22
			end
		elseif role_job == 14 then
			if role_type == 4 then
				Item_ID[1] = 4196
				Item_Num[1] = 1
				Item_PZ[1] = 22
			else
				Item_ID[1] = 4195
				Item_Num[1] = 1
				Item_PZ[1] = 22
			end
		elseif role_job == 16 then
			if role_type == 4 then
				Item_ID[1] = 4188
				Item_Num[1] = 1
				Item_PZ[1] = 22
			else
				Item_ID[1] = 4187
				Item_Num[1] = 1
				Item_PZ[1] = 22
			end
		end
	else
		if role_job == 8 then
			Item_ID[1] = 477
			Item_Num[1] = 1
			Item_PZ[1] = 22
		elseif role_job == 9 then
			Item_ID[1] = 4166
			Item_Num[1] = 1
			Item_PZ[1] = 22
		elseif role_job == 12 then
			Item_ID[1] = 4168
			Item_Num[1] = 1
			Item_PZ[1] = 22
		elseif role_job == 13 then
			if role_type == 3 then
				Item_ID[1] = 4175
				Item_Num[1] = 1
				Item_PZ[1] = 22
			else
				Item_ID[1] = 4176
				Item_Num[1] = 1
				Item_PZ[1] = 22
			end
		elseif role_job == 14 then
			if role_type == 4 then
				Item_ID[1] = 4180
				Item_Num[1] = 1
				Item_PZ[1] = 22
			else
				Item_ID[1] = 4179
				Item_Num[1] = 1
				Item_PZ[1] = 22
			end
		elseif role_job == 16 then
			if role_type == 4 then
				Item_ID[1] = 4172
				Item_Num[1] = 1
				Item_PZ[1] = 22
			else
				Item_ID[1] = 4171
				Item_Num[1] = 1
				Item_PZ[1] = 22
			end
		end
	end
	for i = 1, 3, 1 do
		if Item_ID[i] ~= nil and Item_Num[i] ~= nil and Item_PZ[i] ~= nil then
			GiveItem ( role , 0 , Item_ID[i] , Item_Num[i] , Item_PZ[i] )
		end
	end
end

-------------------------------------圣诞礼包
function ItemUse_XmasLB ( role, Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000402 = GetResString("CALCULATE_ITEMEFFECT_LUA_000402")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000402)
		UseItemFailed ( role )
		return
	end

--	local Now_Day = os.date("%d")
--	local Now_Month = os.date("%m")
--	local Now_Time = os.date("%H")
--	local Now_Year = os.date("%y")
--	local NowTimeNum = tonumber(Now_Time)
--	local NowDayNum = tonumber(Now_Day)
--	local NowMonthNum = tonumber(Now_Month)
--	local NowYearNum = tonumber(Now_Year)
--	local CheckDateNum = NowYearNum * 1000000 + NowMonthNum * 10000 + NowDayNum * 100 + NowTimeNum

	

--	if CheckDateNum >= 8122200 and CheckDateNum <= 9010923 then
		local br = math.random( 1, 20)
		local Item_ID = 0
		local Item_Num = 0
		if br >= 1 and br <= 6 then
			Item_ID = 3343
			Item_Num = 10
		elseif br >= 7 and br <= 12 then
			Item_ID = 3344
			Item_Num = 10
		elseif br >= 13 and br <= 18 then
			Item_ID = 2883
			Item_Num = 5
		elseif br == 19  then
			Item_ID = 3895
			Item_Num = 1
		else
			Item_ID = 3898
			Item_Num = 1
		end
		GiveItem ( role , 0 , Item_ID , Item_Num , 4 )
--	else
--		SystemNotice(role ,"圣诞已经过了喔")
--		UseItemFailed ( role )
--		return
--	end
end

--------------------------------------圣诞机票
function ItemUse_movexmas ( role , Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )
	if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	local Now_Day = os.date("%d")
	local Now_Month = os.date("%m")
	local Now_Time = os.date("%H")
	local Now_Year = os.date("%y")
	local NowTimeNum = tonumber(Now_Time)
	local NowDayNum = tonumber(Now_Day)
	local NowMonthNum = tonumber(Now_Month)
	local NowYearNum = tonumber(Now_Year)
	local CheckDateNum = NowYearNum * 1000000 + NowMonthNum * 10000 + NowDayNum * 100 + NowTimeNum

	

	if CheckDateNum >= 8122200 and CheckDateNum <= 9010923 then
		local j = DelBagItem(role,2883,1)
		if j == 1 then
			A07XMAS_ENTRY_LUA_000005 = GetResString("A07XMAS_ENTRY_LUA_000005")
			MoveCity(role,A07XMAS_ENTRY_LUA_000005)
			return
		end
	else
		CALCULATE_ITEMEFFECT_LUA_000408 = GetResString("CALCULATE_ITEMEFFECT_LUA_000408")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000408)
		UseItemFailed ( role )
		return
	end
end	
------------------------------------------------------------阿拉丁背包
function ItemUse_ALDXB ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000409 = GetResString("CALCULATE_ITEMEFFECT_LUA_000409")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000409)
		UseItemFailed ( role )
		return
	end

	local cha_name = GetChaDefaultName ( role ) 
	local star=math.random ( 1, 20000 )
	--SystemNotice(role ,"star=="..star)
		if star<=3700 then
			GiveItem ( role , 0 , 2440  , 10 , 4  )
		elseif star>=3701 and star<=5700 then
			GiveItem ( role , 0 , 3885  , 1 , 4  )
		elseif star>=5701 and star<=7100 then
			GiveItem ( role , 0 , 3094  , 1 , 4  )
		elseif star>=7101 and star<=13100 then
			local el = math.random ( 1, 5 )
			if el==1  then
				GiveItem ( role , 0 , 2445  , 3 , 4 )
			elseif el==2	then
				GiveItem ( role , 0 , 3076  , 3 , 4 )
			elseif el==3	then
				GiveItem ( role , 0 , 0563  , 3 , 4 )
			elseif el==4	then	
				GiveItem ( role , 0 , 0583  , 3 , 4 )
			elseif el==5	then
				GiveItem ( role , 0 , 3050  , 3 , 4 )
			end
		elseif star>=13101 and star<=15100 then
			local el = math.random ( 1, 2 )
			if el==1  then
				GiveItem ( role , 0 , 0849  , 1 , 4 )
			elseif el==2  then
				GiveItem ( role , 0 , 0680  , 1 , 4 )
			end
		elseif star>=15101 and star<=19300 then
			local el1= math.random ( 1, 6 )
			if el1==1  then
				GiveItem ( role , 0 , 2438  , 5 , 4 )
			elseif el1==2 then
				GiveItem ( role , 0 , 2419  , 3 , 4 )
			elseif el1==3 then
				GiveItem ( role , 0 , 2386  , 4 , 4 )
			elseif el1==4 then
				GiveItem ( role , 0 , 0179  , 1 , 4 )
			elseif el1==5 then
				GiveItem ( role , 0 , 3084  , 1 , 4 )
			elseif el1==6 then
				GiveItem ( role , 0 , 3085  , 1 , 4 )
			end
		elseif star>=19301 and star<=19600 then
			local el1= math.random ( 1, 5 )
			if el1==1  then
				GiveItem ( role , 0 , 0863  , 1 , 4 )
				CALCULATE_ITEMEFFECT_LUA_000410 = GetResString("CALCULATE_ITEMEFFECT_LUA_000410")
				local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000410 
				Notice ( message )
			elseif el1==2 then
				GiveItem ( role , 0 , 0860  , 1 , 4 )
				CALCULATE_ITEMEFFECT_LUA_000411 = GetResString("CALCULATE_ITEMEFFECT_LUA_000411")
				local message1 = cha_name..CALCULATE_ITEMEFFECT_LUA_000411 
				Notice ( message1 )
			elseif el1==3 then
				GiveItem ( role , 0 , 0861  , 1 , 4 )
				CALCULATE_ITEMEFFECT_LUA_000412 = GetResString("CALCULATE_ITEMEFFECT_LUA_000412")
				local message2 = cha_name..CALCULATE_ITEMEFFECT_LUA_000412 
				Notice ( message2 )
			elseif el1==4 then
				GiveItem ( role , 0 , 0862  , 1 , 4 )
				CALCULATE_ITEMEFFECT_LUA_000413 = GetResString("CALCULATE_ITEMEFFECT_LUA_000413")
				local message3 = cha_name..CALCULATE_ITEMEFFECT_LUA_000413 
				Notice ( message3 )
			elseif el1==5 then
				GiveItem ( role , 0 , 1012  , 1 , 4 )
				CALCULATE_ITEMEFFECT_LUA_000414 = GetResString("CALCULATE_ITEMEFFECT_LUA_000414")
				local message4 = cha_name..CALCULATE_ITEMEFFECT_LUA_000414 
				Notice ( message4 )
			end

		elseif star==19601 then
			GiveItem ( role , 0 , 0192  , 1 , 4  )
			CALCULATE_ITEMEFFECT_LUA_000415 = GetResString("CALCULATE_ITEMEFFECT_LUA_000415")
			local message8= cha_name..CALCULATE_ITEMEFFECT_LUA_000415 
			Notice ( message8 )

		elseif star>=19601 and star<=20000 then	
			GiveItem ( role , 0 , 2224  , 1 , 4  )
			CALCULATE_ITEMEFFECT_LUA_000416 = GetResString("CALCULATE_ITEMEFFECT_LUA_000416")
			local message8= cha_name..CALCULATE_ITEMEFFECT_LUA_000416 
			Notice ( message8 )
		end
	
end

----情人节戒指----
function ItemUse_QRJJZ (role, Item )

	local x, y = GetChaPos(role)
	local map_name = GetChaMapName (role)
	x = math.floor (x*0.01)
	y = math.floor (y*0.01)
	local t = {} 
	t[0] = DEFER 
	t[1] = GetTeamCha(role, 0 )  
	t[2] = GetTeamCha(role, 1 )   
	t[3] = GetTeamCha(role, 2 )    
	t[4] = GetTeamCha(role, 3 )
	local item_count = CheckBagItem ( role , 3101 )	 ----情人节戒指
	if item_count <= 0 then  
	end
end 

-------------------------------------------------85BB系列 By dina
----------白银戒指兑换券
function ItemUse_byjz( role , Item )

	-- local Cha_Boat = 0
	-- Cha_Boat = GetCtrlBoat ( role )
	-- if Cha_Boat ~=  nil then
		-- SystemNotice( role , "海上不可使用" )
		-- UseItemFailed ( role )
		-- return
	-- end
	-- local Item_CanGet = GetChaFreeBagGridNum ( role )
	-- if Item_CanGet < 1 then
		-- SystemNotice(role ,"背包需要1个格子")
		-- UseItemFailed ( role )
		-- return
	-- end
	local cha_name = GetChaDefaultName ( role ) 
	local star=math.random ( 1, 10 )
	--SystemNotice(role ,"star=="..star)
	if star==1 then
		GiveItem ( role , 0 , 1107  , 1 , 4  )
		CALCULATE_ITEMEFFECT_LUA_000417 = GetResString("CALCULATE_ITEMEFFECT_LUA_000417")
		local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000417 
		Notice ( message )
	elseif star==2 then
		GiveItem ( role , 0 , 1108, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000418 = GetResString("CALCULATE_ITEMEFFECT_LUA_000418")
		local message1 = cha_name..CALCULATE_ITEMEFFECT_LUA_000418 
		Notice ( message1 )
	elseif star==3 then
		GiveItem ( role , 0 , 1109, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000419 = GetResString("CALCULATE_ITEMEFFECT_LUA_000419")
		local message2 = cha_name..CALCULATE_ITEMEFFECT_LUA_000419 
		Notice ( message2 )
	elseif star==4 then
		GiveItem ( role , 0 , 1110, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000420 = GetResString("CALCULATE_ITEMEFFECT_LUA_000420")
		local message3 = cha_name..CALCULATE_ITEMEFFECT_LUA_000420 
		Notice ( message3 )
	elseif star==5 then
		GiveItem ( role , 0 , 1112, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000421 = GetResString("CALCULATE_ITEMEFFECT_LUA_000421")
		local message4 = cha_name..CALCULATE_ITEMEFFECT_LUA_000421 
		Notice ( message4 )
	elseif star==6 then
		GiveItem ( role , 0 , 1113, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000422 = GetResString("CALCULATE_ITEMEFFECT_LUA_000422")
		local message5 = cha_name..CALCULATE_ITEMEFFECT_LUA_000422 
		Notice ( message5 )
	elseif star==7 then
		GiveItem ( role , 0 , 1114, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000423 = GetResString("CALCULATE_ITEMEFFECT_LUA_000423")
		local message6 = cha_name..CALCULATE_ITEMEFFECT_LUA_000423 
		Notice ( message6 )
	elseif star==8 then
		GiveItem ( role , 0 , 1862, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000424 = GetResString("CALCULATE_ITEMEFFECT_LUA_000424")
		local message7 = cha_name..CALCULATE_ITEMEFFECT_LUA_000424 
		Notice ( message7 )
	elseif star==9 then
		GiveItem ( role , 0 , 2209, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000425 = GetResString("CALCULATE_ITEMEFFECT_LUA_000425")
		local message8 = cha_name..CALCULATE_ITEMEFFECT_LUA_000425 
		Notice ( message8 )
	else
		GiveItem ( role , 0 , 1111, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000426 = GetResString("CALCULATE_ITEMEFFECT_LUA_000426")
		local message9 = cha_name..CALCULATE_ITEMEFFECT_LUA_000426 
		Notice ( message9 )
	end
end

----------黄金戒指兑换券
function ItemUse_hjjz( role , Item )

	-- local Cha_Boat = 0
	-- Cha_Boat = GetCtrlBoat ( role )
	-- if Cha_Boat ~=  nil then
		-- SystemNotice( role , "海上不可使用" )
		-- UseItemFailed ( role )
		-- return
	-- end
	-- local Item_CanGet = GetChaFreeBagGridNum ( role )
	-- if Item_CanGet < 1 then
		-- SystemNotice(role ,"背包需要1个格子")
		-- UseItemFailed ( role )
		-- return
	-- end
	local cha_name = GetChaDefaultName ( role ) 
	local star=math.random ( 1, 10 )
	--SystemNotice(role ,"star=="..star)
	if star==1 then
		GiveItem ( role , 0 , 2308  , 1 , 4  )
		CALCULATE_ITEMEFFECT_LUA_000427 = GetResString("CALCULATE_ITEMEFFECT_LUA_000427")
		local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000427 
		Notice ( message )
	elseif star==2 then
		GiveItem ( role , 0 , 2309, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000428 = GetResString("CALCULATE_ITEMEFFECT_LUA_000428")
		local message1 = cha_name..CALCULATE_ITEMEFFECT_LUA_000428 
		Notice ( message1 )
	elseif star==3 then
		GiveItem ( role , 0 , 2310, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000429 = GetResString("CALCULATE_ITEMEFFECT_LUA_000429")
		local message2 = cha_name..CALCULATE_ITEMEFFECT_LUA_000429 
		Notice ( message2 )
	elseif star==4 then
		GiveItem ( role , 0 , 2311, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000430 = GetResString("CALCULATE_ITEMEFFECT_LUA_000430")
		local message3 = cha_name..CALCULATE_ITEMEFFECT_LUA_000430 
		Notice ( message3 )
	elseif star==5 then
		GiveItem ( role , 0 , 2316, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000431 = GetResString("CALCULATE_ITEMEFFECT_LUA_000431")
		local message4 = cha_name..CALCULATE_ITEMEFFECT_LUA_000431 
		Notice ( message4 )
	elseif star==6 then
		GiveItem ( role , 0 , 2317, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000432 = GetResString("CALCULATE_ITEMEFFECT_LUA_000432")
		local message5 = cha_name..CALCULATE_ITEMEFFECT_LUA_000432 
		Notice ( message5 )
	elseif star==7 then
		GiveItem ( role , 0 , 2318, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000433 = GetResString("CALCULATE_ITEMEFFECT_LUA_000433")
		local message6 = cha_name..CALCULATE_ITEMEFFECT_LUA_000433 
		Notice ( message6 )
	elseif star==8 then
		GiveItem ( role , 0 , 2319, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000434 = GetResString("CALCULATE_ITEMEFFECT_LUA_000434")
		local message7 = cha_name..CALCULATE_ITEMEFFECT_LUA_000434 
		Notice ( message7 )
	elseif star==9 then
		GiveItem ( role , 0 , 2320, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000435 = GetResString("CALCULATE_ITEMEFFECT_LUA_000435")
		local message8 = cha_name..CALCULATE_ITEMEFFECT_LUA_000435 
		Notice ( message8 )
	else
		GiveItem ( role , 0 , 2321, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000436 = GetResString("CALCULATE_ITEMEFFECT_LUA_000436")
		local message9 = cha_name..CALCULATE_ITEMEFFECT_LUA_000436 
		Notice ( message9 )
	end
end

----------钻石戒指兑换券
function ItemUse_zsjz( role , Item )

	-- local Cha_Boat = 0
	-- Cha_Boat = GetCtrlBoat ( role )
	-- if Cha_Boat ~=  nil then
		-- SystemNotice( role , "海上不可使用" )
		-- UseItemFailed ( role )
		-- return
	-- end
	-- local Item_CanGet = GetChaFreeBagGridNum ( role )
	-- if Item_CanGet < 1 then
		-- SystemNotice(role ,"背包需要1个格子")
		-- UseItemFailed ( role )
		-- return
	-- end
	local cha_name = GetChaDefaultName ( role ) 
	local star=math.random ( 1, 10 )
	--SystemNotice(role ,"star=="..star)
	if star==1 then
		GiveItem ( role , 0 , 2322  , 1 , 4  )
		CALCULATE_ITEMEFFECT_LUA_000437 = GetResString("CALCULATE_ITEMEFFECT_LUA_000437")
		local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000437 
		Notice ( message )
	elseif star==2 then
		GiveItem ( role , 0 , 2345, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000438 = GetResString("CALCULATE_ITEMEFFECT_LUA_000438")
		local message1 = cha_name..CALCULATE_ITEMEFFECT_LUA_000438 
		Notice ( message1 )
	elseif star==3 then
		GiveItem ( role , 0 , 2346, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000439 = GetResString("CALCULATE_ITEMEFFECT_LUA_000439")
		local message2 = cha_name..CALCULATE_ITEMEFFECT_LUA_000439 
		Notice ( message2 )
	elseif star==4 then
		GiveItem ( role , 0 , 2347, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000440 = GetResString("CALCULATE_ITEMEFFECT_LUA_000440")
		local message3 = cha_name..CALCULATE_ITEMEFFECT_LUA_000440 
		Notice ( message3 )
	elseif star==5 then
		GiveItem ( role , 0 , 2397, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000441 = GetResString("CALCULATE_ITEMEFFECT_LUA_000441")
		local message4 = cha_name..CALCULATE_ITEMEFFECT_LUA_000441 
		Notice ( message4 )
	elseif star==6 then
		GiveItem ( role , 0 , 2398, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000442 = GetResString("CALCULATE_ITEMEFFECT_LUA_000442")
		local message5 = cha_name..CALCULATE_ITEMEFFECT_LUA_000442 
		Notice ( message5 )
	elseif star==7 then
		GiveItem ( role , 0 , 2399, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000443 = GetResString("CALCULATE_ITEMEFFECT_LUA_000443")
		local message6 = cha_name..CALCULATE_ITEMEFFECT_LUA_000443 
		Notice ( message6 )
	elseif star==8 then
		GiveItem ( role , 0 , 2400, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000444 = GetResString("CALCULATE_ITEMEFFECT_LUA_000444")
		local message7 = cha_name..CALCULATE_ITEMEFFECT_LUA_000444 
		Notice ( message7 )
	elseif star==9 then
		GiveItem ( role , 0 , 2401, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000445 = GetResString("CALCULATE_ITEMEFFECT_LUA_000445")
		local message8 = cha_name..CALCULATE_ITEMEFFECT_LUA_000445 
		Notice ( message8 )
	else
		GiveItem ( role , 0 , 2402, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000446 = GetResString("CALCULATE_ITEMEFFECT_LUA_000446")
		local message9 = cha_name..CALCULATE_ITEMEFFECT_LUA_000446 
		Notice ( message9 )
	end
end

----------伯爵项链兑换券
function ItemUse_bjxl( role , Item )

	-- local Cha_Boat = 0
	-- Cha_Boat = GetCtrlBoat ( role )
	-- if Cha_Boat ~=  nil then
		-- SystemNotice( role , "海上不可使用" )
		-- UseItemFailed ( role )
		-- return
	-- end
	-- local Item_CanGet = GetChaFreeBagGridNum ( role )
	-- if Item_CanGet < 1 then
		-- SystemNotice(role ,"背包需要1个格子")
		-- UseItemFailed ( role )
		-- return
	-- end
	local cha_name = GetChaDefaultName ( role ) 
	local star=math.random ( 1, 5 )
	--SystemNotice(role ,"star=="..star)
	if star==1 then
		GiveItem ( role , 0 , 2405  , 1 , 4  )
		CALCULATE_ITEMEFFECT_LUA_000447 = GetResString("CALCULATE_ITEMEFFECT_LUA_000447")
		local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000447 
		Notice ( message )
	elseif star==2 then
		GiveItem ( role , 0 , 2406, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000448 = GetResString("CALCULATE_ITEMEFFECT_LUA_000448")
		local message1 = cha_name..CALCULATE_ITEMEFFECT_LUA_000448 
		Notice ( message1 )
	elseif star==3 then
		GiveItem ( role , 0 , 2407, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000449 = GetResString("CALCULATE_ITEMEFFECT_LUA_000449")
		local message2 = cha_name..CALCULATE_ITEMEFFECT_LUA_000449 
		Notice ( message2 )
	elseif star==4 then
		GiveItem ( role , 0 , 2494, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000450 = GetResString("CALCULATE_ITEMEFFECT_LUA_000450")
		local message3 = cha_name..CALCULATE_ITEMEFFECT_LUA_000450 
		Notice ( message3 )
	else
		GiveItem ( role , 0 , 2497, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000451 = GetResString("CALCULATE_ITEMEFFECT_LUA_000451")
		local message4 = cha_name..CALCULATE_ITEMEFFECT_LUA_000451 
		Notice ( message4 )
	end
end

----------侯爵项链兑换券
function ItemUse_hjxl( role , Item )

	-- local Cha_Boat = 0
	-- Cha_Boat = GetCtrlBoat ( role )
	-- if Cha_Boat ~=  nil then
		-- SystemNotice( role , "海上不可使用" )
		-- UseItemFailed ( role )
		-- return
	-- end
	-- local Item_CanGet = GetChaFreeBagGridNum ( role )
	-- if Item_CanGet < 1 then
		-- SystemNotice(role ,"背包需要1个格子")
		-- UseItemFailed ( role )
		-- return
	-- end
	local cha_name = GetChaDefaultName ( role ) 
	local star=math.random ( 1, 5 )
	--SystemNotice(role ,"star=="..star)
	if star==1 then
		GiveItem ( role , 0 , 2498  , 1 , 4  )
		CALCULATE_ITEMEFFECT_LUA_000452 = GetResString("CALCULATE_ITEMEFFECT_LUA_000452")
		local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000452 
		Notice ( message )
	elseif star==2 then
		GiveItem ( role , 0 , 2506, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000453 = GetResString("CALCULATE_ITEMEFFECT_LUA_000453")
		local message1 = cha_name..CALCULATE_ITEMEFFECT_LUA_000453 
		Notice ( message1 )
	elseif star==3 then
		GiveItem ( role , 0 , 2507, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000454 = GetResString("CALCULATE_ITEMEFFECT_LUA_000454")
		local message2 = cha_name..CALCULATE_ITEMEFFECT_LUA_000454 
		Notice ( message2 )
	elseif star==4 then
		GiveItem ( role , 0 , 2508, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000455 = GetResString("CALCULATE_ITEMEFFECT_LUA_000455")
		local message3 = cha_name..CALCULATE_ITEMEFFECT_LUA_000455 
		Notice ( message3 )
	else
		GiveItem ( role , 0 , 2509, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000456 = GetResString("CALCULATE_ITEMEFFECT_LUA_000456")
		local message4 = cha_name..CALCULATE_ITEMEFFECT_LUA_000456 
		Notice ( message4 )
	end
end

----------公爵项链兑换券
function ItemUse_gjxl( role , Item )

	-- local Cha_Boat = 0
	-- Cha_Boat = GetCtrlBoat ( role )
	-- if Cha_Boat ~=  nil then
		-- SystemNotice( role , "海上不可使用" )
		-- UseItemFailed ( role )
		-- return
	-- end
	-- local Item_CanGet = GetChaFreeBagGridNum ( role )
	-- if Item_CanGet < 1 then
		-- SystemNotice(role ,"背包需要1个格子")
		-- UseItemFailed ( role )
		-- return
	-- end
	local cha_name = GetChaDefaultName ( role ) 
	local star=math.random ( 1, 5 )
	--SystemNotice(role ,"star=="..star)
	if star==1 then
		GiveItem ( role , 0 , 2510  , 1 , 4  )
		CALCULATE_ITEMEFFECT_LUA_000457 = GetResString("CALCULATE_ITEMEFFECT_LUA_000457")
		local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000457 
		Notice ( message )
	elseif star==2 then
		GiveItem ( role , 0 , 2511, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000458 = GetResString("CALCULATE_ITEMEFFECT_LUA_000458")
		local message1 = cha_name..CALCULATE_ITEMEFFECT_LUA_000458 
		Notice ( message1 )
	elseif star==3 then
		GiveItem ( role , 0 , 2512, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000459 = GetResString("CALCULATE_ITEMEFFECT_LUA_000459")
		local message2 = cha_name..CALCULATE_ITEMEFFECT_LUA_000459 
		Notice ( message2 )
	elseif star==4 then
		GiveItem ( role , 0 , 2513, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000460 = GetResString("CALCULATE_ITEMEFFECT_LUA_000460")
		local message3 = cha_name..CALCULATE_ITEMEFFECT_LUA_000460 
		Notice ( message3 )
	else
		GiveItem ( role , 0 , 2514, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000461 = GetResString("CALCULATE_ITEMEFFECT_LUA_000461")
		local message4 = cha_name..CALCULATE_ITEMEFFECT_LUA_000461 
		Notice ( message4 )
	end
end

---------------------------------神之祈福包
function ItemUse_SZQFB( role, Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000256 = GetResString("CALCULATE_ITEMEFFECT_LUA_000256")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000256 )
		UseItemFailed ( role )
		return
	end
	local job = GetChaAttr( role, ATTR_JOB) --取职业
	local cha_type = GetChaTypeID ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000462 = GetResString("CALCULATE_ITEMEFFECT_LUA_000462")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000462)
		UseItemFailed ( role )
		return
	end
	if cha_type ~= 2 and job==4 then
		GiveItem ( role , 0 , 4276 , 1 , 4 )--------------封印的雪月刺	
	elseif cha_type ~= 2 and job==16 then
		GiveItem ( role , 0 , 4276 , 1 , 4 )--------------封印的雪月刺	
	elseif cha_type == 2  and job~=0 then
		local dina=math.random ( 1, 2 )
	    if dina==1 then
		GiveItem ( role , 0 , 4281  , 1 , 4 )-------------封印的狂雪刀
		else
		GiveItem ( role , 0 , 4275  , 1 , 4 )------------封印的冷凝重剑
		end
	elseif cha_type ~= 2 and  cha_type ~= 4 and job==2 then
		local dina1=math.random ( 1, 2 )
	    if dina1==1 then
		GiveItem ( role , 0 , 4278  , 1 , 4 )-------------封印的寒魅弓
		else
		GiveItem ( role , 0 , 4277  , 1 , 4 )------------封印的雪魔枪
		end
	elseif cha_type ~= 2 and  cha_type ~= 4 and job==12 then
		local dina2=math.random ( 1, 2 )
	    if dina2==1 then
		GiveItem ( role , 0 , 4277  , 1 , 4 )------------封印的雪魔枪
		else
		GiveItem ( role , 0 , 4278  , 1 , 4 )-------------封印的寒魅弓
		end
	elseif cha_type ~= 1 and  cha_type ~= 2 and job==5 then
		local dina3=math.random ( 1, 2 )
	    if dina3==1 then
		GiveItem ( role , 0 , 4279  , 1 , 4 )------------封印的寒羽之仗
		else
		GiveItem ( role , 0 , 4280  , 1 , 4 )-------------封印的鬼霜之杖
		end
	elseif cha_type ~= 1 and  cha_type ~= 2 and job==13 then
	    GiveItem ( role , 0 , 4279  , 1 , 4 )------------封印的寒羽之仗
	elseif cha_type ~= 1 and  cha_type ~= 2 and job==14 then
	    GiveItem ( role , 0 , 4280  , 1 , 4 )-------------封印的鬼霜之杖
	elseif cha_type == 1 and  job==1 then
	    GiveItem ( role , 0 , 4274  , 1 , 4 )-------------封印的冷凝轻剑
	elseif cha_type == 1 and  job==9 then
	    GiveItem ( role , 0 , 4274  , 1 , 4 )-------------封印的冷凝轻剑
	elseif cha_type == 3 and  job==1 then
	    GiveItem ( role , 0 , 4274  , 1 , 4 )-------------封印的冷凝轻剑
	elseif cha_type == 3 and  job==9 then
	    GiveItem ( role , 0 , 4274  , 1 , 4 )-------------封印的冷凝轻剑
	else 
		CALCULATE_ITEMEFFECT_LUA_000103 = GetResString("CALCULATE_ITEMEFFECT_LUA_000103")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000103)
		UseItemFailed ( role )
		return
	end
end


---------------------------------圣之降临包
function ItemUse_SZJFB( role, Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000256 = GetResString("CALCULATE_ITEMEFFECT_LUA_000256")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000256 )
		UseItemFailed ( role )
		return
	end
	local job = GetChaAttr( role, ATTR_JOB) --取职业
	local cha_type = GetChaTypeID ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000463 = GetResString("CALCULATE_ITEMEFFECT_LUA_000463")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000463)
		UseItemFailed ( role )
		return
	end
	if cha_type ~= 2 and job==4 then
		GiveItem ( role , 0 , 2580 , 1 , 4 )--------------修罗之海魄		
	elseif cha_type ~= 2 and job==16 then
		GiveItem ( role , 0 , 2580 , 1 , 4 )--------------修罗之海魄		
	elseif cha_type == 2  and job~=0 then
		GiveItem ( role , 0 , 2577 , 1 , 4 )----------------哈迪斯之强悍
	elseif cha_type ~= 2 and  cha_type ~= 4 and job==2 then
		GiveItem ( role , 0 , 2579  , 1 , 4 )-----------------地狱之羿羽
	elseif cha_type ~= 2 and  cha_type ~= 4 and job==12 then
		GiveItem ( role , 0 , 2579  , 1 , 4 )-----------------地狱之羿羽
	elseif cha_type ~= 1 and  cha_type ~= 2 and job==5 then
		local dina=math.random ( 1, 2 )
	    if dina==1 then
		GiveItem ( role , 0 , 2582  , 1 , 4 )------------幽冥之晶灵
		else
		GiveItem ( role , 0 , 2581  , 1 , 4 )-------------冥河之魔化
		end
	elseif cha_type ~= 1 and  cha_type ~= 2 and job==13 then
	    GiveItem ( role , 0 , 2582  , 1 , 4 )------------幽冥之晶灵
	elseif cha_type ~= 1 and  cha_type ~= 2 and job==14 then
	    GiveItem ( role , 0 , 2581  , 1 , 4 )-------------冥河之魔化
	elseif cha_type == 1 and  job==1 then
	    GiveItem ( role , 0 , 2578  , 1 , 4 )-------------黑暗之威力
	elseif cha_type == 1 and  job==9 then
	    GiveItem ( role , 0 , 2578  , 1 , 4 )-------------黑暗之威力
	elseif cha_type == 3 and  job==1 then
	    GiveItem ( role , 0 , 2578  , 1 , 4 )-------------黑暗之威力
	elseif cha_type == 3 and  job==9 then
	    GiveItem ( role , 0 , 2578  , 1 , 4 )-------------黑暗之威力
	else 
		CALCULATE_ITEMEFFECT_LUA_000103 = GetResString("CALCULATE_ITEMEFFECT_LUA_000103")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000103)
		UseItemFailed ( role )
		return
	end
end

---------------------------------祥之护佑包
function ItemUse_XZHYB( role, Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000256 = GetResString("CALCULATE_ITEMEFFECT_LUA_000256")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000256 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000464 = GetResString("CALCULATE_ITEMEFFECT_LUA_000464")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000464)
		UseItemFailed ( role )
		return
	else
		GiveItem ( role , 0 , 4282 , 1 , 4 )
	end
end

-----------------------------------------------------08鼠年春节系列红包kokora-----------------------------------------------------------

----------------------------------------------新手鼠年红包----------------------------------------------------------
function ItemUse_springgiftA (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000465 = GetResString("CALCULATE_ITEMEFFECT_LUA_000465")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000465 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000466 = GetResString("CALCULATE_ITEMEFFECT_LUA_000466")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000466)
		UseItemFailed ( role )
		return
	end
	local	sc = math.random ( 1, 100 )
	local cha_name = GetChaDefaultName ( role )
	local item_name = ""
	if  sc <=60 then	
		GiveItem ( role , 0 , 3094 , 5 , 4 )                      ---------------双倍经验增幅器   获得机率60%
		CALCULATE_FUNCTIONS_LUA_000682 = GetResString("CALCULATE_FUNCTIONS_LUA_000682")
		item_name = CALCULATE_FUNCTIONS_LUA_000682
	elseif sc <=76 then		
		GiveItem ( role , 0 , 0849 , 5 , 4 )                      ---------------组队经验果   获得机率16%
		CALCULATE_ITEMEFFECT_LUA_000467 = GetResString("CALCULATE_ITEMEFFECT_LUA_000467")
		item_name = CALCULATE_ITEMEFFECT_LUA_000467
	elseif sc <=86 then
		GiveItem ( role , 0 , 3096 , 5 , 4 )                      ---------------双倍掉料增幅器   获得机率10%
		CALCULATE_ITEMEFFECT_LUA_000468 = GetResString("CALCULATE_ITEMEFFECT_LUA_000468")
		item_name = CALCULATE_ITEMEFFECT_LUA_000468
	elseif sc <=91 then
		GiveItem ( role , 0 , 3095 , 2 , 4 )                      ---------------高级努力增幅器   获得机率5%
		CALCULATE_ITEMEFFECT_LUA_000469 = GetResString("CALCULATE_ITEMEFFECT_LUA_000469")
		item_name = CALCULATE_ITEMEFFECT_LUA_000469
	elseif sc <=96 then
		GiveItem ( role , 0 , 3097 , 2 , 4 )                      ---------------高级财富增幅器   获得机率5%
		CALCULATE_ITEMEFFECT_LUA_000470 = GetResString("CALCULATE_ITEMEFFECT_LUA_000470")
		item_name = CALCULATE_ITEMEFFECT_LUA_000470
	elseif sc <=98 then
		GiveItem ( role , 0 , 1036 , 1 , 4 )                      ---------------魔幻女神卡   获得机率2%
		CALCULATE_ITEMEFFECT_LUA_000471 = GetResString("CALCULATE_ITEMEFFECT_LUA_000471")
		item_name = CALCULATE_ITEMEFFECT_LUA_000471
	else   
		GiveItem ( role , 0 , 1019 , 1 , 4 )                      ---------------迷你黑龙包   获得机率2%
		CALCULATE_ITEMEFFECT_LUA_000472 = GetResString("CALCULATE_ITEMEFFECT_LUA_000472")
		item_name = CALCULATE_ITEMEFFECT_LUA_000472
	end
	CALCULATE_ITEMEFFECT_LUA_000473 = GetResString("CALCULATE_ITEMEFFECT_LUA_000473")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000473..item_name )
	
end

------------------------------------------------高级鼠年红包-------------------------------------------------------
function ItemUse_springgiftB (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000474 = GetResString("CALCULATE_ITEMEFFECT_LUA_000474")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000474 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000475 = GetResString("CALCULATE_ITEMEFFECT_LUA_000475")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000475)
		UseItemFailed ( role )
		return
	end
	local	sc = math.random ( 1, 49 )
	local ItemId = 0
	
	if sc <=14 then	
		ItemId = 3457						     -------------纳卡符石       获得机率14%

	elseif sc <=26 then		
		local GoodItem = {}
		GoodItem[0] = 1923                                       -------------寒冰封印的迷幻之刺       获得机率12%
		GoodItem[1] = 1905                                       -------------寒冰封印的迷之长枪       获得机率12%
	
		local Good_C = math.random ( 1, 2 )-1
		ItemId = GoodItem[Good_C]

	elseif sc <=36 then
		local GoodItem = {}
		GoodItem[0] = 0890                                       -------------装备加固剂       获得机率10%
		GoodItem[1] = 1916                                       -------------寒冰封印的迷咒法杖       获得机率10%
	
		local Good_C = math.random ( 1, 2 )-1
		ItemId = GoodItem[Good_C]

	elseif sc <=44 then
		local GoodItem = {}
		GoodItem[0] = 1897                                       -------------寒冰封印的迷之利刃       获得机率8%
		GoodItem[1] = 1894                                       -------------寒冰封印的迷之裁决       获得机率8%
		GoodItem[2] = 1909                                       -------------寒冰封印的迷法之杖       获得机率8%
	
		local Good_C = math.random ( 1, 3 )-1
		ItemId = GoodItem[Good_C]

	elseif sc <=47 then
		local GoodItem = {}
		GoodItem[0] = 2536                                       -------------马特躯石       获得机率3%
		GoodItem[1] = 2539                                       -------------杰克躯石       获得机率3%
		GoodItem[2] = 2542                                       -------------伊丽躯石       获得机率3%
		GoodItem[3] = 2545                                       -------------维克躯石       获得机率3%
	
		local Good_C = math.random ( 1, 4 )-1
		ItemId = GoodItem[Good_C]

	else  local GoodItem = {}
		GoodItem[0] = 0891                                       -------------装备催化粉       获得机率2%
		GoodItem[1] = 2533                                       -------------梅尔躯石          获得机率2%
		GoodItem[2] = 2530                                       -------------戴维躯石          获得机率2%
	
		local Good_C = math.random ( 1, 3 )-1
		ItemId = GoodItem[Good_C]
	end
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role )
	GiveItem ( role , 0 , ItemId , 1 , 4 )
	CALCULATE_ITEMEFFECT_LUA_000476 = GetResString("CALCULATE_ITEMEFFECT_LUA_000476")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	local message = CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000476..itemname  
	Notice ( message )
end

----------------------------------------------超级鼠年红包----------------------------------------------------------
function ItemUse_springgiftC (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000477 = GetResString("CALCULATE_ITEMEFFECT_LUA_000477")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000477 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000478 = GetResString("CALCULATE_ITEMEFFECT_LUA_000478")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000478)
		UseItemFailed ( role )
		return
	end
	local	sc = math.random ( 1, 1000 )
	local cha_name = GetChaDefaultName ( role )
	local item_name = ""
	local cha_type = GetChaTypeID ( role ) 

	if  sc <=239 then
		if cha_type == 1  then
		GiveItem ( role , 0 , 5651 , 1 , 4 )                      ---------------新春套装-蓝崎头部   获得机率23.9%
		CALCULATE_ITEMEFFECT_LUA_000479 = GetResString("CALCULATE_ITEMEFFECT_LUA_000479")
		item_name = CALCULATE_ITEMEFFECT_LUA_000479
		elseif	cha_type == 2  then
		GiveItem ( role , 0 , 5655 , 1 , 4 )                      ---------------新春套装-卡西斯头部   获得机率23.9%
		CALCULATE_ITEMEFFECT_LUA_000480 = GetResString("CALCULATE_ITEMEFFECT_LUA_000480")
		item_name = CALCULATE_ITEMEFFECT_LUA_000480
		elseif	cha_type == 3  then
		GiveItem ( role , 0 , 5659 , 1 , 4 )                      ---------------新春套装-菲利尔头部   获得机率23.9%
		CALCULATE_ITEMEFFECT_LUA_000481 = GetResString("CALCULATE_ITEMEFFECT_LUA_000481")
		item_name = CALCULATE_ITEMEFFECT_LUA_000481
		elseif	cha_type == 4  then
		GiveItem ( role , 0 , 5695 , 1 , 4 )                      ---------------新春套装-艾米头部   获得机率23.9%
		CALCULATE_ITEMEFFECT_LUA_000482 = GetResString("CALCULATE_ITEMEFFECT_LUA_000482")
		item_name = CALCULATE_ITEMEFFECT_LUA_000482
		end
	elseif sc <=439 then
		if cha_type == 1  then
		GiveItem ( role , 0 , 5652 , 1 , 4 )                      ---------------新春套装-蓝崎身体   获得机率20%
		CALCULATE_ITEMEFFECT_LUA_000483 = GetResString("CALCULATE_ITEMEFFECT_LUA_000483")
		item_name = CALCULATE_ITEMEFFECT_LUA_000483
		elseif	cha_type == 2  then
		GiveItem ( role , 0 , 5656 , 1 , 4 )                      ---------------新春套装-卡西斯身体   获得机率20%
		CALCULATE_ITEMEFFECT_LUA_000484 = GetResString("CALCULATE_ITEMEFFECT_LUA_000484")
		item_name = CALCULATE_ITEMEFFECT_LUA_000484
		elseif	cha_type == 3  then
		GiveItem ( role , 0 , 5660 , 1 , 4 )                      ---------------新春套装-菲利尔身体   获得机率20%
		CALCULATE_ITEMEFFECT_LUA_000485 = GetResString("CALCULATE_ITEMEFFECT_LUA_000485")
		item_name = CALCULATE_ITEMEFFECT_LUA_000485
		elseif	cha_type == 4  then
		GiveItem ( role , 0 , 5696 , 1 , 4 )                      ---------------新春套装-艾米身体   获得机率20%
		CALCULATE_ITEMEFFECT_LUA_000486 = GetResString("CALCULATE_ITEMEFFECT_LUA_000486")
		item_name = CALCULATE_ITEMEFFECT_LUA_000486
		end
	elseif sc <=639 then
		if cha_type == 1  then
		GiveItem ( role , 0 , 5653 , 1 , 4 )                      ---------------新春套装-蓝崎手套   获得机率20%
		CALCULATE_ITEMEFFECT_LUA_000487 = GetResString("CALCULATE_ITEMEFFECT_LUA_000487")
		item_name = CALCULATE_ITEMEFFECT_LUA_000487
		elseif	cha_type == 2  then
		GiveItem ( role , 0 , 5657 , 1 , 4 )                      ---------------新春套装-卡西斯手套   获得机率20%
		CALCULATE_ITEMEFFECT_LUA_000488 = GetResString("CALCULATE_ITEMEFFECT_LUA_000488")
		item_name = CALCULATE_ITEMEFFECT_LUA_000488
		elseif	cha_type == 3  then
		GiveItem ( role , 0 , 5693 , 1 , 4 )                      ---------------新春套装-菲利尔手套   获得机率20%
		CALCULATE_ITEMEFFECT_LUA_000489 = GetResString("CALCULATE_ITEMEFFECT_LUA_000489")
		item_name = CALCULATE_ITEMEFFECT_LUA_000489
		elseif	cha_type == 4  then
		GiveItem ( role , 0 , 5697 , 1 , 4 )                      ---------------新春套装-艾米手套   获得机率20%
		CALCULATE_ITEMEFFECT_LUA_000490 = GetResString("CALCULATE_ITEMEFFECT_LUA_000490")
		item_name = CALCULATE_ITEMEFFECT_LUA_000490
		end
	elseif sc <=839 then
		if cha_type == 1  then
		GiveItem ( role , 0 , 5654 , 1 , 4 )                      ---------------新春套装-蓝崎鞋子   获得机率20%
		CALCULATE_ITEMEFFECT_LUA_000491 = GetResString("CALCULATE_ITEMEFFECT_LUA_000491")
		item_name = CALCULATE_ITEMEFFECT_LUA_000491
		elseif	cha_type == 2  then
		GiveItem ( role , 0 , 5658 , 1 , 4 )                      ---------------新春套装-卡西斯鞋子   获得机率20%
		CALCULATE_ITEMEFFECT_LUA_000492 = GetResString("CALCULATE_ITEMEFFECT_LUA_000492")
		item_name = CALCULATE_ITEMEFFECT_LUA_000492
		elseif	cha_type == 3  then
		GiveItem ( role , 0 , 5694 , 1 , 4 )                      ---------------新春套装-菲利尔鞋子   获得机率20%
		CALCULATE_ITEMEFFECT_LUA_000493 = GetResString("CALCULATE_ITEMEFFECT_LUA_000493")
		item_name = CALCULATE_ITEMEFFECT_LUA_000493
		elseif	cha_type == 4  then
		GiveItem ( role , 0 , 5698 , 1 , 4 )                      ---------------新春套装-艾米鞋子   获得机率20%
		CALCULATE_ITEMEFFECT_LUA_000494 = GetResString("CALCULATE_ITEMEFFECT_LUA_000494")
		item_name = CALCULATE_ITEMEFFECT_LUA_000494
		end
	elseif sc <=909 then
		GiveItem ( role , 0 , 1012 , 1 , 4 )                      ---------------加纳之神          获得机率7%
		CALCULATE_ITEMEFFECT_LUA_000495 = GetResString("CALCULATE_ITEMEFFECT_LUA_000495")
		item_name = CALCULATE_ITEMEFFECT_LUA_000495
	elseif sc <=939 then
		GiveItem ( role , 0 , 0863 , 1 , 4 )                      ---------------炎玉   获得机率3%
		CALCULATE_ITEMEFFECT_LUA_000496 = GetResString("CALCULATE_ITEMEFFECT_LUA_000496")
		item_name = CALCULATE_ITEMEFFECT_LUA_000496
	elseif sc <=969 then
		GiveItem ( role , 0 , 0862 , 1 , 4 )                      ---------------岩玉   获得机率3%
		CALCULATE_ITEMEFFECT_LUA_000497 = GetResString("CALCULATE_ITEMEFFECT_LUA_000497")
		item_name = CALCULATE_ITEMEFFECT_LUA_000497
	elseif sc <=979 then
		GiveItem ( role , 0 , 0864 , 1 , 4 )                      ---------------黑龙之瞳   获得机率1%
		CALCULATE_ITEMEFFECT_LUA_000498 = GetResString("CALCULATE_ITEMEFFECT_LUA_000498")
		item_name = CALCULATE_ITEMEFFECT_LUA_000498
	elseif sc <=989 then
		GiveItem ( role , 0 , 0865 , 1 , 4 )                      ---------------黑龙之魂   获得机率1%
		CALCULATE_ITEMEFFECT_LUA_000499 = GetResString("CALCULATE_ITEMEFFECT_LUA_000499")
		item_name = CALCULATE_ITEMEFFECT_LUA_000499
	elseif sc <=999 then
		GiveItem ( role , 0 , 0866 , 1 , 4 )                      ---------------黑龙之心   获得机率1%
		CALCULATE_ITEMEFFECT_LUA_000500 = GetResString("CALCULATE_ITEMEFFECT_LUA_000500")
		item_name = CALCULATE_ITEMEFFECT_LUA_000500
	else   
		GiveItem ( role , 0 , 0094 , 1 , 4 )                      ---------------元帅之首   获得机率0.1%
		CALCULATE_ITEMEFFECT_LUA_000501 = GetResString("CALCULATE_ITEMEFFECT_LUA_000501")
		item_name = CALCULATE_ITEMEFFECT_LUA_000501
	end
	CALCULATE_ITEMEFFECT_LUA_000502 = GetResString("CALCULATE_ITEMEFFECT_LUA_000502")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	local message = CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000502..item_name  
	Notice ( message )
	
end

-----------------------------------------------------------------------end----------------------------------------------------------------------

----------------------------------------------------------------------08年商品调整(改名,效果不变) kokora-----------------------------------------------

------------------------------------------------------------------幸运洛克藏宝图--------------------------------------------------- 
function ItemUse_rockluck ( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000058 = GetResString("CALCULATE_ITEMEFFECT_LUA_000058")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000058)
		UseItemFailed ( role )
		return
	end 
	local Has_GoldenMap = CheckBagItem ( role , 2998 )
	if Has_GoldenMap >= 1 then
		CALCULATE_ITEMEFFECT_LUA_000334 = GetResString("CALCULATE_ITEMEFFECT_LUA_000334")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000334 )
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 2998 , 1 , 0 )
end

-------------------------------------------------------- 超级转生彩票-----------------------------------------------------------
function ItemUse_superticket( role , Item )

	-- local Item_CanGet = GetChaFreeBagGridNum ( role )
	-- if Item_CanGet < 1 then
		-- SystemNotice(role ,"背包需要1个格子")
		-- UseItemFailed ( role )
		-- return
	-- end
	local star=math.random ( 1, 1000 )

	if  star==1 then
		GiveItem ( role , 0 , 2941, 1 , 4  ) 
		local cha_name = GetChaDefaultName ( role ) 
		CALCULATE_ITEMEFFECT_LUA_000503 = GetResString("CALCULATE_ITEMEFFECT_LUA_000503")
		CALCULATE_EXP_AND_LEVEL_LUA_000040 = GetResString("CALCULATE_EXP_AND_LEVEL_LUA_000040")
		local message = CALCULATE_EXP_AND_LEVEL_LUA_000040..cha_name..CALCULATE_ITEMEFFECT_LUA_000503 
		Notice ( message )
	elseif star>1 and star<=10 then
		GiveItem ( role , 0 , 3016, 1 , 4  ) 
		local cha_name = GetChaDefaultName ( role ) 
		CALCULATE_ITEMEFFECT_LUA_000504 = GetResString("CALCULATE_ITEMEFFECT_LUA_000504")
		CALCULATE_EXP_AND_LEVEL_LUA_000040 = GetResString("CALCULATE_EXP_AND_LEVEL_LUA_000040")
		local message = CALCULATE_EXP_AND_LEVEL_LUA_000040..cha_name..CALCULATE_ITEMEFFECT_LUA_000504 
		Notice ( message )
	elseif star>=11 and star<190 then
		GiveItem ( role , 0 , 0992, 1 , 4  ) 
	elseif star>=190 and star<=1000 then
		GiveItem ( role , 0 , 3885, 1 , 4  ) 
	end
end

----------------------------------------------------------------- 超级魔幻女神卡--------------------------------------------------
function ItemUse_supergodness( role , Item )

	-- local Item_CanGet = GetChaFreeBagGridNum ( role )
	-- if Item_CanGet < 1 then
		-- SystemNotice(role ,"背包需要1个格子")
		-- UseItemFailed ( role )
		-- return
	-- end
	local cha_name = GetChaDefaultName ( role ) 
	local star=math.random ( 1, 1000 )

	if star<=8 then
		GiveItem ( role , 0 , 1014  , 1 , 4  )
		CALCULATE_ITEMEFFECT_LUA_000505 = GetResString("CALCULATE_ITEMEFFECT_LUA_000505")
		local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000505 
		Notice ( message )
	elseif star>=9 and star<=17 then
		GiveItem ( role , 0 , 271, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000506 = GetResString("CALCULATE_ITEMEFFECT_LUA_000506")
		local message1 = cha_name..CALCULATE_ITEMEFFECT_LUA_000506 
		Notice ( message1 )
	elseif star>=18 and star<=27 then
		GiveItem ( role , 0 , 1012, 1 , 4  ) 
		CALCULATE_ITEMEFFECT_LUA_000507 = GetResString("CALCULATE_ITEMEFFECT_LUA_000507")
		local message3 = cha_name..CALCULATE_ITEMEFFECT_LUA_000507 
		Notice ( message3 )
	elseif star>=28 and star<=227 then
		GiveItem ( role , 0 , 3886, 1 , 4  ) 
	else
		GiveItem ( role , 0 , 3830, 5 , 4  ) 
	end
end

-----------------------------------------------------------白金黑龙彩票--------------------------------------------------------------
function ItemUse_platinadress( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 1 then
		SystemNotice(role ,"背包需要1个格子")
		UseItemFailed ( role )
		return
	end
	local star=math.random ( 1, 1000000 )
	local el=math.random ( 1, 100 )

	SystemNotice(role ,"star=="..star)
	SystemNotice(role ,"el=="..el)
	if  star==1 then
		if el>=1 and el<=40 then
		GiveItem ( role , 0 , 2370  , 1 , 4  )
		elseif el>=41 and el<=65 then
		GiveItem ( role , 0 , 2368  , 1 , 4  )
		elseif el>=65 and el<=90 then
		GiveItem ( role , 0 , 2369  , 1 , 4  )
		elseif el>=91 and el<=100 then
		GiveItem ( role , 0 , 2367  , 1 , 4  ) 
		end
	elseif star>1 and star<=9999 then
		GiveItem ( role , 0 , 0273, 1 , 4  ) 
	elseif star>=10000 and star<170000 then
		GiveItem ( role , 0 , 2312, 30 , 4  ) 
	elseif star>=170000 and star<=1000000 then
		GiveItem ( role , 0 , 3877, 1 , 4  ) 
	end
end

------------------------------------------------------------白金年兽彩票------------------------------------------------------
function ItemUse_platinayear( role , Item )

	-- local Item_CanGet = GetChaFreeBagGridNum ( role )
	-- if Item_CanGet < 1 then
		-- SystemNotice(role ,"背包需要1个格子")
		-- UseItemFailed ( role )
		-- return
	-- end
	local star=math.random ( 1, 1000000 )
	local el=math.random ( 1, 100 )

	--SystemNotice(role ,"star=="..star)
	--SystemNotice(role ,"el=="..el)
	if  star==1 then
		if el>=1 and el<=40 then
		GiveItem ( role , 0 , 2552  , 1 , 4  )
		elseif el>=41 and el<=65 then
		GiveItem ( role , 0 , 2550  , 1 , 4  )
		elseif el>=65 and el<=90 then
		GiveItem ( role , 0 , 2551  , 1 , 4  )
		elseif el>=91 and el<=100 then
		GiveItem ( role , 0 , 2549  , 1 , 4  ) 
		end
	elseif star>1 and star<=9999 then
		GiveItem ( role , 0 , 0273, 1 , 4  ) 
	elseif star>=10000 and star<170000 then
		GiveItem ( role , 0 , 2312, 30 , 4  ) 
	elseif star>=170000 and star<=1000000 then
		GiveItem ( role , 0 , 3877, 1 , 4  ) 
	end
end

----------------------------------------------------------------------白金辉煌彩票----------------------------------------------------
function ItemUse_platinareful( role , Item )

	-- local Item_CanGet = GetChaFreeBagGridNum ( role )
	-- if Item_CanGet < 1 then
		-- SystemNotice(role ,"背包需要1个格子")
		-- UseItemFailed ( role )
		-- return
	-- end
	local star=math.random ( 1, 1000000 )
	local el=math.random ( 1, 100 )

	--SystemNotice(role ,"star=="..star)
	--SystemNotice(role ,"el=="..el)
	if  star==1 then
		if el>=1 and el<=40 then
		GiveItem ( role , 0 , 1115  , 1 , 4  )
		elseif el>=41 and el<=65 then
		GiveItem ( role , 0 , 1117  , 1 , 4  )
		elseif el>=65 and el<=90 then
		GiveItem ( role , 0 , 1118  , 1 , 4  )
		elseif el>=91 and el<=100 then
		GiveItem ( role , 0 , 1116  , 1 , 4  ) 
		end
	elseif star>1 and star<=9999 then
		GiveItem ( role , 0 , 0273, 1 , 4  ) 
	elseif star>=10000 and star<170000 then
		GiveItem ( role , 0 , 2312, 30 , 4  ) 
	elseif star>=170000 and star<=1000000 then
		GiveItem ( role , 0 , 3877, 1 , 4  ) 
	end
end

---------------------------------------------------------------------新手十倍经验果-------------------------------------------------
function ItemUse_moliimm ( role , Item )

	local lv= GetChaAttr(role, ATTR_LV) 
	if lv >49 then
		CALCULATE_ITEMEFFECT_LUA_000508 = GetResString("CALCULATE_ITEMEFFECT_LUA_000508")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000508 )
		UseItemFailed ( role )
		return	
	end
	local statelv = 9
	local statetime = 900
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ==  nil then
		local ret = UseAexpItem(role,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	
end

--------------------------------------------------------------中阶五倍经验果-------------------------------------------------
function ItemUse_molibless ( role , Item )
	
	local lv= GetChaAttr(role, ATTR_LV) 
	if lv > 70  then
		CALCULATE_ITEMEFFECT_LUA_000509 = GetResString("CALCULATE_ITEMEFFECT_LUA_000509")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000509 )
		UseItemFailed ( role )
		return	
	end

	local statelv = 7
	local statetime = 1800
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		local ret = UseAexpItem(role,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	else
		local ret = UseAexpItem(Cha_Boat,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	end
	CALCULATE_ITEMEFFECT_LUA_000510 = GetResString("CALCULATE_ITEMEFFECT_LUA_000510")
	SystemNotice ( role ,CALCULATE_ITEMEFFECT_LUA_000510 )
end

--------------------------------------------------------------摩力祝福果-------------------------------------------------
function ItemUse_molibless1 ( role , Item )
	
	
	local lv= GetChaAttr(role, ATTR_LV) 
	if lv < 50 then
		CALCULATE_ITEMEFFECT_LUA_000511 = GetResString("CALCULATE_ITEMEFFECT_LUA_000511")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000511 )
		UseItemFailed ( role )
		return
	elseif lv > 75  then
		CALCULATE_ITEMEFFECT_LUA_000512 = GetResString("CALCULATE_ITEMEFFECT_LUA_000512")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000512 )
		UseItemFailed ( role )
		return	
	end

	local statelv = 7

	local statetime = 1800
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		local ret = UseAexpItem(role,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	else
		local ret = UseAexpItem(Cha_Boat,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	end
	CALCULATE_ITEMEFFECT_LUA_000513 = GetResString("CALCULATE_ITEMEFFECT_LUA_000513")
	SystemNotice ( role ,CALCULATE_ITEMEFFECT_LUA_000513 )
end  

--------------------------------------------------------------摩力团队果-----------------------------------------------------
function ItemUse_moliteam( role , Item )

	local statelv = 1
	
	local ZDJYstatelv=GetChaStateLv(role,STATE_ZDSBJYGZ)
	if ZDJYstatelv~= 0 then
		CALCULATE_ITEMEFFECT_LUA_000029 = GetResString("CALCULATE_ITEMEFFECT_LUA_000029")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000029 )
		UseItemFailed ( role )
		return
	end

	local statetime = 900
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		AddState( role , role , STATE_ZDSBJYGZ , statelv , statetime )
	else
		AddState( Cha_Boat , Cha_Boat , STATE_ZDSBJYGZ , statelv , statetime )
	end
end

-------------------------------------------------------------------春风镇传送石-----------------------------------------------------------------------
function Jz_Script_spring(role, Item )

	local i = CheckBagItem(role,5619)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )
	if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,5619,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000045 = GetResString("BIRTH_BIRTH_CONF_LUA_000045")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000045)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

------------------------------------------------------------夏岛传送石-----------------------------------------------------------------------------
function Jz_Script_summer(role, Item )

	local i = CheckBagItem(role,5620)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )
	if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,5620,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000046 = GetResString("BIRTH_BIRTH_CONF_LUA_000046")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000046)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

----------------------------------------------------------------秋岛传送石-------------------------------------------------------------------------
function Jz_Script_autumn(role, Item )

	local i = CheckBagItem(role,5621)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )
	if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,5621,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000047 = GetResString("BIRTH_BIRTH_CONF_LUA_000047")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000047)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

-----------------------------------------------------------------加勒比传送石------------------------------------------------------------------------
function Jz_Script_caribbean (role, Item )

	local i = CheckBagItem(role,5622)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )
	if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,5622,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000048 = GetResString("BIRTH_BIRTH_CONF_LUA_000048")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000048)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

------------------------------------------------------------------地狱4层传送石----------------------------------------------------------------------
function Jz_Script_4clime(role, Item )

	local i = CheckBagItem(role,5623)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )
	if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,5623,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000049 = GetResString("BIRTH_BIRTH_CONF_LUA_000049")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000049)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

-----------------------------------------------------------------------圣雪山传送石---------------------------------------------------------------------
function Jz_Script_jokul(role, Item )

	local i = CheckBagItem(role,5624)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )
	if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,5624,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000028 = GetResString("BIRTH_BIRTH_CONF_LUA_000028")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000028)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

-------------------------------------------------------------------雷霆堡传送石-----------------------------------------------------------------------
function Jz_Script_lante(role, Item )

	local i = CheckBagItem(role,5625)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )
	if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,5625,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000002 = GetResString("BIRTH_BIRTH_CONF_LUA_000002")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000002)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

----------------------------------------------------------------------08年商品调整(改名,效果提升) kokora-----------------------------------------------

-------------------------------------超级生命恢复剂-----------------------------------------
function ItemUse_superment( role , Item )

	local hp = GetChaAttr(role, ATTR_HP) 
	hp_resume = 1500 
	
	hp = hp + hp_resume 
	mxhp = GetChaAttr(role,ATTR_MXHP) 
	if hp > mxhp then --加超过最大sp时返回为最大sp
		hp = mxhp 
	end 
	SetCharaAttr(hp, role, ATTR_HP)
end

------------------------------------法力圣水-----------------------------------------
function ItemUse_holywater( role , Item ) 

	local sp = GetChaAttr(role, ATTR_SP) 
	sp_resume = 250
	
	sp = sp + sp_resume 
	mxsp = GetChaAttr(role,ATTR_MXSP) 
	if sp > mxsp then --加超过最大sp时返回为最大sp
		sp = mxsp 
	end 
	SetCharaAttr(sp, role, ATTR_SP) 
end 

------------------------------------------------------防御灯笼-------------------------------------------------------------
function ItemUse_lantern ( role , Item )

	local statelv = 2
--	local ChaStateLv = GetChaStateLv ( role , STATE_LANTERN )
--	if ChaStateLv > statelv then
--		SystemNotice ( role , "已使用更高级的物品，请稍候再用" )
--		UseItemFailed ( role )
--		return
--	end
	local statetime = 600
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ==  nil then
		AddState( role , role , STATE_LANTERN , statelv , statetime )
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
end

---------------------------------------------------------------超人饺子-----------------------------------------------------------------
function ItemUse_supdumpling ( role , Item )

  	local hp = GetChaAttr(role, ATTR_HP) 
	local mxhp = GetChaAttr(role,ATTR_MXHP) 	
	hp = hp + 0.35*mxhp 

	if hp > mxhp then 
		hp = mxhp 
	end 
	SetCharaAttr(hp, role, ATTR_HP)

end

--------------------------------迅捷幻行水 移动速度提高50%小幅度降低防御,持续时间5分钟---------------------------------------------------
function ItemUse_rapiddrug ( role , Item )

	local statelv = 1
	local statetime = 300
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ==  nil then
		Rem_State_StarUnnormal ( role )
		AddState( role , role , STATE_RAPIDDRUG , statelv , statetime )
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
end

--战狂药剂 瞬间提高攻击力500同时防御力降低60持续时间10分钟------------------------------------------------------
function ItemUse_warsit ( role , Item )

	Rem_State_StarUnnormal ( role )
	local statelv = 1
	local statetime = 600
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		Rem_State_StarUnnormal ( role )
		AddState( role , role , STATE_WARSIT , statelv , statetime )
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
end

------------------------------------------玄龙装甲 瞬间提高攻击力100同时防御力降低30持续时间10分钟--------------------------------------------
function ItemUse_darkdress ( role , Item )

	local statelv = 1
	local statetime = 600
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ==  nil then
		Rem_State_StarUnnormal ( role )
		AddState( role , role , STATE_DARKDRESS , statelv , statetime )
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
end

---------------------------------------------------附魔针剂---------------------------------------------------------------------
function ItemUse_demon( role , Item )
	
	local OtherStateLv = 0
	local i = 0
	local State_Num = 8
	local State = {}
	State [0] = GetChaStateLv ( role , STATE_YSMJQH )
	State [1] = GetChaStateLv ( role , STATE_YSLQQH )
	State [2] = GetChaStateLv ( role , STATE_YSTZQH )
	State [3] = GetChaStateLv ( role , STATE_YSLLQH )
	State [4] = GetChaStateLv ( role , STATE_YSJSQH )
	State [5] = GetChaStateLv ( role , STATE_GREATSH )
	State [6] = GetChaStateLv ( role , STATE_MIRAGE )
	State [7] = GetChaStateLv ( role , STATE_DEVOTE )
	State [8] = GetChaStateLv ( role , STATE_VIGOUR )

	for i = 0 , State_Num , 1 do
		if State[i] >= 1 then
			OtherStateLv = OtherStateLv + 1
		end
	end


	if OtherStateLv > 0 then
		CALCULATE_ITEMEFFECT_LUA_000043 = GetResString("CALCULATE_ITEMEFFECT_LUA_000043")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000043)
		UseItemFailed ( role )
		return
	end

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end


	local statelv = 1
	local statetime = 900
	AddState( role , role , STATE_DEMON , statelv , statetime )

end

----------------------------------------------------------------巨甲针剂-------------------------------------------------------------------
function ItemUse_greatsh( role , Item )
	
	local OtherStateLv = 0
	local i = 0
	local State_Num = 8
	local State = {}
	State [0] = GetChaStateLv ( role , STATE_YSMJQH )
	State [1] = GetChaStateLv ( role , STATE_YSLQQH )
	State [2] = GetChaStateLv ( role , STATE_YSTZQH )
	State [3] = GetChaStateLv ( role , STATE_YSLLQH )
	State [4] = GetChaStateLv ( role , STATE_YSJSQH )
	State [5] = GetChaStateLv ( role , STATE_DEMON )
	State [6] = GetChaStateLv ( role , STATE_MIRAGE )
	State [7] = GetChaStateLv ( role , STATE_DEVOTE )
	State [8] = GetChaStateLv ( role , STATE_VIGOUR )


	for i = 0 , State_Num , 1 do
		if State[i] >= 1 then
			OtherStateLv = OtherStateLv + 1
		end
	end



	if OtherStateLv > 0 then
		CALCULATE_ITEMEFFECT_LUA_000043 = GetResString("CALCULATE_ITEMEFFECT_LUA_000043")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000043)
		UseItemFailed ( role )
		return
	end

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end


	local statelv = 1
	local statetime = 900
	AddState( role , role , STATE_GREATSH , statelv , statetime )

end

----------------------------------------------------------------幻灵针剂-------------------------------------------------------------------
function ItemUse_mirage( role , Item )

	local OtherStateLv = 0
	local i = 0
	local State_Num = 8
	local State = {}
	State [0] = GetChaStateLv ( role , STATE_YSMJQH )
	State [1] = GetChaStateLv ( role , STATE_YSLQQH )
	State [2] = GetChaStateLv ( role , STATE_YSTZQH )
	State [3] = GetChaStateLv ( role , STATE_YSLLQH )
	State [4] = GetChaStateLv ( role , STATE_YSJSQH )
	State [5] = GetChaStateLv ( role , STATE_DEMON )
	State [6] = GetChaStateLv ( role , STATE_GREATSH )
	State [7] = GetChaStateLv ( role , STATE_DEVOTE )
	State [8] = GetChaStateLv ( role , STATE_VIGOUR )




	for i = 0 , State_Num , 1 do
		if State[i] >= 1 then
			OtherStateLv = OtherStateLv + 1
		end
	end

	if OtherStateLv > 0 then
		CALCULATE_ITEMEFFECT_LUA_000043 = GetResString("CALCULATE_ITEMEFFECT_LUA_000043")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000043)
		UseItemFailed ( role )
		return
	end
	
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end

	local statelv = 1
	local statetime = 900
	AddState( role , role , STATE_MIRAGE , statelv , statetime )

end

--------------------------------------------------------------------专注针剂-------------------------------------------------------------------------
function ItemUse_devote( role , Item )

	local OtherStateLv = 0
	local i = 0
	local State_Num = 8
	local State = {}
	State [0] = GetChaStateLv ( role , STATE_YSMJQH )
	State [1] = GetChaStateLv ( role , STATE_YSLQQH )
	State [2] = GetChaStateLv ( role , STATE_YSTZQH )
	State [3] = GetChaStateLv ( role , STATE_YSLLQH )
	State [4] = GetChaStateLv ( role , STATE_YSJSQH )
	State [5] = GetChaStateLv ( role , STATE_DEMON )
	State [6] = GetChaStateLv ( role , STATE_GREATSH )
	State [7] = GetChaStateLv ( role , STATE_MIRAGE )
	State [8] = GetChaStateLv ( role , STATE_VIGOUR )

	for i = 0 , State_Num , 1 do
		if State[i] >= 1 then
			OtherStateLv = OtherStateLv + 1
		end
	end



	if OtherStateLv > 0 then
		CALCULATE_ITEMEFFECT_LUA_000043 = GetResString("CALCULATE_ITEMEFFECT_LUA_000043")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000043)
		UseItemFailed ( role )
		return
	end

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end


	local statelv = 1
	local statetime = 900
	AddState( role , role , STATE_DEVOTE , statelv , statetime )

end

--------------------------------------------------------------力狂针剂--------------------------------------------------------------------
function ItemUse_vigour( role , Item )
	
	local OtherStateLv = 0
	local i = 0
	local State_Num = 8
	local State = {}
	State [0] = GetChaStateLv ( role , STATE_YSMJQH )
	State [1] = GetChaStateLv ( role , STATE_YSLQQH )
	State [2] = GetChaStateLv ( role , STATE_YSTZQH )
	State [3] = GetChaStateLv ( role , STATE_YSLLQH )
	State [4] = GetChaStateLv ( role , STATE_YSJSQH )
	State [5] = GetChaStateLv ( role , STATE_DEMON )
	State [6] = GetChaStateLv ( role , STATE_GREATSH )
	State [7] = GetChaStateLv ( role , STATE_MIRAGE )
	State [8] = GetChaStateLv ( role , STATE_DEVOTE )

	for i = 0 , State_Num , 1 do
		if State[i] >= 1 then
			OtherStateLv = OtherStateLv + 1
		end
	end


	if OtherStateLv > 0 then
		CALCULATE_ITEMEFFECT_LUA_000043 = GetResString("CALCULATE_ITEMEFFECT_LUA_000043")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000043)
		UseItemFailed ( role )
		return
	end	

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end


	local statelv = 1
	local statetime = 900
	AddState( role , role , STATE_VIGOUR , statelv , statetime )

end

---------------------------------------------------------------新手双倍经验果---------------------------------------------------------
function ItemUse_molilucky( role , Item )

	local statelv = 1
	local lv_star = GetChaAttr( role , ATTR_LV) 
	if lv_star > 40 then
		CALCULATE_ITEMEFFECT_LUA_000247 = GetResString("CALCULATE_ITEMEFFECT_LUA_000247")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000247 )
		UseItemFailed ( role )
		return
	end
	local statetime = 60+5*(lv_star-1)
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		local ret = UseAexpItem(role,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	else
		local ret = UseAexpItem(Cha_Boat,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	end
end 

-----------------------------------------------------------------高阶三倍经验果-----------------------------------------------------------
function ItemUse_moliegis( role , Item )
	
	local Lv = Lv( role )
	if Lv < 50 then
		CALCULATE_ITEMEFFECT_LUA_000514 = GetResString("CALCULATE_ITEMEFFECT_LUA_000514")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000514)
		UseItemFailed ( role )
		return
	end

	local statelv = 5
	local ZBMain= GetChaAttr(role,ATTR_EXTEND0)
	local ZBNType= math.floor(ZBMain/10)      ---第几次占卜
	local ZBNMain= math.fmod(ZBMain,10 )			---BUFF OR DEBUFF
	local ZBday = GetChaAttr(role,ATTR_EXTEND2)		--占卜天数
	local ZBstate=GetChaAttr(role, ATTR_EXTEND1)	--
	local ZBstate1=math.floor(ZBstate/10)			--占卜效果注册
	local ZBstate2=math.fmod(ZBstate,10)				--占卜类型
	local now_day=os.date("%d")
	now_day=tonumber(now_day)
	if now_day==ZBday and ZBstate2==7 then
		statelv=7
	end
	
	
	local statetime = 1800
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		local ret = UseAexpItem(role,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	else
		local ret = UseAexpItem(Cha_Boat,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	end
	CALCULATE_ITEMEFFECT_LUA_000515 = GetResString("CALCULATE_ITEMEFFECT_LUA_000515")
	SystemNotice ( role ,CALCULATE_ITEMEFFECT_LUA_000515 )
	if statelv==7 then 
		CALCULATE_ITEMEFFECT_LUA_000516 = GetResString("CALCULATE_ITEMEFFECT_LUA_000516")
		SystemNotice ( role,CALCULATE_ITEMEFFECT_LUA_000516 )
	end
end

-------------------------------------------------------------高阶三倍掉料果/魔力财富果-----------------------------------------------------------------------------
function ItemUse_molimoney( role , Item )

	local Lv = Lv( role )
	if Lv < 60 then
		CALCULATE_ITEMEFFECT_LUA_000033 = GetResString("CALCULATE_ITEMEFFECT_LUA_000033")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000033)
		UseItemFailed ( role )
		return
	end


	local statelv = 5

	local statetime = 1800
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ==  nil then
		local ret = UseABLItem(role,Item,statelv,statetime)
		if ret == 0 then
			UseItemFailed ( role )
			return
		end
	else
		local ret = UseABLItem(Cha_Boat,Item,statelv,statetime)
		if ret == 0 then
			UseItemFailed ( role )
			return
		end
	end
	CALCULATE_ITEMEFFECT_LUA_000517 = GetResString("CALCULATE_ITEMEFFECT_LUA_000517")
	SystemNotice ( role ,CALCULATE_ITEMEFFECT_LUA_000517 )
end

------------------------------------------------------高级精灵饲料\高级自动喂食饲料-----------------------------------------------------------------------------

function ItemUse_numeneat ( role , Item , Item_Traget )
	
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end      
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
		local Item_Traget_URE=GetItemAttr(Item_Traget,ITEMATTR_URE)  --取当前耐久
		local Item_Traget_MAXURE=GetItemAttr(Item_Traget,ITEMATTR_MAXURE)--取最大耐久
		local Item_type = GetItemType ( Item )
		local Item_Traget_Type = GetItemType ( Item_Traget )
		local Num = 5000

		if Item_type == 57 and Item_Traget_Type == 59 then
				if Item_Traget_URE < Item_Traget_MAXURE then
				   Give_ElfURE ( role , Item_Traget , Num )
   	 			else
                                        CALCULATE_ITEMEFFECT_LUA_000081 = GetResString("CALCULATE_ITEMEFFECT_LUA_000081")
                                        SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000081 ) 
					UseItemFailed ( role )
					return
				end
		end 

end

----------------------------------------------------------船只加速帆-----------------------------------------------------------------------
function ItemUse_shipdrive ( role , Item )

	local statelv = 1
	local statetime = 900
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		AddState( Cha_Boat , Cha_Boat , STATE_SHIPDRIVE , statelv , statetime )
	else
		CALCULATE_ITEMEFFECT_LUA_000074 = GetResString("CALCULATE_ITEMEFFECT_LUA_000074")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000074 )
		UseItemFailed ( role )
		return
	end

end


-------------------------------------------------------------船只防御甲----------------------------------------------------------------
function ItemUse_shiprecovery ( role , Item )

	local statelv = 1
	local statetime = 1800
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )                  
	if Cha_Boat ~=  nil then
		AddState( Cha_Boat , Cha_Boat , STATE_SHIPRECOVER , statelv , statetime )
	else
		CALCULATE_ITEMEFFECT_LUA_000074 = GetResString("CALCULATE_ITEMEFFECT_LUA_000074")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000074 )
		UseItemFailed ( role )
		return
	end

end


-------------------------------------------------------黑龙瞳匣子
function ItemUse_HLTBOX ( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <2 then
		CALCULATE_ITEMEFFECT_LUA_000518 = GetResString("CALCULATE_ITEMEFFECT_LUA_000518")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000518)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 864
	local stone1_lv = 5
	local stone2_id = 885
	local stone2_lv = 5
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	local r3,r4 =MakeItem ( role , stone2_id  , 1 , 4 )
	local Item_newJL2 = GetChaItem ( role , 2 , r4 )			
	local Item_newJLID2 = GetItemID ( Item_newJL2 )		
	SetItemAttr ( Item_newJL2 , ITEMATTR_VAL_BaoshiLV , stone2_lv )
	LG( "Lv5StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end

-------------------------------------------------------黑龙心匣子
function ItemUse_HLXBOX ( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <2 then
		CALCULATE_ITEMEFFECT_LUA_000518 = GetResString("CALCULATE_ITEMEFFECT_LUA_000518")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000518)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 866
	local stone1_lv = 5
	local stone2_id = 885
	local stone2_lv = 5
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	local r3,r4 =MakeItem ( role , stone2_id  , 1 , 4 )
	local Item_newJL2 = GetChaItem ( role , 2 , r4 )			
	local Item_newJLID2 = GetItemID ( Item_newJL2 )		
	SetItemAttr ( Item_newJL2 , ITEMATTR_VAL_BaoshiLV , stone2_lv )
	LG( "Lv5StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end

-------------------------------------------------------黑龙魂匣子
function ItemUse_HLHBOX ( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <2 then
		CALCULATE_ITEMEFFECT_LUA_000518 = GetResString("CALCULATE_ITEMEFFECT_LUA_000518")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000518)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 865
	local stone1_lv = 5
	local stone2_id = 885
	local stone2_lv = 5
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	local r3,r4 =MakeItem ( role , stone2_id  , 1 , 4 )
	local Item_newJL2 = GetChaItem ( role , 2 , r4 )			
	local Item_newJLID2 = GetItemID ( Item_newJL2 )		
	SetItemAttr ( Item_newJL2 , ITEMATTR_VAL_BaoshiLV , stone2_lv )
	LG( "Lv5StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end
------------------------------------------------------------香港白色情人节精选宝箱------------------by FGCA.Justice---------
function ItemUse_JXBX ( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <4 then
		CALCULATE_ITEMEFFECT_LUA_000519 = GetResString("CALCULATE_ITEMEFFECT_LUA_000519")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000519)
		UseItemFailed ( role )
		return
	end
		GiveItem ( role , 0 , 3354  , 1 , 4 ) 
		GiveItem ( role , 0 , 3355  , 1 , 4 ) 
		GiveItem ( role , 0 , 3356  , 1 , 4 )
		GiveItem ( role , 0 , 3077  , 1 , 4 )
end

---------------------------------------------------080220新需求-------------------------kokora-------------------------------

----------------------------------乾坤锦囊--------------------------------------------------------------
function ItemUse_universebox (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000520 = GetResString("CALCULATE_ITEMEFFECT_LUA_000520")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000520 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000521 = GetResString("CALCULATE_ITEMEFFECT_LUA_000521")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000521)
		UseItemFailed ( role )
		return
	end
		
	local Itemsc = {0863,0860,0862,0861,1012}	 -----------------------------打开背包获得炎玉;风灵石;岩玉;鹰眼石;加纳之神的机率为20%
	local	sc = math.random(1,5)
	local ItemId = Itemsc[sc]
	GiveItem ( role , 0 , ItemId , 1 , 4 )
	local cha_name = GetChaDefaultName ( role )
	local itemname = GetItemName ( ItemId )
	CALCULATE_ITEMEFFECT_LUA_000522 = GetResString("CALCULATE_ITEMEFFECT_LUA_000522")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000522..itemname )
end

----------------------------------乌龙宝箱--------------------------------------------------------------
function ItemUse_jetdragon (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000523 = GetResString("CALCULATE_ITEMEFFECT_LUA_000523")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000523 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000524 = GetResString("CALCULATE_ITEMEFFECT_LUA_000524")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000524)
		UseItemFailed ( role )
		return
	end
		
	local Itemsc = {0866,0866,0865,0864}	 -----------------------------打开背包获得黑龙之心的机率为50%,获得黑龙之瞳和黑龙之魂的机率为25%
	local	sc = math.random(1,4)
	local ItemId = Itemsc[sc]
	GiveItem ( role , 0 , ItemId , 1 , 4 )
	local cha_name = GetChaDefaultName ( role )
	local itemname = GetItemName ( ItemId )
	CALCULATE_ITEMEFFECT_LUA_000525 = GetResString("CALCULATE_ITEMEFFECT_LUA_000525")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000525..itemname )
end

----------------------------------85级神装宝箱--------------------------------------------------------------
function ItemUse_raritybox (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000526 = GetResString("CALCULATE_ITEMEFFECT_LUA_000526")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000526 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000527 = GetResString("CALCULATE_ITEMEFFECT_LUA_000527")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000527)
		UseItemFailed ( role )
		return
	end
	
	local job = GetChaAttr( role, ATTR_JOB) --取职业
	local cha_type = GetChaTypeID ( role )
	local itemname = ""
	if cha_type ~= 2 and job==4 then
		GiveItem ( role , 0 , 2580 , 1 , 4 )--------------修罗之海魄
		CALCULATE_ITEMEFFECT_LUA_000528 = GetResString("CALCULATE_ITEMEFFECT_LUA_000528")
		itemname = CALCULATE_ITEMEFFECT_LUA_000528
	elseif cha_type ~= 2 and job==16 then
		GiveItem ( role , 0 , 2580 , 1 , 4 )--------------修罗之海魄
		CALCULATE_ITEMEFFECT_LUA_000528 = GetResString("CALCULATE_ITEMEFFECT_LUA_000528")
		itemname = CALCULATE_ITEMEFFECT_LUA_000528
	elseif cha_type == 2  and job~=0 then
		GiveItem ( role , 0 , 2577 , 1 , 4 )----------------哈迪斯之强悍
		CALCULATE_ITEMEFFECT_LUA_000529 = GetResString("CALCULATE_ITEMEFFECT_LUA_000529")
		itemname = CALCULATE_ITEMEFFECT_LUA_000529
	elseif cha_type ~= 2 and  cha_type ~= 4 and job==2 then
		GiveItem ( role , 0 , 2579  , 1 , 4 )-----------------地狱之羿羽
		CALCULATE_ITEMEFFECT_LUA_000530 = GetResString("CALCULATE_ITEMEFFECT_LUA_000530")
		itemname = CALCULATE_ITEMEFFECT_LUA_000530
	elseif cha_type ~= 2 and  cha_type ~= 4 and job==12 then
		GiveItem ( role , 0 , 2579  , 1 , 4 )-----------------地狱之羿羽
		CALCULATE_ITEMEFFECT_LUA_000530 = GetResString("CALCULATE_ITEMEFFECT_LUA_000530")
		itemname = CALCULATE_ITEMEFFECT_LUA_000530
	elseif cha_type ~= 1 and  cha_type ~= 2 and job==5 then
		local dina=math.random ( 1, 2 )
	if dina==1 then
		GiveItem ( role , 0 , 2582  , 1 , 4 )------------幽冥之晶灵
		CALCULATE_ITEMEFFECT_LUA_000531 = GetResString("CALCULATE_ITEMEFFECT_LUA_000531")
		itemname = CALCULATE_ITEMEFFECT_LUA_000531
	else
		GiveItem ( role , 0 , 2581  , 1 , 4 )-------------冥河之魔化
		CALCULATE_ITEMEFFECT_LUA_000532 = GetResString("CALCULATE_ITEMEFFECT_LUA_000532")
		itemname = CALCULATE_ITEMEFFECT_LUA_000532
	end
	elseif cha_type ~= 1 and  cha_type ~= 2 and job==13 then
		GiveItem ( role , 0 , 2582  , 1 , 4 )------------幽冥之晶灵
		CALCULATE_ITEMEFFECT_LUA_000533 = GetResString("CALCULATE_ITEMEFFECT_LUA_000533")
		itemname = CALCULATE_ITEMEFFECT_LUA_000533
	elseif cha_type ~= 1 and  cha_type ~= 2 and job==14 then
		GiveItem ( role , 0 , 2581  , 1 , 4 )-------------冥河之魔化
		CALCULATE_ITEMEFFECT_LUA_000532 = GetResString("CALCULATE_ITEMEFFECT_LUA_000532")
		itemname = CALCULATE_ITEMEFFECT_LUA_000532
	elseif cha_type == 1 and  job==1 then
		GiveItem ( role , 0 , 2578  , 1 , 4 )-------------黑暗之威力
		CALCULATE_ITEMEFFECT_LUA_000534 = GetResString("CALCULATE_ITEMEFFECT_LUA_000534")
		itemname = CALCULATE_ITEMEFFECT_LUA_000534
	elseif cha_type == 1 and  job==9 then
		GiveItem ( role , 0 , 2578  , 1 , 4 )-------------黑暗之威力
		CALCULATE_ITEMEFFECT_LUA_000534 = GetResString("CALCULATE_ITEMEFFECT_LUA_000534")
		itemname = CALCULATE_ITEMEFFECT_LUA_000534
	elseif cha_type == 3 and  job==1 then
		GiveItem ( role , 0 , 2578  , 1 , 4 )-------------黑暗之威力
		CALCULATE_ITEMEFFECT_LUA_000534 = GetResString("CALCULATE_ITEMEFFECT_LUA_000534")
		itemname = CALCULATE_ITEMEFFECT_LUA_000534
	elseif cha_type == 3 and  job==9 then
		GiveItem ( role , 0 , 2578  , 1 , 4 )-------------黑暗之威力
		CALCULATE_ITEMEFFECT_LUA_000534 = GetResString("CALCULATE_ITEMEFFECT_LUA_000534")
		itemname = CALCULATE_ITEMEFFECT_LUA_000534
	else 
		CALCULATE_ITEMEFFECT_LUA_000103 = GetResString("CALCULATE_ITEMEFFECT_LUA_000103")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000103)
		UseItemFailed ( role )
		return
	end
	local cha_name = GetChaDefaultName ( role )
	CALCULATE_ITEMEFFECT_LUA_000535 = GetResString("CALCULATE_ITEMEFFECT_LUA_000535")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000535..itemname )
end

----------------------------------紫晶宝箱 --------------------------------------------------------------
function ItemUse_purplebox (role, Item)

	-- local Cha_Boat = GetCtrlBoat ( role )
	-- if Cha_Boat ~=  nil then
		-- SystemNotice( role , "出海时不可使用紫晶宝箱" )
		-- UseItemFailed ( role )
		-- return
	-- end
	-- local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 -- if Item_CanGet < 1 then
		-- SystemNotice(role ,"打开紫晶宝箱至少需要1个空位")
		-- UseItemFailed ( role )
		-- return
	-- end
	-- local i= CheckBagItem( role, 5702 )                                                
	-- if i <=0 then
		-- SystemNotice(  role , "请确定您身上有开启紫晶宝箱的紫晶钥匙")
		-- UseItemFailed ( role )
		-- return LUA_FALSE
	-- end
	
	-- local s = DelBagItem ( role , 5702 , 1 ) 
	local	sc = math.random(1,100)
	local itemname = ""
	if  sc <=50 then	
		GiveItem ( role , 0 , 5711 , 1 , 4 )                    ---------------青龙宝箱   获得机率50%
		CALCULATE_ITEMEFFECT_LUA_000536 = GetResString("CALCULATE_ITEMEFFECT_LUA_000536")
		itemname = CALCULATE_ITEMEFFECT_LUA_000536
	elseif sc <=90 then		
		GiveItem ( role , 0 , 2997 , 5 , 4 )                    ---------------洛克藏宝图   获得机率40%
		CALCULATE_ITEMEFFECT_LUA_000537 = GetResString("CALCULATE_ITEMEFFECT_LUA_000537")
		itemname = CALCULATE_ITEMEFFECT_LUA_000537
	elseif sc <=95 then
		GiveItem ( role , 0 ,5703 , 1 , 4 )                    ---------------青龙钥匙   获得机率5%
		CALCULATE_ITEMEFFECT_LUA_000538 = GetResString("CALCULATE_ITEMEFFECT_LUA_000538")
		itemname = CALCULATE_ITEMEFFECT_LUA_000538
	elseif sc <=98 then
		GiveItem ( role , 0 ,5707 , 1 , 4 )                    ---------------乾坤锦囊   获得机率3%
		CALCULATE_ITEMEFFECT_LUA_000539 = GetResString("CALCULATE_ITEMEFFECT_LUA_000539")
		itemname = CALCULATE_ITEMEFFECT_LUA_000539
	elseif sc <=99 then
		GiveItem ( role , 0 ,0091 , 1 , 4 )                    ---------------中校之首   获得机率1%
		CALCULATE_ITEMEFFECT_LUA_000540 = GetResString("CALCULATE_ITEMEFFECT_LUA_000540")
		itemname = CALCULATE_ITEMEFFECT_LUA_000540	
	else   
		GiveItem ( role , 0 , 0853 , 1 , 4 )                   ---------------假期欢乐杂志   获得机率1%
		CALCULATE_ITEMEFFECT_LUA_000541 = GetResString("CALCULATE_ITEMEFFECT_LUA_000541")
		itemname = CALCULATE_ITEMEFFECT_LUA_000541
	end
	local cha_name = GetChaDefaultName ( role )
	CALCULATE_ITEMEFFECT_LUA_000542 = GetResString("CALCULATE_ITEMEFFECT_LUA_000542")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000542..itemname )
end

----------------------------------青龙宝箱 --------------------------------------------------------------
function ItemUse_greenbox (role, Item)

	-- local Cha_Boat = GetCtrlBoat ( role )
	-- if Cha_Boat ~=  nil then
		-- SystemNotice( role , "出海时不可使用青龙宝箱" )
		-- UseItemFailed ( role )
		-- return
	-- end
	-- local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 -- if Item_CanGet < 1 then
		-- SystemNotice(role ,"打开青龙宝箱至少需要1个空位")
		-- UseItemFailed ( role )
		-- return
	-- end
	-- local i= CheckBagItem( role, 5703 )                                                
	-- if i <=0 then
		-- SystemNotice(  role , "请确定您身上有开启青龙宝箱的青龙钥匙")
		-- UseItemFailed ( role )
		-- return LUA_FALSE
	-- end
	
	-- local s = DelBagItem ( role , 5703 , 1 ) 
	local	sc = math.random(1,100)
	local itemname = ""
	if  sc <=30 then	
		GiveItem ( role , 0 , 5712 , 1 , 4 )                    ---------------真龙宝箱   获得机率30%
		CALCULATE_ITEMEFFECT_LUA_000543 = GetResString("CALCULATE_ITEMEFFECT_LUA_000543")
		itemname = CALCULATE_ITEMEFFECT_LUA_000543
	elseif sc <=50 then		
		GiveItem ( role , 0 , 5707 , 1 , 4 )                    ---------------乾坤锦囊   获得机率20%
		CALCULATE_ITEMEFFECT_LUA_000539 = GetResString("CALCULATE_ITEMEFFECT_LUA_000539")
		itemname = CALCULATE_ITEMEFFECT_LUA_000539
	elseif sc <=65 then
		GiveItem ( role , 0 ,5750 , 1 , 4 )                    ---------------黄玉  获得机率15%
		CALCULATE_ITEMEFFECT_LUA_000544 = GetResString("CALCULATE_ITEMEFFECT_LUA_000544")
		itemname = CALCULATE_ITEMEFFECT_LUA_000544
	elseif sc <=80 then
		GiveItem ( role , 0 ,5752 , 1 , 4 )                    ---------------青玉   获得机率15%
		CALCULATE_ITEMEFFECT_LUA_000545 = GetResString("CALCULATE_ITEMEFFECT_LUA_000545")
		itemname = CALCULATE_ITEMEFFECT_LUA_000545
	elseif sc <=93 then
		GiveItem ( role , 0 ,5751 , 1 , 4 )                    ---------------赤玉   获得机率13%
		CALCULATE_ITEMEFFECT_LUA_000546 = GetResString("CALCULATE_ITEMEFFECT_LUA_000546")
		itemname = CALCULATE_ITEMEFFECT_LUA_000546
	elseif sc <=98 then
		GiveItem ( role , 0 ,5704 , 1 , 4 )                    ---------------真龙钥匙   获得机率5%
		CALCULATE_ITEMEFFECT_LUA_000547 = GetResString("CALCULATE_ITEMEFFECT_LUA_000547")
		itemname = CALCULATE_ITEMEFFECT_LUA_000547
	else   
		GiveItem ( role , 0 , 0092 , 1 , 4 )                   ---------------上校之首   获得机率2%
		CALCULATE_ITEMEFFECT_LUA_000548 = GetResString("CALCULATE_ITEMEFFECT_LUA_000548")
		itemname = CALCULATE_ITEMEFFECT_LUA_000548
	end
	local cha_name = GetChaDefaultName ( role )
	CALCULATE_ITEMEFFECT_LUA_000549 = GetResString("CALCULATE_ITEMEFFECT_LUA_000549")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000549..itemname )
end

----------------------------------真龙宝箱 --------------------------------------------------------------
function ItemUse_turebox (role, Item)

	-- local Cha_Boat = GetCtrlBoat ( role )
	-- if Cha_Boat ~=  nil then
		-- SystemNotice( role , "出海时不可使用真龙宝箱" )
		-- UseItemFailed ( role )
		-- return
	-- end
	-- local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 -- if Item_CanGet < 1 then
		-- SystemNotice(role ,"打开真龙宝箱至少需要1个空位")
		-- UseItemFailed ( role )
		-- return
	-- end
	-- local i= CheckBagItem( role, 5704 )                                                
	-- if i <=0 then
		-- SystemNotice(  role , "请确定您身上有开启真龙宝箱的真龙钥匙")
		-- UseItemFailed ( role )
		-- return LUA_FALSE
	-- end
	
	-- local s = DelBagItem ( role , 5704 , 1 ) 
	local	sc = math.random(1,100)
	local itemname = ""
	if  sc <=38 then	
		GiveItem ( role , 0 , 1014 , 1 , 4 )                    ---------------女神试炼仪式   获得机率38%
		CALCULATE_ITEMEFFECT_LUA_000550 = GetResString("CALCULATE_ITEMEFFECT_LUA_000550")
		itemname = CALCULATE_ITEMEFFECT_LUA_000550
	elseif sc <=58 then		
		GiveItem ( role , 0 , 5713 , 1 , 4 )                    ---------------至尊宝箱   获得机率20%
		CALCULATE_ITEMEFFECT_LUA_000551 = GetResString("CALCULATE_ITEMEFFECT_LUA_000551")
		itemname = CALCULATE_ITEMEFFECT_LUA_000551
	elseif sc <=77 then
		GiveItem ( role , 0 ,0992 , 20 , 4 )                    ---------------成长快餐   获得机率19%
		CALCULATE_ITEMEFFECT_LUA_000552 = GetResString("CALCULATE_ITEMEFFECT_LUA_000552")
		itemname = CALCULATE_ITEMEFFECT_LUA_000552
	elseif sc <=92 then
		GiveItem ( role , 0 ,3016, 1 , 4 )                    ---------------黑龙幻体召唤券   获得机率15%
		CALCULATE_ITEMEFFECT_LUA_000553 = GetResString("CALCULATE_ITEMEFFECT_LUA_000553")
		itemname = CALCULATE_ITEMEFFECT_LUA_000553
	elseif sc <=97 then
		GiveItem ( role , 0 ,5708 , 1 , 4 )                    ---------------乌龙宝箱   获得机率5%
		CALCULATE_ITEMEFFECT_LUA_000554 = GetResString("CALCULATE_ITEMEFFECT_LUA_000554")
		itemname = CALCULATE_ITEMEFFECT_LUA_000554
	else   
		GiveItem ( role , 0 , 5705 , 1 , 4 )                   ---------------至尊钥匙   获得机率3%
		CALCULATE_ITEMEFFECT_LUA_000555 = GetResString("CALCULATE_ITEMEFFECT_LUA_000555")
		itemname = CALCULATE_ITEMEFFECT_LUA_000555
	end
	local cha_name = GetChaDefaultName ( role )
	CALCULATE_ITEMEFFECT_LUA_000556 = GetResString("CALCULATE_ITEMEFFECT_LUA_000556")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000556..itemname )
end

----------------------------------至尊宝箱 --------------------------------------------------------------
function ItemUse_respectbox (role, Item)

	-- local Cha_Boat = GetCtrlBoat ( role )
	-- if Cha_Boat ~=  nil then
		-- SystemNotice( role , "出海时不可使用至尊宝箱" )
		-- UseItemFailed ( role )
		-- return
	-- end
	-- local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 -- if Item_CanGet < 1 then
		-- SystemNotice(role ,"打开至尊宝箱至少需要1个空位")
		-- UseItemFailed ( role )
		-- return
	-- end
	-- local i= CheckBagItem( role, 5705 )                                                
	-- if i <=0 then
		-- SystemNotice(  role , "请确定您身上有开启至尊宝箱的至尊钥匙")
		-- UseItemFailed ( role )
		-- return LUA_FALSE
	-- end
	
	-- local s = DelBagItem ( role , 5705 , 1 ) 
	local	sc = math.random(1,100)
	local itemname = ""
	if  sc <=20 then	
		GiveItem ( role , 0 , 0094 , 1 , 4 )                    ---------------元帅之首   获得机率20%
		CALCULATE_ITEMEFFECT_LUA_000501 = GetResString("CALCULATE_ITEMEFFECT_LUA_000501")
		itemname = CALCULATE_ITEMEFFECT_LUA_000501
	elseif sc <=40 then		
		GiveItem ( role , 0 , 2368 , 1 , 20 )                    ---------------真黑龙之爪   获得机率20%
		CALCULATE_ITEMEFFECT_LUA_000557 = GetResString("CALCULATE_ITEMEFFECT_LUA_000557")
		itemname = CALCULATE_ITEMEFFECT_LUA_000557
	elseif sc <=60 then
		GiveItem ( role , 0 ,2369 , 1 , 20 )                    ---------------真黑龙之翼   获得机率20%
		CALCULATE_ITEMEFFECT_LUA_000558 = GetResString("CALCULATE_ITEMEFFECT_LUA_000558")
		itemname = CALCULATE_ITEMEFFECT_LUA_000558
	elseif sc <=75 then
		GiveItem ( role , 0 ,5714 , 1 , 4 )                    ---------------无双宝箱   获得机率15%
		CALCULATE_ITEMEFFECT_LUA_000559 = GetResString("CALCULATE_ITEMEFFECT_LUA_000559")
		itemname = CALCULATE_ITEMEFFECT_LUA_000559
	elseif sc <=89 then
		GiveItem ( role , 0 ,2367 , 1 , 20 )                    ---------------真黑龙之躯   获得机率14%
		CALCULATE_ITEMEFFECT_LUA_000560 = GetResString("CALCULATE_ITEMEFFECT_LUA_000560")
		itemname = CALCULATE_ITEMEFFECT_LUA_000560
	elseif sc <=99 then
		GiveItem ( role , 0 ,5769 , 1 , 4 )                    ---------------魂魄百宝箱   获得机率10%
		CALCULATE_ITEMEFFECT_LUA_000561 = GetResString("CALCULATE_ITEMEFFECT_LUA_000561")
		itemname = CALCULATE_ITEMEFFECT_LUA_000561
	else   
		GiveItem ( role , 0 , 5706 , 1 , 4 )                   ---------------无双钥匙   获得机率1%
		CALCULATE_ITEMEFFECT_LUA_000562 = GetResString("CALCULATE_ITEMEFFECT_LUA_000562")
		itemname = CALCULATE_ITEMEFFECT_LUA_000562
	end
	local cha_name = GetChaDefaultName ( role )
	CALCULATE_ITEMEFFECT_LUA_000563 = GetResString("CALCULATE_ITEMEFFECT_LUA_000563")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000563..itemname )
end

----------------------------------无双宝箱 --------------------------------------------------------------
function ItemUse_peerlessbox (role, Item)

	-- local Cha_Boat = GetCtrlBoat ( role )
	-- if Cha_Boat ~=  nil then
		-- SystemNotice( role , "出海时不可使用无双宝箱" )
		-- UseItemFailed ( role )
		-- return
	-- end
	-- local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 -- if Item_CanGet < 1 then
		-- SystemNotice(role ,"打开无双宝箱至少需要1个空位")
		-- UseItemFailed ( role )
		-- return
	-- end
	-- local i= CheckBagItem( role, 5706 )                                                
	-- if i <=0 then
		-- SystemNotice(  role , "请确定您身上有开启无双宝箱的无双钥匙")
		-- UseItemFailed ( role )
		-- return LUA_FALSE
	-- end
	
	-- local s = DelBagItem ( role , 5706 , 1 ) 
	local	sc = math.random(1,100)
	local itemname = ""
	if  sc <=60 then	
		GiveItem ( role , 0 , 5709 , 1 , 4 )                    ---------------85级神装宝箱   获得机率60%
		CALCULATE_ITEMEFFECT_LUA_000564 = GetResString("CALCULATE_ITEMEFFECT_LUA_000564")
		itemname = CALCULATE_ITEMEFFECT_LUA_000564
	else   
		GiveItem ( role , 0 , 2522 , 1 , 4 )                   ---------------神之祈福包   获得机率15%
		CALCULATE_ITEMEFFECT_LUA_000565 = GetResString("CALCULATE_ITEMEFFECT_LUA_000565")
		itemname = CALCULATE_ITEMEFFECT_LUA_000565
	end
	local cha_name = GetChaDefaultName ( role )
	CALCULATE_ITEMEFFECT_LUA_000566 = GetResString("CALCULATE_ITEMEFFECT_LUA_000566")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000566..itemname )
end

---------------------------------------------080228运营新需求添加仿真洛克藏宝图（kokora）------------------------------------------
function ItemUse_hidebox (role, Item)

	local Itemsc = {0863,0860,0862,0861,1028,0992,0853,1012,0096,0094}	 --------------打开藏宝图获得炎玉;风灵石;鹰眼石;岩玉;摩力符石;成长快餐;假期欢乐杂志;加纳之神;船长之首;元帅之首的机率各为10%
	local	sc = math.random(1,10)
	local ItemId = Itemsc[sc]
	local cha_name = GetChaDefaultName ( role )
	local itemname = GetItemName ( ItemId )
	CALCULATE_ITEMEFFECT_LUA_000567 = GetResString("CALCULATE_ITEMEFFECT_LUA_000567")
	Notice ( cha_name..CALCULATE_ITEMEFFECT_LUA_000567..itemname )
end


------会战荣誉箱-------
function ItemUse_HZRYX ( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <=0 then
		CALCULATE_ITEMEFFECT_LUA_000568 = GetResString("CALCULATE_ITEMEFFECT_LUA_000568")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000568)
		UseItemFailed ( role )
		return
	end

--	local s = DelBagItem ( role , 5716 , 1 ) 
	local	sc = math.random(1,100)
	local itemname = ""
	if  sc <=30 then	
		GiveItem ( role , 0 , 0992 , 1 , 4 )                    ---------------成长快餐   获得机率30%
		CALCULATE_ITEMEFFECT_LUA_000569 = GetResString("CALCULATE_ITEMEFFECT_LUA_000569")
		itemname = CALCULATE_ITEMEFFECT_LUA_000569
	elseif sc <=69 then		
		GiveItem ( role , 0 , 2951 , 1 , 4 )                    ---------------乱斗加点书   获得机率39%
		CALCULATE_ITEMEFFECT_LUA_000570 = GetResString("CALCULATE_ITEMEFFECT_LUA_000570")
		itemname = CALCULATE_ITEMEFFECT_LUA_000570
	elseif sc <=99 then
		local Money_add = 3000000
		AddMoney ( role , 0 , Money_add )                  ---------------金钱300万   获得机率30%
		CALCULATE_ITEMEFFECT_LUA_000571 = GetResString("CALCULATE_ITEMEFFECT_LUA_000571")
		itemname = CALCULATE_ITEMEFFECT_LUA_000571
	else   
		GiveItem ( role , 0 , 0090 , 1 , 4 )                   ---------------少校之首   获得机率1%
		CALCULATE_ITEMEFFECT_LUA_000572 = GetResString("CALCULATE_ITEMEFFECT_LUA_000572")
		itemname = CALCULATE_ITEMEFFECT_LUA_000572
	end
	local cha_name = GetChaDefaultName ( role )
	local Guild_ID = GetChaGuildID(role)
	local Guild_Name = GetGuildName( Guild_ID )
	CALCULATE_ITEMEFFECT_LUA_000573 = GetResString("CALCULATE_ITEMEFFECT_LUA_000573")
	CALCULATE_ITEMEFFECT_LUA_000574 = GetResString("CALCULATE_ITEMEFFECT_LUA_000574")
	Notice ( Guild_Name..CALCULATE_ITEMEFFECT_LUA_000574..cha_name..CALCULATE_ITEMEFFECT_LUA_000573..itemname )

end
-------------------------
---------------------------------------------080401运营新需增加转生等级道具-通神的杂志（kokora）------------------------------------------
function ItemUse_generalbook ( role , Item )

	local zs_exp = GetChaAttr ( role , ATTR_CSAILEXP )
	if zs_exp <= 0 then
		UseItemFailed ( role )
		CALCULATE_ITEMEFFECT_LUA_000575 = GetResString("CALCULATE_ITEMEFFECT_LUA_000575")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000575)
		return 
	end
	if zs_exp >= 10000 then
		UseItemFailed ( role )
		CALCULATE_ITEMEFFECT_LUA_000576 = GetResString("CALCULATE_ITEMEFFECT_LUA_000576")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000576)
		return 
	end
	CALCULATE_ITEMEFFECT_LUA_000577 = GetResString("CALCULATE_ITEMEFFECT_LUA_000577")
	local goodluck = CALCULATE_ITEMEFFECT_LUA_000577
	if zs_exp > 0 and zs_exp < 400 then 
	SetChaAttrI(role, ATTR_CSAILEXP , 400)
	RefreshCha ( role )
	SystemNotice(role , goodluck)
	end
	if zs_exp >= 400 and zs_exp < 900 then 
	SetChaAttrI(role, ATTR_CSAILEXP , 900)
	RefreshCha ( role )
	SystemNotice(role , goodluck)
	end
	if zs_exp >= 900 and zs_exp < 1600 then 
	SetChaAttrI(role, ATTR_CSAILEXP , 1600)
	RefreshCha ( role )
	SystemNotice(role , goodluck)
	end
	if zs_exp >= 1600 and zs_exp < 2500 then 
	SetChaAttrI(role, ATTR_CSAILEXP , 2500)
	RefreshCha ( role )
	SystemNotice(role , goodluck)
	end
	if zs_exp >= 2500 and zs_exp < 3600 then 
	SetChaAttrI(role, ATTR_CSAILEXP , 3600)
	RefreshCha ( role )
	SystemNotice(role , goodluck)
	end
	if zs_exp >= 3600 and zs_exp < 4900 then 
	SetChaAttrI(role, ATTR_CSAILEXP , 4900)
	RefreshCha ( role )
	SystemNotice(role , goodluck)
	end
	if zs_exp >= 4900 and zs_exp < 6400 then 
	SetChaAttrI(role, ATTR_CSAILEXP , 6400)
	RefreshCha ( role )
	SystemNotice(role , goodluck)
	end
	if zs_exp >= 6400 and zs_exp < 8100 then 
	SetChaAttrI(role, ATTR_CSAILEXP , 8100)
	RefreshCha ( role )
	SystemNotice(role , goodluck)
	end
	if zs_exp >= 8100 and zs_exp < 10000 then 
	SetChaAttrI(role, ATTR_CSAILEXP , 10000)
	RefreshCha ( role )
	SystemNotice(role , goodluck)
	end
end

------------------------------------------------------魂魄百宝箱 by eric
function ItemUse_hpbbxBOX (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000578 = GetResString("CALCULATE_ITEMEFFECT_LUA_000578")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000578 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000579 = GetResString("CALCULATE_ITEMEFFECT_LUA_000579")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000579)
		UseItemFailed ( role )
		return
	end
	local job = GetChaAttr(role, ATTR_JOB)
	local itemname = ""
	if job == 9 then
		GiveItem ( role , 0 , 2563  , 1 , 41 )
		CALCULATE_FORGE_LUA_000235 = GetResString("CALCULATE_FORGE_LUA_000235")
		itemname = CALCULATE_FORGE_LUA_000235
	elseif job == 8 then
		GiveItem ( role , 0 , 2562  , 1 , 41 )
		CALCULATE_FORGE_LUA_000233 = GetResString("CALCULATE_FORGE_LUA_000233")
		itemname = CALCULATE_FORGE_LUA_000233 
	elseif job == 12 then
		GiveItem ( role , 0 , 2564  , 1 , 41 )
		CALCULATE_FORGE_LUA_000232 = GetResString("CALCULATE_FORGE_LUA_000232")
		itemname = CALCULATE_FORGE_LUA_000232 
	elseif job == 16 then
		GiveItem ( role , 0 , 2565  , 1 , 41 )
		CALCULATE_FORGE_LUA_000234 = GetResString("CALCULATE_FORGE_LUA_000234")
		itemname = CALCULATE_FORGE_LUA_000234
	elseif job == 13 then
		GiveItem ( role , 0 , 2566  , 1 , 41 )
		CALCULATE_FORGE_LUA_000231 = GetResString("CALCULATE_FORGE_LUA_000231")
		itemname = CALCULATE_FORGE_LUA_000231
	elseif job == 14 then
		GiveItem ( role , 0 , 2567  , 1 , 41 )
		CALCULATE_FORGE_LUA_000230 = GetResString("CALCULATE_FORGE_LUA_000230")
		itemname = CALCULATE_FORGE_LUA_000230
	else
		CALCULATE_ITEMEFFECT_LUA_000580 = GetResString("CALCULATE_ITEMEFFECT_LUA_000580")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000580 )
		UseItemFailed ( role )
		return
	end
	local cha_name = GetChaDefaultName ( role )
	CALCULATE_ITEMEFFECT_LUA_000581 = GetResString("CALCULATE_ITEMEFFECT_LUA_000581")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000581..itemname )
end

---------------------------召唤冥皇—卡拉 by eric
function ItemUse_MHKALAZHQ ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local star = 0
	star =IsChaInRegion( role, 2 )
	if star == 1 then
		CALCULATE_ITEMEFFECT_LUA_000234 = GetResString("CALCULATE_ITEMEFFECT_LUA_000234")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000234 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	local MonsterID = 988
	local Refresh = 9000					--重生时间，秒单位
	local life = 9000000						--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaLifeTime( new, life )
end


--------------------------一级圣王宝藏
function ItemUse_lv1swbzbox (role, Item)

	SystemNotice( role , "in1" )
	local Cha_Boat = GetCtrlBoat ( role )
	
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000582 = GetResString("CALCULATE_ITEMEFFECT_LUA_000582")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000582 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000583 = GetResString("CALCULATE_ITEMEFFECT_LUA_000583")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000583)
		UseItemFailed ( role )
		return
	end
	local	sc = math.random(1,100)
	local itemname = ""
	if  sc <=5 then	
		GiveItem ( role , 0 , 3012 , 1 , 4 )                    ---------------蜥蜴战士统领召唤券   获得机率5%
		CALCULATE_ITEMEFFECT_LUA_000584 = GetResString("CALCULATE_ITEMEFFECT_LUA_000584")
		itemname = CALCULATE_ITEMEFFECT_LUA_000584
	elseif sc <=26 then		
		GiveItem ( role , 0 , 3095 , 1 , 4 )                    ---------------高级努力增幅器   获得机率21%
		CALCULATE_ITEMEFFECT_LUA_000469 = GetResString("CALCULATE_ITEMEFFECT_LUA_000469")
		itemname = CALCULATE_ITEMEFFECT_LUA_000469
	elseif sc <=27 then
		GiveItem ( role , 0 , 5782 , 1 , 4 )                    ---------------二级圣王宝藏钥匙   获得机率1%
		CALCULATE_ITEMEFFECT_LUA_000585 = GetResString("CALCULATE_ITEMEFFECT_LUA_000585")
		itemname = CALCULATE_ITEMEFFECT_LUA_000585
	elseif sc <=77 then
		GiveItem ( role , 0 , 5778 , 1 , 4 )                    ---------------二级圣王宝藏   获得机率50%
		CALCULATE_ITEMEFFECT_LUA_000586 = GetResString("CALCULATE_ITEMEFFECT_LUA_000586")
		itemname = CALCULATE_ITEMEFFECT_LUA_000586
	else   
		GiveItem ( role , 0 , 5609 , 1 , 4 )                   ---------------免死金牌   获得机率23%
		CALCULATE_ITEMEFFECT_LUA_000587 = GetResString("CALCULATE_ITEMEFFECT_LUA_000587")
		itemname = CALCULATE_ITEMEFFECT_LUA_000587
	end
	local cha_name = GetChaDefaultName ( role )
	CALCULATE_ITEMEFFECT_LUA_000588 = GetResString("CALCULATE_ITEMEFFECT_LUA_000588")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000588..itemname )
end

--------------------------二级圣王宝藏
function ItemUse_lv2swbzbox (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000589 = GetResString("CALCULATE_ITEMEFFECT_LUA_000589")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000589 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000590 = GetResString("CALCULATE_ITEMEFFECT_LUA_000590")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000590)
		UseItemFailed ( role )
		return
	end
	local i= CheckBagItem( role, 5782)                                                
	if i <=0 then
		CALCULATE_ITEMEFFECT_LUA_000591 = GetResString("CALCULATE_ITEMEFFECT_LUA_000591")
		SystemNotice(  role , CALCULATE_ITEMEFFECT_LUA_000591)
		UseItemFailed ( role )
		return LUA_FALSE
	end
	
	local s = DelBagItem ( role , 5782 , 1 ) 
	local	sc = math.random(1,100)
	local itemname = ""
	if  sc <=35 then	
		GiveItem ( role , 0 , 5779 , 1 , 4 )                    ---------------三级圣王宝藏   获得机率35%
		CALCULATE_ITEMEFFECT_LUA_000592 = GetResString("CALCULATE_ITEMEFFECT_LUA_000592")
		itemname = CALCULATE_ITEMEFFECT_LUA_000592
	elseif sc <=36 then
		GiveItem ( role , 0 , 5783 , 1 , 4 )                    ---------------三级圣王宝藏钥匙   获得机率1%
		CALCULATE_ITEMEFFECT_LUA_000593 = GetResString("CALCULATE_ITEMEFFECT_LUA_000593")
		itemname = CALCULATE_ITEMEFFECT_LUA_000593
	elseif sc <=40 then
		GiveItem ( role , 0 , 5703 , 1 , 4 )                    ---------------青龙钥匙   获得机率4%
		CALCULATE_ITEMEFFECT_LUA_000538 = GetResString("CALCULATE_ITEMEFFECT_LUA_000538")
		itemname = CALCULATE_ITEMEFFECT_LUA_000538
	elseif sc <=70 then
		GiveItem ( role , 0 , 0578 , 1 , 4 )                    ---------------精灵加速成长果   获得机率30%
		CALCULATE_ITEMEFFECT_LUA_000594 = GetResString("CALCULATE_ITEMEFFECT_LUA_000594")
		itemname = CALCULATE_ITEMEFFECT_LUA_000594
	elseif sc <=90 then
		GiveItem ( role , 0 , 0145 , 1 , 4 )                    ---------------神泣宝箱   获得机率20%
		CALCULATE_ITEMEFFECT_LUA_000595 = GetResString("CALCULATE_ITEMEFFECT_LUA_000595")
		itemname = CALCULATE_ITEMEFFECT_LUA_000595
	else 
		GiveItem ( role , 0 , 0146 , 1 , 4 )                    ---------------霸王宝箱   获得机率10%
		CALCULATE_ITEMEFFECT_LUA_000596 = GetResString("CALCULATE_ITEMEFFECT_LUA_000596")
		itemname = CALCULATE_ITEMEFFECT_LUA_000596	
	end
	local cha_name = GetChaDefaultName ( role )
	CALCULATE_ITEMEFFECT_LUA_000597 = GetResString("CALCULATE_ITEMEFFECT_LUA_000597")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000597..itemname )
end


--------------------------三级圣王宝藏
function ItemUse_lv3swbzbox (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000598 = GetResString("CALCULATE_ITEMEFFECT_LUA_000598")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000598 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000599 = GetResString("CALCULATE_ITEMEFFECT_LUA_000599")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000599)
		UseItemFailed ( role )
		return
	end
	local i= CheckBagItem( role, 5783)                                                
	if i <=0 then
		CALCULATE_ITEMEFFECT_LUA_000600 = GetResString("CALCULATE_ITEMEFFECT_LUA_000600")
		SystemNotice(  role , CALCULATE_ITEMEFFECT_LUA_000600)
		UseItemFailed ( role )
		return LUA_FALSE
	end
	
	local s = DelBagItem ( role , 5783 , 1 ) 
	local	sc = math.random(1,100)
	local itemname = ""
	if  sc <=30 then	
		GiveItem ( role , 0 , 5780 , 1 , 4 )                    --------------四级圣王宝藏   获得机率30%
		CALCULATE_ITEMEFFECT_LUA_000601 = GetResString("CALCULATE_ITEMEFFECT_LUA_000601")
		itemname = CALCULATE_ITEMEFFECT_LUA_000601
	elseif sc <=31 then
		GiveItem ( role , 0 , 5783 , 1 , 4 )                    ---------------四级圣王宝藏钥匙   获得机率1%
		CALCULATE_ITEMEFFECT_LUA_000602 = GetResString("CALCULATE_ITEMEFFECT_LUA_000602")
		itemname = CALCULATE_ITEMEFFECT_LUA_000602
	elseif sc <=32 then
		GiveItem ( role , 0 , 5704 , 1 , 4 )                    ---------------真龙钥匙   获得机率1%
		CALCULATE_ITEMEFFECT_LUA_000547 = GetResString("CALCULATE_ITEMEFFECT_LUA_000547")
		itemname = CALCULATE_ITEMEFFECT_LUA_000547
	elseif sc <=50 then
		GiveItem ( role , 0 , 0853 , 1 , 4 )                    ---------------假期欢乐杂志   获得机率18%
		CALCULATE_ITEMEFFECT_LUA_000541 = GetResString("CALCULATE_ITEMEFFECT_LUA_000541")
		itemname = CALCULATE_ITEMEFFECT_LUA_000541
	elseif sc <=60 then
		GiveItem ( role , 0 , 0271 , 1 , 4 )                    ---------------天使骰子   获得机率10%
		CALCULATE_ITEMEFFECT_LUA_000603 = GetResString("CALCULATE_ITEMEFFECT_LUA_000603")
		itemname = CALCULATE_ITEMEFFECT_LUA_000603
	elseif sc <=90 then 
		GiveItem ( role , 0 , 1036 , 10 , 4 )                    ---------------魔幻女神卡   获得机率30%
		CALCULATE_ITEMEFFECT_LUA_000471 = GetResString("CALCULATE_ITEMEFFECT_LUA_000471")
		itemname = CALCULATE_ITEMEFFECT_LUA_000471	
	else 
		GiveItem ( role , 0 , 1019 , 10 , 4 )                    ---------------迷你黑龙包   获得机率10%
		CALCULATE_ITEMEFFECT_LUA_000472 = GetResString("CALCULATE_ITEMEFFECT_LUA_000472")
		itemname = CALCULATE_ITEMEFFECT_LUA_000472		
	end
	local cha_name = GetChaDefaultName ( role )
	CALCULATE_ITEMEFFECT_LUA_000604 = GetResString("CALCULATE_ITEMEFFECT_LUA_000604")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000604..itemname )
end
--------------------------四级圣王宝藏

function ItemUse_lv4swbzbox (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000605 = GetResString("CALCULATE_ITEMEFFECT_LUA_000605")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000605 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000606 = GetResString("CALCULATE_ITEMEFFECT_LUA_000606")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000606)
		UseItemFailed ( role )
		return
	end
	local i= CheckBagItem( role, 5784)                                                
	if i <=0 then
		CALCULATE_ITEMEFFECT_LUA_000607 = GetResString("CALCULATE_ITEMEFFECT_LUA_000607")
		SystemNotice(  role , CALCULATE_ITEMEFFECT_LUA_000607)
		UseItemFailed ( role )
		return LUA_FALSE
	end
	
	local s = DelBagItem ( role , 5784 , 1 ) 
	local	sc = math.random(1,100)
	local itemname = ""
	if  sc <=25 then	
		GiveItem ( role , 0 , 5781 , 1 , 4 )                    --------------五级圣王宝藏   获得机率25%
		CALCULATE_ITEMEFFECT_LUA_000608 = GetResString("CALCULATE_ITEMEFFECT_LUA_000608")
		itemname = CALCULATE_ITEMEFFECT_LUA_000608
	elseif sc <=26 then
		GiveItem ( role , 0 , 5785 , 1 , 4 )                    ---------------五级圣王宝藏钥匙   获得机率1%
		CALCULATE_ITEMEFFECT_LUA_000609 = GetResString("CALCULATE_ITEMEFFECT_LUA_000609")
		itemname = CALCULATE_ITEMEFFECT_LUA_000609
	elseif sc <=26.5 then
		GiveItem ( role , 0 , 5705 , 1 , 4 )                    ---------------至尊钥匙   获得机率0.5%
		CALCULATE_ITEMEFFECT_LUA_000555 = GetResString("CALCULATE_ITEMEFFECT_LUA_000555")
		itemname = CALCULATE_ITEMEFFECT_LUA_000555
	elseif sc <=46.5 then
		GiveItem ( role , 0 , 5707 , 1 , 4 )                    ---------------乾坤锦囊   获得机率20%
		CALCULATE_ITEMEFFECT_LUA_000539 = GetResString("CALCULATE_ITEMEFFECT_LUA_000539")
		itemname = CALCULATE_ITEMEFFECT_LUA_000539
	elseif sc <=76.5 then
		GiveItem ( role , 0 , 3018 , 1 , 4 )                    ---------------黄金圣斗士宝藏   获得机率30%
		CALCULATE_ITEMEFFECT_LUA_000610 = GetResString("CALCULATE_ITEMEFFECT_LUA_000610")
		itemname = CALCULATE_ITEMEFFECT_LUA_000610
	elseif sc <=86.5 then 
		GiveItem ( role , 0 , 5615 , 10 , 4 )                    ---------------白金辉煌彩票   获得机率10%
		CALCULATE_ITEMEFFECT_LUA_000611 = GetResString("CALCULATE_ITEMEFFECT_LUA_000611")
		itemname = CALCULATE_ITEMEFFECT_LUA_000611	
	else 
		GiveItem ( role , 0 , 5614 , 10 , 4 )                    ---------------白金年兽彩票   获得机率13.5%
		CALCULATE_ITEMEFFECT_LUA_000612 = GetResString("CALCULATE_ITEMEFFECT_LUA_000612")
		itemname = CALCULATE_ITEMEFFECT_LUA_000612		
	end
	local cha_name = GetChaDefaultName ( role )
	CALCULATE_ITEMEFFECT_LUA_000613 = GetResString("CALCULATE_ITEMEFFECT_LUA_000613")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000613..itemname )
end
--------------------------五级圣王宝藏
function ItemUse_lv5swbzbox (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000614 = GetResString("CALCULATE_ITEMEFFECT_LUA_000614")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000614 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000615 = GetResString("CALCULATE_ITEMEFFECT_LUA_000615")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000615)
		UseItemFailed ( role )
		return
	end
	local i= CheckBagItem( role, 5785)                                                
	if i <=0 then
		CALCULATE_ITEMEFFECT_LUA_000616 = GetResString("CALCULATE_ITEMEFFECT_LUA_000616")
		SystemNotice(  role , CALCULATE_ITEMEFFECT_LUA_000616)
		UseItemFailed ( role )
		return LUA_FALSE
	end
	
	local s = DelBagItem ( role , 5785 , 1 ) 
	local	sc = math.random(1,100)
	local itemname = ""
	if  sc <=0.1 then	
		GiveItem ( role , 0 , 5706 , 1 , 4 )                    --------------无双钥匙   获得机率0.1%
		CALCULATE_ITEMEFFECT_LUA_000562 = GetResString("CALCULATE_ITEMEFFECT_LUA_000562")
		itemname = CALCULATE_ITEMEFFECT_LUA_000562
	elseif sc <=10.1 then
		GiveItem ( role , 0 , 0242 , 1 , 4 )                    ---------------白银戒指兑换券   获得机率10%
		CALCULATE_ITEMEFFECT_LUA_000617 = GetResString("CALCULATE_ITEMEFFECT_LUA_000617")
		itemname = CALCULATE_ITEMEFFECT_LUA_000617
	elseif sc <=14.1 then
		GiveItem ( role , 0 , 2515 , 1 , 4 )                    ---------------黄金戒指兑换券   获得机率4%
		CALCULATE_ITEMEFFECT_LUA_000618 = GetResString("CALCULATE_ITEMEFFECT_LUA_000618")
		itemname = CALCULATE_ITEMEFFECT_LUA_000618
	elseif sc <=16.1 then
		GiveItem ( role , 0 , 2516 , 1 , 4 )                    ---------------钻石戒指兑换券   获得机率2%
		CALCULATE_ITEMEFFECT_LUA_000619 = GetResString("CALCULATE_ITEMEFFECT_LUA_000619")
		itemname = CALCULATE_ITEMEFFECT_LUA_000619
	elseif sc <=31.1 then
		GiveItem ( role , 0 , 2517 , 1 , 4 )                    ---------------伯爵项链兑换券   获得机率15%
		CALCULATE_ITEMEFFECT_LUA_000620 = GetResString("CALCULATE_ITEMEFFECT_LUA_000620")
		itemname = CALCULATE_ITEMEFFECT_LUA_000620
	elseif sc <=37.1 then 
		GiveItem ( role , 0 , 2518 , 1 , 4 )                    ---------------侯爵项链兑换券   获得机率6%
		CALCULATE_ITEMEFFECT_LUA_000621 = GetResString("CALCULATE_ITEMEFFECT_LUA_000621")
		itemname = CALCULATE_ITEMEFFECT_LUA_000621	
	elseif sc <=40.1 then 
		GiveItem ( role , 0 , 2519 , 1 , 4 )                    ---------------公爵项链兑换券   获得机率3%
		CALCULATE_ITEMEFFECT_LUA_000622 = GetResString("CALCULATE_ITEMEFFECT_LUA_000622")
		itemname = CALCULATE_ITEMEFFECT_LUA_000622	
	else 
		GiveItem ( role , 0 , 0333 , 1 , 4 )                    ---------------高级宝石兑换券   获得机率59.9%
		CALCULATE_ITEMEFFECT_LUA_000623 = GetResString("CALCULATE_ITEMEFFECT_LUA_000623")
		itemname = CALCULATE_ITEMEFFECT_LUA_000623	
	end
	local cha_name = GetChaDefaultName ( role )
	CALCULATE_ITEMEFFECT_LUA_000624 = GetResString("CALCULATE_ITEMEFFECT_LUA_000624")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000624..itemname )
end
------------------------------六一儿童节礼物
function ItemUse_ETJ (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000625 = GetResString("CALCULATE_ITEMEFFECT_LUA_000625")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000625 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 6 then
		CALCULATE_ITEMEFFECT_LUA_000626 = GetResString("CALCULATE_ITEMEFFECT_LUA_000626")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000626)
		UseItemFailed ( role )
		return
	end
		local BY1 = CheckBagItem( role, 5341 )
		local BY2 = CheckBagItem( role, 5345 )
		local BY3 = CheckBagItem( role, 5349 )
		local BY4 = CheckBagItem( role, 5353 )
		local JN1 = CheckBagItem( role, 5357 )
		local JN2 = CheckBagItem( role, 5361 )
		local JN3 = CheckBagItem( role, 5365 )
		local JN4 = CheckBagItem( role, 5369 )
		local SZ1 = CheckBagItem( role, 5373 )
		local SZ2 = CheckBagItem( role, 5377 )
		local SZ3 = CheckBagItem( role, 5381 )
		local SZ4 = CheckBagItem( role, 5385 )
		local JX1 = CheckBagItem( role, 5457 )
		local JX2 = CheckBagItem( role, 5461 )
		local JX3 = CheckBagItem( role, 5465 )
		local JX4 = CheckBagItem( role, 5469 )


	if BY1 == 1 or BY2 == 1 or BY3 == 1 or BY4 == 1 then
			if JN1 == 1 or JN2 == 1 or JN3 == 1 or JN4 == 1 or SZ1 == 1 or SZ2 == 1 or SZ3 == 1 or SZ4 == 1 or JX1 == 1 or JX2 == 1 or JX3 == 1 or JX4 == 1 then
			CALCULATE_ITEMEFFECT_LUA_000627 = GetResString("CALCULATE_ITEMEFFECT_LUA_000627")
			SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000627)
			UseItemFailed ( role )
        	return
        end
		   GiveItem ( role , 0 , 3080  , 99 , 4 )
	       GiveItem ( role , 0 , 581  , 1 , 4 )
	elseif JN1 == 1 or JN2 == 1 or JN3 == 1 or JN4 == 1 then
		if BY1 == 1 or BY2 == 1 or BY3 == 1 or BY4 == 1 or SZ1 == 1 or SZ2 == 1 or SZ3 == 1 or SZ4 == 1 or JX1 == 1 or JX2 == 1 or JX3 == 1 or JX4 == 1 then
			CALCULATE_ITEMEFFECT_LUA_000627 = GetResString("CALCULATE_ITEMEFFECT_LUA_000627")
			SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000627)
			UseItemFailed ( role )
        	return
        end
	   GiveItem ( role , 0 , 3089  , 1 , 4 )
	   GiveItem ( role , 0 , 580  , 1 , 4 )
	elseif SZ1 == 1 or SZ2 == 1 or SZ3 == 1 or SZ4 == 1 then
		if BY1 == 1 or BY2 == 1 or BY3 == 1 or BY4 == 1 or JN1 == 1 or JN2 == 1 or JN3 == 1 or JN4 == 1 or JX1 == 1 or JX2 == 1 or JX3 == 1 or JX4 == 1 then
			CALCULATE_ITEMEFFECT_LUA_000627 = GetResString("CALCULATE_ITEMEFFECT_LUA_000627")
			SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000627)
			UseItemFailed ( role )
        	return
        end
	   GiveItem ( role , 0 , 580  , 1 , 4 )
	   GiveItem ( role , 0 , 3047  , 5 , 4 )
	elseif JX1 == 1 or JX2 == 1 or JX3 == 1 or JX4 == 1 then
		if BY1 == 1 or BY2 == 1 or BY3 == 1 or BY4 == 1 or JN1 == 1 or JN2 == 1 or JN3 == 1 or JN4 == 1 or SZ1 == 1 or SZ2 == 1 or SZ3 == 1 or SZ4 == 1 then
			CALCULATE_ITEMEFFECT_LUA_000627 = GetResString("CALCULATE_ITEMEFFECT_LUA_000627")
			SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000627)
			UseItemFailed ( role )
        	return
        end
	   GiveItem ( role , 0 , 333  , 1 , 4 )
	elseif BY1 < 1 and BY2 < 1 and BY3 < 1 and BY4 < 1 and JN1 < 1 and JN2 < 1 and JN3 < 1 and JN4 < 1 and SZ1 < 1 and SZ2 < 1 and SZ3 < 1 and SZ4 < 1 and JX1 < 1 and JX2 < 1 and JX3 < 1 and JX4 < 1 then
	   GiveItem ( role , 0 , 3083  , 10 , 4 )
	   GiveItem ( role , 0 , 5804  , 1 , 4 )
	end
end
----------------------------------------------猪年儿童宝箱
function ItemUse_ZNBOX (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000625 = GetResString("CALCULATE_ITEMEFFECT_LUA_000625")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000625 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 4 then
		CALCULATE_ITEMEFFECT_LUA_000628 = GetResString("CALCULATE_ITEMEFFECT_LUA_000628")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000628)
		UseItemFailed ( role )
		return
	end
	    	local cha_type = GetChaTypeID ( role ) 
			if cha_type == 1  then 
	       GiveItem ( role , 0 , 5315  , 1 , 4 )
	       GiveItem ( role , 0 , 5316  , 1 , 4 )
	       GiveItem ( role , 0 , 5317  , 1 , 4 )
	       GiveItem ( role , 0 , 5318  , 1 , 4 )
	       
			elseif cha_type == 2  then 
	       GiveItem ( role , 0 , 5319 , 1 , 4 )
	       GiveItem ( role , 0 , 5320  , 1 , 4 )
	       GiveItem ( role , 0 , 5321  , 1 , 4 )
	       GiveItem ( role , 0 , 5322  , 1 , 4 )
	       
			elseif cha_type == 3 then 
	       GiveItem ( role , 0 , 5323  , 1 , 4 )
	       GiveItem ( role , 0 , 5324  , 1 , 4 )
	       GiveItem ( role , 0 , 5325  , 1 , 4 )
	       GiveItem ( role , 0 , 5326  , 1 , 4 )
	       
			elseif cha_type == 4 then 
	       GiveItem ( role , 0 , 5327  , 1 , 4 )
	       GiveItem ( role , 0 , 5328  , 1 , 4 )
	       GiveItem ( role , 0 , 5329  , 1 , 4 )
	       GiveItem ( role , 0 , 5330  , 1 , 4 )
	       
		   end

end
------------------------------------------疯狂的撒加召唤券
function ItemUse_FKDSJSummon (role, Item)

		local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end

	local el = 0
	el =IsChaInRegion( role, 2 )
	if el == 1 then
		CALCULATE_ITEMEFFECT_LUA_000234 = GetResString("CALCULATE_ITEMEFFECT_LUA_000234")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000234 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	local MonsterID = 1070
	local Refresh = 1801					--重生时间，秒单位
	local life = 1800000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaLifeTime( new, life )
	local x, y = GetChaPos(role)
	local MonsterID1 = 1069
	local new1 = CreateChaX( MonsterID1 , x , y , 145 , Refresh, role )
	SetChaLifeTime( new1, life )
	local x, y = GetChaPos(role)
	local MonsterID2 = 1069
	local new2 = CreateChaX( MonsterID2 , x , y , 145 , Refresh, role )
	SetChaLifeTime( new2, life )
end
-------------------------------------------------邪恶教皇召唤券
function ItemUse_XEJHSummon (role, Item)

		local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end

	local el = 0
	el =IsChaInRegion( role, 2 )
	if el == 1 then
		CALCULATE_ITEMEFFECT_LUA_000234 = GetResString("CALCULATE_ITEMEFFECT_LUA_000234")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000234 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	local MonsterID = 1071
	local Refresh = 1801					--重生时间，秒单位
	local life = 1800000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaLifeTime( new, life )
end
-------------------------------------cosplay认可证书
function ItemUse_COSPLAY (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000629 = GetResString("CALCULATE_ITEMEFFECT_LUA_000629")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000629 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000630 = GetResString("CALCULATE_ITEMEFFECT_LUA_000630")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000630)
		UseItemFailed ( role )
		return
	end
	local	sc = math.random(1,4)
	if sc == 1 then
		GiveItem ( role , 0 , 5807  , 1 , 4 )
	elseif sc == 2 then
		GiveItem ( role , 0 , 5808  , 1 , 4 )
	elseif sc == 3 then
		GiveItem ( role , 0 , 5809  , 1 , 4 )
	elseif sc == 4 then
		GiveItem ( role , 0 , 5810  , 1 , 4 )
	end
end

---------------------------------人偶小猪召唤券--双击召唤人偶小猪 by Lee 2008.06.13

function ItemUse_ROXZ ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000256 = GetResString("CALCULATE_ITEMEFFECT_LUA_000256")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000256 )
		UseItemFailed ( role )
		return
	end
	
	local pet_num = GetPetNum(role)
	if pet_num >= 2 then
		CALCULATE_ITEMEFFECT_LUA_000631 = GetResString("CALCULATE_ITEMEFFECT_LUA_000631")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000631 )
		UseItemFailed ( role )
		return
	end
	
	local x, y = GetChaPos(role)
	x_resume = 5
	y_resume = 5
	x = x + x_resume
	y = y + y_resume
	local MonsterID = 1074     -------------------人偶小猪 1074
	local Refresh = 3600					--重生时间，秒单位
	local life = 3600000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaHost(new,role)
	SetChaLifeTime( new, life )
	SetChaTarget(new, role)
	PlayEffect( new, 361 )
end

----夏天的魔法书----------by Peter 2008.7.1---------------------------------------------------------------------------------------------------------------------------
function ItemUse_XTMFS(role, Item )

	local statelv = 1
	local statetime = 30                 ----1=1秒
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local CD_LV1 = GetChaStateLv(role,STATE_XTMFS)
--		SystemNotice(role,"CD_LV1")	
	if CD_LV1 > 0 then
		CALCULATE_ITEMEFFECT_LUA_000632 = GetResString("CALCULATE_ITEMEFFECT_LUA_000632")
		SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_000632)
		UseItemFailed ( role )
		return
	end

	AddState( role , role , STATE_XTMFS , statelv , statetime )
	CALCULATE_ITEMEFFECT_LUA_000633 = GetResString("CALCULATE_ITEMEFFECT_LUA_000633")
	SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000633)
end
----高超的莫邪剑-----------by Peter 2008.7.1---------------------------------------------------------------------------------------------------------------------------
function ItemUse_MWMXJ(role, Item )

	local statelv = 1
	local statetime = 30
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local CD_LV2 = GetChaStateLv(role,STATE_MWMXJ)
--		SystemNotice(role,"CD_LV2")	
	if CD_LV2 > 0 then
		CALCULATE_ITEMEFFECT_LUA_000632 = GetResString("CALCULATE_ITEMEFFECT_LUA_000632")
		SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_000632)
		UseItemFailed ( role )
		return
	end	
	AddState( role , role , STATE_MWMXJ , statelv , statetime )
	CALCULATE_ITEMEFFECT_LUA_000633 = GetResString("CALCULATE_ITEMEFFECT_LUA_000633")
	SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000633)
end
----丰丰的金刚盾---------by Peter 2008.7.1-----------------------------------------------------------------------------------------------------------------------------
function ItemUse_FFJGD(role, Item )

	local statelv = 1
	local statetime =30
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
--		SystemNotice(role,"1111111111")	
	local CD_LV3 = GetChaStateLv(role,STATE_FFJGD)
--		SystemNotice(role,"CD_LV3")	
	if CD_LV3 > 0 then
		CALCULATE_ITEMEFFECT_LUA_000632 = GetResString("CALCULATE_ITEMEFFECT_LUA_000632")
		SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_000632)
		UseItemFailed ( role )
		return
	end		
	
	AddState( role , role , STATE_FFJGD , statelv , statetime )
	CALCULATE_ITEMEFFECT_LUA_000633 = GetResString("CALCULATE_ITEMEFFECT_LUA_000633")
	SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000633)
end
----皮特的隐身药水----------------by Peter 2008.7.1----------------------------------------------------------------------------------------------------------------------
function ItemUse_YSYS(role, Item )
	
	local statelv = 1
	local statetime =5
	local  statetime2 = 5
	local CD_LV = GetChaStateLv(role,STATE_CD)
--		SystemNotice(role,"CD_LV")	
	local job = GetChaAttr( role, ATTR_JOB) --取职业
	if job == 8 or job == 9    then
		CALCULATE_ITEMEFFECT_LUA_000634 = GetResString("CALCULATE_ITEMEFFECT_LUA_000634")
		SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_000634)
		UseItemFailed ( role )
		return
	end
	if CD_LV > 0 then
		CALCULATE_ITEMEFFECT_LUA_000632 = GetResString("CALCULATE_ITEMEFFECT_LUA_000632")
		SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_000632)
		UseItemFailed ( role )
		return
	end

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end

	AddState ( role , role , STATE_YSYS , statelv , statetime )
	AddState ( role , role , STATE_CD , statelv , statetime2 ) 

	CALCULATE_ITEMEFFECT_LUA_000635 = GetResString("CALCULATE_ITEMEFFECT_LUA_000635")
	SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000635)


end



---------------宙斯箱子使用------------------- by peter 
function ItemUse_ZhouSi( role, Item )

	local Elf_URE = GetItemAttr(Item,ITEMATTR_URE) --当前耐久记录剩余封印点数
	local Elf_EXP = GetItemAttr(Item,ITEMATTR_ENERGY) --最大能量记录诅咒点数
	if Elf_URE ~= 0 then
		CALCULATE_ITEMEFFECT_LUA_000123 = GetResString("CALCULATE_ITEMEFFECT_LUA_000123")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000123)
		UseItemFailed ( role )
		return
	end
	if Elf_EXP >0 then
		CALCULATE_ITEMEFFECT_LUA_000636 = GetResString("CALCULATE_ITEMEFFECT_LUA_000636")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000636)
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000125 = GetResString("CALCULATE_ITEMEFFECT_LUA_000125")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000125)
		UseItemFailed ( role )
		return
	end
	local sta = GetItemAttr( Item ,ITEMATTR_VAL_STA )       --精神
	if sta == 0 then
		CALCULATE_ITEMEFFECT_LUA_000126 = GetResString("CALCULATE_ITEMEFFECT_LUA_000126")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000126)
		UseItemFailed ( role )
		return
	end
	local cha_name = GetChaDefaultName ( role ) 
	if sta == 1 then ---核心一866黑龙之心----------给宙斯之躯
		if Elf_EXP == 0 then
		GiveItem ( role , 0 , 1518  , 1 , 4  )  		
		end
		CALCULATE_ITEMEFFECT_LUA_000637 = GetResString("CALCULATE_ITEMEFFECT_LUA_000637")
		CALCULATE_ITEMEFFECT_LUA_000638 = GetResString("CALCULATE_ITEMEFFECT_LUA_000638")
		local message =CALCULATE_ITEMEFFECT_LUA_000638.. cha_name..CALCULATE_ITEMEFFECT_LUA_000637  
	end
	if sta == 2 then ---核心二865黑龙之魂---------------给宙斯之手
		if Elf_EXP == 0 then
		GiveItem ( role , 0 , 1519  , 1 ,4 )  		
		end
		CALCULATE_ITEMEFFECT_LUA_000639 = GetResString("CALCULATE_ITEMEFFECT_LUA_000639")
		CALCULATE_ITEMEFFECT_LUA_000640 = GetResString("CALCULATE_ITEMEFFECT_LUA_000640")
		local message =CALCULATE_ITEMEFFECT_LUA_000640.. cha_name..CALCULATE_ITEMEFFECT_LUA_000639  
	end
	if sta == 3 then ---核心三864黑龙之瞳---------------给黑龙之爪
		if Elf_EXP == 0 then
		GiveItem ( role , 0 , 1520  , 1 ,4 )  		
		end
		CALCULATE_ITEMEFFECT_LUA_000641 = GetResString("CALCULATE_ITEMEFFECT_LUA_000641")
		CALCULATE_ITEMEFFECT_LUA_000640 = GetResString("CALCULATE_ITEMEFFECT_LUA_000640")
		local message =CALCULATE_ITEMEFFECT_LUA_000640.. cha_name..CALCULATE_ITEMEFFECT_LUA_000641  
	end

end
---------------核心2使用------------ by peter -----------sta = GetItemAttr( Item_Traget ,ITEMATTR_VAL_STA )       --精神
function ItemUse_hexin2 ( role , Item , Item_Traget ) 

	local Item_Traget_ID = GetItemID ( Item_Traget )
	local Item_ID = GetItemID ( Item )		
	local sta = GetItemAttr( Item_Traget ,ITEMATTR_VAL_STA )       --精神
	if Item_Traget_ID ~= 5873 then
		CALCULATE_ITEMEFFECT_LUA_000139 = GetResString("CALCULATE_ITEMEFFECT_LUA_000139")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000139)
		UseItemFailed ( role )
		return
	end
	if sta==1 and Item_ID == 5878 then
		CALCULATE_ITEMEFFECT_LUA_000642 = GetResString("CALCULATE_ITEMEFFECT_LUA_000642")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000642)
		UseItemFailed ( role )
		return	
	end
	if sta==2 and Item_ID == 5879 then
		CALCULATE_ITEMEFFECT_LUA_000643 = GetResString("CALCULATE_ITEMEFFECT_LUA_000643")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000643)
		UseItemFailed ( role )
		return	
	end
	if sta==3 and Item_ID == 5880 then
		CALCULATE_ITEMEFFECT_LUA_000644 = GetResString("CALCULATE_ITEMEFFECT_LUA_000644")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000644)
		UseItemFailed ( role )
		return	
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type = GetItemType ( Item )
		local Item_Traget_Type = GetItemType ( Item_Traget )
		local cha_name = GetChaDefaultName ( role ) 
		if Item_type == 49 and Item_Traget_Type == 65 then
				if Item_ID == 5878 then						---核心A
				sta =1
				CALCULATE_ITEMEFFECT_LUA_000645 = GetResString("CALCULATE_ITEMEFFECT_LUA_000645")
				SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000645 )
				CALCULATE_ITEMEFFECT_LUA_000646 = GetResString("CALCULATE_ITEMEFFECT_LUA_000646")
				CALCULATE_ITEMEFFECT_LUA_000131 = GetResString("CALCULATE_ITEMEFFECT_LUA_000131")
				LG("ZhouSiHeiXiaZi_HeXin2",CALCULATE_ITEMEFFECT_LUA_000131,cha_name,CALCULATE_ITEMEFFECT_LUA_000646)
				elseif Item_ID == 5879 then						---核心B
				sta =2
				CALCULATE_ITEMEFFECT_LUA_000647 = GetResString("CALCULATE_ITEMEFFECT_LUA_000647")
				SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000647 )
				CALCULATE_ITEMEFFECT_LUA_000648 = GetResString("CALCULATE_ITEMEFFECT_LUA_000648")
				CALCULATE_ITEMEFFECT_LUA_000131 = GetResString("CALCULATE_ITEMEFFECT_LUA_000131")
				LG("ZhouSiHeiXiaZi_HeXin2",CALCULATE_ITEMEFFECT_LUA_000131,cha_name,CALCULATE_ITEMEFFECT_LUA_000648)
				elseif Item_ID ==5880 then						---核心C
				sta =3
				CALCULATE_ITEMEFFECT_LUA_000649 = GetResString("CALCULATE_ITEMEFFECT_LUA_000649")
				SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000649 )
				CALCULATE_ITEMEFFECT_LUA_000650 = GetResString("CALCULATE_ITEMEFFECT_LUA_000650")
				CALCULATE_ITEMEFFECT_LUA_000131 = GetResString("CALCULATE_ITEMEFFECT_LUA_000131")
				LG("ZhouSiHeiXiaZi_HeXin2",CALCULATE_ITEMEFFECT_LUA_000131,cha_name,CALCULATE_ITEMEFFECT_LUA_000650)
				else 
						UseItemFailed ( role )
						return
				end
				SetItemAttr( Item_Traget ,ITEMATTR_VAL_STA ,sta )
		end 
end
--------------赫拉神符使用----------------- by peter ---------str = GetItemAttr( Item_Traget ,ITEMATTR_VAL_STR )       --力量
function  ItemUse_HLSF ( role , Item , Item_Traget ) 

	local Item_ID = GetItemID ( Item_Traget )
	if Item_ID ~= 5873 then
		CALCULATE_ITEMEFFECT_LUA_000651 = GetResString("CALCULATE_ITEMEFFECT_LUA_000651")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000651)
		UseItemFailed ( role )
		return
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type = GetItemType ( Item )
		local Item_Traget_Type = GetItemType ( Item_Traget )
		if Item_type == 66 and Item_Traget_Type == 65  then
				local str = GetItemAttr( Item_Traget ,ITEMATTR_VAL_STR )       --力量
				if str >= 10 then                    --------做法是从0加到10，超过10无法使用，客户端处理为10减到0
					UseItemFailed ( role )
				return
				end
				local rad = math.random ( 1, 100 )
				 if rad<=50 then
					local Elf_URE = GetItemAttr(Item_Traget,ITEMATTR_URE) --当前耐久记录剩余封印点数
					str = str + 1
					if Elf_URE >= 50 then
					Elf_URE = Elf_URE-50
					end
					SetItemAttr( Item_Traget ,ITEMATTR_VAL_STR ,str )
					SetItemAttr( Item_Traget ,ITEMATTR_URE ,Elf_URE )
				else 
				local Elf_MaxEXP = GetItemAttr(Item_Traget,ITEMATTR_MAXENERGY) --最大能量记录诅咒点数
				local Elf_EXP = GetItemAttr(Item_Traget,ITEMATTR_ENERGY) --最大能量记录诅咒点数
					Elf_MaxEXP = Elf_MaxEXP + 1
					Elf_EXP = Elf_EXP + 1
					CALCULATE_ITEMEFFECT_LUA_000652 = GetResString("CALCULATE_ITEMEFFECT_LUA_000652")
					SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000652 ) 
					SetItemAttr( Item_Traget ,ITEMATTR_MAXENERGY ,Elf_MaxEXP )
					SetItemAttr( Item_Traget ,ITEMATTR_ENERGY ,Elf_EXP )
				end 
		end 
end


---------------雅典娜神符使用------------- by peter ------------con = GetItemAttr( Item_Traget ,ITEMATTR_VAL_CON )       --体质

function ItemUse_YDNSF ( role , Item , Item_Traget ) 

	local Item_ID = GetItemID ( Item_Traget )
	if Item_ID ~= 5873  then
		CALCULATE_ITEMEFFECT_LUA_000653 = GetResString("CALCULATE_ITEMEFFECT_LUA_000653")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000653)
		UseItemFailed ( role )
		return
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type = GetItemType ( Item )
		local Item_Traget_Type = GetItemType ( Item_Traget )
		if Item_type == 66 and Item_Traget_Type == 65 then
				local con = GetItemAttr( Item_Traget ,ITEMATTR_VAL_CON )       --体质
				if con >= 10 then
					UseItemFailed ( role )
				return
				end
				local rad = math.random ( 1, 100 )
				 if rad<=50 then
					local Elf_URE = GetItemAttr(Item_Traget,ITEMATTR_URE) --当前耐久记录剩余封印点数
					con = con + 1
					if Elf_URE >= 50 then
					Elf_URE = Elf_URE-50
					end
					SetItemAttr( Item_Traget ,ITEMATTR_VAL_CON ,con )
					SetItemAttr( Item_Traget ,ITEMATTR_URE ,Elf_URE )
				else 
				local Elf_MaxEXP = GetItemAttr(Item_Traget,ITEMATTR_MAXENERGY) --最大能量记录诅咒点数
				local Elf_EXP = GetItemAttr(Item_Traget,ITEMATTR_ENERGY) --最大能量记录诅咒点数
					Elf_MaxEXP = Elf_MaxEXP + 1
					Elf_EXP = Elf_EXP + 1
					CALCULATE_ITEMEFFECT_LUA_000652 = GetResString("CALCULATE_ITEMEFFECT_LUA_000652")
					SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000652 ) 
					SetItemAttr( Item_Traget ,ITEMATTR_MAXENERGY ,Elf_MaxEXP )
					SetItemAttr( Item_Traget ,ITEMATTR_ENERGY ,Elf_EXP )
				end 
		end 
end
----------------阿波罗神符使用------------------- by peter --------agi = GetItemAttr( Item_Traget ,ITEMATTR_VAL_AGI )       --敏捷
function ItemUse_ABLSF ( role , Item , Item_Traget ) 

	local Item_ID = GetItemID ( Item_Traget )
	if Item_ID ~= 5873 then
		CALCULATE_ITEMEFFECT_LUA_000654 = GetResString("CALCULATE_ITEMEFFECT_LUA_000654")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000654)
		UseItemFailed ( role )
		return
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type = GetItemType ( Item )
		local Item_Traget_Type = GetItemType ( Item_Traget )
		if Item_type == 66 and Item_Traget_Type == 65 then
				local agi = GetItemAttr( Item_Traget ,ITEMATTR_VAL_AGI )       --敏捷
					if agi >= 10 then
					UseItemFailed ( role )
					return
					end
				local rad = math.random ( 1, 100 )
				 if rad<=50 then
					local Elf_URE= GetItemAttr(Item_Traget,ITEMATTR_URE) --当前耐久记录剩余封印点数
					agi = agi + 1
					if Elf_URE >= 50 then
					Elf_URE = Elf_URE-50
					end
					SetItemAttr( Item_Traget ,ITEMATTR_VAL_AGI ,agi )
					SetItemAttr( Item_Traget ,ITEMATTR_URE ,Elf_URE )
				else 
				local Elf_MaxEXP = GetItemAttr(Item_Traget,ITEMATTR_MAXENERGY) --最大能量记录诅咒点数
				local Elf_EXP = GetItemAttr(Item_Traget,ITEMATTR_ENERGY) --最大能量记录诅咒点数
					Elf_MaxEXP = Elf_MaxEXP + 1
					Elf_EXP = Elf_EXP + 1
					CALCULATE_ITEMEFFECT_LUA_000652 = GetResString("CALCULATE_ITEMEFFECT_LUA_000652")
					SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000652 ) 
					SetItemAttr( Item_Traget ,ITEMATTR_MAXENERGY ,Elf_MaxEXP )
					SetItemAttr( Item_Traget ,ITEMATTR_ENERGY ,Elf_EXP )
				end 
		end 
end

----------------丘比特神符使用------------ by peter ---------------dex = GetItemAttr( Item_Traget ,ITEMATTR_VAL_DEX )       --专注
function ItemUse_QBTSF ( role , Item , Item_Traget ) 

	local Item_ID = GetItemID ( Item_Traget )
	if Item_ID ~= 5873 then
		CALCULATE_ITEMEFFECT_LUA_000655 = GetResString("CALCULATE_ITEMEFFECT_LUA_000655")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000655)
		UseItemFailed ( role )
		return
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
		local Item_type = GetItemType ( Item )
		local Item_Traget_Type = GetItemType ( Item_Traget )
		if Item_type == 66 and Item_Traget_Type == 65 then
				local dex = GetItemAttr( Item_Traget ,ITEMATTR_VAL_DEX )       --力量
					if dex >=10 then
					UseItemFailed ( role )
					return
					end
				local rad = math.random ( 1, 100 )
				 if rad<=50 then
					local Elf_URE = GetItemAttr(Item_Traget,ITEMATTR_URE) --当前耐久记录剩余封印点数
					dex = dex + 1
					if Elf_URE >= 50 then
					Elf_URE = Elf_URE-50
					end
					SetItemAttr( Item_Traget ,ITEMATTR_VAL_DEX ,dex )
					SetItemAttr( Item_Traget ,ITEMATTR_URE,Elf_URE )
				else 
				local Elf_MaxEXP = GetItemAttr(Item_Traget,ITEMATTR_MAXENERGY) --最大能量记录诅咒点数
				local Elf_EXP = GetItemAttr(Item_Traget,ITEMATTR_ENERGY) --最大能量记录诅咒点数
					Elf_MaxEXP = Elf_MaxEXP + 1
					Elf_EXP = Elf_EXP + 1
					CALCULATE_ITEMEFFECT_LUA_000652 = GetResString("CALCULATE_ITEMEFFECT_LUA_000652")
					SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000652 ) 
					SetItemAttr( Item_Traget ,ITEMATTR_MAXENERGY ,Elf_MaxEXP )
					SetItemAttr( Item_Traget ,ITEMATTR_ENERGY ,Elf_EXP )
				end 
		end 
end

----------------天使之手使用------------  by peter -------------
function ItemUse_ZhuFu2 ( role , Item , Item_Traget ) 

	local Item_ID = GetItemID ( Item_Traget )
	if Item_ID ~= 5873     then
		CALCULATE_ITEMEFFECT_LUA_000154 = GetResString("CALCULATE_ITEMEFFECT_LUA_000154")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000154)
		UseItemFailed ( role )
		return
	end
	local Elf_EXP = GetItemAttr(Item_Traget,ITEMATTR_ENERGY) --当前能量记录诅咒点数
	local Elf_MaxEXP = GetItemAttr(Item_Traget,ITEMATTR_MAXENERGY) --最大能量记录诅咒点数

	if Elf_EXP ==0 then
		UseItemFailed ( role )
		
		return
	end
	local rad = math.random ( 1, 100 )

	if Elf_EXP <= 5 and Elf_EXP >= 1 then
		if rad <= 30 then
			Elf_EXP = Elf_EXP -1
		else
			CALCULATE_ITEMEFFECT_LUA_000656 = GetResString("CALCULATE_ITEMEFFECT_LUA_000656")
			SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000656)
		end
	end

	if Elf_EXP <= 10 and Elf_EXP >= 6 then
		if rad <= 50 then
			Elf_EXP = Elf_EXP -1
		else
			CALCULATE_ITEMEFFECT_LUA_000656 = GetResString("CALCULATE_ITEMEFFECT_LUA_000656")
			SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000656)
		end
	end

	if Elf_EXP <= 15 and Elf_EXP >= 11 then
		if rad <= 80 then
			Elf_EXP = Elf_EXP -1
		else
			CALCULATE_ITEMEFFECT_LUA_000656 = GetResString("CALCULATE_ITEMEFFECT_LUA_000656")
			SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000656)
		end
	end

	if Elf_EXP >= 16  then
		Elf_EXP = Elf_EXP -1
	end

	SetItemAttr( Item_Traget ,ITEMATTR_ENERGY ,Elf_EXP )
	SetItemAttr( Item_Traget ,ITEMATTR_MAXENERGY ,Elf_EXP )
end


-----------承影神盒
function ItemUse_chengyingbox (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000657 = GetResString("CALCULATE_ITEMEFFECT_LUA_000657")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000657 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 4 then
		CALCULATE_ITEMEFFECT_LUA_000658 = GetResString("CALCULATE_ITEMEFFECT_LUA_000658")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000658)
		UseItemFailed ( role )
		return
	end
--	local i= CheckBagItem( role, xxxx )                                                
--	if i <=0 then
--		SystemNotice(  role , "请确定您身上有开启承影神盒的石头")
--		UseItemFailed ( role )
--		return LUA_FALSE
--	end
	
--	local s = DelBagItem ( role , xxxx , 1 ) 
	local	sc = math.random(1,1000)
	local itemname = ""
	if  sc <=300 then	
		GiveItem ( role , 0 , 5707 , 1 , 4 )                    ---------------乾坤锦囊   获得机率30%
		GiveItem ( role , 0 , 5910 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000539 = GetResString("CALCULATE_ITEMEFFECT_LUA_000539")
		itemname = CALCULATE_ITEMEFFECT_LUA_000539
	elseif sc <=600 and sc >300 then		
		GiveItem ( role , 0 , 3336 , 40 , 4 )                    ---------------神算草   获得机率30%
		GiveItem ( role , 0 , 5910 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000659 = GetResString("CALCULATE_ITEMEFFECT_LUA_000659")
		itemname = CALCULATE_ITEMEFFECT_LUA_000659
	elseif sc <=800 and sc >600 then
		GiveItem ( role , 0 , 5703 , 2 , 4 )                    ---------------青龙钥匙   获得机率20%
		GiveItem ( role , 0 , 5910 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000538 = GetResString("CALCULATE_ITEMEFFECT_LUA_000538")
		itemname = CALCULATE_ITEMEFFECT_LUA_000538
	elseif sc <=989 and sc >800 then
		GiveItem ( role , 0 , 5910 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000660 = GetResString("CALCULATE_ITEMEFFECT_LUA_000660")
		itemname = CALCULATE_ITEMEFFECT_LUA_000660
	elseif sc <=999 and sc >989 then
		GiveItem ( role , 0 , 5708 , 1 , 4 )                    ---------------乌龙宝箱   获得机率1%
		GiveItem ( role , 0 , 5910 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000554 = GetResString("CALCULATE_ITEMEFFECT_LUA_000554")
		itemname = CALCULATE_ITEMEFFECT_LUA_000554	
	
	else   
		GiveItem ( role , 0 , 0094 , 1 , 4 )                   ---------------元帅之首  获得机率0.1%
		GiveItem ( role , 0 , 5910 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000501 = GetResString("CALCULATE_ITEMEFFECT_LUA_000501")
		itemname = CALCULATE_ITEMEFFECT_LUA_000501
	end
	local cha_name = GetChaDefaultName ( role )
	CALCULATE_ITEMEFFECT_LUA_000661 = GetResString("CALCULATE_ITEMEFFECT_LUA_000661")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000661..itemname )
end

-----------纯钧神盒
function 	ItemUse_chunjunbox (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000662 = GetResString("CALCULATE_ITEMEFFECT_LUA_000662")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000662 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 2 then
		CALCULATE_ITEMEFFECT_LUA_000663 = GetResString("CALCULATE_ITEMEFFECT_LUA_000663")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000663)
		UseItemFailed ( role )
		return
	end
	local i= CheckBagItem( role, 5900 )                                                
	if i <=0 then
		CALCULATE_ITEMEFFECT_LUA_000664 = GetResString("CALCULATE_ITEMEFFECT_LUA_000664")
		SystemNotice(  role , CALCULATE_ITEMEFFECT_LUA_000664)
		UseItemFailed ( role )
		return LUA_FALSE
	end
	
	local s = DelBagItem ( role , 5900 , 1 ) 
	local	sc = math.random(1,100)
	local itemname = ""
	if  sc <=30 then	
		GiveItem ( role , 0 , 5644 , 35 , 4 )                    ---------------高级精灵饲料   获得机率30%
		GiveItem ( role , 0 , 5911 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000665 = GetResString("CALCULATE_ITEMEFFECT_LUA_000665")
		itemname = CALCULATE_ITEMEFFECT_LUA_000665
	elseif sc <=32 and sc >30 then		
		GiveItem ( role , 0 , 5708 , 1 , 4 )                    ---------------乌龙宝箱   获得机率2%
		GiveItem ( role , 0 , 5911 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000554 = GetResString("CALCULATE_ITEMEFFECT_LUA_000554")
		itemname = CALCULATE_ITEMEFFECT_LUA_000554
	elseif sc <=33 and sc >32 then
		GiveItem ( role , 0 , 5704 , 1 , 4 )                    ---------------真龙钥匙   获得机率1%
		GiveItem ( role , 0 , 5911 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000547 = GetResString("CALCULATE_ITEMEFFECT_LUA_000547")
		itemname = CALCULATE_ITEMEFFECT_LUA_000547
	elseif sc <=63 and sc >33 then
		GiveItem ( role , 0 , 5712 , 1 , 4 )                    ---------------真龙宝箱   获得机率30%
		GiveItem ( role , 0 , 5911 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000543 = GetResString("CALCULATE_ITEMEFFECT_LUA_000543")
		itemname = CALCULATE_ITEMEFFECT_LUA_000543
	elseif sc <=83 and sc >63 then
		GiveItem ( role , 0 , 1871 , 30 , 4 )                    ---------------祝福宝珠   获得机率20%
		GiveItem ( role , 0 , 5911 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000666 = GetResString("CALCULATE_ITEMEFFECT_LUA_000666")
		itemname = CALCULATE_ITEMEFFECT_LUA_000666	
	
	else   
		GiveItem ( role , 0 , 2519 , 1 , 4 )                   ---------------公爵项链兑换券  获得机率17%
		GiveItem ( role , 0 , 5911 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000622 = GetResString("CALCULATE_ITEMEFFECT_LUA_000622")
		itemname = CALCULATE_ITEMEFFECT_LUA_000622
	end
	local cha_name = GetChaDefaultName ( role )
	CALCULATE_ITEMEFFECT_LUA_000667 = GetResString("CALCULATE_ITEMEFFECT_LUA_000667")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000667..itemname )
end

-----------鱼肠神盒
function ItemUse_yuchangbox (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000668 = GetResString("CALCULATE_ITEMEFFECT_LUA_000668")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000668 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 2 then
		CALCULATE_ITEMEFFECT_LUA_000669 = GetResString("CALCULATE_ITEMEFFECT_LUA_000669")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000669)
		UseItemFailed ( role )
		return
	end
	local i= CheckBagItem( role, 5901 )                                                
	if i <=0 then
		CALCULATE_ITEMEFFECT_LUA_000670 = GetResString("CALCULATE_ITEMEFFECT_LUA_000670")
		SystemNotice(  role , CALCULATE_ITEMEFFECT_LUA_000670)
		UseItemFailed ( role )
		return LUA_FALSE
	end
	
	local s = DelBagItem ( role , 5901 , 1 ) 
	local	sc = math.random(1,100)
	local itemname = " "
	if  sc <=30 then	
		GiveItem ( role , 0 , 5703 , 2 , 4 )                    ---------------青龙钥匙   获得机率30%
		GiveItem ( role , 0 , 5912 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000538 = GetResString("CALCULATE_ITEMEFFECT_LUA_000538")
		itemname = CALCULATE_ITEMEFFECT_LUA_000538
	elseif sc <=40 and sc >30 then		
		GiveItem ( role , 0 , 1019 , 10 , 4 )                    ---------------迷你黑龙包   获得机率10%
		GiveItem ( role , 0 , 5912 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000472 = GetResString("CALCULATE_ITEMEFFECT_LUA_000472")
		itemname = CALCULATE_ITEMEFFECT_LUA_000472
	elseif sc <=60 and sc >40 then
		GiveItem ( role , 0 , 5919 , 1 , 4 )                    ---------------海盗王2008神秘兑换券   获得机率20%
		GiveItem ( role , 0 , 5912 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000671 = GetResString("CALCULATE_ITEMEFFECT_LUA_000671")
		itemname = CALCULATE_ITEMEFFECT_LUA_000671
	elseif sc <=89 and sc >60 then
		GiveItem ( role , 0 , 5629 , 99 , 4 )                    ---------------超人饺子   获得机率30%
		GiveItem ( role , 0 , 5912 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000672 = GetResString("CALCULATE_ITEMEFFECT_LUA_000672")
		itemname = CALCULATE_ITEMEFFECT_LUA_000672
	elseif sc <=90 and sc >89 then
		GiveItem ( role , 0 , 5704 , 1 , 4 )                    ---------------真龙钥匙   获得机率1%
		GiveItem ( role , 0 , 5912 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000547 = GetResString("CALCULATE_ITEMEFFECT_LUA_000547")
		itemname = CALCULATE_ITEMEFFECT_LUA_000547	
	
	else   
		GiveItem ( role , 0 , 2516 , 1 , 4 )                   ---------------钻石戒指兑换券  获得机率10%
		GiveItem ( role , 0 , 5912 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000619 = GetResString("CALCULATE_ITEMEFFECT_LUA_000619")
		itemname = CALCULATE_ITEMEFFECT_LUA_000619
	end
	local cha_name = GetChaDefaultName ( role )
	CALCULATE_ITEMEFFECT_LUA_000673 = GetResString("CALCULATE_ITEMEFFECT_LUA_000673")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000673..itemname )
end

-----------干将神盒
function ItemUse_ganjiangbox (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000674 = GetResString("CALCULATE_ITEMEFFECT_LUA_000674")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000674 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 2 then
		CALCULATE_ITEMEFFECT_LUA_000675 = GetResString("CALCULATE_ITEMEFFECT_LUA_000675")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000675)
		UseItemFailed ( role )
		return
	end
	local i= CheckBagItem( role, 5902 )                                                
	if i <=0 then
		CALCULATE_ITEMEFFECT_LUA_000676 = GetResString("CALCULATE_ITEMEFFECT_LUA_000676")
		SystemNotice(  role , CALCULATE_ITEMEFFECT_LUA_000676)
		UseItemFailed ( role )
		return LUA_FALSE
	end
	
	local s = DelBagItem ( role , 5902 , 1 ) 
	local	sc = math.random(1,10000)
	local itemname = ""
	if  sc <=1000 then	
		GiveItem ( role , 0 , 5774 , 1 , 4 )                    ---------------丰烽之抵御   获得机率10%
		GiveItem ( role , 0 , 5913 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000677 = GetResString("CALCULATE_ITEMEFFECT_LUA_000677")
		itemname = CALCULATE_ITEMEFFECT_LUA_000677
	elseif sc <=1001 and sc >1000 then		
		GiveItem ( role , 0 , 5705 , 1 , 4 )                    ---------------至尊钥匙   获得机率0.01%
		GiveItem ( role , 0 , 5913 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000555 = GetResString("CALCULATE_ITEMEFFECT_LUA_000555")
		itemname = CALCULATE_ITEMEFFECT_LUA_000555
	elseif sc <=2001 and sc >1001 then
		GiveItem ( role , 0 , 5919 , 1 , 4 )                    ---------------海盗王2008神秘兑换券   获得机率10%
		GiveItem ( role , 0 , 5913 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000671 = GetResString("CALCULATE_ITEMEFFECT_LUA_000671")
		itemname = CALCULATE_ITEMEFFECT_LUA_000671
	elseif sc <=3001 and sc >2001 then
		GiveItem ( role , 0 , 0853 , 1 , 4 )                    ---------------假期欢乐杂志   获得机率10%
		GiveItem ( role , 0 , 5913 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000541 = GetResString("CALCULATE_ITEMEFFECT_LUA_000541")
		itemname = CALCULATE_ITEMEFFECT_LUA_000541
	elseif sc <=7001 and sc >3001 then
		GiveItem ( role , 0 , 5645 , 30 , 4 )                    ---------------高级自动喂食饲料   获得机率40%
		GiveItem ( role , 0 , 5913 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000678 = GetResString("CALCULATE_ITEMEFFECT_LUA_000678")
		itemname = CALCULATE_ITEMEFFECT_LUA_000678	
	
	else   
		GiveItem ( role , 0 , 5612 , 15 , 4 )                   ---------------超级魔幻女神卡  获得机率29.99%
		GiveItem ( role , 0 , 5913 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000679 = GetResString("CALCULATE_ITEMEFFECT_LUA_000679")
		itemname = CALCULATE_ITEMEFFECT_LUA_000679
	end
	local cha_name = GetChaDefaultName ( role )
	CALCULATE_ITEMEFFECT_LUA_000680 = GetResString("CALCULATE_ITEMEFFECT_LUA_000680")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000680..itemname )
end

-----------莫邪神盒
function ItemUse_moxiebox (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000681 = GetResString("CALCULATE_ITEMEFFECT_LUA_000681")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000681 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 2 then
		CALCULATE_ITEMEFFECT_LUA_000682 = GetResString("CALCULATE_ITEMEFFECT_LUA_000682")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000682)
		UseItemFailed ( role )
		return
	end
	local i= CheckBagItem( role, 5903 )                                                
	if i <=0 then
		CALCULATE_ITEMEFFECT_LUA_000683 = GetResString("CALCULATE_ITEMEFFECT_LUA_000683")
		SystemNotice(  role , CALCULATE_ITEMEFFECT_LUA_000683)
		UseItemFailed ( role )
		return LUA_FALSE
	end
	
	local s = DelBagItem ( role , 5903 , 1 ) 
	local	sc = math.random(1,100)
	local itemname = ""
	if  sc <=10 then	
		GiveItem ( role , 0 , 5771 , 1 , 4 )                    ---------------夏天之灵光   获得机率10%
		GiveItem ( role , 0 , 5914 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000684 = GetResString("CALCULATE_ITEMEFFECT_LUA_000684")
		itemname = CALCULATE_ITEMEFFECT_LUA_000684
	elseif sc <=11 and sc >10 then		
		GiveItem ( role , 0 , 5705 , 1 , 4 )                    ---------------至尊钥匙   获得机率1%
		GiveItem ( role , 0 , 5914 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000555 = GetResString("CALCULATE_ITEMEFFECT_LUA_000555")
		itemname = CALCULATE_ITEMEFFECT_LUA_000555
	elseif sc <=16 and sc >11 then
		GiveItem ( role , 0 , 5920 , 1 , 4 )                    ---------------海盗王2008至尊兑换券   获得机率5%
		GiveItem ( role , 0 , 5914 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000685 = GetResString("CALCULATE_ITEMEFFECT_LUA_000685")
		itemname = CALCULATE_ITEMEFFECT_LUA_000685
	elseif sc <=40 and sc >16 then
		GiveItem ( role , 0 , 0679 , 1 , 4 )                    ---------------摩豆精灵蛋   获得机率24%
		GiveItem ( role , 0 , 5914 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000686 = GetResString("CALCULATE_ITEMEFFECT_LUA_000686")
		itemname = CALCULATE_ITEMEFFECT_LUA_000686
	elseif sc <=70 and sc >40 then
		GiveItem ( role , 0 , 0890 , 1 , 4 )                    ---------------装备加固剂   获得机率30%
		GiveItem ( role , 0 , 5914 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000687 = GetResString("CALCULATE_ITEMEFFECT_LUA_000687")
		itemname = CALCULATE_ITEMEFFECT_LUA_000687	
	
	else   
		GiveItem ( role , 0 , 0891 , 1 , 4 )                   ---------------装备催化粉  获得机率30%
		GiveItem ( role , 0 , 5914 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000688 = GetResString("CALCULATE_ITEMEFFECT_LUA_000688")
		itemname = CALCULATE_ITEMEFFECT_LUA_000688
	end
	local cha_name = GetChaDefaultName ( role )
	CALCULATE_ITEMEFFECT_LUA_000689 = GetResString("CALCULATE_ITEMEFFECT_LUA_000689")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000689..itemname )
end

-----------七星神盒
function ItemUse_qixingbox (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000690 = GetResString("CALCULATE_ITEMEFFECT_LUA_000690")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000690 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 2 then
		CALCULATE_ITEMEFFECT_LUA_000691 = GetResString("CALCULATE_ITEMEFFECT_LUA_000691")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000691)
		UseItemFailed ( role )
		return
	end
	local i= CheckBagItem( role, 5904 )                                                
	if i <=0 then
		CALCULATE_ITEMEFFECT_LUA_000692 = GetResString("CALCULATE_ITEMEFFECT_LUA_000692")
		SystemNotice(  role , CALCULATE_ITEMEFFECT_LUA_000692)
		UseItemFailed ( role )
		return LUA_FALSE
	end
	
	local s = DelBagItem ( role , 5904 , 1 ) 
	local	sc = math.random(1,10000)
	local itemname = ""
	if  sc <=1500 then	
		GiveItem ( role , 0 , 5751 , 1 , 4 )                    ---------------赤玉   获得机率15%
		GiveItem ( role , 0 , 5915 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000546 = GetResString("CALCULATE_ITEMEFFECT_LUA_000546")
		itemname = CALCULATE_ITEMEFFECT_LUA_000546
	elseif sc <=3000 and sc >1500 then		
		GiveItem ( role , 0 , 5752 , 1 , 4 )                    ---------------青玉   获得机率15%
		GiveItem ( role , 0 , 5915 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000545 = GetResString("CALCULATE_ITEMEFFECT_LUA_000545")
		itemname = CALCULATE_ITEMEFFECT_LUA_000545
	elseif sc <=3600 and sc >3000  then
		GiveItem ( role , 0 , 5920 , 1 , 4 )                    ---------------海盗王2008至尊兑换券   获得机率6%
		GiveItem ( role , 0 , 5915 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000685 = GetResString("CALCULATE_ITEMEFFECT_LUA_000685")
		itemname = CALCULATE_ITEMEFFECT_LUA_000685
	elseif sc <=6600 and sc >3600 then
		GiveItem ( role , 0 , 4023 , 30 , 4 )                    ---------------浪贝煨煎羹   获得机率30%
		GiveItem ( role , 0 , 5915 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000693 = GetResString("CALCULATE_ITEMEFFECT_LUA_000693")
		itemname = CALCULATE_ITEMEFFECT_LUA_000693
	elseif sc <=9999 and sc >6600 then
		GiveItem ( role , 0 , 0056 , 1 , 4 )                    ---------------大闸蟹   获得机率33.99%
		GiveItem ( role , 0 , 5915 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000694 = GetResString("CALCULATE_ITEMEFFECT_LUA_000694")
		itemname = CALCULATE_ITEMEFFECT_LUA_000694	
	
	else   
		GiveItem ( role , 0 , 2842 , 1 , 4 )                   ---------------死神藏尸处  获得机率0.01%
		GiveItem ( role , 0 , 5915 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000695 = GetResString("CALCULATE_ITEMEFFECT_LUA_000695")
		itemname = CALCULATE_ITEMEFFECT_LUA_000695
	end
	local cha_name = GetChaDefaultName ( role )
	CALCULATE_ITEMEFFECT_LUA_000696 = GetResString("CALCULATE_ITEMEFFECT_LUA_000696")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000696..itemname )
end

-----------泰阿神盒
function ItemUse_taiabox (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000697 = GetResString("CALCULATE_ITEMEFFECT_LUA_000697")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000697 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 2 then
		CALCULATE_ITEMEFFECT_LUA_000698 = GetResString("CALCULATE_ITEMEFFECT_LUA_000698")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000698)
		UseItemFailed ( role )
		return
	end
	local i= CheckBagItem( role, 5905 )                                                
	if i <=0 then
		CALCULATE_ITEMEFFECT_LUA_000699 = GetResString("CALCULATE_ITEMEFFECT_LUA_000699")
		SystemNotice(  role , CALCULATE_ITEMEFFECT_LUA_000699)
		UseItemFailed ( role )
		return LUA_FALSE
	end
	
	local s = DelBagItem ( role , 5905 , 1 ) 
	local	sc = math.random(1,10000)
	local itemname = ""
	if  sc <=2500 then	
		GiveItem ( role , 0 , 4022 , 5 , 4 )                    ---------------映月鲟鱼汤   获得机率25%
		GiveItem ( role , 0 , 5916 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000700 = GetResString("CALCULATE_ITEMEFFECT_LUA_000700")
		itemname = CALCULATE_ITEMEFFECT_LUA_000700
	elseif sc <=5500 and sc >2500 then		
		GiveItem ( role , 0 , 5643 , 99, 4 )                    ---------------精灵自动加速果   获得机率30%
		GiveItem ( role , 0 , 5916 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000701 = GetResString("CALCULATE_ITEMEFFECT_LUA_000701")
		itemname = CALCULATE_ITEMEFFECT_LUA_000701
	elseif sc <=6300 and sc >5500 then
		GiveItem ( role , 0 , 5920 , 1 , 4 )                    ---------------海盗王2008至尊兑换券   获得机率8%
		GiveItem ( role , 0 , 5916 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000685 = GetResString("CALCULATE_ITEMEFFECT_LUA_000685")
		itemname = CALCULATE_ITEMEFFECT_LUA_000685
	elseif sc <=7300 and sc >6300 then
		GiveItem ( role , 0 , 5750 , 1 , 4 )                    ---------------黄玉   获得机率10%
		GiveItem ( role , 0 , 5916 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000544 = GetResString("CALCULATE_ITEMEFFECT_LUA_000544")
		itemname = CALCULATE_ITEMEFFECT_LUA_000544
	elseif sc <=9999 and sc >7300 then
		GiveItem ( role , 0 , 3457 , 1 , 4 )                    ---------------纳卡符石   获得机率26.99%
		GiveItem ( role , 0 , 5916 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000702 = GetResString("CALCULATE_ITEMEFFECT_LUA_000702")
		itemname = CALCULATE_ITEMEFFECT_LUA_000702	
	
	else   
		GiveItem ( role , 0 , 5706 , 1 , 4 )                   ---------------无双钥匙  获得机率0.01%
		GiveItem ( role , 0 , 5916 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000562 = GetResString("CALCULATE_ITEMEFFECT_LUA_000562")
		itemname = CALCULATE_ITEMEFFECT_LUA_000562
	end
	local cha_name = GetChaDefaultName ( role )
	CALCULATE_ITEMEFFECT_LUA_000703 = GetResString("CALCULATE_ITEMEFFECT_LUA_000703")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000703..itemname )
end

-----------赤霄神盒
function ItemUse_chixiaobox (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000704 = GetResString("CALCULATE_ITEMEFFECT_LUA_000704")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000704 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 2 then
		CALCULATE_ITEMEFFECT_LUA_000705 = GetResString("CALCULATE_ITEMEFFECT_LUA_000705")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000705)
		UseItemFailed ( role )
		return
	end
	local i= CheckBagItem( role, 5906 )                                                
	if i <=0 then
		CALCULATE_ITEMEFFECT_LUA_000706 = GetResString("CALCULATE_ITEMEFFECT_LUA_000706")
		SystemNotice(  role , CALCULATE_ITEMEFFECT_LUA_000706)
		UseItemFailed ( role )
		return LUA_FALSE
	end
	
	local s = DelBagItem ( role , 5906 , 1 ) 
	local	sc = math.random(1,10000)
	local itemname = ""
	if  sc <=2000 then	
		GiveItem ( role , 0 , 0937 , 1 , 4 )                    ---------------天使之翼   获得机率20%
		GiveItem ( role , 0 , 5917 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000707 = GetResString("CALCULATE_ITEMEFFECT_LUA_000707")
		itemname = CALCULATE_ITEMEFFECT_LUA_000707
	elseif sc <=5000 and sc >2000 then		
		GiveItem ( role , 0 , 1080 , 30, 4 )                    ---------------大饼   获得机率30%
		GiveItem ( role , 0 , 5917 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000708 = GetResString("CALCULATE_ITEMEFFECT_LUA_000708")
		itemname = CALCULATE_ITEMEFFECT_LUA_000708
	elseif sc <=6000 and sc >5000 then
		GiveItem ( role , 0 , 5920 , 1 , 4 )                    ---------------海盗王2008至尊兑换券   获得机率10%
		GiveItem ( role , 0 , 5917 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000685 = GetResString("CALCULATE_ITEMEFFECT_LUA_000685")
		itemname = CALCULATE_ITEMEFFECT_LUA_000685
	elseif sc <=8000 and sc >6000 then
		GiveItem ( role , 0 , 5707 , 1 , 4 )                    ---------------乾坤锦囊   获得机率20%
		GiveItem ( role , 0 , 5917 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000539 = GetResString("CALCULATE_ITEMEFFECT_LUA_000539")
		itemname = CALCULATE_ITEMEFFECT_LUA_000539
	elseif sc <=9999 and sc >8000 then
		GiveItem ( role , 0 , 5610 , 18 , 4 )                    ---------------幸运洛克藏宝图   获得机率19.99%
		GiveItem ( role , 0 , 5917 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000709 = GetResString("CALCULATE_ITEMEFFECT_LUA_000709")
		itemname = CALCULATE_ITEMEFFECT_LUA_000709	
	
	else   
		GiveItem ( role , 0 , 2522 , 1 , 4 )                   ---------------神之祈福包  获得机率0.01%
		GiveItem ( role , 0 , 5917 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000565 = GetResString("CALCULATE_ITEMEFFECT_LUA_000565")
		itemname = CALCULATE_ITEMEFFECT_LUA_000565
	end
	local cha_name = GetChaDefaultName ( role )
	CALCULATE_ITEMEFFECT_LUA_000710 = GetResString("CALCULATE_ITEMEFFECT_LUA_000710")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000710..itemname )
end

-----------湛泸神盒
function ItemUse_zhanlubox (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000711 = GetResString("CALCULATE_ITEMEFFECT_LUA_000711")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000711 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 2 then
		CALCULATE_ITEMEFFECT_LUA_000712 = GetResString("CALCULATE_ITEMEFFECT_LUA_000712")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000712)
		UseItemFailed ( role )
		return
	end
	local i= CheckBagItem( role, 5907 )                                                
	if i <=0 then
		CALCULATE_ITEMEFFECT_LUA_000713 = GetResString("CALCULATE_ITEMEFFECT_LUA_000713")
		SystemNotice(  role , CALCULATE_ITEMEFFECT_LUA_000713)
		UseItemFailed ( role )
		return LUA_FALSE
	end
	
	local s = DelBagItem ( role , 5907 , 1 ) 
	local	sc = math.random(1,100)
	local itemname = ""
	if  sc <=40 then	
		GiveItem ( role , 0 , 5610 , 15 , 4 )                    ---------------幸运洛克藏宝图   获得机率40%
		GiveItem ( role , 0 , 5918 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000709 = GetResString("CALCULATE_ITEMEFFECT_LUA_000709")
		itemname = CALCULATE_ITEMEFFECT_LUA_000709
	elseif sc <=45 and sc >40 then		
		GiveItem ( role , 0 , 0273 , 1 , 4 )                    ---------------一等奖   获得机率5%
		GiveItem ( role , 0 , 5918 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000714 = GetResString("CALCULATE_ITEMEFFECT_LUA_000714")
		itemname = CALCULATE_ITEMEFFECT_LUA_000714
	elseif sc <=50 and sc > 45 then
		GiveItem ( role , 0 , 5714 , 1 , 4 )                    ---------------无双宝箱   获得机率5%
		GiveItem ( role , 0 , 5918 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000559 = GetResString("CALCULATE_ITEMEFFECT_LUA_000559")
		itemname = CALCULATE_ITEMEFFECT_LUA_000559
	elseif sc <=55 and sc >50 then
		GiveItem ( role , 0 , 0095 , 1 , 4 )                    ---------------大副之首   获得机率5%
		GiveItem ( role , 0 , 5918 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000715 = GetResString("CALCULATE_ITEMEFFECT_LUA_000715")
		itemname = CALCULATE_ITEMEFFECT_LUA_000715
	elseif sc <=75 and sc >55 then
		GiveItem ( role , 0 , 5848 , 1 , 4 )                    ---------------死神凝聚   获得机率20%
		GiveItem ( role , 0 , 5918 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000716 = GetResString("CALCULATE_ITEMEFFECT_LUA_000716")
		itemname = CALCULATE_ITEMEFFECT_LUA_000716	
	
	else   
		GiveItem ( role , 0 , 3878 , 1 , 4 )                   ---------------二级精炼石兑换券  获得机率25%
		GiveItem ( role , 0 , 5918 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000717 = GetResString("CALCULATE_ITEMEFFECT_LUA_000717")
		itemname = CALCULATE_ITEMEFFECT_LUA_000717
	end
	local cha_name = GetChaDefaultName ( role )
	CALCULATE_ITEMEFFECT_LUA_000718 = GetResString("CALCULATE_ITEMEFFECT_LUA_000718")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000718..itemname )
end

-----------轩辕神盒
function ItemUse_xuanyuanbox (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000719 = GetResString("CALCULATE_ITEMEFFECT_LUA_000719")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000719 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 2 then
		CALCULATE_ITEMEFFECT_LUA_000720 = GetResString("CALCULATE_ITEMEFFECT_LUA_000720")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000720)
		UseItemFailed ( role )
		return
	end
	local i= CheckBagItem( role, 5908 )                                                
	if i <=0 then
		CALCULATE_ITEMEFFECT_LUA_000721 = GetResString("CALCULATE_ITEMEFFECT_LUA_000721")
		SystemNotice(  role , CALCULATE_ITEMEFFECT_LUA_000721)
		UseItemFailed ( role )
		return LUA_FALSE
	end
	
	local s = DelBagItem ( role , 5908 , 1 ) 
	local	sc = math.random(1,100)
	local itemname = ""
	if  sc <=5 then	
		GiveItem ( role , 0 , 5845 , 1 , 4 )                    ---------------死神辉耀   获得机率5%
		GiveItem ( role , 0 , 5919 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000722 = GetResString("CALCULATE_ITEMEFFECT_LUA_000722")
		itemname = CALCULATE_ITEMEFFECT_LUA_000722
	elseif sc <=15 and sc >5 then		
		GiveItem ( role , 0 , 5846 , 1 , 4 )                    ---------------死神不死   获得机率10%
		GiveItem ( role , 0 , 5919 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000723 = GetResString("CALCULATE_ITEMEFFECT_LUA_000723")
		itemname = CALCULATE_ITEMEFFECT_LUA_000723
	elseif sc <=20 and sc >15 then
		GiveItem ( role , 0 , 5847 , 1 , 4 )                    ---------------死神光芒   获得机率5%
		GiveItem ( role , 0 , 5919 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000724 = GetResString("CALCULATE_ITEMEFFECT_LUA_000724")
		itemname = CALCULATE_ITEMEFFECT_LUA_000724
	elseif sc <=55 and sc >20 then
		GiveItem ( role , 0 , 5711 , 1 , 4 )                    ---------------青龙宝箱   获得机率35%
		GiveItem ( role , 0 , 5919 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000536 = GetResString("CALCULATE_ITEMEFFECT_LUA_000536")
		itemname = CALCULATE_ITEMEFFECT_LUA_000536
	elseif sc <=65 and sc >55 then
		GiveItem ( role , 0 , 5849 , 1 , 4 )                    ---------------死神旋舞   获得机率10%
		GiveItem ( role , 0 , 5919 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000725 = GetResString("CALCULATE_ITEMEFFECT_LUA_000725")
		itemname = CALCULATE_ITEMEFFECT_LUA_000725	
	
	else   
		GiveItem ( role , 0 , 3088 , 1 , 4 )                   ---------------28格背包  获得机率35%
		GiveItem ( role , 0 , 5919 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000726 = GetResString("CALCULATE_ITEMEFFECT_LUA_000726")
		itemname = CALCULATE_ITEMEFFECT_LUA_000726
	end
	local cha_name = GetChaDefaultName ( role )
	CALCULATE_ITEMEFFECT_LUA_000727 = GetResString("CALCULATE_ITEMEFFECT_LUA_000727")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000727..itemname )
end

-----------长生剑神盒
function ItemUse_changshengbox (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000728 = GetResString("CALCULATE_ITEMEFFECT_LUA_000728")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000728 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 4 then
		CALCULATE_ITEMEFFECT_LUA_000729 = GetResString("CALCULATE_ITEMEFFECT_LUA_000729")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000729)
		UseItemFailed ( role )
		return
	end
--	local i= CheckBagItem( role, xxxx )                                                
--	if i <=0 then
--		SystemNotice(  role , "请确定您身上有开启长生剑神盒的石头")
--		UseItemFailed ( role )
--		return LUA_FALSE
--	end
	
--	local s = DelBagItem ( role , xxxx , 1 ) 
	local	sc = math.random(1,100)
	local itemname = ""
	if  sc <=30 then	
		GiveItem ( role , 0 , 3094 , 6 , 4 )                    ---------------双倍经验增幅器   获得机率30%
		GiveItem ( role , 0 , 5928 , 1 , 4 ) 
		GiveItem ( role , 0 , 3093 , 1 , 4 ) 
		CALCULATE_FUNCTIONS_LUA_000682 = GetResString("CALCULATE_FUNCTIONS_LUA_000682")
		itemname = CALCULATE_FUNCTIONS_LUA_000682
	elseif sc <=35 and sc >30 then		
		GiveItem ( role , 0 , 0885 , 1 , 4 )                    ---------------精炼石   获得机率5%
		GiveItem ( role , 0 , 5928 , 1 , 4 ) 
		GiveItem ( role , 0 , 3093 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000730 = GetResString("CALCULATE_ITEMEFFECT_LUA_000730")
		itemname = CALCULATE_ITEMEFFECT_LUA_000730
	elseif sc <=45 and sc >35 then
		GiveItem ( role , 0 , 5618 , 4 , 4 )                    ---------------摩力团队果   获得机率10%
		GiveItem ( role , 0 , 5928 , 1 , 4 ) 
		GiveItem ( role , 0 , 3093 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000731 = GetResString("CALCULATE_ITEMEFFECT_LUA_000731")
		itemname = CALCULATE_ITEMEFFECT_LUA_000731
	elseif sc <=75 and sc >45 then
		GiveItem ( role , 0 , 5617 , 1 , 4 )                    ---------------中阶五倍经验果   获得机率30%
		GiveItem ( role , 0 , 5928 , 1 , 4 ) 
		GiveItem ( role , 0 , 3093 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000732 = GetResString("CALCULATE_ITEMEFFECT_LUA_000732")
		itemname = CALCULATE_ITEMEFFECT_LUA_000732
	elseif sc <=95 and sc >95 then
		GiveItem ( role , 0 , 5609 , 3 , 4 )                    ---------------免死金牌   获得机率20%
		GiveItem ( role , 0 , 5928 , 1 , 4 ) 
		GiveItem ( role , 0 , 3093 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000587 = GetResString("CALCULATE_ITEMEFFECT_LUA_000587")
		itemname = CALCULATE_ITEMEFFECT_LUA_000587	
	
	else   
		GiveItem ( role , 0 , 5928 , 1 , 4 ) 
		GiveItem ( role , 0 , 3093 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000733 = GetResString("CALCULATE_ITEMEFFECT_LUA_000733")
		itemname = CALCULATE_ITEMEFFECT_LUA_000733
	end
	local cha_name = GetChaDefaultName ( role )
	CALCULATE_ITEMEFFECT_LUA_000734 = GetResString("CALCULATE_ITEMEFFECT_LUA_000734")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000734..itemname )
end

-----------孔雀翎神盒
function ItemUse_kongquelingbox (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000735 = GetResString("CALCULATE_ITEMEFFECT_LUA_000735")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000735 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 3 then
		CALCULATE_ITEMEFFECT_LUA_000736 = GetResString("CALCULATE_ITEMEFFECT_LUA_000736")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000736)
		UseItemFailed ( role )
		return
	end
	local i= CheckBagItem( role, 5921 )                                                
	if i <=0 then
		CALCULATE_ITEMEFFECT_LUA_000737 = GetResString("CALCULATE_ITEMEFFECT_LUA_000737")
		SystemNotice(  role , CALCULATE_ITEMEFFECT_LUA_000737)
		UseItemFailed ( role )
		return LUA_FALSE
	end
	
	local s = DelBagItem ( role , 5921 , 1 ) 
	local	sc = math.random(1,100)
	local itemname = ""
	if  sc <=10 then	
		GiveItem ( role , 0 , 0276 , 1 , 4 )                    ---------------高级圣雪山龙果   获得机率10%
		GiveItem ( role , 0 , 5929 , 1 , 4 ) 
		GiveItem ( role , 0 , 3092 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000738 = GetResString("CALCULATE_ITEMEFFECT_LUA_000738")
		itemname = CALCULATE_ITEMEFFECT_LUA_000738
	elseif sc <=30 and sc >10 then		
		GiveItem ( role , 0 , 0277 , 1 , 4 )                    ---------------高级冰极爽口梅   获得机率20%
		GiveItem ( role , 0 , 5929 , 1 , 4 ) 
		GiveItem ( role , 0 , 3092 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000739 = GetResString("CALCULATE_ITEMEFFECT_LUA_000739")
		itemname = CALCULATE_ITEMEFFECT_LUA_000739
	elseif sc <=50 and sc >30 then
		GiveItem ( role , 0 , 0279 , 1 , 4 )                    ---------------高级白银城果脯   获得机率20%
		GiveItem ( role , 0 , 5929 , 1 , 4 ) 
		GiveItem ( role , 0 , 3092 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000740 = GetResString("CALCULATE_ITEMEFFECT_LUA_000740")
		itemname = CALCULATE_ITEMEFFECT_LUA_000740
	elseif sc <=60 and sc >50 then
		GiveItem ( role , 0 , 0280 , 1 , 4 )                    ---------------高级新沙岚米饼   获得机率10%
		GiveItem ( role , 0 , 5929 , 1 , 4 ) 
		GiveItem ( role , 0 , 3092 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000741 = GetResString("CALCULATE_ITEMEFFECT_LUA_000741")
		itemname = CALCULATE_ITEMEFFECT_LUA_000741
	elseif sc <=90 and sc >60 then
		GiveItem ( role , 0 , 0278 , 1 , 4 )                    ---------------高级海风鳕鱼丝   获得机率30%
		GiveItem ( role , 0 , 5929 , 1 , 4 ) 
		GiveItem ( role , 0 , 3092 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000742 = GetResString("CALCULATE_ITEMEFFECT_LUA_000742")
		itemname = CALCULATE_ITEMEFFECT_LUA_000742	
	
	else   
		GiveItem ( role , 0 , 5610 , 4 , 4 )                   ---------------幸运洛克藏宝图  获得机率10%
		GiveItem ( role , 0 , 5929 , 1 , 4 ) 
		GiveItem ( role , 0 , 3092 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000709 = GetResString("CALCULATE_ITEMEFFECT_LUA_000709")
		itemname = CALCULATE_ITEMEFFECT_LUA_000709
	end
	local cha_name = GetChaDefaultName ( role )
	CALCULATE_ITEMEFFECT_LUA_000743 = GetResString("CALCULATE_ITEMEFFECT_LUA_000743")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000743..itemname )
end

-----------碧玉刀神盒
function ItemUse_biyudaobox (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000744 = GetResString("CALCULATE_ITEMEFFECT_LUA_000744")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000744 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 3 then
		CALCULATE_ITEMEFFECT_LUA_000745 = GetResString("CALCULATE_ITEMEFFECT_LUA_000745")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000745)
		UseItemFailed ( role )
		return
	end
	local i= CheckBagItem( role, 5922 )                                                
	if i <=0 then
		CALCULATE_ITEMEFFECT_LUA_000746 = GetResString("CALCULATE_ITEMEFFECT_LUA_000746")
		SystemNotice(  role , CALCULATE_ITEMEFFECT_LUA_000746)
		UseItemFailed ( role )
		return LUA_FALSE
	end
	
	local s = DelBagItem ( role , 5922 , 1 ) 
	local	sc = math.random(1,100)
	local itemname = ""
	if  sc <=20 then	
		GiveItem ( role , 0 , 0259 , 1 , 4 )                    ---------------初级沉思   获得机率20%
		GiveItem ( role , 0 , 5930 , 1 , 4 ) 
		GiveItem ( role , 0 , 3091 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000747 = GetResString("CALCULATE_ITEMEFFECT_LUA_000747")
		itemname = CALCULATE_ITEMEFFECT_LUA_000747
	elseif sc <=50 and sc >20 then		
		GiveItem ( role , 0 , 0227 , 12 , 4 )                    ---------------初级精灵饲料   获得机率30%
		GiveItem ( role , 0 , 5930 , 1 , 4 ) 
		GiveItem ( role , 0 , 3091 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000748 = GetResString("CALCULATE_ITEMEFFECT_LUA_000748")
		itemname = CALCULATE_ITEMEFFECT_LUA_000748
	elseif sc <=70 and sc >50 then
		GiveItem ( role , 0 , 3096 , 17 , 4 )                    ---------------双倍掉料增幅器   获得机率20%
		GiveItem ( role , 0 , 5930 , 1 , 4 ) 
		GiveItem ( role , 0 , 3091 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000468 = GetResString("CALCULATE_ITEMEFFECT_LUA_000468")
		itemname = CALCULATE_ITEMEFFECT_LUA_000468
	elseif sc <=80 and sc >70 then
		GiveItem ( role , 0 , 0246 , 1 , 4 )                    ---------------初级爆击   获得机率10%
		GiveItem ( role , 0 , 5930 , 1 , 4 ) 
		GiveItem ( role , 0 , 3091 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000749 = GetResString("CALCULATE_ITEMEFFECT_LUA_000749")
		itemname = CALCULATE_ITEMEFFECT_LUA_000749
	elseif sc <=95 and sc >80 then
		GiveItem ( role , 0 , 0937 , 1 , 4 )                    ---------------天使之翼   获得机率15%
		GiveItem ( role , 0 , 5930 , 1 , 4 ) 
		GiveItem ( role , 0 , 3091 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000707 = GetResString("CALCULATE_ITEMEFFECT_LUA_000707")
		itemname = CALCULATE_ITEMEFFECT_LUA_000707	
	
	else   
		GiveItem ( role , 0 , 0679 , 1 , 4 )                   ---------------摩豆精灵蛋  获得机率5%
		GiveItem ( role , 0 , 5930 , 1 , 4 ) 
		GiveItem ( role , 0 , 3091 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000686 = GetResString("CALCULATE_ITEMEFFECT_LUA_000686")
		itemname = CALCULATE_ITEMEFFECT_LUA_000686
	end
	local cha_name = GetChaDefaultName ( role )
	CALCULATE_ITEMEFFECT_LUA_000750 = GetResString("CALCULATE_ITEMEFFECT_LUA_000750")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000750..itemname )
end

-----------多情环神盒
function ItemUse_duoqinghuanbox (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000751 = GetResString("CALCULATE_ITEMEFFECT_LUA_000751")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000751 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 3 then
		CALCULATE_ITEMEFFECT_LUA_000752 = GetResString("CALCULATE_ITEMEFFECT_LUA_000752")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000752)
		UseItemFailed ( role )
		return
	end
	local i= CheckBagItem( role, 5923 )                                                
	if i <=0 then
		CALCULATE_ITEMEFFECT_LUA_000753 = GetResString("CALCULATE_ITEMEFFECT_LUA_000753")
		SystemNotice(  role , CALCULATE_ITEMEFFECT_LUA_000753)
		UseItemFailed ( role )
		return LUA_FALSE
	end
	
	local s = DelBagItem ( role , 5923 , 1 ) 
	local	sc = math.random(1,100)
	local itemname = ""
	if  sc <=20 then	
		GiveItem ( role , 0 , 3079 , 5 , 4 )                    ---------------红包   获得机率20%
		GiveItem ( role , 0 , 5931 , 1 , 4 ) 
		GiveItem ( role , 0 , 3090 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000754 = GetResString("CALCULATE_ITEMEFFECT_LUA_000754")
		itemname = CALCULATE_ITEMEFFECT_LUA_000754
	elseif sc <=50 and sc >20 then		
		GiveItem ( role , 0 , 0890 , 1 , 4 )                    ---------------装备加固剂   获得机率30%
		GiveItem ( role , 0 , 5931 , 1 , 4 ) 
		GiveItem ( role , 0 , 3090 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000687 = GetResString("CALCULATE_ITEMEFFECT_LUA_000687")
		itemname = CALCULATE_ITEMEFFECT_LUA_000687
	elseif sc <=70 and sc >50 then
		GiveItem ( role , 0 , 0891 , 1 , 4 )                    ---------------装备催化粉   获得机率20%
		GiveItem ( role , 0 , 5931 , 1 , 4 ) 
		GiveItem ( role , 0 , 3090 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000688 = GetResString("CALCULATE_ITEMEFFECT_LUA_000688")
		itemname = CALCULATE_ITEMEFFECT_LUA_000688
	elseif sc <=80 and sc >70 then
		GiveItem ( role , 0 , 0252 , 1 , 4 )                    ---------------初级回复   获得机率10%
		GiveItem ( role , 0 , 5931 , 1 , 4 ) 
		GiveItem ( role , 0 , 3090 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000755 = GetResString("CALCULATE_ITEMEFFECT_LUA_000755")
		itemname = CALCULATE_ITEMEFFECT_LUA_000755
	elseif sc <=95 and sc >80 then
		GiveItem ( role , 0 , 0906 , 1 , 4 )                    ---------------黑魔翅膀   获得机率15%
		GiveItem ( role , 0 , 5931 , 1 , 4 ) 
		GiveItem ( role , 0 , 3090 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000756 = GetResString("CALCULATE_ITEMEFFECT_LUA_000756")
		itemname = CALCULATE_ITEMEFFECT_LUA_000756	
	
	else   
		GiveItem ( role , 0 , 3457 , 1 , 4 )                   ---------------纳卡符石  获得机率5%
		GiveItem ( role , 0 , 5931 , 1 , 4 ) 
		GiveItem ( role , 0 , 3090 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000702 = GetResString("CALCULATE_ITEMEFFECT_LUA_000702")
		itemname = CALCULATE_ITEMEFFECT_LUA_000702
	end
	local cha_name = GetChaDefaultName ( role )
	CALCULATE_ITEMEFFECT_LUA_000757 = GetResString("CALCULATE_ITEMEFFECT_LUA_000757")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000757..itemname )
end

-----------离别钩神盒
function ItemUse_libiegoubox (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000758 = GetResString("CALCULATE_ITEMEFFECT_LUA_000758")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000758 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 3 then
		CALCULATE_ITEMEFFECT_LUA_000759 = GetResString("CALCULATE_ITEMEFFECT_LUA_000759")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000759)
		UseItemFailed ( role )
		return
	end
	local i= CheckBagItem( role, 5924 )                                                
	if i <=0 then
		CALCULATE_ITEMEFFECT_LUA_000760 = GetResString("CALCULATE_ITEMEFFECT_LUA_000760")
		SystemNotice(  role , CALCULATE_ITEMEFFECT_LUA_000760)
		UseItemFailed ( role )
		return LUA_FALSE
	end
	
	local s = DelBagItem ( role , 5924 , 1 ) 
	local	sc = math.random(1,100)
	local itemname = ""
	if  sc <=20 then	
		GiveItem ( role , 0 , 5641 , 2 , 4 )                    ---------------神奇老虎钳   获得机率20%
		GiveItem ( role , 0 , 5932 , 1 , 4 ) 
		GiveItem ( role , 0 , 3089 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000761 = GetResString("CALCULATE_ITEMEFFECT_LUA_000761")
		itemname = CALCULATE_ITEMEFFECT_LUA_000761
	elseif sc <=40 and sc >20 then		
		GiveItem ( role , 0 , 3878 , 1 , 4 )                    ---------------二级精炼石兑换券   获得机率20%
		GiveItem ( role , 0 , 5932 , 1 , 4 ) 
		GiveItem ( role , 0 , 3089 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000717 = GetResString("CALCULATE_ITEMEFFECT_LUA_000717")
		itemname = CALCULATE_ITEMEFFECT_LUA_000717
	elseif sc <=60 and sc >40 then
		GiveItem ( role , 0 , 0090 , 1 , 4 )                    ---------------少校之首   获得机率20%
		GiveItem ( role , 0 , 5932 , 1 , 4 ) 
		GiveItem ( role , 0 , 3089 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000572 = GetResString("CALCULATE_ITEMEFFECT_LUA_000572")
		itemname = CALCULATE_ITEMEFFECT_LUA_000572
	elseif sc <=90 and sc >60 then
		GiveItem ( role , 0 , 5644 , 15 , 4 )                    ---------------高级精灵饲料   获得机率30%
		GiveItem ( role , 0 , 5932 , 1 , 4 ) 
		GiveItem ( role , 0 , 3089 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000665 = GetResString("CALCULATE_ITEMEFFECT_LUA_000665")
		itemname = CALCULATE_ITEMEFFECT_LUA_000665
	elseif sc <=95 and sc >90 then
		GiveItem ( role , 0 , 0887 , 1 , 4 )                    ---------------圣光石   获得机率5%
		GiveItem ( role , 0 , 5932 , 1 , 4 ) 
		GiveItem ( role , 0 , 3089 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000762 = GetResString("CALCULATE_ITEMEFFECT_LUA_000762")
		itemname = CALCULATE_ITEMEFFECT_LUA_000762	
	
	else   
		GiveItem ( role , 0 , 5707 , 1 , 4 )                   ---------------乾坤锦囊  获得机率5%
		GiveItem ( role , 0 , 5932 , 1 , 4 ) 
		GiveItem ( role , 0 , 3089 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000539 = GetResString("CALCULATE_ITEMEFFECT_LUA_000539")
		itemname = CALCULATE_ITEMEFFECT_LUA_000539
	end
	local cha_name = GetChaDefaultName ( role )
	CALCULATE_ITEMEFFECT_LUA_000763 = GetResString("CALCULATE_ITEMEFFECT_LUA_000763")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000763..itemname )
end

-----------霸王枪神盒
function ItemUse_bawangqiangbox (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000764 = GetResString("CALCULATE_ITEMEFFECT_LUA_000764")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000764 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 2 then
		CALCULATE_ITEMEFFECT_LUA_000765 = GetResString("CALCULATE_ITEMEFFECT_LUA_000765")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000765)
		UseItemFailed ( role )
		return
	end
	local i= CheckBagItem( role, 5925 )                                                
	if i <=0 then
		CALCULATE_ITEMEFFECT_LUA_000766 = GetResString("CALCULATE_ITEMEFFECT_LUA_000766")
		SystemNotice(  role , CALCULATE_ITEMEFFECT_LUA_000766)
		UseItemFailed ( role )
		return LUA_FALSE
	end
	
	local s = DelBagItem ( role , 5925 , 1 ) 
	local	sc = math.random(1,100)
	local itemname = ""
	if  sc <=30 then	
		GiveItem ( role , 0 , 0582 , 1 , 4 )                    ---------------高级贝壳兑换券   获得机率30%
		GiveItem ( role , 0 , 5933 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000767 = GetResString("CALCULATE_ITEMEFFECT_LUA_000767")
		itemname = CALCULATE_ITEMEFFECT_LUA_000767
	elseif sc <=45 and sc >30 then		
		GiveItem ( role , 0 , 2670 , 1 , 4 )                    ---------------天衣宝箱   获得机率15%
		GiveItem ( role , 0 , 5933 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000768 = GetResString("CALCULATE_ITEMEFFECT_LUA_000768")
		itemname = CALCULATE_ITEMEFFECT_LUA_000768
	elseif sc <=70 and sc >45 then
		GiveItem ( role , 0 , 0091 , 1 , 4 )                    ---------------中校之首   获得机率25%
		GiveItem ( role , 0 , 5933 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000540 = GetResString("CALCULATE_ITEMEFFECT_LUA_000540")
		itemname = CALCULATE_ITEMEFFECT_LUA_000540
	elseif sc <=94 and sc >70 then
		GiveItem ( role , 0 , 2216 , 1 , 4 )                    ---------------技能重塑之书   获得机率24%
		GiveItem ( role , 0 , 5933 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000769 = GetResString("CALCULATE_ITEMEFFECT_LUA_000769")
		itemname = CALCULATE_ITEMEFFECT_LUA_000769
	elseif sc <=99 and sc >94 then
		GiveItem ( role , 0 , 0581 , 1 , 4 )                    ---------------高级项链兑换券   获得机率5%
		GiveItem ( role , 0 , 5933 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000770 = GetResString("CALCULATE_ITEMEFFECT_LUA_000770")
		itemname = CALCULATE_ITEMEFFECT_LUA_000770	
	
	else   
		GiveItem ( role , 0 , 0853 , 1 , 4 )                   ---------------假期欢乐杂志  获得机率1%
		GiveItem ( role , 0 , 5933 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000541 = GetResString("CALCULATE_ITEMEFFECT_LUA_000541")
		itemname = CALCULATE_ITEMEFFECT_LUA_000541
	end
	local cha_name = GetChaDefaultName ( role )
	CALCULATE_ITEMEFFECT_LUA_000771 = GetResString("CALCULATE_ITEMEFFECT_LUA_000771")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000771..itemname )
end

-----------拳头神盒
function ItemUse_quantoubox (role, Item)

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000772 = GetResString("CALCULATE_ITEMEFFECT_LUA_000772")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000772 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	 if Item_CanGet < 2 then
		CALCULATE_ITEMEFFECT_LUA_000773 = GetResString("CALCULATE_ITEMEFFECT_LUA_000773")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000773)
		UseItemFailed ( role )
		return
	end
	local i= CheckBagItem( role, 5926 )                                                
	if i <=0 then
		CALCULATE_ITEMEFFECT_LUA_000774 = GetResString("CALCULATE_ITEMEFFECT_LUA_000774")
		SystemNotice(  role , CALCULATE_ITEMEFFECT_LUA_000774)
		UseItemFailed ( role )
		return LUA_FALSE
	end
	
	local s = DelBagItem ( role , 5926 , 1 ) 
	local	sc = math.random(1,100)
	local itemname = ""
	if  sc <=20 then	
		GiveItem ( role , 0 , 0862 , 1 , 4 )                    ---------------岩玉   获得机率20%
		GiveItem ( role , 0 , 3088 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000497 = GetResString("CALCULATE_ITEMEFFECT_LUA_000497")
		itemname = CALCULATE_ITEMEFFECT_LUA_000497
	elseif sc <=35 and sc >20 then		
		GiveItem ( role , 0 , 0863 , 1 , 4 )                    ---------------炎玉   获得机率15%
		GiveItem ( role , 0 , 3088 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000496 = GetResString("CALCULATE_ITEMEFFECT_LUA_000496")
		itemname = CALCULATE_ITEMEFFECT_LUA_000496
	elseif sc <=65 and sc >35 then
		GiveItem ( role , 0 , 0861 , 1 , 4 )                    ---------------鹰眼石   获得机率30%
		GiveItem ( role , 0 , 3088 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000775 = GetResString("CALCULATE_ITEMEFFECT_LUA_000775")
		itemname = CALCULATE_ITEMEFFECT_LUA_000775
	elseif sc <=90 and sc >65 then
		GiveItem ( role , 0 , 0860 , 1 , 4 )                    ---------------风灵石   获得机率25%
		GiveItem ( role , 0 , 3088 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000776 = GetResString("CALCULATE_ITEMEFFECT_LUA_000776")
		itemname = CALCULATE_ITEMEFFECT_LUA_000776
	elseif sc <=95 and sc >90 then
		GiveItem ( role , 0 , 0580 , 1 , 4 )                    ---------------高级戒指兑换券   获得机率5%
		GiveItem ( role , 0 , 3088 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000777 = GetResString("CALCULATE_ITEMEFFECT_LUA_000777")
		itemname = CALCULATE_ITEMEFFECT_LUA_000777	
	
	else   
		GiveItem ( role , 0 , 1012 , 1 , 4 )                   ---------------加纳之神  获得机率5%
		GiveItem ( role , 0 , 3088 , 1 , 4 ) 
		CALCULATE_ITEMEFFECT_LUA_000495 = GetResString("CALCULATE_ITEMEFFECT_LUA_000495")
		itemname = CALCULATE_ITEMEFFECT_LUA_000495
	end
	local cha_name = GetChaDefaultName ( role )
	CALCULATE_ITEMEFFECT_LUA_000778 = GetResString("CALCULATE_ITEMEFFECT_LUA_000778")
	CALCULATE_ITEMEFFECT_LUA_000349 = GetResString("CALCULATE_ITEMEFFECT_LUA_000349")
	Notice ( CALCULATE_ITEMEFFECT_LUA_000349 ..cha_name..CALCULATE_ITEMEFFECT_LUA_000778..itemname )
end
----5级以下可以使用的新手升级果
function ItemUse_Lv5_AddExp(role) 

	local cha_lv = Lv(role)
	if cha_lv > 5 then 
		CALCULATE_ITEMEFFECT_LUA_000779 = GetResString("CALCULATE_ITEMEFFECT_LUA_000779")
		SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_000779)
		UseItemFailed ( role )
		return LUA_FALSE
	else	
		--local exp_role=GetChaAttr (  role , ATTR_CEXP )----------当前经验	
		local cha_nlv = cha_lv+20
		local exp_add= GetExp[cha_nlv]-GetExp[cha_lv]			
			AddExp( role , npc , exp_add , exp_add)
		return LUA_TRUE	
	end
end
----50级以下可以使用的升级果
function ItemUse_Lv50_AddLv5(role) 

	local cha_lv = Lv(role)
	if cha_lv > 50 then 
		CALCULATE_ITEMEFFECT_LUA_000780 = GetResString("CALCULATE_ITEMEFFECT_LUA_000780")
		SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_000780)
		UseItemFailed ( role )
		return LUA_FALSE
	else	
		--local exp_role=GetChaAttr (  role , ATTR_CEXP )----------当前经验	
		local cha_nlv = cha_lv+5
		local exp_add= GetExp[cha_nlv]- GetExp[cha_lv]			
			AddExp( role , npc , exp_add , exp_add)		
	end
end
----100级以下可以使用的升级果
function ItemUse_Lv100_AddLv1(role) 

	local cha_lv = Lv(role)
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if cha_lv >= 100 then 
		CALCULATE_ITEMEFFECT_LUA_000781 = GetResString("CALCULATE_ITEMEFFECT_LUA_000781")
		SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_000781)
		UseItemFailed ( role )
		return LUA_FALSE
--	SystemNotice( role , Cha_Boat )
	elseif Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000023 = GetResString("CALCULATE_ITEMEFFECT_LUA_000023")
		SystemNotice(Cha_Boat,CALCULATE_ITEMEFFECT_LUA_000023)
		UseItemFailed ( role )
		return LUA_FALSE
	else	
		local exp_role=GetChaAttr (  role , ATTR_CEXP )----------当前经验
		-- if cha_lv >=1 and cha_lv <=79 then
		local cha_nlv = cha_lv+1
		local cha_n2lv= cha_nlv+1
		local lvNeedexp=GetExp[cha_nlv]-GetExp[cha_lv]
		local NlvNeedexp= GetExp[cha_n2lv]-GetExp[cha_nlv]
		local LvlessExp = exp_role-GetExp[cha_lv]
		local per= LvlessExp/lvNeedexp
		local NLvlessEXP=per*NlvNeedexp
		local ExpAfterAdd=NLvlessEXP+GetExp[cha_nlv]
		ExpAfterAdd=math.floor(ExpAfterAdd)
		SetChaAttr(role,ATTR_CEXP,ExpAfterAdd)
			-- local exp_add= GetExp[cha_nlv]-GetExp[cha_lv]
				-- SystemNotice(role,"exp_add="..exp_add)
			-- AddExp( role , npc , exp_add , exp_add)
		-- elseif	cha_lv >= 80 and cha_lv <= 89 then
			-- local cha_nlv = cha_lv+1
			-- local exp_add= (GetExp[cha_nlv]-GetExp[cha_lv])*50
				-- SystemNotice(role,"exp_add="..exp_add)
			-- AddExp( role , npc , exp_add , exp_add)			
		-- elseif 	cha_lv >= 90 and cha_lv <= 99 then
			-- local cha_nlv = cha_lv+1
			-- local exp_add= GetExp[cha_nlv]-GetExp[cha_lv]
				-- SystemNotice(role,"exp_add="..exp_add)
			-- AddExp( role , npc , exp_add , exp_add)
		-- end	
	end		
end
--精炼护佑石
function ItemUse_JLBYS ( role , Item )

	local statelv = 10
	local statetime = 60
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		AddState( role , role , STATE_JLBYS , statelv , statetime )
		CALCULATE_ITEMEFFECT_LUA_000782 = GetResString("CALCULATE_ITEMEFFECT_LUA_000782")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000782 )
				
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
end

--高级精炼护佑石
function ItemUse_GJJLHYS ( role , Item )
	local statelv = 11
	local statetime = 60
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		AddState( role , role , STATE_JLBYS , statelv , statetime )
		CALCULATE_ITEMEFFECT_LUA_000783 = GetResString("CALCULATE_ITEMEFFECT_LUA_000783")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000783 )
				
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
end
--合成护佑石

function ItemUse_HCBYS ( role , Item )

	local statelv = 11
	local statetime = 60
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		AddState( role , role , STATE_HCBYS , statelv , statetime )
		CALCULATE_ITEMEFFECT_LUA_000784 = GetResString("CALCULATE_ITEMEFFECT_LUA_000784")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000784 )		
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
end

--高级合成护佑石

function ItemUse_GJHCHYS ( role , Item )
	local statelv = 10
	local statetime = 60
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		AddState( role , role , STATE_HCBYS , statelv , statetime )
		CALCULATE_ITEMEFFECT_LUA_000785 = GetResString("CALCULATE_ITEMEFFECT_LUA_000785")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000785 )		
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
end

function ItemUse_HANBAO ( role , Item )  --[[汉堡公式]]--

	local hp = GetChaAttr(role, ATTR_HP) 
	--LG("药品使用", "当前hp = ", hp , "\n" ) 
	if hp <= 0 then 
		--LuaPrint("人物死后或非法hp值")  return 
		--LG("药品使用", "人物死后或非法hp值","\n" )  
	end 
	hp_resume = 235    
	hp = hp + hp_resume 
	mxhp = GetChaAttr(role,ATTR_MXHP) 
	if hp > mxhp then --加超过最大hp时返回为最大hp
		hp = mxhp 
		--LG("药品使用", "已达hp最大上限", "\n" ) 
	end 
		--LG("药品使用", "hp回复为", hp ,"\n" ) 
	SetCharaAttr(hp, role, ATTR_HP) 
	--LuaPrint("Out function hp_med_small( role )  --[[精灵果公式]]--") 
end 

----[[烤乳猪公式]]--————————————————————————————————————————————————————————————————————————————

function ItemUse_KAORUZHU ( role , Item )  --[[烤乳猪公式]]--
	local hp = GetChaAttr(role, ATTR_HP) 

	--LG("药品使用", "当前hp = ", hp , "\n" ) 
	if hp <= 0 then 
		--LuaPrint("人物死后或非法hp值")  return 
		--LG("药品使用", "人物死后或非法hp值","\n" )  
	end 
	hp_resume = 280    
	hp = hp + hp_resume 
	mxhp = GetChaAttr(role,ATTR_MXHP) 
	if hp > mxhp then				 --加超过最大hp时返回为最大hp
		hp = mxhp 
		--LG("药品使用", "已达hp最大上限", "\n" ) 
	end 
		--LG("药品使用", "hp回复为", hp ,"\n" ) 
	SetCharaAttr(hp, role, ATTR_HP) 
	--LuaPrint("Out function hp_med_small( role )  --[[精灵果公式]]--") 
end 
---------------------冬岛双剑武器宝箱
function ItemUse_DDWQSHUANG( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	local Cha_Boat = GetCtrlBoat ( role )
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000799 = GetResString("CALCULATE_ITEMEFFECT_LUA_000799")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000799)
		UseItemFailed ( role )
		return
	end
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 6136  , 1 , 4) 
end
---------------------冬岛巨剑武器宝箱
function ItemUse_DDWQNIU( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	local Cha_Boat = GetCtrlBoat ( role )
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000800 = GetResString("CALCULATE_ITEMEFFECT_LUA_000800")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000800)
		UseItemFailed ( role )
		return
	end
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 6141 , 1 , 4) 
end
---------------------冬岛狙击武器宝箱

function ItemUse_DDWQJU( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	local Cha_Boat = GetCtrlBoat ( role )
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000801 = GetResString("CALCULATE_ITEMEFFECT_LUA_000801")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000801)
		UseItemFailed ( role )
		return
	end
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 6138 , 1 , 4) 
end

---------------------冬岛航海武器宝箱
function ItemUse_DDWQHANG( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	local Cha_Boat = GetCtrlBoat ( role )
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000802 = GetResString("CALCULATE_ITEMEFFECT_LUA_000802")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000802)
		UseItemFailed ( role )
		return
	end
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 6140 , 1 , 4) 
end
---------------------冬岛封印武器宝箱
function ItemUse_DDWQFENG( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	local Cha_Boat = GetCtrlBoat ( role )
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000803 = GetResString("CALCULATE_ITEMEFFECT_LUA_000803")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000803)
		UseItemFailed ( role )
		return
	end
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 6142 , 1 , 4) 
end
---------------------冬岛圣职武器宝箱
function ItemUse_DDWQSHENG( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	local Cha_Boat = GetCtrlBoat ( role )
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000804 = GetResString("CALCULATE_ITEMEFFECT_LUA_000804")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000804)
		UseItemFailed ( role )
		return
	end
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 6143 , 1 , 4) 
end

----银翼航空公司冬岛机票--------------------------------------------------------------------------------------------------------------------------------
function ItemUse_DDJP(role, Item )

	local i = CheckBagItem(role,6205)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )
	if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	-- local Ishave = HasRecord( role , 1636 )
		-- if Ishave == 0 then
		-- SystemNotice ( role , "你需要完成进入冬岛的前置才能使用机票" )
		-- UseItemFailed ( role )
		-- return
	-- end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,6205,1)
			if j == 1 then
				BIRTH_BIRTH_CONF_LUA_000053 = GetResString("BIRTH_BIRTH_CONF_LUA_000053")
				MoveCity(role,BIRTH_BIRTH_CONF_LUA_000053)
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

--神之英勇宝箱————————————————————————————————————————————————————————————————
function ItemUse_SZYINGYONG ( role , Item )

	local Cha_Boat = GetCtrlBoat ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000805 = GetResString("CALCULATE_ITEMEFFECT_LUA_000805")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000805)
		UseItemFailed ( role )
		return
	end
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local job = GetChaAttr(role, ATTR_JOB)
	if job~= 12 then
		CALCULATE_ITEMEFFECT_LUA_000806 = GetResString("CALCULATE_ITEMEFFECT_LUA_000806")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000806 )
		UseItemFailed ( role )
		return
	end 
	local i=math.random(1,100)
	if i<=25 then
		GiveItem ( role , 0 , 6173 , 1 , 4)
		return
 	elseif i<=50 then
		GiveItem ( role , 0 , 6174 , 1 , 4)
		return
 	elseif i<=75 then
		GiveItem ( role , 0 , 6175 , 1 , 4)
		return
	elseif i<=100 then
		GiveItem ( role , 0 , 6176 , 1 , 4)
		return
	end
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000807 = GetResString("CALCULATE_ITEMEFFECT_LUA_000807")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000807..itemname  
	Notice ( message )
end
--神之荣誉宝箱————————————————————————————————————————————————————————————————
function ItemUse_SZRONGYU ( role , Item )

	local Cha_Boat = GetCtrlBoat ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000808 = GetResString("CALCULATE_ITEMEFFECT_LUA_000808")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000808)
		UseItemFailed ( role )
		return
	end
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local job = GetChaAttr(role, ATTR_JOB)
	if job~= 9 then
		CALCULATE_ITEMEFFECT_LUA_000809 = GetResString("CALCULATE_ITEMEFFECT_LUA_000809")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000809 )
		UseItemFailed ( role )
		return
	end
	local i=math.random(1,100)
	if i<=25 then
		GiveItem ( role , 0 , 6177 , 1 , 4)
		return
 	elseif i<=50 then
		GiveItem ( role , 0 , 6178 , 1 , 4)
		return
 	elseif i<=75 then
		GiveItem ( role , 0 , 6179 , 1 , 4)
		return
	elseif i<=100 then
		GiveItem ( role , 0 , 6180 , 1 , 4)
		return
	end
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000810 = GetResString("CALCULATE_ITEMEFFECT_LUA_000810")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000810..itemname  
	Notice ( message )
end
--神之牺牲宝箱————————————————————————————————————————————————————————————————
function ItemUse_SZXISHENG ( role , Item )

	local Cha_Boat = GetCtrlBoat ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000811 = GetResString("CALCULATE_ITEMEFFECT_LUA_000811")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000811)
		UseItemFailed ( role )
		return
	end
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local job = GetChaAttr(role, ATTR_JOB)
	if job~= 8 then
		CALCULATE_ITEMEFFECT_LUA_000812 = GetResString("CALCULATE_ITEMEFFECT_LUA_000812")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000812 )
		UseItemFailed ( role )
		return
	end
	local i=math.random(1,100)
	if i<=25 then
		GiveItem ( role , 0 , 6181 , 1 , 4)
		return
 	elseif i<=50 then
		GiveItem ( role , 0 , 6182 , 1 , 4)
		return
 	elseif i<=75 then
		GiveItem ( role , 0 , 6183 , 1 , 4)
		return
	elseif i<=100 then
		GiveItem ( role , 0 , 6184 , 1 , 4)
		return
	end
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000813 = GetResString("CALCULATE_ITEMEFFECT_LUA_000813")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000813..itemname  
	Notice ( message )
end
--神之公正宝箱————————————————————————————————————————————————————————————————
function ItemUse_SZGONGZHENG ( role , Item )

	local job = GetChaAttr(role, ATTR_JOB)
	if job~= 16 then
		CALCULATE_ITEMEFFECT_LUA_000814 = GetResString("CALCULATE_ITEMEFFECT_LUA_000814")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000814 )
		UseItemFailed ( role )
		return
	end
	local Cha_Boat = GetCtrlBoat ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000815 = GetResString("CALCULATE_ITEMEFFECT_LUA_000815")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000815)
		UseItemFailed ( role )
		return
	end
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local i=math.random(1,100)
	if i<=25 then
		GiveItem ( role , 0 , 6185 , 1 , 4)
		return
 	elseif i<=50 then
		GiveItem ( role , 0 , 6186 , 1 , 4)
		return
 	elseif i<=75 then
		GiveItem ( role , 0 , 6187 , 1 , 4)
		return
	elseif i<=100 then
		GiveItem ( role , 0 , 6188 , 1 , 4)
		return
	end
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000816 = GetResString("CALCULATE_ITEMEFFECT_LUA_000816")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000816..itemname  
	Notice ( message )
end
--神之怜悯宝箱————————————————————————————————————————————————————————————————
function ItemUse_SZLIANMING ( role , Item )

	local job = GetChaAttr(role, ATTR_JOB)
	if job~= 13 then
		CALCULATE_ITEMEFFECT_LUA_000817 = GetResString("CALCULATE_ITEMEFFECT_LUA_000817")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000817 )
		UseItemFailed ( role )
		return
	end
	local Cha_Boat = GetCtrlBoat ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000818 = GetResString("CALCULATE_ITEMEFFECT_LUA_000818")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000818)
		UseItemFailed ( role )
		return
	end
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local i=math.random(1,100)
	if i<=25 then
		GiveItem ( role , 0 , 6189 , 1 , 4)
		return
 	elseif i<=50 then
		GiveItem ( role , 0 , 6190 , 1 , 4)
		return
 	elseif i<=75 then
		GiveItem ( role , 0 , 6191 , 1 , 4)
		return
	elseif i<=100 then
		GiveItem ( role , 0 , 6192 , 1 , 4)
		return
	end
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000819 = GetResString("CALCULATE_ITEMEFFECT_LUA_000819")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000819..itemname  
	Notice ( message )
end
--神之精神宝箱————————————————————————————————————————————————————————————————
function ItemUse_SZJINGSHENG ( role , Item )

	local job = GetChaAttr(role, ATTR_JOB)
	if job~= 14 then
		CALCULATE_ITEMEFFECT_LUA_000820 = GetResString("CALCULATE_ITEMEFFECT_LUA_000820")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000820 )
		UseItemFailed ( role )
		return
	end
	local Cha_Boat = GetCtrlBoat ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000821 = GetResString("CALCULATE_ITEMEFFECT_LUA_000821")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000821)
		UseItemFailed ( role )
		return
	end
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local i=math.random(1,100)
	if i<=25 then
		GiveItem ( role , 0 , 6193 , 1 , 4)
		return
 	elseif i<=50 then
		GiveItem ( role , 0 , 6194 , 1 , 4)
		return
 	elseif i<=75 then
		GiveItem ( role , 0 , 6195 , 1 , 4)
		return
	elseif i<=100 then
		GiveItem ( role , 0 , 6196 , 1 , 4)
		return
	end
	local itemname = GetItemName ( ItemId ) 
	local cha_name = GetChaDefaultName ( role ) 
	CALCULATE_ITEMEFFECT_LUA_000822 = GetResString("CALCULATE_ITEMEFFECT_LUA_000822")
	local message = cha_name..CALCULATE_ITEMEFFECT_LUA_000822..itemname  
	Notice ( message )
end
----------------------------[[上古卷轴]]--
function ItemUse_SGJZ ( role , Item )  

	local el_exp = GetChaAttr(role, ATTR_CEXP)
	local exp1=el_exp
	local charLv=Lv ( role )
	local exp_resume = 2000000
	el_exp = el_exp + exp_resume
	if charLv>=100 then	
		el_exp = exp1 + exp_resume
	else
		CALCULATE_ITEMEFFECT_LUA_000823 = GetResString("CALCULATE_ITEMEFFECT_LUA_000823")
		SystemNotice (role , CALCULATE_ITEMEFFECT_LUA_000823)
		UseItemFailed(role)
		return
	end
	SetCharaAttr(el_exp, role, ATTR_CEXP) 
end 

------------------------------------------------------------随从召唤券兑换宝箱
function ItemUse_CWKPDHBX ( role )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000409 = GetResString("CALCULATE_ITEMEFFECT_LUA_000409")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000409)
		UseItemFailed ( role )
		return
	end

	local cha_name = GetChaDefaultName ( role ) 
	local star=math.random ( 1, 100 )
	--SystemNotice(role ,"star=="..star)
		if star<=10 then
			GiveItem ( role , 0 , 6295  , 1 , 4  )
			CALCULATE_ITEMEFFECT_LUA_000824 = GetResString("CALCULATE_ITEMEFFECT_LUA_000824")
			local message1 = cha_name..CALCULATE_ITEMEFFECT_LUA_000824 
			Notice ( message1 )
		elseif star>=10 and star<=20 then
			GiveItem ( role , 0 , 6296  , 1 , 4  )
			CALCULATE_ITEMEFFECT_LUA_000825 = GetResString("CALCULATE_ITEMEFFECT_LUA_000825")
			local message2 = cha_name..CALCULATE_ITEMEFFECT_LUA_000825 
			Notice ( message2 )
		elseif star>=21 and star<=30 then
			GiveItem ( role , 0 , 6297  , 1 , 4  )
			CALCULATE_ITEMEFFECT_LUA_000826 = GetResString("CALCULATE_ITEMEFFECT_LUA_000826")
			local message3 = cha_name..CALCULATE_ITEMEFFECT_LUA_000826 
			Notice ( message3 )
		elseif star>=31 and star<=40 then
			GiveItem ( role , 0 , 6298  , 1 , 4  )
			CALCULATE_ITEMEFFECT_LUA_000827 = GetResString("CALCULATE_ITEMEFFECT_LUA_000827")
			local message4 = cha_name..CALCULATE_ITEMEFFECT_LUA_000827 
			Notice ( message4 )
		elseif star>=41 and star<=50 then
			GiveItem ( role , 0 , 6299  , 1 , 4  )
			CALCULATE_ITEMEFFECT_LUA_000828 = GetResString("CALCULATE_ITEMEFFECT_LUA_000828")
			local message5 = cha_name..CALCULATE_ITEMEFFECT_LUA_000828 
			Notice ( message5 )
		elseif star>=51 and star<=60 then
			GiveItem ( role , 0 , 6300  , 1 , 4  )
			CALCULATE_ITEMEFFECT_LUA_000829 = GetResString("CALCULATE_ITEMEFFECT_LUA_000829")
			local message6 = cha_name..CALCULATE_ITEMEFFECT_LUA_000829 
			Notice ( message6 )
		elseif star>=61 and star<=70 then
			GiveItem ( role , 0 , 6301  , 1 , 4  )
			CALCULATE_ITEMEFFECT_LUA_000830 = GetResString("CALCULATE_ITEMEFFECT_LUA_000830")
			local message7 = cha_name..CALCULATE_ITEMEFFECT_LUA_000830 
			Notice ( message7 )
		elseif star>=71 and star<=80 then
			GiveItem ( role , 0 , 6302  , 1 , 4  )
			CALCULATE_ITEMEFFECT_LUA_000831 = GetResString("CALCULATE_ITEMEFFECT_LUA_000831")
			local message8 = cha_name..CALCULATE_ITEMEFFECT_LUA_000831 
			Notice ( message8 )
		elseif star>=81 and star<=90 then
			GiveItem ( role , 0 , 6303  , 1 , 4  )
			CALCULATE_ITEMEFFECT_LUA_000832 = GetResString("CALCULATE_ITEMEFFECT_LUA_000832")
			local message9 = cha_name..CALCULATE_ITEMEFFECT_LUA_000832 
			Notice ( message9 )
		elseif star>=91 and star<=100 then
			GiveItem ( role , 0 , 6304  , 1 , 4  )
			CALCULATE_ITEMEFFECT_LUA_000833 = GetResString("CALCULATE_ITEMEFFECT_LUA_000833")
			local message10 = cha_name..CALCULATE_ITEMEFFECT_LUA_000833 
			Notice ( message10 )

		end	
end

---------------------------------艾米新娘召唤券--双击召唤艾米新娘
function ItemUse_AMXN ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000256 = GetResString("CALCULATE_ITEMEFFECT_LUA_000256")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000256 )
		UseItemFailed ( role )
		return
	end
	local pet_num = GetPetNum(role)
	if pet_num >= 2 then
		CALCULATE_ITEMEFFECT_LUA_000834 = GetResString("CALCULATE_ITEMEFFECT_LUA_000834")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000834 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	x_resume = 5
	y_resume = 5
	x = x + x_resume
	y = y + y_resume
	local MonsterID = 1126     -------------------艾米新娘 1126
	local Refresh = 3600					--重生时间，秒单位
	local life = 3600000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaHost(new,role)
	SetChaLifeTime( new, life )
	SetChaTarget(new, role)
	PlayEffect( new, 361 )
end

---------------------------------可爱罗莉召唤券--双击召唤可爱罗莉
function ItemUse_AMKALL ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000256 = GetResString("CALCULATE_ITEMEFFECT_LUA_000256")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000256 )
		UseItemFailed ( role )
		return
	end
	local pet_num = GetPetNum(role)
	if pet_num >= 2 then
		CALCULATE_ITEMEFFECT_LUA_000834 = GetResString("CALCULATE_ITEMEFFECT_LUA_000834")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000834 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	x_resume = 5
	y_resume = 5
	x = x + x_resume
	y = y + y_resume
	local MonsterID = 1127     -------------------可爱罗莉 1127
	local Refresh = 3600					--重生时间，秒单位
	local life = 3600000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaHost(new,role)
	SetChaLifeTime( new, life )
	SetChaTarget(new, role)
	PlayEffect( new, 361 )
end

---------------------------------年兽小妹召唤券--双击召唤年兽小妹
function ItemUse_AMNSXM ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000256 = GetResString("CALCULATE_ITEMEFFECT_LUA_000256")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000256 )
		UseItemFailed ( role )
		return
	end
	local pet_num = GetPetNum(role)
	if pet_num >= 2 then
		CALCULATE_ITEMEFFECT_LUA_000834 = GetResString("CALCULATE_ITEMEFFECT_LUA_000834")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000834 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	x_resume = 5
	y_resume = 5
	x = x + x_resume
	y = y + y_resume
	local MonsterID = 1128     -------------------年兽小妹 1128
	local Refresh = 3600					--重生时间，秒单位
	local life = 3600000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaHost(new,role)
	SetChaLifeTime( new, life )
	SetChaTarget(new, role)
	PlayEffect( new, 361 )
end

---------------------------------冷月女皇召唤券--双击召唤冷月女皇
function ItemUse_FLELYNH ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000256 = GetResString("CALCULATE_ITEMEFFECT_LUA_000256")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000256 )
		UseItemFailed ( role )
		return
	end
	local pet_num = GetPetNum(role)
	if pet_num >= 2 then
		CALCULATE_ITEMEFFECT_LUA_000834 = GetResString("CALCULATE_ITEMEFFECT_LUA_000834")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000834 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	x_resume = 5
	y_resume = 5
	x = x + x_resume
	y = y + y_resume
	local MonsterID = 1129     -------------------冷月女皇 1129
	local Refresh = 3600					--重生时间，秒单位
	local life = 3600000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaHost(new,role)
	SetChaLifeTime( new, life )
	SetChaTarget(new, role)
	PlayEffect( new, 361 )
end

---------------------------------菲利尔新娘召唤券--双击召唤菲利尔新娘
function ItemUse_FLEXN ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000256 = GetResString("CALCULATE_ITEMEFFECT_LUA_000256")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000256 )
		UseItemFailed ( role )
		return
	end
	local pet_num = GetPetNum(role)
	if pet_num >= 2 then
		CALCULATE_ITEMEFFECT_LUA_000834 = GetResString("CALCULATE_ITEMEFFECT_LUA_000834")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000834 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	x_resume = 5
	y_resume = 5
	x = x + x_resume
	y = y + y_resume
	local MonsterID = 1130     -------------------菲利尔新娘 1130
	local Refresh = 3600					--重生时间，秒单位
	local life = 3600000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaHost(new,role)
	SetChaLifeTime( new, life )
	SetChaTarget(new, role)
	PlayEffect( new, 361 )
end

---------------------------------皇家少校召唤券--双击召唤皇家少校
function ItemUse_FLEHJSX ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000256 = GetResString("CALCULATE_ITEMEFFECT_LUA_000256")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000256 )
		UseItemFailed ( role )
		return
	end
	local pet_num = GetPetNum(role)
	if pet_num >= 2 then
		CALCULATE_ITEMEFFECT_LUA_000834 = GetResString("CALCULATE_ITEMEFFECT_LUA_000834")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000834 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	x_resume = 5
	y_resume = 5
	x = x + x_resume
	y = y + y_resume
	local MonsterID = 1131     -------------------皇家少校 1131
	local Refresh = 3600					--重生时间，秒单位
	local life = 3600000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaHost(new,role)
	SetChaLifeTime( new, life )
	SetChaTarget(new, role)
	PlayEffect( new, 361 )
end

---------------------------------不哭死神召唤券--双击召唤不哭死神
function ItemUse_LQBKSS ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000256 = GetResString("CALCULATE_ITEMEFFECT_LUA_000256")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000256 )
		UseItemFailed ( role )
		return
	end
	local pet_num = GetPetNum(role)
	if pet_num >= 2 then
		CALCULATE_ITEMEFFECT_LUA_000834 = GetResString("CALCULATE_ITEMEFFECT_LUA_000834")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000834 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	x_resume = 5
	y_resume = 5
	x = x + x_resume
	y = y + y_resume
	local MonsterID = 1132     -------------------不哭死神 1132
	local Refresh = 3600					--重生时间，秒单位
	local life = 3600000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaHost(new,role)
	SetChaLifeTime( new, life )
	SetChaTarget(new, role)
	PlayEffect( new, 361 )
end

---------------------------------骇客战士召唤券--双击召唤金牛战士
function ItemUse_KXSHKZS ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000256 = GetResString("CALCULATE_ITEMEFFECT_LUA_000256")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000256 )
		UseItemFailed ( role )
		return
	end
	local pet_num = GetPetNum(role)
	if pet_num >= 2 then
		CALCULATE_ITEMEFFECT_LUA_000834 = GetResString("CALCULATE_ITEMEFFECT_LUA_000834")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000834 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	x_resume = 5
	y_resume = 5
	x = x + x_resume
	y = y + y_resume
	local MonsterID = 1133     -------------------骇客战士 1133
	local Refresh = 3600					--重生时间，秒单位
	local life = 3600000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaHost(new,role)
	SetChaLifeTime( new, life )
	SetChaTarget(new, role)
	PlayEffect( new, 361 )
end

---------------------------------射水贝王召唤券--双击召唤射水贝王
function ItemUse_CWSSBW ( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000256 = GetResString("CALCULATE_ITEMEFFECT_LUA_000256")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000256 )
		UseItemFailed ( role )
		return
	end
	local pet_num = GetPetNum(role)
	if pet_num >= 2 then
		CALCULATE_ITEMEFFECT_LUA_000834 = GetResString("CALCULATE_ITEMEFFECT_LUA_000834")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000834 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	x_resume = 5
	y_resume = 5
	x = x + x_resume
	y = y + y_resume
	local MonsterID = 1134     -------------------射水贝王 1134
	local Refresh = 3600					--重生时间，秒单位
	local life = 3600000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaHost(new,role)
	SetChaLifeTime( new, life )
	SetChaTarget(new, role)
	PlayEffect( new, 361 )
end

---------------------------------蔻蔻召唤券--双击召唤蔻蔻
function ItemUse_CWKK( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000256 = GetResString("CALCULATE_ITEMEFFECT_LUA_000256")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000256 )
		UseItemFailed ( role )
		return
	end
	local pet_num = GetPetNum(role)
	if pet_num >= 2 then
		CALCULATE_ITEMEFFECT_LUA_000834 = GetResString("CALCULATE_ITEMEFFECT_LUA_000834")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000834 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	x_resume = 5
	y_resume = 5
	x = x + x_resume
	y = y + y_resume
	local MonsterID = 1135     -------------------蔻蔻 1135
	local Refresh = 3600					--重生时间，秒单位
	local life = 3600000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaHost(new,role)
	SetChaLifeTime( new, life )
	SetChaTarget(new, role)
	PlayEffect( new, 361 )
end

---------------------------------黑龙宝宝召唤券--双击召唤黑龙宝宝
function ItemUse_CWHLBB( role , Item  )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000256 = GetResString("CALCULATE_ITEMEFFECT_LUA_000256")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000256 )
		UseItemFailed ( role )
		return
	end
	local pet_num = GetPetNum(role)
	if pet_num >= 2 then
		CALCULATE_ITEMEFFECT_LUA_000834 = GetResString("CALCULATE_ITEMEFFECT_LUA_000834")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000834 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	x_resume = 5
	y_resume = 5
	x = x + x_resume
	y = y + y_resume
	local MonsterID = 1136     -------------------黑龙宝宝 1136
	local Refresh = 3600					--重生时间，秒单位
	local life = 3600000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaHost(new,role)
	SetChaLifeTime( new, life )
	SetChaTarget(new, role)
	PlayEffect( new, 361 )
end




--0902新版挖宝


--盗宝贼击杀令的使用以及刷出怪物的分布（by 刘博颋）
function ItemUse_WaBao_DBZJSL ( role , Item )
	
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local name = GetChaDefaultName ( role )
	local Lv = Lv( role )
	local Item = GetChaItem2 ( role , 2 , 6341 )						-------------------这个接口是取角色背包里某种ID的道具指针，前提是这个道具在背包里只有一个
	local Item_MAXURE = GetItemAttr ( Item , ITEMATTR_MAXURE )
	local Item_URE = GetItemAttr ( Item , ITEMATTR_URE )
	local Item_MAXENERGY = GetItemAttr ( Item , ITEMATTR_MAXENERGY )
	local pos_x = Item_MAXURE									-------------------最大耐久，记录x坐标
	local pos_y = Item_MAXENERGY								-------------------最大能量，记录y坐标
	local Themap = Item_URE
	--按照玩家等级随机分配怪物的坐标
	local MapList = { }
	
	MapList [0] = "NoMap"
	MapList [1] = "garner"
	MapList [2] = "magicsea"
	MapList [3] = "darkblue"

	local MapNameList = { }
	
	CALCULATE_ITEMEFFECT_LUA_000062 = GetResString("CALCULATE_ITEMEFFECT_LUA_000062")
	MapNameList [0] = CALCULATE_ITEMEFFECT_LUA_000062
	CALCULATE_ITEMEFFECT_LUA_000063 = GetResString("CALCULATE_ITEMEFFECT_LUA_000063")
	MapNameList [1] = CALCULATE_ITEMEFFECT_LUA_000063
	CALCULATE_ITEMEFFECT_LUA_000064 = GetResString("CALCULATE_ITEMEFFECT_LUA_000064")
	MapNameList [2] = CALCULATE_ITEMEFFECT_LUA_000064
	CALCULATE_ITEMEFFECT_LUA_000065 = GetResString("CALCULATE_ITEMEFFECT_LUA_000065")
	MapNameList [3] = CALCULATE_ITEMEFFECT_LUA_000065
	if pos_x == 0 or pos_y == 0 or Themap == 0 then
		UseItemNoHint ( role )
		if  Lv <= 40 then 			
			CALCULATE_ITEMEFFECT_LUA_000835 = GetResString("CALCULATE_ITEMEFFECT_LUA_000835")
			SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000835 )
			return
			
		elseif Lv > 40 and Lv < 45 then			
			local pos_x , pos_y , Themap = GetTheMapPos_40 ( role , 1 )		
			local Item_MAXURE = pos_x
			local Item_URE = Themap									---------------------当前耐久为0~3，通过MapList[Themap]来变相记录是哪张地图
			local Item_MAXENERGY = pos_y
			CALCULATE_ITEMEFFECT_LUA_000836 = GetResString("CALCULATE_ITEMEFFECT_LUA_000836")
			CALCULATE_ITEMEFFECT_LUA_000067 = GetResString("CALCULATE_ITEMEFFECT_LUA_000067")
			CALCULATE_ITEMEFFECT_LUA_000837 = GetResString("CALCULATE_ITEMEFFECT_LUA_000837")
			SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000837..MapNameList[Themap]..CALCULATE_ITEMEFFECT_LUA_000067..pos_x..","..pos_y..CALCULATE_ITEMEFFECT_LUA_000836 )
			SetItemAttr ( Item , ITEMATTR_MAXENERGY , Item_MAXENERGY )
			SetItemAttr ( Item , ITEMATTR_MAXURE , Item_MAXURE )
			SetItemAttr ( Item , ITEMATTR_URE , Item_URE )			
			return
			
		elseif Lv >= 45 and Lv < 50 then			
			pos_x , pos_y , Themap = GetTheMapPos_45 ( role , 1 )		
			Item_MAXURE = pos_x
			Item_URE = Themap									---------------------当前耐久为0~3，通过MapList[Themap]来变相记录是哪张地图
			Item_MAXENERGY = pos_y
			CALCULATE_ITEMEFFECT_LUA_000836 = GetResString("CALCULATE_ITEMEFFECT_LUA_000836")
			CALCULATE_ITEMEFFECT_LUA_000067 = GetResString("CALCULATE_ITEMEFFECT_LUA_000067")
			CALCULATE_ITEMEFFECT_LUA_000837 = GetResString("CALCULATE_ITEMEFFECT_LUA_000837")
			SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000837..MapNameList[Themap]..CALCULATE_ITEMEFFECT_LUA_000067..pos_x..","..pos_y..CALCULATE_ITEMEFFECT_LUA_000836 )
			SetItemAttr ( Item , ITEMATTR_MAXENERGY , Item_MAXENERGY )
			SetItemAttr ( Item , ITEMATTR_MAXURE , Item_MAXURE )
			SetItemAttr ( Item , ITEMATTR_URE , Item_URE )			
			return	
			
		elseif Lv >= 50 and Lv < 55 then			
			pos_x , pos_y , Themap = GetTheMapPos_50 ( role , 1 )		
			Item_MAXURE = pos_x
			Item_URE = Themap									---------------------当前耐久为0~3，通过MapList[Themap]来变相记录是哪张地图
			Item_MAXENERGY = pos_y
			CALCULATE_ITEMEFFECT_LUA_000836 = GetResString("CALCULATE_ITEMEFFECT_LUA_000836")
			CALCULATE_ITEMEFFECT_LUA_000067 = GetResString("CALCULATE_ITEMEFFECT_LUA_000067")
			CALCULATE_ITEMEFFECT_LUA_000837 = GetResString("CALCULATE_ITEMEFFECT_LUA_000837")
			SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000837..MapNameList[Themap]..CALCULATE_ITEMEFFECT_LUA_000067..pos_x..","..pos_y..CALCULATE_ITEMEFFECT_LUA_000836 )
			SetItemAttr ( Item , ITEMATTR_MAXENERGY , Item_MAXENERGY )
			SetItemAttr ( Item , ITEMATTR_MAXURE , Item_MAXURE )
			SetItemAttr ( Item , ITEMATTR_URE , Item_URE )			
			return
			
		elseif Lv >= 55 and Lv < 60 then			
			pos_x , pos_y , Themap = GetTheMapPos_55 ( role , 1 )		
			Item_MAXURE = pos_x
			Item_URE = Themap									---------------------当前耐久为0~3，通过MapList[Themap]来变相记录是哪张地图
			Item_MAXENERGY = pos_y
			CALCULATE_ITEMEFFECT_LUA_000836 = GetResString("CALCULATE_ITEMEFFECT_LUA_000836")
			CALCULATE_ITEMEFFECT_LUA_000067 = GetResString("CALCULATE_ITEMEFFECT_LUA_000067")
			CALCULATE_ITEMEFFECT_LUA_000837 = GetResString("CALCULATE_ITEMEFFECT_LUA_000837")
			SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000837..MapNameList[Themap]..CALCULATE_ITEMEFFECT_LUA_000067..pos_x..","..pos_y..CALCULATE_ITEMEFFECT_LUA_000836 )
			SetItemAttr ( Item , ITEMATTR_MAXENERGY , Item_MAXENERGY )
			SetItemAttr ( Item , ITEMATTR_MAXURE , Item_MAXURE )
			SetItemAttr ( Item , ITEMATTR_URE , Item_URE )
			return
			
		elseif Lv >= 60 and Lv < 65 then			
			pos_x , pos_y , Themap = GetTheMapPos_60 ( role , 1 )		
			Item_MAXURE = pos_x
			Item_URE = Themap									---------------------当前耐久为0~3，通过MapList[Themap]来变相记录是哪张地图
			Item_MAXENERGY = pos_y
			CALCULATE_ITEMEFFECT_LUA_000836 = GetResString("CALCULATE_ITEMEFFECT_LUA_000836")
			CALCULATE_ITEMEFFECT_LUA_000067 = GetResString("CALCULATE_ITEMEFFECT_LUA_000067")
			CALCULATE_ITEMEFFECT_LUA_000837 = GetResString("CALCULATE_ITEMEFFECT_LUA_000837")
			SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000837..MapNameList[Themap]..CALCULATE_ITEMEFFECT_LUA_000067..pos_x..","..pos_y..CALCULATE_ITEMEFFECT_LUA_000836 )
			SetItemAttr ( Item , ITEMATTR_MAXENERGY , Item_MAXENERGY )
			SetItemAttr ( Item , ITEMATTR_MAXURE , Item_MAXURE )
			SetItemAttr ( Item , ITEMATTR_URE , Item_URE )
			return	
			
		elseif Lv >= 65 and Lv < 70 then			
			pos_x , pos_y , Themap = GetTheMapPos_65 ( role , 1 )		
			Item_MAXURE = pos_x
			Item_URE = Themap									---------------------当前耐久为0~3，通过MapList[Themap]来变相记录是哪张地图
			Item_MAXENERGY = pos_y
			CALCULATE_ITEMEFFECT_LUA_000836 = GetResString("CALCULATE_ITEMEFFECT_LUA_000836")
			CALCULATE_ITEMEFFECT_LUA_000067 = GetResString("CALCULATE_ITEMEFFECT_LUA_000067")
			CALCULATE_ITEMEFFECT_LUA_000837 = GetResString("CALCULATE_ITEMEFFECT_LUA_000837")
			SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000837..MapNameList[Themap]..CALCULATE_ITEMEFFECT_LUA_000067..pos_x..","..pos_y..CALCULATE_ITEMEFFECT_LUA_000836 )
			SetItemAttr ( Item , ITEMATTR_MAXENERGY , Item_MAXENERGY )
			SetItemAttr ( Item , ITEMATTR_MAXURE , Item_MAXURE )
			SetItemAttr ( Item , ITEMATTR_URE , Item_URE )
			return
		
		elseif Lv >= 70  then			
			pos_x , pos_y , Themap = GetTheMapPos_70 ( role , 1 )		
			Item_MAXURE = pos_x
			Item_URE = Themap									---------------------当前耐久为0~3，通过MapList[Themap]来变相记录是哪张地图
			Item_MAXENERGY = pos_y
			CALCULATE_ITEMEFFECT_LUA_000836 = GetResString("CALCULATE_ITEMEFFECT_LUA_000836")
			CALCULATE_ITEMEFFECT_LUA_000067 = GetResString("CALCULATE_ITEMEFFECT_LUA_000067")
			CALCULATE_ITEMEFFECT_LUA_000837 = GetResString("CALCULATE_ITEMEFFECT_LUA_000837")
			SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000837..MapNameList[Themap]..CALCULATE_ITEMEFFECT_LUA_000067..pos_x..","..pos_y..CALCULATE_ITEMEFFECT_LUA_000836 )
			SetItemAttr ( Item , ITEMATTR_MAXENERGY , Item_MAXENERGY )
			SetItemAttr ( Item , ITEMATTR_MAXURE , Item_MAXURE )
			SetItemAttr ( Item , ITEMATTR_URE , Item_URE )
		    return
		end	
	end
	local GetPos = CheckGetMapPos ( role , pos_x , pos_y , MapList[Themap] )
	if GetPos == 0 then
		CALCULATE_ITEMEFFECT_LUA_000836 = GetResString("CALCULATE_ITEMEFFECT_LUA_000836")
		CALCULATE_ITEMEFFECT_LUA_000067 = GetResString("CALCULATE_ITEMEFFECT_LUA_000067")
		CALCULATE_ITEMEFFECT_LUA_000837 = GetResString("CALCULATE_ITEMEFFECT_LUA_000837")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000837..MapNameList[Themap]..CALCULATE_ITEMEFFECT_LUA_000067..pos_x..","..pos_y..CALCULATE_ITEMEFFECT_LUA_000836 )
		UseItemNoHint ( role )
		return
	elseif GetPos == 1 then
		local x, y = GetChaPos(role)
		local Refresh = 6000000					--重生时间，秒单位
		local life = 5900000000					--生命时间，毫秒单位
		if Lv > 40 and Lv <= 45 then
			local MonsterID = 1144      --40级盗宝怪ID
			local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
			--SetChaHost(new,role)
			SetChaLifeTime( new, life )
			--SetChaTarget(new, role)
			CALCULATE_ITEMEFFECT_LUA_000838 = GetResString("CALCULATE_ITEMEFFECT_LUA_000838")
			SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000838)
			return
		elseif Lv > 45 and Lv <= 50 then
			local MonsterID = 1145      --45级盗宝怪ID
			local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
			--SetChaHost(new,role)
			SetChaLifeTime( new, life )
			--SetChaTarget(new, role)
			CALCULATE_ITEMEFFECT_LUA_000838 = GetResString("CALCULATE_ITEMEFFECT_LUA_000838")
			SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000838)
			return
		elseif Lv > 50 and Lv <= 55 then
			local MonsterID = 1146		--50级盗宝怪ID
			local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
			--SetChaHost(new,role)
			SetChaLifeTime( new, life )
			--SetChaTarget(new, role)
			CALCULATE_ITEMEFFECT_LUA_000838 = GetResString("CALCULATE_ITEMEFFECT_LUA_000838")
			SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000838)
			return
		elseif Lv > 55 and Lv <= 60 then
			local MonsterID = 1147		--55级盗宝怪ID
			local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
			--SetChaHost(new,role)
			SetChaLifeTime( new, life )
			--SetChaTarget(new, role)
			CALCULATE_ITEMEFFECT_LUA_000838 = GetResString("CALCULATE_ITEMEFFECT_LUA_000838")
			SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000838)
			return	
		elseif Lv > 60 and Lv <= 65 then
			local MonsterID = 1148		--60级盗宝怪ID
			local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
			--SetChaHost(new,role)
			SetChaLifeTime( new, life )
			--SetChaTarget(new, role)
			CALCULATE_ITEMEFFECT_LUA_000838 = GetResString("CALCULATE_ITEMEFFECT_LUA_000838")
			SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000838)
			return
		elseif Lv > 65 and Lv <= 70 then
			local MonsterID = 1149		--65级盗宝怪ID
			local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
			--SetChaHost(new,role)
			SetChaLifeTime( new, life )
			--SetChaTarget(new, role)
			CALCULATE_ITEMEFFECT_LUA_000838 = GetResString("CALCULATE_ITEMEFFECT_LUA_000838")
			SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000838)
			return
		-- elseif Lv > 70 and Lv <= 75 then
			-- local MonsterID = 1151		--70级盗宝怪ID
			-- local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
			--SetChaHost(new,role)
			-- SetChaLifeTime( new, life )
			--SetChaTarget(new, role)
			-- SystemNotice(role , "使用道具成功，盗宝贼现身了。")
			-- return	
		else
			local MonsterID = 1150		--70级盗宝怪ID
			local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
			--SetChaHost(new,role)
			SetChaLifeTime( new, life )
			--SetChaTarget(new, role)
			CALCULATE_ITEMEFFECT_LUA_000838 = GetResString("CALCULATE_ITEMEFFECT_LUA_000838")
			SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000838)
			return
		end
	end	
end			



--宝图初始坐标创建以及掉落状况（by 萝卜）
function ItemUse_WaBao_HDCBT ( role , Item )

 	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000058 = GetResString("CALCULATE_ITEMEFFECT_LUA_000058")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000058)
		UseItemFailed ( role )
		return
	end 
	
	local Has_Map_NewPT = CheckBagItem ( role , 6343 )


	if Has_Map_NewPT >= 2 then
		CALCULATE_ITEMEFFECT_LUA_000061 = GetResString("CALCULATE_ITEMEFFECT_LUA_000061")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000061 )
		UseItemFailed ( role )
		return
	end
	local name = GetChaDefaultName ( role )
	local Lv = Lv( role )
	local Item = GetChaItem2 ( role , 2 , 6343 )						-------------------这个接口是取角色背包里某种ID的道具指针，前提是这个道具在背包里只有一个
	local Item_MAXURE = GetItemAttr ( Item , ITEMATTR_MAXURE )
	local Item_URE = GetItemAttr ( Item , ITEMATTR_URE )
	local Item_MAXENERGY = GetItemAttr ( Item , ITEMATTR_MAXENERGY )
	local pos_x = Item_MAXURE									-------------------最大耐久，记录x坐标
	local pos_y = Item_MAXENERGY								-------------------最大能量，记录y坐标
	local Themap = Item_URE
	--按照宝图等级随机分配挖图的坐标
	local MapList = { }
	
	MapList [0] = "NoMap"
	MapList [1] = "garner"
	MapList [2] = "magicsea"
	MapList [3] = "darkblue"

	local MapNameList = { }
	
	CALCULATE_ITEMEFFECT_LUA_000062 = GetResString("CALCULATE_ITEMEFFECT_LUA_000062")
	MapNameList [0] = CALCULATE_ITEMEFFECT_LUA_000062
	CALCULATE_ITEMEFFECT_LUA_000063 = GetResString("CALCULATE_ITEMEFFECT_LUA_000063")
	MapNameList [1] = CALCULATE_ITEMEFFECT_LUA_000063
	CALCULATE_ITEMEFFECT_LUA_000064 = GetResString("CALCULATE_ITEMEFFECT_LUA_000064")
	MapNameList [2] = CALCULATE_ITEMEFFECT_LUA_000064
	CALCULATE_ITEMEFFECT_LUA_000065 = GetResString("CALCULATE_ITEMEFFECT_LUA_000065")
	MapNameList [3] = CALCULATE_ITEMEFFECT_LUA_000065
	if pos_x == 0 or pos_y == 0 or Themap == 0 then
		UseItemNoHint ( role )
		if  Lv < 41 then 
		
			CALCULATE_ITEMEFFECT_LUA_000839 = GetResString("CALCULATE_ITEMEFFECT_LUA_000839")
			SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000839 )
			return
			
		elseif Lv >= 41 and Lv < 45 then	
			UseItemNoHint ( role )
			pos_x , pos_y , Themap = GetTheMapPos_40 ( role , 1 )		
			Item_MAXURE = pos_x
			Item_URE = Themap									---------------------当前耐久为0~3，通过MapList[Themap]来变相记录是哪张地图
			Item_MAXENERGY = pos_y
			CALCULATE_ITEMEFFECT_LUA_000066 = GetResString("CALCULATE_ITEMEFFECT_LUA_000066")
			CALCULATE_ITEMEFFECT_LUA_000067 = GetResString("CALCULATE_ITEMEFFECT_LUA_000067")
			CALCULATE_ITEMEFFECT_LUA_000068 = GetResString("CALCULATE_ITEMEFFECT_LUA_000068")
			SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000068..MapNameList[Themap]..CALCULATE_ITEMEFFECT_LUA_000067..pos_x..","..pos_y..CALCULATE_ITEMEFFECT_LUA_000066 )
			SetItemAttr ( Item , ITEMATTR_MAXENERGY , Item_MAXENERGY )
			SetItemAttr ( Item , ITEMATTR_MAXURE , Item_MAXURE )
			SetItemAttr ( Item , ITEMATTR_URE , Item_URE )
			return
			
		elseif Lv >= 45 and Lv < 50 then			
			UseItemNoHint ( role )
			pos_x , pos_y , Themap = GetTheMapPos_45 ( role , 1 )		
			Item_MAXURE = pos_x
			Item_URE = Themap									---------------------当前耐久为0~3，通过MapList[Themap]来变相记录是哪张地图
			Item_MAXENERGY = pos_y
			CALCULATE_ITEMEFFECT_LUA_000066 = GetResString("CALCULATE_ITEMEFFECT_LUA_000066")
			CALCULATE_ITEMEFFECT_LUA_000067 = GetResString("CALCULATE_ITEMEFFECT_LUA_000067")
			CALCULATE_ITEMEFFECT_LUA_000068 = GetResString("CALCULATE_ITEMEFFECT_LUA_000068")
			SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000068..MapNameList[Themap]..CALCULATE_ITEMEFFECT_LUA_000067..pos_x..","..pos_y..CALCULATE_ITEMEFFECT_LUA_000066 )
			SetItemAttr ( Item , ITEMATTR_MAXENERGY , Item_MAXENERGY )
			SetItemAttr ( Item , ITEMATTR_MAXURE , Item_MAXURE )
			SetItemAttr ( Item , ITEMATTR_URE , Item_URE )
			return	
			
		elseif Lv >= 50 and Lv < 55 then			
			UseItemNoHint ( role )
			pos_x , pos_y , Themap = GetTheMapPos_50 ( role , 1 )		
			Item_MAXURE = pos_x
			Item_URE = Themap									---------------------当前耐久为0~3，通过MapList[Themap]来变相记录是哪张地图
			Item_MAXENERGY = pos_y
			CALCULATE_ITEMEFFECT_LUA_000066 = GetResString("CALCULATE_ITEMEFFECT_LUA_000066")
			CALCULATE_ITEMEFFECT_LUA_000067 = GetResString("CALCULATE_ITEMEFFECT_LUA_000067")
			CALCULATE_ITEMEFFECT_LUA_000068 = GetResString("CALCULATE_ITEMEFFECT_LUA_000068")
			SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000068..MapNameList[Themap]..CALCULATE_ITEMEFFECT_LUA_000067..pos_x..","..pos_y..CALCULATE_ITEMEFFECT_LUA_000066 )
			SetItemAttr ( Item , ITEMATTR_MAXENERGY , Item_MAXENERGY )
			SetItemAttr ( Item , ITEMATTR_MAXURE , Item_MAXURE )
			SetItemAttr ( Item , ITEMATTR_URE , Item_URE )
			return
			
		elseif Lv >= 55 and Lv < 60 then			
			UseItemNoHint ( role )
			pos_x , pos_y , Themap = GetTheMapPos_55 ( role , 1 )		
			Item_MAXURE = pos_x
			Item_URE = Themap									---------------------当前耐久为0~3，通过MapList[Themap]来变相记录是哪张地图
			Item_MAXENERGY = pos_y
			CALCULATE_ITEMEFFECT_LUA_000066 = GetResString("CALCULATE_ITEMEFFECT_LUA_000066")
			CALCULATE_ITEMEFFECT_LUA_000067 = GetResString("CALCULATE_ITEMEFFECT_LUA_000067")
			CALCULATE_ITEMEFFECT_LUA_000068 = GetResString("CALCULATE_ITEMEFFECT_LUA_000068")
			SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000068..MapNameList[Themap]..CALCULATE_ITEMEFFECT_LUA_000067..pos_x..","..pos_y..CALCULATE_ITEMEFFECT_LUA_000066 )
			SetItemAttr ( Item , ITEMATTR_MAXENERGY , Item_MAXENERGY )
			SetItemAttr ( Item , ITEMATTR_MAXURE , Item_MAXURE )
			SetItemAttr ( Item , ITEMATTR_URE , Item_URE )
			return
			
		elseif Lv >= 60 and Lv < 65 then			
			UseItemNoHint ( role )
			pos_x , pos_y , Themap = GetTheMapPos_60 ( role , 1 )		
			Item_MAXURE = pos_x
			Item_URE = Themap									---------------------当前耐久为0~3，通过MapList[Themap]来变相记录是哪张地图
			Item_MAXENERGY = pos_y
			CALCULATE_ITEMEFFECT_LUA_000066 = GetResString("CALCULATE_ITEMEFFECT_LUA_000066")
			CALCULATE_ITEMEFFECT_LUA_000067 = GetResString("CALCULATE_ITEMEFFECT_LUA_000067")
			CALCULATE_ITEMEFFECT_LUA_000068 = GetResString("CALCULATE_ITEMEFFECT_LUA_000068")
			SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000068..MapNameList[Themap]..CALCULATE_ITEMEFFECT_LUA_000067..pos_x..","..pos_y..CALCULATE_ITEMEFFECT_LUA_000066 )
			SetItemAttr ( Item , ITEMATTR_MAXENERGY , Item_MAXENERGY )
			SetItemAttr ( Item , ITEMATTR_MAXURE , Item_MAXURE )
			SetItemAttr ( Item , ITEMATTR_URE , Item_URE )
			return	
			
		elseif Lv >= 65 and Lv < 70 then			
			UseItemNoHint ( role )
			pos_x , pos_y , Themap = GetTheMapPos_65 ( role , 1 )		
			Item_MAXURE = pos_x
			Item_URE = Themap									---------------------当前耐久为0~3，通过MapList[Themap]来变相记录是哪张地图
			Item_MAXENERGY = pos_y
			CALCULATE_ITEMEFFECT_LUA_000066 = GetResString("CALCULATE_ITEMEFFECT_LUA_000066")
			CALCULATE_ITEMEFFECT_LUA_000067 = GetResString("CALCULATE_ITEMEFFECT_LUA_000067")
			CALCULATE_ITEMEFFECT_LUA_000068 = GetResString("CALCULATE_ITEMEFFECT_LUA_000068")
			SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000068..MapNameList[Themap]..CALCULATE_ITEMEFFECT_LUA_000067..pos_x..","..pos_y..CALCULATE_ITEMEFFECT_LUA_000066 )
			SetItemAttr ( Item , ITEMATTR_MAXENERGY , Item_MAXENERGY )
			SetItemAttr ( Item , ITEMATTR_MAXURE , Item_MAXURE )
			SetItemAttr ( Item , ITEMATTR_URE , Item_URE )
			return
		
		elseif Lv >= 70  then			
			UseItemNoHint ( role )
			pos_x , pos_y , Themap = GetTheMapPos_70 ( role , 1 )		
			Item_MAXURE = pos_x
			Item_URE = Themap									---------------------当前耐久为0~3，通过MapList[Themap]来变相记录是哪张地图
			Item_MAXENERGY = pos_y
			CALCULATE_ITEMEFFECT_LUA_000066 = GetResString("CALCULATE_ITEMEFFECT_LUA_000066")
			CALCULATE_ITEMEFFECT_LUA_000067 = GetResString("CALCULATE_ITEMEFFECT_LUA_000067")
			CALCULATE_ITEMEFFECT_LUA_000068 = GetResString("CALCULATE_ITEMEFFECT_LUA_000068")
			SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000068..MapNameList[Themap]..CALCULATE_ITEMEFFECT_LUA_000067..pos_x..","..pos_y..CALCULATE_ITEMEFFECT_LUA_000066 )
			SetItemAttr ( Item , ITEMATTR_MAXENERGY , Item_MAXENERGY )
			SetItemAttr ( Item , ITEMATTR_MAXURE , Item_MAXURE )
			SetItemAttr ( Item , ITEMATTR_URE , Item_URE )
		    return
		end	
	end
			
	
	local GetPos = CheckGetMapPos ( role , pos_x , pos_y , MapList[Themap] )
	if GetPos == 0 then
		CALCULATE_ITEMEFFECT_LUA_000066 = GetResString("CALCULATE_ITEMEFFECT_LUA_000066")
		CALCULATE_ITEMEFFECT_LUA_000067 = GetResString("CALCULATE_ITEMEFFECT_LUA_000067")
		CALCULATE_ITEMEFFECT_LUA_000068 = GetResString("CALCULATE_ITEMEFFECT_LUA_000068")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000068..MapNameList[Themap]..CALCULATE_ITEMEFFECT_LUA_000067..pos_x..","..pos_y..CALCULATE_ITEMEFFECT_LUA_000066 )
		UseItemNoHint ( role )
		return
	elseif GetPos == 1 then
		local bsdwy_count = CheckBagItem ( role , 2672 ) --检查宝石探测器数量
		if bsdwy_count >= 1 then
			local getrandom = math.random ( 1 , 100 )
			if getrandom <= 4 then					----------------------------------------------+5属性宝石，不包含5精（ID：860~863）
				a = math.random(1,4)
				ItemId = 859 + a
				TakeItem( role , 0 , 2672 , 1)
				GiveItem ( role , 0 , ItemId , 1 , 4 )
				local itemname = GetItemName ( ItemId ) 
				CALCULATE_ITEMEFFECT_LUA_000840 = GetResString("CALCULATE_ITEMEFFECT_LUA_000840")
				ScrollNotice (name..CALCULATE_ITEMEFFECT_LUA_000840..itemname,1)
				return	
			elseif getrandom > 4 and getrandom <= 29 then					----------------------------------------------+2属性宝石		
				a = math.random(1,5)
				ItemId = 6814 + 3 * a
				TakeItem( role , 0 , 2672 , 1)
				GiveItem ( role , 0 , ItemId , 1 , 4 )
				local itemname = GetItemName ( ItemId ) 
				CALCULATE_ITEMEFFECT_LUA_000840 = GetResString("CALCULATE_ITEMEFFECT_LUA_000840")
				Notice (name..CALCULATE_ITEMEFFECT_LUA_000840..itemname )
				return
			elseif getrandom > 29 and getrandom <= 79 then					----------------------------------------------+3属性宝石		
				a = math.random(1,5)
				ItemId = 6815 + 3 * a
				TakeItem( role , 0 , 2672 , 1)
				GiveItem ( role , 0 , ItemId , 1 , 4 )
				local itemname = GetItemName ( ItemId ) 
				CALCULATE_ITEMEFFECT_LUA_000840 = GetResString("CALCULATE_ITEMEFFECT_LUA_000840")
				Notice (name..CALCULATE_ITEMEFFECT_LUA_000840..itemname )
				return				
			elseif getrandom > 79 and getrandom <= 99 then					----------------------------------------------+4属性宝石		
				a = math.random(1,5)
				ItemId = 6816 + 3 * a
				TakeItem( role , 0 , 2672 , 1)
				GiveItem ( role , 0 , ItemId , 1 , 4 )
				local itemname = GetItemName ( ItemId ) 
				CALCULATE_ITEMEFFECT_LUA_000840 = GetResString("CALCULATE_ITEMEFFECT_LUA_000840")
				Notice (name..CALCULATE_ITEMEFFECT_LUA_000840..itemname )
				return				
			else	----------------------------------------------+5精神宝石	
				ItemId = 1012
				TakeItem( role , 0 , 2672 , 1)
				GiveItem ( role , 0 , ItemId , 1 , 4 )
				local itemname = GetItemName ( ItemId ) 
				CALCULATE_ITEMEFFECT_LUA_000840 = GetResString("CALCULATE_ITEMEFFECT_LUA_000840")
				ScrollNotice (name..CALCULATE_ITEMEFFECT_LUA_000840..itemname,1 )
				return							
			end
		elseif  IsWaBao(role) == 0 then
			
			local getrandom = math.random ( 1 , 400 )
			if getrandom <= 20 then					----------------------------------------------什么都没有获得
				CALCULATE_ITEMEFFECT_LUA_000841 = GetResString("CALCULATE_ITEMEFFECT_LUA_000841")
				SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000841 )
				return
			elseif getrandom > 20 and getrandom <= 60 then               ----------------------------------------------------少量金钱
				local GiveMoney = math.random (2000,2000+lv*20)
				CALCULATE_FUNCTIONS_LUA_000095 = GetResString("CALCULATE_FUNCTIONS_LUA_000095")
				CALCULATE_ITEMEFFECT_LUA_000842 = GetResString("CALCULATE_ITEMEFFECT_LUA_000842")
				SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000842..GiveMoney..CALCULATE_FUNCTIONS_LUA_000095 )
				AddMoney ( role , 0 , GiveMoney )
				return
			elseif getrandom > 60 and getrandom <= 140 then              -------------------------------------------------获得商城道具
				CALCULATE_ITEMEFFECT_LUA_000843 = GetResString("CALCULATE_ITEMEFFECT_LUA_000843")
				SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000843 )
				local get_shopitem_random = math.random( 1,100 )
				if get_shopitem_random < 3 then
					GiveItem ( role , 0 , 1807 , 1 , 4 )  --理发券
					return
				elseif get_shopitem_random >= 3 and get_shopitem_random < 13 then
					GiveItem ( role , 0 , 5626 , 1 , 4 )  --超级生命恢复剂
					return	
				elseif get_shopitem_random >= 13 and get_shopitem_random < 18 then
					GiveItem ( role , 0 , 5627 , 1 , 4 )  --法力圣水
					return	
				elseif get_shopitem_random >= 18 and get_shopitem_random < 19 then
					GiveItem ( role , 0 , 3095 , 1 , 4 )  --高级努力
					return	
				elseif get_shopitem_random >= 19 and get_shopitem_random < 24 then
					GiveItem ( role , 0 , 3081 , 1 , 4 )  --菊型礼花
					return		
				elseif get_shopitem_random >= 24 and get_shopitem_random < 29 then
					GiveItem ( role , 0 , 3082 , 1 , 4 )  --豪华礼花
					return	
				elseif get_shopitem_random >= 29 and get_shopitem_random < 34 then
					GiveItem ( role , 0 , 3343 , 1 , 4 )  --玫瑰
					return		
				elseif get_shopitem_random >= 34 and get_shopitem_random < 39 then
					GiveItem ( role , 0 , 3077 , 1 , 4 )  --甜蜜巧克力
					return		
				elseif get_shopitem_random >= 39 and get_shopitem_random < 44 then
					GiveItem ( role , 0 , 3094 , 1 , 4 )  --双倍经验增幅器
					return		
				elseif get_shopitem_random >= 44 and get_shopitem_random < 46 then
					GiveItem ( role , 0 , 3100 , 1 , 4 )  --雄狮模拟药剂
					return		
				elseif get_shopitem_random >= 46 and get_shopitem_random < 48 then
					GiveItem ( role , 0 , 3101 , 1 , 4 )  --灵猴模拟药剂
					return	
				elseif get_shopitem_random >= 48 and get_shopitem_random < 50 then
					GiveItem ( role , 0 , 3102 , 1 , 4 )  --蛮牛模拟药剂
					return	
				elseif get_shopitem_random >= 50 and get_shopitem_random < 52 then
					GiveItem ( role , 0 , 3103 , 1 , 4 )  --鹰眼模拟药剂
					return	
				elseif get_shopitem_random >= 52 and get_shopitem_random < 54 then
					GiveItem ( role , 0 , 3104 , 1 , 4 )  --圣灵模拟药剂
					return	
				elseif get_shopitem_random >= 54 and get_shopitem_random < 56 then
					GiveItem ( role , 0 , 0332 , 1 , 4 )  --春风机票
					return	
				elseif get_shopitem_random >= 56 and get_shopitem_random < 58 then
					GiveItem ( role , 0 , 0563 , 1 , 4 )  --夏岛机票
					return	
				elseif get_shopitem_random >= 58 and get_shopitem_random < 60 then
					GiveItem ( role , 0 , 0583 , 1 , 4 )  --秋岛机票
					return	
				elseif get_shopitem_random >= 60 and get_shopitem_random < 62 then
					GiveItem ( role , 0 , 2491 , 1 , 4 )  --海军机票
					return	
				elseif get_shopitem_random >= 62 and get_shopitem_random < 64 then
					GiveItem ( role , 0 , 3099 , 1 , 4 )  --SP神仙水
					return		
				elseif get_shopitem_random >= 64 and get_shopitem_random < 69 then
					GiveItem ( role , 0 , 3097 , 1 , 4 )  --强力体力恢复药剂
					return	
				elseif get_shopitem_random >= 69 and get_shopitem_random < 71 then
					GiveItem ( role , 0 , 3351 , 1 , 4 )  --皇家礼炮A
					return	
				elseif get_shopitem_random >= 71 and get_shopitem_random < 73 then
					GiveItem ( role , 0 , 3352 , 1 , 4 )  --皇家礼炮B
					return	
				elseif get_shopitem_random >= 73 and get_shopitem_random < 75 then
					GiveItem ( role , 0 , 3353 , 1 , 4 )  --皇家礼炮C
					return	
				elseif get_shopitem_random >= 75 and get_shopitem_random < 77 then
					GiveItem ( role , 0 , 3354 , 1 , 4 )  --心型烟花-I
					return	
				elseif get_shopitem_random >= 77 and get_shopitem_random < 79 then
					GiveItem ( role , 0 , 3355 , 1 , 4 )  --心型烟花-LOVE
					return	
				elseif get_shopitem_random >= 79 and get_shopitem_random < 81 then
					GiveItem ( role , 0 , 3356 , 1 , 4 )  --心型烟花-U
					return	
				elseif get_shopitem_random >= 81 and get_shopitem_random < 83 then
					GiveItem ( role , 0 , 3357 , 1 , 4 )  --心型烟花-爱
					return	
				elseif get_shopitem_random >= 83 and get_shopitem_random < 85 then
					GiveItem ( role , 0 , 3358 , 1 , 4 )  --心型烟花-你
					return	
				elseif get_shopitem_random >= 85 and get_shopitem_random < 87 then
					GiveItem ( role , 0 , 3359 , 1 , 4 )  --心型烟花-我
					return	
				elseif get_shopitem_random >= 87 and get_shopitem_random < 89 then
					GiveItem ( role , 0 , 3834 , 1 , 4 )  --寂寞之塔门口机票
					return	
				elseif get_shopitem_random >= 89 and get_shopitem_random < 91 then
					GiveItem ( role , 0 , 3839 , 1 , 4 )  --寂寞之塔2层机票
					return	
				elseif get_shopitem_random >= 91 and get_shopitem_random < 93 then
					GiveItem ( role , 0 , 3840 , 1 , 4 )  --寂寞之塔3层机票
					return	
				elseif get_shopitem_random >= 93 and get_shopitem_random < 95 then
					GiveItem ( role , 0 , 3841 , 1 , 4 )  --寂寞之塔4层机票
					return	
				elseif get_shopitem_random >= 95 and get_shopitem_random < 97 then
					GiveItem ( role , 0 , 3842 , 1 , 4 )  --寂寞之塔5层机票
					return	
				elseif get_shopitem_random >= 97 and get_shopitem_random < 99 then
					GiveItem ( role , 0 , 3843 , 1 , 4 )  --寂寞之塔6层机票
					return	
				else
					GiveItem ( role , 0 , 3846 , 1 , 4 )  --替身娃娃
					return		
				end
				
				
			elseif getrandom > 140 and getrandom <= 200 then	              -------------------------------------------------吹回白银城
				RemoveChaItem( role , 6343 , 1 , 2 , -1 , 2 , 1 )
				CALCULATE_ITEMEFFECT_LUA_000844 = GetResString("CALCULATE_ITEMEFFECT_LUA_000844")
				SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000844 )
				MoveTo( role,2200,2888,"garner" )					
				return
			elseif getrandom > 200 and getrandom <= 240 then					----------------------------出现怪物守护
				local x, y = GetChaPos(role)
				local Refresh = 6000000					--重生时间，秒单位
				local life = 5900000000					--生命时间，毫秒单位
				if Lv > 40 and Lv <= 45 then
					local MonsterID = 1160		--40怪ID
					local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
					-- SetChaHost(new,role)
					SetChaLifeTime( new, life )
					-- SetChaTarget(new, role)
					CALCULATE_ITEMEFFECT_LUA_000845 = GetResString("CALCULATE_ITEMEFFECT_LUA_000845")
					SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000845)
					return
				elseif Lv > 45 and Lv <= 50 then
					local MonsterID = 1161		--45怪ID
					local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
					-- SetChaHost(new,role)
					SetChaLifeTime( new, life )
					-- SetChaTarget(new, role)
					CALCULATE_ITEMEFFECT_LUA_000845 = GetResString("CALCULATE_ITEMEFFECT_LUA_000845")
					SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000845)
					return
				elseif Lv > 50 and Lv <= 55 then
					local MonsterID = 1162		--50怪ID
					local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
					-- SetChaHost(new,role)
					SetChaLifeTime( new, life )
					-- SetChaTarget(new, role)
					CALCULATE_ITEMEFFECT_LUA_000845 = GetResString("CALCULATE_ITEMEFFECT_LUA_000845")
					SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000845)
					return
				elseif Lv > 55 and Lv <= 60 then
					local MonsterID = 1163		--55怪ID
					local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
					-- SetChaHost(new,role)
					SetChaLifeTime( new, life )
					-- SetChaTarget(new, role)
					CALCULATE_ITEMEFFECT_LUA_000845 = GetResString("CALCULATE_ITEMEFFECT_LUA_000845")
					SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000845)
					return
				elseif Lv > 60 and Lv <= 65 then
					local MonsterID = 1164		--60怪ID
					local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
					-- SetChaHost(new,role)
					SetChaLifeTime( new, life )
					-- SetChaTarget(new, role)
					CALCULATE_ITEMEFFECT_LUA_000845 = GetResString("CALCULATE_ITEMEFFECT_LUA_000845")
					SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000845)
					return
				elseif Lv > 65 and Lv <= 70 then
					local MonsterID = 1165		--65怪ID
					local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
					-- SetChaHost(new,role)
					SetChaLifeTime( new, life )
					-- SetChaTarget(new, role)
					CALCULATE_ITEMEFFECT_LUA_000845 = GetResString("CALCULATE_ITEMEFFECT_LUA_000845")
					SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000845)
					return
				elseif Lv > 70 then
					local MonsterID = 1166		--70怪ID
					local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
					-- SetChaHost(new,role)
					SetChaLifeTime( new, life )
					-- SetChaTarget(new, role)
					CALCULATE_ITEMEFFECT_LUA_000845 = GetResString("CALCULATE_ITEMEFFECT_LUA_000845")
					SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000845)
					return
				end	
			elseif getrandom > 240 and getrandom <= 256 then					---------------------------------会掉紫装的小BOSS			
				local x, y = GetChaPos(role)
				local Refresh = 6000000					--重生时间，秒单位
				local life = 5900000000					--生命时间，毫秒单位
				local MonsterID = 1168		--挖宝大boss的ID
				local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
				-- SetChaHost(new,role)
				SetChaLifeTime( new, life )
				-- SetChaTarget(new, role)
				
				if Lv > 40 and Lv <= 45 then
					CALCULATE_ITEMEFFECT_LUA_000846 = GetResString("CALCULATE_ITEMEFFECT_LUA_000846")
					SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000846 )
					CALCULATE_ITEMEFFECT_LUA_000847 = GetResString("CALCULATE_ITEMEFFECT_LUA_000847")
					CALCULATE_ITEMEFFECT_LUA_000848 = GetResString("CALCULATE_ITEMEFFECT_LUA_000848")
					ScrollNotice ( name..CALCULATE_ITEMEFFECT_LUA_000848..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000847 ,1)
					CALCULATE_ITEMEFFECT_LUA_000847 = GetResString("CALCULATE_ITEMEFFECT_LUA_000847")
					CALCULATE_ITEMEFFECT_LUA_000848 = GetResString("CALCULATE_ITEMEFFECT_LUA_000848")
					Notice ( name..CALCULATE_ITEMEFFECT_LUA_000848..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000847)
					return
				elseif Lv > 45 and Lv <= 50 then
					CALCULATE_ITEMEFFECT_LUA_000846 = GetResString("CALCULATE_ITEMEFFECT_LUA_000846")
					SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000846 )
					CALCULATE_ITEMEFFECT_LUA_000847 = GetResString("CALCULATE_ITEMEFFECT_LUA_000847")
					CALCULATE_ITEMEFFECT_LUA_000848 = GetResString("CALCULATE_ITEMEFFECT_LUA_000848")
					ScrollNotice ( name..CALCULATE_ITEMEFFECT_LUA_000848..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000847 ,1)
					CALCULATE_ITEMEFFECT_LUA_000847 = GetResString("CALCULATE_ITEMEFFECT_LUA_000847")
					CALCULATE_ITEMEFFECT_LUA_000848 = GetResString("CALCULATE_ITEMEFFECT_LUA_000848")
					Notice ( name..CALCULATE_ITEMEFFECT_LUA_000848..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000847)
					return
				elseif Lv > 50 and Lv <= 55 then
					CALCULATE_ITEMEFFECT_LUA_000846 = GetResString("CALCULATE_ITEMEFFECT_LUA_000846")
					SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000846 )
					CALCULATE_ITEMEFFECT_LUA_000847 = GetResString("CALCULATE_ITEMEFFECT_LUA_000847")
					CALCULATE_ITEMEFFECT_LUA_000848 = GetResString("CALCULATE_ITEMEFFECT_LUA_000848")
					ScrollNotice ( name..CALCULATE_ITEMEFFECT_LUA_000848..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000847 ,1)
					CALCULATE_ITEMEFFECT_LUA_000847 = GetResString("CALCULATE_ITEMEFFECT_LUA_000847")
					CALCULATE_ITEMEFFECT_LUA_000848 = GetResString("CALCULATE_ITEMEFFECT_LUA_000848")
					Notice ( name..CALCULATE_ITEMEFFECT_LUA_000848..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000847)
					return	
				elseif Lv > 55 and Lv <= 60 then
					CALCULATE_ITEMEFFECT_LUA_000846 = GetResString("CALCULATE_ITEMEFFECT_LUA_000846")
					SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000846 )
					CALCULATE_ITEMEFFECT_LUA_000847 = GetResString("CALCULATE_ITEMEFFECT_LUA_000847")
					CALCULATE_ITEMEFFECT_LUA_000848 = GetResString("CALCULATE_ITEMEFFECT_LUA_000848")
					ScrollNotice ( name..CALCULATE_ITEMEFFECT_LUA_000848..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000847 ,1)
					CALCULATE_ITEMEFFECT_LUA_000847 = GetResString("CALCULATE_ITEMEFFECT_LUA_000847")
					CALCULATE_ITEMEFFECT_LUA_000848 = GetResString("CALCULATE_ITEMEFFECT_LUA_000848")
					Notice ( name..CALCULATE_ITEMEFFECT_LUA_000848..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000847)
					return
				elseif Lv > 60 and Lv <= 65 then
					CALCULATE_ITEMEFFECT_LUA_000846 = GetResString("CALCULATE_ITEMEFFECT_LUA_000846")
					SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000846 )
					CALCULATE_ITEMEFFECT_LUA_000847 = GetResString("CALCULATE_ITEMEFFECT_LUA_000847")
					CALCULATE_ITEMEFFECT_LUA_000848 = GetResString("CALCULATE_ITEMEFFECT_LUA_000848")
					ScrollNotice ( name..CALCULATE_ITEMEFFECT_LUA_000848..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000847 ,1)
					CALCULATE_ITEMEFFECT_LUA_000847 = GetResString("CALCULATE_ITEMEFFECT_LUA_000847")
					CALCULATE_ITEMEFFECT_LUA_000848 = GetResString("CALCULATE_ITEMEFFECT_LUA_000848")
					Notice ( name..CALCULATE_ITEMEFFECT_LUA_000848..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000847)
					return	
				elseif Lv > 65 and Lv <= 70 then
					CALCULATE_ITEMEFFECT_LUA_000846 = GetResString("CALCULATE_ITEMEFFECT_LUA_000846")
					SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000846 )
					CALCULATE_ITEMEFFECT_LUA_000847 = GetResString("CALCULATE_ITEMEFFECT_LUA_000847")
					CALCULATE_ITEMEFFECT_LUA_000849 = GetResString("CALCULATE_ITEMEFFECT_LUA_000849")
					ScrollNotice ( name..CALCULATE_ITEMEFFECT_LUA_000849..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000847 ,1)
					CALCULATE_ITEMEFFECT_LUA_000847 = GetResString("CALCULATE_ITEMEFFECT_LUA_000847")
					CALCULATE_ITEMEFFECT_LUA_000849 = GetResString("CALCULATE_ITEMEFFECT_LUA_000849")
					Notice ( name..CALCULATE_ITEMEFFECT_LUA_000849..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000847)
					return	
				else
					CALCULATE_ITEMEFFECT_LUA_000846 = GetResString("CALCULATE_ITEMEFFECT_LUA_000846")
					SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000846 )
					CALCULATE_ITEMEFFECT_LUA_000847 = GetResString("CALCULATE_ITEMEFFECT_LUA_000847")
					CALCULATE_ITEMEFFECT_LUA_000849 = GetResString("CALCULATE_ITEMEFFECT_LUA_000849")
					ScrollNotice ( name..CALCULATE_ITEMEFFECT_LUA_000849..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000847 ,1)
					CALCULATE_ITEMEFFECT_LUA_000847 = GetResString("CALCULATE_ITEMEFFECT_LUA_000847")
					CALCULATE_ITEMEFFECT_LUA_000849 = GetResString("CALCULATE_ITEMEFFECT_LUA_000849")
					Notice ( name..CALCULATE_ITEMEFFECT_LUA_000849..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000847)
					return	
				end	
				
				-- local map_role = GetChaMapName ( role )
				-- local map_role_name = 0
				-- if map_role == "garner" then
					-- local map_role_name = "加纳大陆"
				-- elseif map_role == "magicsea" then
					-- local map_role_name = "魔女海岸"	
				-- elseif map_role == "darkblue" then
					-- local map_role_name = "深蓝群岛"
				-- end		
				
				-- SystemNotice ( role , "你挖宝不慎惊醒了沉睡中的妖怪，实力不够的话最好走为上计。" )
				-- Notice ( name.."挖宝不慎惊醒了沉睡中的妖怪，现在发怒的妖怪正在"..map_role_name.."地区的"..math.floor(x/100)..","..math.floor(y/100).."肆虐，勇士们拿上你们的武器去征服它吧。" )
				-- return

			elseif getrandom > 256 and getrandom <= 320 then					----------------------------------搞笑的特效--因BB组件祛除而增加1%几率
				--SystemNotice ( role , "你挖宝时遭到了天神的鄙视。" )
				CALCULATE_ITEMEFFECT_LUA_000850 = GetResString("CALCULATE_ITEMEFFECT_LUA_000850")
				Notice(name..CALCULATE_ITEMEFFECT_LUA_000850)
				AddState(role , role , STATE_JLTX6 , 1 , 300 )
				return	

			elseif getrandom > 320 and getrandom <= 340 then					-------------------------------难度不大，但是皮很厚的经验boss
				local x, y = GetChaPos(role)
				local Refresh = 6000000					--重生时间，秒单位
				local life = 5900000000				--生命时间，毫秒单位
				if Lv > 40 and Lv <= 45 then
					local MonsterID = 1152		--40经验肉boss的ID
					local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x+4000 , y , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x , y+4000 , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x-4000 , y , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x , y-4000 , 145 , Refresh, role )
					-- SetChaHost(new,role)
					SetChaLifeTime( new, life )
					-- SetChaTarget(new, role)
					CALCULATE_ITEMEFFECT_LUA_000851 = GetResString("CALCULATE_ITEMEFFECT_LUA_000851")
					CALCULATE_ITEMEFFECT_LUA_000852 = GetResString("CALCULATE_ITEMEFFECT_LUA_000852")
					ScrollNotice ( name..CALCULATE_ITEMEFFECT_LUA_000852..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000851 ,1)
					CALCULATE_ITEMEFFECT_LUA_000851 = GetResString("CALCULATE_ITEMEFFECT_LUA_000851")
					CALCULATE_ITEMEFFECT_LUA_000852 = GetResString("CALCULATE_ITEMEFFECT_LUA_000852")
					Notice ( name..CALCULATE_ITEMEFFECT_LUA_000852..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000851 )
					return	
				elseif Lv > 45 and Lv <= 50 then
					local MonsterID = 1153		--45经验肉boss的ID
					local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x+4000 , y , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x , y+4000 , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x-4000 , y , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x , y-4000 , 145 , Refresh, role )
					-- SetChaHost(new,role)
					SetChaLifeTime( new, life )
					-- SetChaTarget(new, role)
					CALCULATE_ITEMEFFECT_LUA_000851 = GetResString("CALCULATE_ITEMEFFECT_LUA_000851")
					CALCULATE_ITEMEFFECT_LUA_000852 = GetResString("CALCULATE_ITEMEFFECT_LUA_000852")
					ScrollNotice ( name..CALCULATE_ITEMEFFECT_LUA_000852..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000851 ,1)
					CALCULATE_ITEMEFFECT_LUA_000851 = GetResString("CALCULATE_ITEMEFFECT_LUA_000851")
					CALCULATE_ITEMEFFECT_LUA_000852 = GetResString("CALCULATE_ITEMEFFECT_LUA_000852")
					Notice ( name..CALCULATE_ITEMEFFECT_LUA_000852..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000851 )
					return	
				elseif Lv > 50 and Lv <= 55 then
					local MonsterID = 1154		--50经验肉boss的ID
					local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x+4000 , y , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x , y+4000 , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x-4000 , y , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x , y-4000 , 145 , Refresh, role )
					-- SetChaHost(new,role)
					SetChaLifeTime( new, life )
					-- SetChaTarget(new, role)
					CALCULATE_ITEMEFFECT_LUA_000851 = GetResString("CALCULATE_ITEMEFFECT_LUA_000851")
					CALCULATE_ITEMEFFECT_LUA_000852 = GetResString("CALCULATE_ITEMEFFECT_LUA_000852")
					ScrollNotice ( name..CALCULATE_ITEMEFFECT_LUA_000852..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000851 ,1)
					CALCULATE_ITEMEFFECT_LUA_000851 = GetResString("CALCULATE_ITEMEFFECT_LUA_000851")
					CALCULATE_ITEMEFFECT_LUA_000852 = GetResString("CALCULATE_ITEMEFFECT_LUA_000852")
					Notice ( name..CALCULATE_ITEMEFFECT_LUA_000852..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000851 )
					return	
				elseif Lv > 55 and Lv <= 60 then
					local MonsterID = 1155		--55经验肉boss的ID
					local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x+4000 , y , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x , y+4000 , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x-4000 , y , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x , y-4000 , 145 , Refresh, role )
					-- SetChaHost(new,role)
					SetChaLifeTime( new, life )
					-- SetChaTarget(new, role)
					CALCULATE_ITEMEFFECT_LUA_000851 = GetResString("CALCULATE_ITEMEFFECT_LUA_000851")
					CALCULATE_ITEMEFFECT_LUA_000852 = GetResString("CALCULATE_ITEMEFFECT_LUA_000852")
					ScrollNotice ( name..CALCULATE_ITEMEFFECT_LUA_000852..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000851 ,1)
					CALCULATE_ITEMEFFECT_LUA_000851 = GetResString("CALCULATE_ITEMEFFECT_LUA_000851")
					CALCULATE_ITEMEFFECT_LUA_000852 = GetResString("CALCULATE_ITEMEFFECT_LUA_000852")
					Notice ( name..CALCULATE_ITEMEFFECT_LUA_000852..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000851 )
					return		
				elseif Lv > 60 and Lv <= 65 then
					local MonsterID = 1156		--60经验肉boss的ID
					local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x+4000 , y , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x , y+4000 , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x-4000 , y , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x , y-4000 , 145 , Refresh, role )
					-- SetChaHost(new,role)
					SetChaLifeTime( new, life )
					-- SetChaTarget(new, role)
					CALCULATE_ITEMEFFECT_LUA_000851 = GetResString("CALCULATE_ITEMEFFECT_LUA_000851")
					CALCULATE_ITEMEFFECT_LUA_000852 = GetResString("CALCULATE_ITEMEFFECT_LUA_000852")
					ScrollNotice ( name..CALCULATE_ITEMEFFECT_LUA_000852..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000851 ,1)
					CALCULATE_ITEMEFFECT_LUA_000851 = GetResString("CALCULATE_ITEMEFFECT_LUA_000851")
					CALCULATE_ITEMEFFECT_LUA_000852 = GetResString("CALCULATE_ITEMEFFECT_LUA_000852")
					Notice ( name..CALCULATE_ITEMEFFECT_LUA_000852..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000851 )
					return	
				elseif Lv > 65 and Lv <= 70 then
					local MonsterID = 1157		--65经验肉boss的ID
					local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x+4000 , y , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x , y+4000 , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x-4000 , y , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x , y-4000 , 145 , Refresh, role )
					-- SetChaHost(new,role)
					SetChaLifeTime( new, life )
					-- SetChaTarget(new, role)
					CALCULATE_ITEMEFFECT_LUA_000851 = GetResString("CALCULATE_ITEMEFFECT_LUA_000851")
					CALCULATE_ITEMEFFECT_LUA_000853 = GetResString("CALCULATE_ITEMEFFECT_LUA_000853")
					ScrollNotice ( name..CALCULATE_ITEMEFFECT_LUA_000853..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000851 ,1)
					CALCULATE_ITEMEFFECT_LUA_000851 = GetResString("CALCULATE_ITEMEFFECT_LUA_000851")
					CALCULATE_ITEMEFFECT_LUA_000853 = GetResString("CALCULATE_ITEMEFFECT_LUA_000853")
					Notice ( name..CALCULATE_ITEMEFFECT_LUA_000853..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000851 )
					return		
				elseif Lv > 70  then
					local MonsterID = 1158		--70经验肉boss的ID
					local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x+4000 , y , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x , y+4000 , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x-4000 , y , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x , y-4000 , 145 , Refresh, role )
					-- SetChaHost(new,role)
					SetChaLifeTime( new, life )
					-- SetChaTarget(new, role)
					CALCULATE_ITEMEFFECT_LUA_000854 = GetResString("CALCULATE_ITEMEFFECT_LUA_000854")
					CALCULATE_ITEMEFFECT_LUA_000853 = GetResString("CALCULATE_ITEMEFFECT_LUA_000853")
					ScrollNotice ( name..CALCULATE_ITEMEFFECT_LUA_000853..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000854 ,1)
					CALCULATE_ITEMEFFECT_LUA_000851 = GetResString("CALCULATE_ITEMEFFECT_LUA_000851")
					CALCULATE_ITEMEFFECT_LUA_000853 = GetResString("CALCULATE_ITEMEFFECT_LUA_000853")
					Notice ( name..CALCULATE_ITEMEFFECT_LUA_000853..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000851 )
					return	
				end	
				
			elseif getrandom > 340 and getrandom <= 342 then					-------------------------------获得用来换取75BB装的组件
				local part_of_boss_item = math.random( 1,3 )
				CALCULATE_ITEMEFFECT_LUA_000855 = GetResString("CALCULATE_ITEMEFFECT_LUA_000855")
				SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000855 )
				CALCULATE_ITEMEFFECT_LUA_000856 = GetResString("CALCULATE_ITEMEFFECT_LUA_000856")
				ScrollNotice ( name..CALCULATE_ITEMEFFECT_LUA_000856 ,1)
				if part_of_boss_item ==	1 then
					GiveItem ( role , 0 , 6344 , 1 , 4  )
					return
				elseif part_of_boss_item == 2 then
					GiveItem ( role , 0 , 6345 , 1 , 4  )
					return
				else
					GiveItem ( role , 0 , 6346 , 1 , 4  )
					return
				end		
			
			elseif getrandom > 342 and getrandom <= 400 then	               -------------------传送至命运房间
				RemoveChaItem( role , 6343 , 1 , 2 , -1 , 2 , 1 )
				CALCULATE_ITEMEFFECT_LUA_000857 = GetResString("CALCULATE_ITEMEFFECT_LUA_000857")
				CALCULATE_ITEMEFFECT_LUA_000858 = GetResString("CALCULATE_ITEMEFFECT_LUA_000858")
				ScrollNotice (CALCULATE_ITEMEFFECT_LUA_000858..name..CALCULATE_ITEMEFFECT_LUA_000857 , 1)
				CALCULATE_ITEMEFFECT_LUA_000859 = GetResString("CALCULATE_ITEMEFFECT_LUA_000859")
				SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000859 )
				MoveTo( role ,50,50,"mingyun")				
				return
		
			end
			
		else
			
			local getrandom = math.random ( 1 , 400 )
			if getrandom <= 40 then               ----------------------------------------------------少量金钱
				local GiveMoney = 200 * math.random ( 1, 10 )
				CALCULATE_FUNCTIONS_LUA_000095 = GetResString("CALCULATE_FUNCTIONS_LUA_000095")
				CALCULATE_ITEMEFFECT_LUA_000842 = GetResString("CALCULATE_ITEMEFFECT_LUA_000842")
				SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000842..GiveMoney..CALCULATE_FUNCTIONS_LUA_000095 )
				AddMoney ( role , 0 , GiveMoney )
				return
			elseif getrandom > 40 and getrandom <= 140 then              -------------------------------------------------获得商城道具
				CALCULATE_ITEMEFFECT_LUA_000843 = GetResString("CALCULATE_ITEMEFFECT_LUA_000843")
				SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000843 )
				local get_shopitem_random = math.random( 1,100 )
				if get_shopitem_random < 3 then
					GiveItem ( role , 0 , 1807 , 1 , 4 )  --理发券
					return
				elseif get_shopitem_random >= 3 and get_shopitem_random < 13 then
					GiveItem ( role , 0 , 5626 , 1 , 4 )  --超级生命恢复剂
					return	
				elseif get_shopitem_random >= 13 and get_shopitem_random < 18 then
					GiveItem ( role , 0 , 5627 , 1 , 4 )  --法力圣水
					return	
				elseif get_shopitem_random >= 18 and get_shopitem_random < 19 then
					GiveItem ( role , 0 , 3095 , 1 , 4 )  --高级努力
					return	
				elseif get_shopitem_random >= 19 and get_shopitem_random < 24 then
					GiveItem ( role , 0 , 3081 , 1 , 4 )  --菊型礼花
					return		
				elseif get_shopitem_random >= 24 and get_shopitem_random < 29 then
					GiveItem ( role , 0 , 3082 , 1 , 4 )  --豪华礼花
					return	
				elseif get_shopitem_random >= 29 and get_shopitem_random < 34 then
					GiveItem ( role , 0 , 3343 , 1 , 4 )  --玫瑰
					return		
				elseif get_shopitem_random >= 34 and get_shopitem_random < 39 then
					GiveItem ( role , 0 , 3077 , 1 , 4 )  --甜蜜巧克力
					return		
				elseif get_shopitem_random >= 39 and get_shopitem_random < 44 then
					GiveItem ( role , 0 , 3094 , 1 , 4 )  --双倍经验增幅器
					return		
				elseif get_shopitem_random >= 44 and get_shopitem_random < 46 then
					GiveItem ( role , 0 , 3100 , 1 , 4 )  --雄狮模拟药剂
					return		
				elseif get_shopitem_random >= 46 and get_shopitem_random < 48 then
					GiveItem ( role , 0 , 3101 , 1 , 4 )  --灵猴模拟药剂
					return	
				elseif get_shopitem_random >= 48 and get_shopitem_random < 50 then
					GiveItem ( role , 0 , 3102 , 1 , 4 )  --蛮牛模拟药剂
					return	
				elseif get_shopitem_random >= 50 and get_shopitem_random < 52 then
					GiveItem ( role , 0 , 3103 , 1 , 4 )  --鹰眼模拟药剂
					return	
				elseif get_shopitem_random >= 52 and get_shopitem_random < 54 then
					GiveItem ( role , 0 , 3104 , 1 , 4 )  --圣灵模拟药剂
					return	
				elseif get_shopitem_random >= 54 and get_shopitem_random < 56 then
					GiveItem ( role , 0 , 0332 , 1 , 4 )  --春风机票
					return	
				elseif get_shopitem_random >= 56 and get_shopitem_random < 58 then
					GiveItem ( role , 0 , 0563 , 1 , 4 )  --夏岛机票
					return	
				elseif get_shopitem_random >= 58 and get_shopitem_random < 60 then
					GiveItem ( role , 0 , 0583 , 1 , 4 )  --秋岛机票
					return	
				elseif get_shopitem_random >= 60 and get_shopitem_random < 62 then
					GiveItem ( role , 0 , 2491 , 1 , 4 )  --海军机票
					return	
				elseif get_shopitem_random >= 62 and get_shopitem_random < 64 then
					GiveItem ( role , 0 , 3099 , 1 , 4 )  --SP神仙水
					return		
				elseif get_shopitem_random >= 64 and get_shopitem_random < 69 then
					GiveItem ( role , 0 , 3097 , 1 , 4 )  --强力体力恢复药剂
					return	
				elseif get_shopitem_random >= 69 and get_shopitem_random < 71 then
					GiveItem ( role , 0 , 3351 , 1 , 4 )  --皇家礼炮A
					return	
				elseif get_shopitem_random >= 71 and get_shopitem_random < 73 then
					GiveItem ( role , 0 , 3352 , 1 , 4 )  --皇家礼炮B
					return	
				elseif get_shopitem_random >= 73 and get_shopitem_random < 75 then
					GiveItem ( role , 0 , 3353 , 1 , 4 )  --皇家礼炮C
					return	
				elseif get_shopitem_random >= 75 and get_shopitem_random < 77 then
					GiveItem ( role , 0 , 3354 , 1 , 4 )  --心型烟花-I
					return	
				elseif get_shopitem_random >= 77 and get_shopitem_random < 79 then
					GiveItem ( role , 0 , 3355 , 1 , 4 )  --心型烟花-LOVE
					return	
				elseif get_shopitem_random >= 79 and get_shopitem_random < 81 then
					GiveItem ( role , 0 , 3356 , 1 , 4 )  --心型烟花-U
					return	
				elseif get_shopitem_random >= 81 and get_shopitem_random < 83 then
					GiveItem ( role , 0 , 3357 , 1 , 4 )  --心型烟花-爱
					return	
				elseif get_shopitem_random >= 83 and get_shopitem_random < 85 then
					GiveItem ( role , 0 , 3358 , 1 , 4 )  --心型烟花-你
					return	
				elseif get_shopitem_random >= 85 and get_shopitem_random < 87 then
					GiveItem ( role , 0 , 3359 , 1 , 4 )  --心型烟花-我
					return	
				elseif get_shopitem_random >= 87 and get_shopitem_random < 89 then
					GiveItem ( role , 0 , 3834 , 1 , 4 )  --寂寞之塔门口机票
					return	
				elseif get_shopitem_random >= 89 and get_shopitem_random < 91 then
					GiveItem ( role , 0 , 3839 , 1 , 4 )  --寂寞之塔2层机票
					return	
				elseif get_shopitem_random >= 91 and get_shopitem_random < 93 then
					GiveItem ( role , 0 , 3840 , 1 , 4 )  --寂寞之塔3层机票
					return	
				elseif get_shopitem_random >= 93 and get_shopitem_random < 95 then
					GiveItem ( role , 0 , 3841 , 1 , 4 )  --寂寞之塔4层机票
					return	
				elseif get_shopitem_random >= 95 and get_shopitem_random < 97 then
					GiveItem ( role , 0 , 3842 , 1 , 4 )  --寂寞之塔5层机票
					return	
				elseif get_shopitem_random >= 97 and get_shopitem_random < 99 then
					GiveItem ( role , 0 , 3843 , 1 , 4 )  --寂寞之塔6层机票
					return	
				else
					GiveItem ( role , 0 , 3846 , 1 , 4 )  --替身娃娃
					return		
				end
				
				
			elseif getrandom > 140 and getrandom <= 160 then	              -------------------------------------------------吹回白银城
				RemoveChaItem( role , 6343 , 1 , 2 , -1 , 2 , 1 )
				CALCULATE_ITEMEFFECT_LUA_000844 = GetResString("CALCULATE_ITEMEFFECT_LUA_000844")
				SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000844 )
				MoveTo( role,2200,2888,"garner" )		
				return
			elseif getrandom > 160 and getrandom <= 200 then					----------------------------出现怪物守护
				local x, y = GetChaPos(role)
				local Refresh = 6000000					--重生时间，秒单位
				local life = 5900000000					--生命时间，毫秒单位
				if Lv > 40 and Lv <= 45 then
					local MonsterID = 1160		--40怪ID
					local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
					--SetChaHost(new,role)
					SetChaLifeTime( new, life )
					--SetChaTarget(new, role)
					CALCULATE_ITEMEFFECT_LUA_000845 = GetResString("CALCULATE_ITEMEFFECT_LUA_000845")
					SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000845)
					return
				elseif Lv > 45 and Lv <= 50 then
					local MonsterID = 1161		--45怪ID
					local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
					--SetChaHost(new,role)
					SetChaLifeTime( new, life )
					--SetChaTarget(new, role)
					CALCULATE_ITEMEFFECT_LUA_000845 = GetResString("CALCULATE_ITEMEFFECT_LUA_000845")
					SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000845)
					return
				elseif Lv > 50 and Lv <= 55 then
					local MonsterID = 1162		--50怪ID
					local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
					--SetChaHost(new,role)
					SetChaLifeTime( new, life )
					--SetChaTarget(new, role)
					CALCULATE_ITEMEFFECT_LUA_000845 = GetResString("CALCULATE_ITEMEFFECT_LUA_000845")
					SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000845)
					return
				elseif Lv > 55 and Lv <= 60 then
					local MonsterID = 1163		--55怪ID
					local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
					--SetChaHost(new,role)
					SetChaLifeTime( new, life )
					--SetChaTarget(new, role)
					CALCULATE_ITEMEFFECT_LUA_000845 = GetResString("CALCULATE_ITEMEFFECT_LUA_000845")
					SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000845)
					return
				elseif Lv > 60 and Lv <= 65 then
					local MonsterID = 1164		--60怪ID
					local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
					--SetChaHost(new,role)
					SetChaLifeTime( new, life )
					--SetChaTarget(new, role)
					CALCULATE_ITEMEFFECT_LUA_000845 = GetResString("CALCULATE_ITEMEFFECT_LUA_000845")
					SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000845)
					return
				elseif Lv > 65 and Lv <= 70 then
					local MonsterID = 1165		--65怪ID
					local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
					--SetChaHost(new,role)
					SetChaLifeTime( new, life )
					--SetChaTarget(new, role)
					CALCULATE_ITEMEFFECT_LUA_000845 = GetResString("CALCULATE_ITEMEFFECT_LUA_000845")
					SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000845)
					return
				elseif Lv > 70 then
					local MonsterID = 1166		--70怪ID
					local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
					--SetChaHost(new,role)
					SetChaLifeTime( new, life )
					--SetChaTarget(new, role)
					CALCULATE_ITEMEFFECT_LUA_000845 = GetResString("CALCULATE_ITEMEFFECT_LUA_000845")
					SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000845)
					return
				end	
			elseif getrandom > 200 and getrandom <= 240 then					---------------------------------会掉紫装的小BOSS			
				local x, y = GetChaPos(role)
				local Refresh = 6000000					--重生时间，秒单位
				local life = 5900000000					--生命时间，毫秒单位
				local MonsterID = 1168		--挖宝大boss的ID
				local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
				--SetChaHost(new,role)
				SetChaLifeTime( new, life )
				if Lv > 40 and Lv <= 45 then
					CALCULATE_ITEMEFFECT_LUA_000846 = GetResString("CALCULATE_ITEMEFFECT_LUA_000846")
					SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000846 )
					CALCULATE_ITEMEFFECT_LUA_000847 = GetResString("CALCULATE_ITEMEFFECT_LUA_000847")
					CALCULATE_ITEMEFFECT_LUA_000848 = GetResString("CALCULATE_ITEMEFFECT_LUA_000848")
					ScrollNotice ( name..CALCULATE_ITEMEFFECT_LUA_000848..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000847 ,1)
					CALCULATE_ITEMEFFECT_LUA_000847 = GetResString("CALCULATE_ITEMEFFECT_LUA_000847")
					CALCULATE_ITEMEFFECT_LUA_000848 = GetResString("CALCULATE_ITEMEFFECT_LUA_000848")
					Notice ( name..CALCULATE_ITEMEFFECT_LUA_000848..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000847 )
					return
				elseif Lv > 45 and Lv <= 50 then
					CALCULATE_ITEMEFFECT_LUA_000846 = GetResString("CALCULATE_ITEMEFFECT_LUA_000846")
					SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000846 )
					CALCULATE_ITEMEFFECT_LUA_000847 = GetResString("CALCULATE_ITEMEFFECT_LUA_000847")
					CALCULATE_ITEMEFFECT_LUA_000848 = GetResString("CALCULATE_ITEMEFFECT_LUA_000848")
					ScrollNotice ( name..CALCULATE_ITEMEFFECT_LUA_000848..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000847 ,1)
					CALCULATE_ITEMEFFECT_LUA_000847 = GetResString("CALCULATE_ITEMEFFECT_LUA_000847")
					CALCULATE_ITEMEFFECT_LUA_000848 = GetResString("CALCULATE_ITEMEFFECT_LUA_000848")
					Notice ( name..CALCULATE_ITEMEFFECT_LUA_000848..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000847 )
					return
				elseif Lv > 50 and Lv <= 55 then
					CALCULATE_ITEMEFFECT_LUA_000846 = GetResString("CALCULATE_ITEMEFFECT_LUA_000846")
					SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000846 )
					CALCULATE_ITEMEFFECT_LUA_000847 = GetResString("CALCULATE_ITEMEFFECT_LUA_000847")
					CALCULATE_ITEMEFFECT_LUA_000848 = GetResString("CALCULATE_ITEMEFFECT_LUA_000848")
					ScrollNotice ( name..CALCULATE_ITEMEFFECT_LUA_000848..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000847 ,1)
					CALCULATE_ITEMEFFECT_LUA_000847 = GetResString("CALCULATE_ITEMEFFECT_LUA_000847")
					CALCULATE_ITEMEFFECT_LUA_000848 = GetResString("CALCULATE_ITEMEFFECT_LUA_000848")
					Notice ( name..CALCULATE_ITEMEFFECT_LUA_000848..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000847 )
					return	
				elseif Lv > 55 and Lv <= 60 then
					CALCULATE_ITEMEFFECT_LUA_000846 = GetResString("CALCULATE_ITEMEFFECT_LUA_000846")
					SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000846 )
					CALCULATE_ITEMEFFECT_LUA_000847 = GetResString("CALCULATE_ITEMEFFECT_LUA_000847")
					CALCULATE_ITEMEFFECT_LUA_000848 = GetResString("CALCULATE_ITEMEFFECT_LUA_000848")
					ScrollNotice ( name..CALCULATE_ITEMEFFECT_LUA_000848..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000847 ,1)
					CALCULATE_ITEMEFFECT_LUA_000847 = GetResString("CALCULATE_ITEMEFFECT_LUA_000847")
					CALCULATE_ITEMEFFECT_LUA_000848 = GetResString("CALCULATE_ITEMEFFECT_LUA_000848")
					Notice ( name..CALCULATE_ITEMEFFECT_LUA_000848..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000847 )
					return
				elseif Lv > 60 and Lv <= 65 then
					CALCULATE_ITEMEFFECT_LUA_000846 = GetResString("CALCULATE_ITEMEFFECT_LUA_000846")
					SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000846 )
					CALCULATE_ITEMEFFECT_LUA_000847 = GetResString("CALCULATE_ITEMEFFECT_LUA_000847")
					CALCULATE_ITEMEFFECT_LUA_000848 = GetResString("CALCULATE_ITEMEFFECT_LUA_000848")
					ScrollNotice ( name..CALCULATE_ITEMEFFECT_LUA_000848..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000847 ,1)
					CALCULATE_ITEMEFFECT_LUA_000847 = GetResString("CALCULATE_ITEMEFFECT_LUA_000847")
					CALCULATE_ITEMEFFECT_LUA_000848 = GetResString("CALCULATE_ITEMEFFECT_LUA_000848")
					Notice ( name..CALCULATE_ITEMEFFECT_LUA_000848..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000847 )
					return	
				elseif Lv > 65 and Lv <= 70 then
					CALCULATE_ITEMEFFECT_LUA_000846 = GetResString("CALCULATE_ITEMEFFECT_LUA_000846")
					SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000846 )
					CALCULATE_ITEMEFFECT_LUA_000847 = GetResString("CALCULATE_ITEMEFFECT_LUA_000847")
					CALCULATE_ITEMEFFECT_LUA_000849 = GetResString("CALCULATE_ITEMEFFECT_LUA_000849")
					ScrollNotice ( name..CALCULATE_ITEMEFFECT_LUA_000849..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000847 ,1)
					CALCULATE_ITEMEFFECT_LUA_000847 = GetResString("CALCULATE_ITEMEFFECT_LUA_000847")
					CALCULATE_ITEMEFFECT_LUA_000849 = GetResString("CALCULATE_ITEMEFFECT_LUA_000849")
					Notice ( name..CALCULATE_ITEMEFFECT_LUA_000849..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000847 )
					return	
				else
					CALCULATE_ITEMEFFECT_LUA_000846 = GetResString("CALCULATE_ITEMEFFECT_LUA_000846")
					SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000846 )
					CALCULATE_ITEMEFFECT_LUA_000847 = GetResString("CALCULATE_ITEMEFFECT_LUA_000847")
					CALCULATE_ITEMEFFECT_LUA_000849 = GetResString("CALCULATE_ITEMEFFECT_LUA_000849")
					ScrollNotice ( name..CALCULATE_ITEMEFFECT_LUA_000849..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000847 ,1)
					CALCULATE_ITEMEFFECT_LUA_000847 = GetResString("CALCULATE_ITEMEFFECT_LUA_000847")
					CALCULATE_ITEMEFFECT_LUA_000849 = GetResString("CALCULATE_ITEMEFFECT_LUA_000849")
					Notice ( name..CALCULATE_ITEMEFFECT_LUA_000849..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000847 )
					return	
				end	
					
				--SetChaTarget(new, role)
				-- local map_role = GetChaMapName ( role )
				-- local map_role_name = 0
				-- if map_role == "garner" then
					-- local map_role_name = "加纳大陆"
				-- elseif map_role == "magicsea" then
					-- local map_role_name = "魔女海岸"	
				-- elseif map_role == "darkblue" then
					-- local map_role_name = "深蓝群岛"
				-- end		
				
				-- SystemNotice ( role , "你挖宝不慎惊醒了沉睡中的妖怪，实力不够的话最好走为上计。" )
				-- Notice ( name.."挖宝不慎惊醒了沉睡中的妖怪，现在发怒的妖怪正在"..map_role_name.."地区的"..math.floor(x/100)..","..math.floor(y/100).."肆虐，勇士们拿上你们的武器去征服它吧。" )
				return

			elseif getrandom > 240 and getrandom <= 304 then					----------------------------------搞笑的特效----因为BB组件祛除而增加2%
				--SystemNotice ( role , "你挖宝时遭到了天神的鄙视。" )
				CALCULATE_ITEMEFFECT_LUA_000850 = GetResString("CALCULATE_ITEMEFFECT_LUA_000850")
				Notice(name..CALCULATE_ITEMEFFECT_LUA_000850)
				AddState(role , role , STATE_JLTX6 , 1 , 300 )
				return	
			
			elseif getrandom > 304 and getrandom <= 324 then					-------------------------------难度不大，但是皮很厚的经验boss
				local x, y = GetChaPos(role)
				local Refresh = 6000000					--重生时间，秒单位
				local life = 5900000000					--生命时间，毫秒单位
				if Lv > 40 and Lv <= 45 then
					local MonsterID = 1152		--40经验肉boss的ID
					local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x+4000 , y , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x , y+4000 , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x-4000 , y , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x , y-4000 , 145 , Refresh, role )
					--SetChaHost(new,role)
					SetChaLifeTime( new, life )
					--SetChaTarget(new, role)
					CALCULATE_ITEMEFFECT_LUA_000851 = GetResString("CALCULATE_ITEMEFFECT_LUA_000851")
					CALCULATE_ITEMEFFECT_LUA_000852 = GetResString("CALCULATE_ITEMEFFECT_LUA_000852")
					ScrollNotice ( name..CALCULATE_ITEMEFFECT_LUA_000852..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000851 ,1)
					CALCULATE_ITEMEFFECT_LUA_000851 = GetResString("CALCULATE_ITEMEFFECT_LUA_000851")
					CALCULATE_ITEMEFFECT_LUA_000852 = GetResString("CALCULATE_ITEMEFFECT_LUA_000852")
					Notice ( name..CALCULATE_ITEMEFFECT_LUA_000852..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000851)
					return	
				elseif Lv > 45 and Lv <= 50 then
					local MonsterID = 1153		--45经验肉boss的ID
					local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x+4000 , y , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x , y+4000 , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x-4000 , y , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x , y-4000 , 145 , Refresh, role )
					--SetChaHost(new,role)
					SetChaLifeTime( new, life )
					--SetChaTarget(new, role)
					CALCULATE_ITEMEFFECT_LUA_000851 = GetResString("CALCULATE_ITEMEFFECT_LUA_000851")
					CALCULATE_ITEMEFFECT_LUA_000852 = GetResString("CALCULATE_ITEMEFFECT_LUA_000852")
					ScrollNotice ( name..CALCULATE_ITEMEFFECT_LUA_000852..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000851 ,1)
					CALCULATE_ITEMEFFECT_LUA_000851 = GetResString("CALCULATE_ITEMEFFECT_LUA_000851")
					CALCULATE_ITEMEFFECT_LUA_000852 = GetResString("CALCULATE_ITEMEFFECT_LUA_000852")
					Notice ( name..CALCULATE_ITEMEFFECT_LUA_000852..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000851)
					return	
				elseif Lv > 50 and Lv <= 55 then
					local MonsterID = 1154		--50经验肉boss的ID
					local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x+4000 , y , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x , y+4000 , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x-4000 , y , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x , y-4000 , 145 , Refresh, role )
					--SetChaHost(new,role)
					SetChaLifeTime( new, life )
					--SetChaTarget(new, role)
					CALCULATE_ITEMEFFECT_LUA_000851 = GetResString("CALCULATE_ITEMEFFECT_LUA_000851")
					CALCULATE_ITEMEFFECT_LUA_000852 = GetResString("CALCULATE_ITEMEFFECT_LUA_000852")
					ScrollNotice ( name..CALCULATE_ITEMEFFECT_LUA_000852..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000851 ,1)
					CALCULATE_ITEMEFFECT_LUA_000851 = GetResString("CALCULATE_ITEMEFFECT_LUA_000851")
					CALCULATE_ITEMEFFECT_LUA_000852 = GetResString("CALCULATE_ITEMEFFECT_LUA_000852")
					Notice ( name..CALCULATE_ITEMEFFECT_LUA_000852..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000851)
					return	
				elseif Lv > 55 and Lv <= 60 then
					local MonsterID = 1155		--55经验肉boss的ID
					local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x+4000 , y , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x , y+4000 , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x-4000 , y , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x , y-4000 , 145 , Refresh, role )
					--SetChaHost(new,role)
					SetChaLifeTime( new, life )
					--SetChaTarget(new, role)
					CALCULATE_ITEMEFFECT_LUA_000851 = GetResString("CALCULATE_ITEMEFFECT_LUA_000851")
					CALCULATE_ITEMEFFECT_LUA_000852 = GetResString("CALCULATE_ITEMEFFECT_LUA_000852")
					ScrollNotice ( name..CALCULATE_ITEMEFFECT_LUA_000852..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000851 ,1)
					CALCULATE_ITEMEFFECT_LUA_000851 = GetResString("CALCULATE_ITEMEFFECT_LUA_000851")
					CALCULATE_ITEMEFFECT_LUA_000852 = GetResString("CALCULATE_ITEMEFFECT_LUA_000852")
					Notice ( name..CALCULATE_ITEMEFFECT_LUA_000852..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000851)
					return		
				elseif Lv > 60 and Lv <= 65 then
					local MonsterID = 1156		--60经验肉boss的ID
					local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x+4000 , y , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x , y+4000 , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x-4000 , y , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x , y-4000 , 145 , Refresh, role )
					--SetChaHost(new,role)
					SetChaLifeTime( new, life )
					--SetChaTarget(new, role)
					CALCULATE_ITEMEFFECT_LUA_000851 = GetResString("CALCULATE_ITEMEFFECT_LUA_000851")
					CALCULATE_ITEMEFFECT_LUA_000852 = GetResString("CALCULATE_ITEMEFFECT_LUA_000852")
					ScrollNotice ( name..CALCULATE_ITEMEFFECT_LUA_000852..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000851 ,1)
					CALCULATE_ITEMEFFECT_LUA_000851 = GetResString("CALCULATE_ITEMEFFECT_LUA_000851")
					CALCULATE_ITEMEFFECT_LUA_000852 = GetResString("CALCULATE_ITEMEFFECT_LUA_000852")
					Notice ( name..CALCULATE_ITEMEFFECT_LUA_000852..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000851)
					return	
				elseif Lv > 65 and Lv <= 70 then
					local MonsterID = 1157		--65经验肉boss的ID
					local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x+4000 , y , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x , y+4000 , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x-4000 , y , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x , y-4000 , 145 , Refresh, role )
					--SetChaHost(new,role)
					SetChaLifeTime( new, life )
					--SetChaTarget(new, role)
					CALCULATE_ITEMEFFECT_LUA_000851 = GetResString("CALCULATE_ITEMEFFECT_LUA_000851")
					CALCULATE_ITEMEFFECT_LUA_000853 = GetResString("CALCULATE_ITEMEFFECT_LUA_000853")
					ScrollNotice ( name..CALCULATE_ITEMEFFECT_LUA_000853..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000851 ,1)
					CALCULATE_ITEMEFFECT_LUA_000851 = GetResString("CALCULATE_ITEMEFFECT_LUA_000851")
					CALCULATE_ITEMEFFECT_LUA_000853 = GetResString("CALCULATE_ITEMEFFECT_LUA_000853")
					Notice ( name..CALCULATE_ITEMEFFECT_LUA_000853..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000851)
					return		
				elseif Lv > 70  then
					local MonsterID = 1158		--70经验肉boss的ID
					local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x+4000 , y , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x , y+4000 , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x-4000 , y , 145 , Refresh, role )
					local new = CreateChaX( MonsterID , x , y-4000 , 145 , Refresh, role )
					--SetChaHost(new,role)
					SetChaLifeTime( new, life )
					--SetChaTarget(new, role)
					CALCULATE_ITEMEFFECT_LUA_000854 = GetResString("CALCULATE_ITEMEFFECT_LUA_000854")
					CALCULATE_ITEMEFFECT_LUA_000853 = GetResString("CALCULATE_ITEMEFFECT_LUA_000853")
					ScrollNotice ( name..CALCULATE_ITEMEFFECT_LUA_000853..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000854 ,1)
					CALCULATE_ITEMEFFECT_LUA_000851 = GetResString("CALCULATE_ITEMEFFECT_LUA_000851")
					CALCULATE_ITEMEFFECT_LUA_000853 = GetResString("CALCULATE_ITEMEFFECT_LUA_000853")
					Notice ( name..CALCULATE_ITEMEFFECT_LUA_000853..math.floor(x/100)..","..math.floor(y/100)..CALCULATE_ITEMEFFECT_LUA_000851)
					return	
				end	
			elseif getrandom > 324 and getrandom <= 328 then					-------------------------------获得用来换取75BB装的组件
				local part_of_boss_item = math.random( 1,3 )
				CALCULATE_ITEMEFFECT_LUA_000855 = GetResString("CALCULATE_ITEMEFFECT_LUA_000855")
				SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000855 )
				CALCULATE_ITEMEFFECT_LUA_000856 = GetResString("CALCULATE_ITEMEFFECT_LUA_000856")
				ScrollNotice ( name..CALCULATE_ITEMEFFECT_LUA_000856 ,1)
				if part_of_boss_item ==	1 then
					GiveItem ( role , 0 , 6344 , 1 , 4  )
					return
				elseif part_of_boss_item == 2 then
					GiveItem ( role , 0 , 6345 , 1 , 4  )
					return
				else
					GiveItem ( role , 0 , 6346 , 1 , 4  )
					return
				end		
			elseif getrandom > 328 and getrandom <= 400 then	               -------------------传送至命运房间
				RemoveChaItem( role , 6343 , 1 , 2 , -1 , 2 , 1 )
				CALCULATE_ITEMEFFECT_LUA_000857 = GetResString("CALCULATE_ITEMEFFECT_LUA_000857")
				CALCULATE_ITEMEFFECT_LUA_000858 = GetResString("CALCULATE_ITEMEFFECT_LUA_000858")
				ScrollNotice (CALCULATE_ITEMEFFECT_LUA_000858..name..CALCULATE_ITEMEFFECT_LUA_000857 , 1)
				CALCULATE_ITEMEFFECT_LUA_000859 = GetResString("CALCULATE_ITEMEFFECT_LUA_000859")
				SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000859 )
				MoveTo( role ,50,50,"mingyun")				
				return
			
			end
		end	
	end
end



--给40级藏宝图随机分配坐标（by 刘博颋）
function GetTheMapPos_40 ( role , type )
	-- SystemNotice( role ,"GetTheMapPos" )

	local Pos_Map = 3
	-- SystemNotice ( role , "Pos_Map"..Pos_Map )

	local Pos_X = math.random ( 2207 , 2278 )
	-- SystemNotice ( role , "Pos_X"..Pos_X )
	local Pos_Y = math.random ( 492 , 645 )
	-- SystemNotice ( role , "Pos_Y"..Pos_Y )
	
	return Pos_X , Pos_Y , Pos_Map
end

--给45级藏宝图随机分配坐标（by 刘博颋）
function GetTheMapPos_45 ( role , type )
--	SystemNotice( role ,"GetTheMapPos" )

	local Pos_Map = 3
--	SystemNotice ( role , "Pos_Map"..Pos_Map )

	local Pos_X = math.random ( 2519 , 2657 )
--	SystemNotice ( role , "Pos_X"..Pos_X )
	local Pos_Y = math.random ( 474 , 586 )
--	SystemNotice ( role , "Pos_Y"..Pos_Y )
	
	return Pos_X , Pos_Y , Pos_Map
end

--给50级藏宝图随机分配坐标（by 刘博颋）
function GetTheMapPos_50 ( role , type )
--	SystemNotice( role ,"GetTheMapPos" )

	local Pos_Map = 3
--	SystemNotice ( role , "Pos_Map"..Pos_Map )

	local Pos_X = math.random ( 2862 , 2891 )
--	SystemNotice ( role , "Pos_X"..Pos_X )
	local Pos_Y = math.random ( 634 , 704 )
--	SystemNotice ( role , "Pos_Y"..Pos_Y )
	
	return Pos_X , Pos_Y , Pos_Map
end

--给55级藏宝图随机分配坐标（by 刘博颋）
function GetTheMapPos_55 ( role , type )
--	SystemNotice( role ,"GetTheMapPos" )

	local Pos_Map = 3
--	SystemNotice ( role , "Pos_Map"..Pos_Map )

	local Pos_X = math.random ( 2541 , 2595 )
--	SystemNotice ( role , "Pos_X"..Pos_X )
	local Pos_Y = math.random ( 771 , 858 )
--	SystemNotice ( role , "Pos_Y"..Pos_Y )
	
	return Pos_X , Pos_Y , Pos_Map
end

--给60级藏宝图随机分配坐标（by 刘博颋）
function GetTheMapPos_60 ( role , type )
--	SystemNotice( role ,"GetTheMapPos" )

	local Pos_Map = 3
--	SystemNotice ( role , "Pos_Map"..Pos_Map )

	local Pos_X = math.random ( 2541 , 2642 )
--	SystemNotice ( role , "Pos_X"..Pos_X )
	local Pos_Y = math.random ( 867 , 926 )
--	SystemNotice ( role , "Pos_Y"..Pos_Y )
	
	return Pos_X , Pos_Y , Pos_Map
end

--给65级藏宝图随机分配坐标（by 刘博颋）
function GetTheMapPos_65 ( role , type )
--	SystemNotice( role ,"GetTheMapPos" )

	local Pos_Map = 1
--	SystemNotice ( role , "Pos_Map"..Pos_Map )

	local Pos_X = math.random ( 323 , 393 )
--	SystemNotice ( role , "Pos_X"..Pos_X )
	local Pos_Y = math.random ( 1314 , 1392 )
--	SystemNotice ( role , "Pos_Y"..Pos_Y )
	
	return Pos_X , Pos_Y , Pos_Map
end

--给70级藏宝图随机分配坐标（by 刘博颋）
function GetTheMapPos_70 ( role , type )
--	SystemNotice( role ,"GetTheMapPos" )

	local Pos_Map = 1
--	SystemNotice ( role , "Pos_Map"..Pos_Map )

	local Pos_X = math.random ( 387 , 494 )
--	SystemNotice ( role , "Pos_X"..Pos_X )
	local Pos_Y = math.random ( 2056 , 2137 )
--	SystemNotice ( role , "Pos_Y"..Pos_Y )
	
	return Pos_X , Pos_Y , Pos_Map
end






--------------------------海盗雏鹰宝箱--------------------

function ItemUse_CYBOX( role , Item )

	-- local Cha_Boat = 0
	-- Cha_Boat = GetCtrlBoat ( role )
	-- if Cha_Boat ~= nil then 
		-- CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		-- SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		-- UseItemFailed ( role ) 
		-- return 
	-- end      
	-- local job = GetChaAttr(role, ATTR_JOB)
	-- local Item_CanGet = GetChaFreeBagGridNum ( role )
	-- if Item_CanGet < 4 then
		-- CALCULATE_ITEMEFFECT_LUA_000860 = GetResString("CALCULATE_ITEMEFFECT_LUA_000860")
		-- SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000860)
		-- UseItemFailed ( role )
		-- return
	-- end 
		-- GiveItem ( role , 0 , 6020 , 1 , 95 )-----------------炎飒封印的暗影披风
		-- GiveItem ( role , 0 , 6022  , 1 , 4 )------------暗影披风解封说明书
		-- GiveItem ( role , 0 , 6005  , 1 , 4 )--------------海盗师徒宝箱
		-- GiveItem ( role , 0 , 6051  , 1 , 4 )--------------新手技能书	
		-- GiveItem ( role , 0 , 0985  , 1 , 4 )----------------35至尊豪礼
		
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
	
		UseItemFailed ( role ) 
		return 
	end      
	local job = GetChaAttr(role, ATTR_JOB)
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 11 then
		SystemNotice(role ,"You need 11 inventory space to open")
		UseItemFailed ( role )
		return
	end 
		GiveItem ( role , 0 , 6020 , 1 , 95 )-----------------炎飒封印的暗影披风
		GiveItem ( role , 0 , 6022  , 1 , 4 )------------暗影披风解封说明书
		GiveItem ( role , 0 , 6005  , 1 , 4 )--------------海盗师徒宝箱
		GiveItem ( role , 0 , 6051  , 1 , 4 )--------------新手技能书
		--GiveItem ( role , 0 , 0985  , 1 , 4 )--------------35至尊豪礼
		--GiveItem ( role , 0 , 7167  , 1 , 4 )----豪华大礼包~~
		--GiveItem ( role , 0 , 8019  , 1 , 4 )----9J新新宝盒
		--GiveItem ( role , 0 , 8474 , 1 , 31 )-----------------街头恋曲酷装盒
		--GiveItem ( role , 0 , 6407  , 99 , 31 )--------------馒头*99
		--GiveItem ( role , 0 , 6408  , 99 , 31 )--------------SP神仙水*99
		--GiveItem ( role , 0 , 5616  , 10 , 31 )--------------新手十倍经验果*10
		--GiveItem ( role , 0 , 7573  , 1 , 22 )--------------V5之躯
		
		
		
		
	end
		
		
-----------------海盗宠宠宝箱-----------------------
function ItemUse_CCBOX( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end      
	local job = GetChaAttr(role, ATTR_JOB)
	local lv = GetChaAttr(role, ATTR_LV) 
    local cha_type = GetChaTypeID ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 6 then
		CALCULATE_ITEMEFFECT_LUA_000861 = GetResString("CALCULATE_ITEMEFFECT_LUA_000861")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000861)
		UseItemFailed ( role )
		return
	end 
		if lv < 11 then
		CALCULATE_ITEMEFFECT_LUA_000862 = GetResString("CALCULATE_ITEMEFFECT_LUA_000862")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000862)
		UseItemFailed ( role )	
	else
		GiveItem( role , 0 , 262 , 1 , 4)----------------精灵礼品宝箱
		GiveItem( role , 0 , 6580 , 3 , 4 )----------白银城果脯
		GiveItem( role , 0 , 6015 , 5 , 4 )-------------特制精灵饲料
		--GiveItem( role , 0 , 6025 , 1 , 4 )-------------精灵养成须知
		GiveItem( role , 0 , 6004 , 1 , 4 )-------------海盗扬帆宝箱
		GiveItem ( role , 0 , 1130  , 1 , 4 )--------------精灵技能书-白痴
		GiveItem ( role , 0 , 1037  , 1 , 4 )--------------精灵技能书-大便			
		--GiveItem( role , 0 , 6026 , 1 , 4 )-------------一转说明书
		--GiveItem ( role , 0 , 9  , 1 , 95 )
		--GiveItem ( role , 0 , 4308  , 1 , 95 )
		end 
	end
	
	
-------------------海盗交友宝箱-------------------
function ItemUse_FriendBOX( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end      
	local job = GetChaAttr(role, ATTR_JOB)
	local lv = GetChaAttr(role, ATTR_LV) 
    local cha_type = GetChaTypeID ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 3 then
		CALCULATE_ITEMEFFECT_LUA_000863 = GetResString("CALCULATE_ITEMEFFECT_LUA_000863")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000863)
		UseItemFailed ( role )
		return
	end 
	if lv < 10 then 
		CALCULATE_ITEMEFFECT_LUA_000102 = GetResString("CALCULATE_ITEMEFFECT_LUA_000102")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000102)
		UseItemFailed ( role )
	elseif job ==1  then
		if cha_type == 1 or cha_type == 2 then
		--GiveItem( role , 0 , 6014 , 1 , 4 ) --找朋友(女)
		GiveItem ( role , 0 , 10  , 1 , 95 ) 
		GiveItem ( role , 0 , 296  , 1 , 95 )
		GiveItem ( role , 0 , 6002  , 1 , 4 )----宠宠宝箱
		elseif cha_type == 3 then
		--GiveItem( role , 0 , 6041 , 1 , 4 ) --找朋友(女)
		GiveItem ( role , 0 , 10  , 1 , 95 ) 
		GiveItem ( role , 0 , 296  , 1 , 95 )
		GiveItem ( role , 0 , 6002  , 1 , 4 )----宠宠宝箱
		end
	elseif job == 2 then
		GiveItem ( role , 0 , 32  , 1 , 95 ) 
		GiveItem ( role , 0 , 311  , 1 , 95 )
		GiveItem ( role , 0 , 6002  , 1 , 4 )-----宠宠宝箱
	if cha_type == 1 then
		--GiveItem( role , 0 , 6014 , 1 , 4 ) --找朋友(女)
		else 
		--GiveItem( role , 0 , 6041 , 1 , 4 ) --找朋友(男)
		end
	elseif job== 4 then
		GiveItem ( role , 0 , 80  , 1 , 95 ) 
		GiveItem ( role , 0 , 6002  , 1 , 4 ) -----宠宠宝箱
		if cha_type == 1 then
		--GiveItem( role , 0 , 6014 , 1 , 4 ) --找朋友(女)
		GiveItem ( role , 0 , 336  , 1 , 95 ) 
			elseif cha_type == 3 then
		--GiveItem( role , 0 , 6041 , 1 , 4 ) --找朋友(男)
		GiveItem ( role , 0 , 336  , 1 , 95 )
			else
		--GiveItem( role , 0 , 6041 , 1 , 4 ) --找朋友(男)
		GiveItem ( role , 0 , 351  , 1 , 95 )
		end
	elseif job == 5 then
		--GiveItem( role , 0 , 6041 , 1 , 4 ) --找朋友(男)
		GiveItem ( role , 0 , 6002  , 1 , 4 )-----宠宠宝箱
		GiveItem ( role , 0 , 104  , 1 , 95 ) 
		if cha_type == 3 then 
			GiveItem ( role , 0 , 372  , 1 , 95 )
		else 
			GiveItem ( role , 0 , 359  , 1 , 95 ) 
		end
	else 
		CALCULATE_ITEMEFFECT_LUA_000864 = GetResString("CALCULATE_ITEMEFFECT_LUA_000864")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000864)
		UseItemFailed ( role )	
	end 
end 
	
	-------------------海盗扬帆宝箱-------------------
function ItemUse_YFBOX ( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end      
	local job = GetChaAttr(role, ATTR_JOB)
	local lv = GetChaAttr(role, ATTR_LV)
    local cha_type = GetChaTypeID ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 5 then
		CALCULATE_ITEMEFFECT_LUA_000865 = GetResString("CALCULATE_ITEMEFFECT_LUA_000865")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000865)
		UseItemFailed ( role )
		return
	end 
	if lv < 15 then
		CALCULATE_ITEMEFFECT_LUA_000110 = GetResString("CALCULATE_ITEMEFFECT_LUA_000110")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000110)
		UseItemFailed ( role )	
	elseif job== 1 then
		GiveItem( role , 0 , 6042 , 1 , 4 ) ---造船证明
		--GiveItem( role , 0 , 6043 , 1 , 4 ) --捕鱼任务介绍
		GiveItem( role , 0 , 6008 , 1 , 4 ) --海盗彩票宝箱
		GiveItem( role , 0 , 6038 , 1 , 4 )--新捕鱼技能书
		GiveItem ( role , 0 , 2 , 1 , 95 ) 
		GiveItem ( role , 0 , 291  , 1 , 95 )
	elseif job == 2 then
		GiveItem( role , 0 , 6042 , 1 , 4 ) ---造船证明
		--GiveItem( role , 0 , 6043 , 1 , 4 ) --捕鱼任务介绍
		GiveItem( role , 0 , 6008 , 1 , 4 )--海盗彩票宝箱
		GiveItem( role , 0 , 6038 , 1 , 4 )--新捕鱼技能书
		GiveItem ( role , 0 , 26  , 1 , 95 ) 
		GiveItem ( role , 0 , 306  , 1 , 95 )
	elseif job == 4 then
		GiveItem( role , 0 , 6042 , 1 , 4 ) ---造船证明
		--GiveItem( role , 0 , 6043 , 1 , 4 ) --捕鱼任务介绍
		GiveItem( role , 0 , 6008 , 1 , 4 )--海盗彩票宝箱
		GiveItem( role , 0 , 6038 , 1 , 4 )--新捕鱼技能书
		GiveItem ( role , 0 , 74  , 1 , 95 )  
	if cha_type == 1 or cha_type == 3 then 
		GiveItem ( role , 0 , 338  , 1 , 95 )
	else
		GiveItem ( role , 0 , 386  , 1 , 95 ) 
	end
		elseif job == 5 then
		GiveItem( role , 0 , 6042 , 1 , 4 ) ---造船证明
		--GiveItem( role , 0 , 6043 , 1 , 4 ) --捕鱼任务介绍
		GiveItem( role , 0 , 6008 , 1 , 4 )--海盗彩票宝箱
		GiveItem( role , 0 , 6038 , 1 , 4 )--新捕鱼技能书
		GiveItem ( role , 0 , 98 , 1 , 95 ) 
	if cha_type == 3 then
		GiveItem ( role , 0 , 366  , 1 , 95 ) 
		else
		GiveItem ( role , 0 , 381  , 1 , 95 )
		end
	else 
		CALCULATE_ITEMEFFECT_LUA_000864 = GetResString("CALCULATE_ITEMEFFECT_LUA_000864")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000864)
		UseItemFailed ( role )	
	end
end	


--------------------海盗拜师宝箱-------------------
function ItemUse_BSBOX( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end      
	local job = GetChaAttr(role, ATTR_JOB)
	local lv = GetChaAttr(role, ATTR_LV) 
    local cha_type = GetChaTypeID ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 3 then
		CALCULATE_ITEMEFFECT_LUA_000866 = GetResString("CALCULATE_ITEMEFFECT_LUA_000866")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000866)
		UseItemFailed ( role )
		return
	end
	if lv < 5 then 
		CALCULATE_ITEMEFFECT_LUA_000100 = GetResString("CALCULATE_ITEMEFFECT_LUA_000100")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000100)
		UseItemFailed ( role )	
	else
		--GiveItem( role , 0 , 6044 , 1 , 4 )--------海盗师徒系统介绍
		GiveItem( role , 0 , 6003 , 1 , 4 )-----------交友宝箱
		GiveItem( role , 0 , 6026 , 1 , 4 )-------------一转说明书
		GiveItem ( role , 0 , 9  , 1 , 95 )
		GiveItem ( role , 0 , 4308  , 1 , 95 )
	end 
end 


---------------------精炼宝箱---------------------
function ItemUse_JLBOX( role , Item )
	local Cha_Boat = 0
	
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end      
	local job = GetChaAttr(role, ATTR_JOB)
	local lv = GetChaAttr(role, ATTR_LV) 
    local cha_type = GetChaTypeID ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000867 = GetResString("CALCULATE_ITEMEFFECT_LUA_000867")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000867)
		UseItemFailed ( role )
		return
	end 
	if lv < 37 then 
		CALCULATE_ITEMEFFECT_LUA_000868 = GetResString("CALCULATE_ITEMEFFECT_LUA_000868")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000868)
		UseItemFailed ( role )	
	elseif job == 1 or job == 8 or job == 9 then  
		GiveItem( role , 0 , 6027 , 1 , 4 )--------精练 熔合 合成介绍
		--GiveItem( role , 0 , 6028 , 1 , 4 )-------海盗指南针指引
		GiveItem( role , 0 , 6011 , 1 , 4 )-------海盗二转宝箱
		--GiveItem( role , 0 , 453 , 1 , 4 )-------宝石熔合卷轴
		-- GiveItem ( role , 0 , 14  , 1 , 95 ) 
		-- GiveItem ( role , 0 , 297  , 1 , 95 )
		--GiveItem ( role , 0 , 6016 , 1 , 4 )------特制精练石
		if cha_type == 1 then 
			GiveItem( role , 0 , 5316 , 1 , 95 )------男一号酷装
		elseif  cha_type == 2 then
			GiveItem( role , 0 , 5320 , 1 , 95 ) ------男二号酷装
		elseif cha_type == 3 then
			GiveItem( role , 0 , 5324 , 1 , 95 )------女一酷装
			end
	elseif job == 2 or job == 12 then 
		GiveItem( role , 0 , 6027 , 1 , 4 )--------精练 熔合 合成介绍
		--GiveItem( role , 0 , 6028 , 1 , 4 )-------海盗指南针指引
		GiveItem( role , 0 , 6011 , 1 , 4 )-------海盗二转宝箱
		--GiveItem( role , 0 , 453 , 1 , 4 )-------宝石熔合卷轴
		-- GiveItem ( role , 0 , 33 , 1 , 95 ) 
		-- GiveItem ( role , 0 , 313  , 1 , 95 )
		--GiveItem ( role , 0 , 6016 , 1 , 4 )------特制精练石
		if cha_type == 3 then
			GiveItem( role , 0 , 5324 , 1 , 95 )------女一酷装
			else
			GiveItem( role , 0 , 5316 , 1 , 95 )------男一号酷装
		end
	elseif job == 4 or job == 16 then 
		GiveItem( role , 0 , 6027 , 1 , 4 )--------精练 熔合 合成介绍
		--GiveItem( role , 0 , 6028 , 1 , 4 )-------海盗指南针指引
		GiveItem( role , 0 , 6011 , 1 , 4 )-------海盗二转宝箱
		--GiveItem( role , 0 , 453 , 1 , 4 )-------宝石熔合卷轴
		-- GiveItem ( role , 0 , 81  , 1 , 95 ) 
		--GiveItem ( role , 0 , 6016 , 1 , 4 )------特制精练石
		if cha_type == 1  then 
			-- GiveItem ( role , 0 , 337  , 1 , 95 )
			GiveItem( role , 0 , 5316 , 1 , 95 )------男一号酷装
			elseif cha_type == 3 then
			-- GiveItem ( role , 0 , 337  , 1 , 95 )
			GiveItem( role , 0 , 5324 , 1 , 95 )------女一酷装
			else
			-- GiveItem ( role , 0 , 352  , 1 , 95 ) 
			GiveItem ( role , 0 , 5328 , 1 , 95 )---女二酷装
		end
	elseif job == 5 or job == 13 or job == 14 then  
		GiveItem( role , 0 , 6027 , 1 , 4 )--------精练 熔合 合成介绍
		GiveItem( role , 0 , 6028 , 1 , 4 )-------海盗指南针指引
		GiveItem( role , 0 , 6011 , 1 , 4 )-------海盗二转宝箱
		-- GiveItem ( role , 0 , 105  , 1 , 95 )
		--GiveItem ( role , 0 , 6016 , 1 , 4 )------特制精练石
		GiveItem( role , 0 , 453 , 1 , 4 )-------宝石熔合卷轴
		if cha_type == 3 then 
			-- GiveItem ( role , 0 , 373  , 1 , 95 )
			GiveItem( role , 0 , 5324 , 1 , 95 )------女一酷装
		else
			-- GiveItem ( role , 0 , 360  , 1 , 95 )
			GiveItem ( role , 0 , 5328 , 1 , 95 )
		end
	else 
		CALCULATE_ITEMEFFECT_LUA_000864 = GetResString("CALCULATE_ITEMEFFECT_LUA_000864")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000864)
		UseItemFailed ( role )	
	end 
end 


----------------海盗PK宝箱-----------------
function ItemUse_PKBOX( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end      
	local job = GetChaAttr(role, ATTR_JOB)
	local lv = GetChaAttr(role, ATTR_LV) 
    local cha_type = GetChaTypeID ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 3 then
		CALCULATE_ITEMEFFECT_LUA_000869 = GetResString("CALCULATE_ITEMEFFECT_LUA_000869")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000869)
		UseItemFailed ( role )
		return
	end 
	if lv < 25 then 
		CALCULATE_ITEMEFFECT_LUA_000112 = GetResString("CALCULATE_ITEMEFFECT_LUA_000112")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000112)
		UseItemFailed ( role )	
	elseif job == 1 then   ----剑士
		local r1,r2 =MakeItem ( role , 3  , 1 , 11 )
		local Item1 = GetChaItem ( role , 2 , r2 )		--取精炼武器道具指针
		--GiveItem(role , 0 , 6032 , 1 , 4 )---------酒吧PK介绍书
		--GiveItem(role , 0 , 6033 , 1 , 4 )---------PK指引
		GiveItem(role , 0 , 6009 , 1 , 4 )------------海盗迷宫宝箱
		GiveItem ( role , 0 , 293  , 1 , 95 )
	elseif job == 2 then  
		local r1,r2 =MakeItem ( role , 27  , 1 , 11 )
		local Item1 = GetChaItem ( role , 2 , r2 )			--取精炼武器道具指针
		--GiveItem(role , 0 , 6032 , 1 , 4 )---------酒吧PK介绍书
		--GiveItem(role , 0 , 6033 , 1 , 4 )---------PK指引
		GiveItem(role , 0 , 6009 , 1 , 4 )------------海盗迷宫宝箱
		GiveItem ( role , 0 , 307  , 1 , 95 )
	elseif job == 4 then 
		local r1,r2 =MakeItem ( role , 75  , 1 , 11 )
		--GiveItem(role , 0 , 6032 , 1 , 4 )---------酒吧PK介绍书
		--GiveItem(role , 0 , 6033 , 1 , 4 )---------PK指引
		GiveItem(role , 0 , 6009 , 1 , 4 )------------海盗迷宫宝箱
		local Item1 = GetChaItem ( role , 2 , r2 )			--取精炼武器道具指针
		if cha_type == 1 or cha_type == 3 then
			GiveItem ( role , 0 , 340  , 1 , 95 ) 
		else
			GiveItem ( role , 0 , 350  , 1 , 95 ) 
		end
	elseif job == 5 then 
		--GiveItem(role , 0 , 6032 , 1 , 4 )---------酒吧PK介绍书
		--GiveItem(role , 0 , 6033 , 1 , 4 )---------PK指引
		GiveItem(role , 0 , 6009 , 1 , 4 )------------海盗迷宫宝箱
		local r1,r2 =MakeItem ( role , 99  , 1 , 11 )
		local Item1 = GetChaItem ( role , 2 , r2 )			--取精炼武器道具指针
		if cha_type == 3 then
			GiveItem ( role , 0 , 368  , 1 , 95 )
		else 
			GiveItem ( role , 0 , 389  , 1 , 95 )
		end
	else 
		CALCULATE_ITEMEFFECT_LUA_000864 = GetResString("CALCULATE_ITEMEFFECT_LUA_000864")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000864)
		UseItemFailed ( role )	
	end
end

-----------------海盗王迷宫宝箱--------------
function ItemUse_MGBOX( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end      
	local job = GetChaAttr(role, ATTR_JOB)
	local lv = GetChaAttr(role, ATTR_LV) 
    local cha_type = GetChaTypeID ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 6 then
		CALCULATE_ITEMEFFECT_LUA_000870 = GetResString("CALCULATE_ITEMEFFECT_LUA_000870")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000870)
		UseItemFailed ( role )
		return
	end 
	if lv < 30 or job == 0 then 
		CALCULATE_ITEMEFFECT_LUA_000113 = GetResString("CALCULATE_ITEMEFFECT_LUA_000113")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000113)
		UseItemFailed ( role )	
	elseif job == 1 then  
		GiveItem( role , 0 , 6035 , 1 , 4 ) ------------海盗三大迷宫介绍书
		--GiveItem( role , 0 , 6045 , 1 , 4 )-----------废灵迷宫探索引导
		GiveItem( role , 0 , 6010 , 1 , 4 )-----------海盗混战宝箱
		GiveItem ( role , 0 , 12  , 1 , 95 ) 
		GiveItem ( role , 0 , 298  , 1 , 95 )
		--GiveItem ( role , 0 , 3909  , 8 , 95 )--------食神水饺
		--GiveItem ( role , 0 , 3098  , 9 , 95 )	-----------	强力体力恢复剂
	elseif job == 2 then 
		GiveItem( role , 0 , 6035 , 1 , 4 ) ------------海盗三大迷宫介绍书
		--GiveItem( role , 0 , 6045 , 1 , 4 )-----------废灵迷宫探索引导
		GiveItem( role , 0 , 6010 , 1 , 4 )-----------海盗混战宝箱
		GiveItem ( role , 0 , 34  , 1 , 95 ) 
		GiveItem ( role , 0 , 314  , 1 , 95 )
		--GiveItem ( role , 0 , 3909  , 8 , 95 )--------食神水饺
		--GiveItem ( role , 0 , 3098  , 9 , 95 )	-----------	强力体力恢复剂		
	elseif job == 4 then  
		GiveItem( role , 0 , 6035 , 1 , 4 ) ------------海盗三大迷宫介绍书
		--GiveItem( role , 0 , 6045 , 1 , 4 )-----------废灵迷宫探索引导
		GiveItem( role , 0 , 6010 , 1 , 4 )-----------海盗混战宝箱
		GiveItem ( role , 0 , 82  , 1 , 95 )
		--GiveItem ( role , 0 , 3909  , 8 , 95 )--------食神水饺
		--GiveItem ( role , 0 , 3098  , 9 , 95 )	-----------	强力体力恢复剂		
		if cha_type == 1 or cha_type == 3 then 
			GiveItem ( role , 0 , 339  , 1 , 95 )
		else 
			GiveItem ( role , 0 , 354  , 1 , 95 ) 
		end
	elseif job == 5 then
		GiveItem( role , 0 , 6035 , 1 , 4 ) ------------海盗三大迷宫介绍书
		--GiveItem( role , 0 , 6045 , 1 , 4 )-----------废灵迷宫探索引导
		GiveItem( role , 0 , 6010 , 1 , 4 )-----------海盗混战宝箱
		GiveItem ( role , 0 , 106  , 1 , 95 )
		--GiveItem ( role , 0 , 3909  , 8 , 95 )--------食神水饺
		--GiveItem ( role , 0 , 3098  , 9 , 95 )	-----------	强力体力恢复剂		
		if cha_type == 3 then
			GiveItem ( role , 0 , 374  , 1 , 95 )
		else 
			GiveItem ( role , 0 , 361  , 1 , 95 )
		end
	else 
		CALCULATE_ITEMEFFECT_LUA_000864 = GetResString("CALCULATE_ITEMEFFECT_LUA_000864")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000864)
		UseItemFailed ( role )	
	end
end

-------海盗混战宝箱----------
function ItemUse_HZBOX( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end      
	local job = GetChaAttr(role, ATTR_JOB)
	local lv = GetChaAttr(role, ATTR_LV) 
    local cha_type = GetChaTypeID ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 3 then
		CALCULATE_ITEMEFFECT_LUA_000871 = GetResString("CALCULATE_ITEMEFFECT_LUA_000871")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000871)
		UseItemFailed ( role )
		return
	end 
	if lv < 35 then 
		CALCULATE_ITEMEFFECT_LUA_000104 = GetResString("CALCULATE_ITEMEFFECT_LUA_000104")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000104)
		UseItemFailed ( role )	
	else
		GiveItem ( role , 0 , 6046  , 1 , 4 )------------新增自由PK区域介绍
		--GiveItem ( role , 0 , 6047  , 1 , 4 )----------------海盗王混战指引
		GiveItem ( role , 0 , 6006  , 1 , 4 )----------海盗精炼宝箱
		GiveItem( role , 0 , 451 , 1 , 4 )
	end
end
	
------------海盗二转宝箱-----
function ItemUse_EZBOX( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end      
	local job = GetChaAttr(role, ATTR_JOB)
	local lv = GetChaAttr(role, ATTR_LV) 
    local cha_type = GetChaTypeID ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 4 then
		CALCULATE_ITEMEFFECT_LUA_000872 = GetResString("CALCULATE_ITEMEFFECT_LUA_000872")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000872)
		UseItemFailed ( role )
		return
	end 
	if lv < 40 then 
		CALCULATE_ITEMEFFECT_LUA_000115 = GetResString("CALCULATE_ITEMEFFECT_LUA_000115")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000115)
		UseItemFailed ( role )	
	end 
	if job == 8 then
		GiveItem( role , 0 , 15 , 1 , 95 )
		GiveItem( role , 0 , 6013 , 1 , 4 )-------收徒宝箱
		GiveItem( role , 0 , 1932 , 1 , 95 )
		--GiveItem( role , 0 , 5707 , 1 , 4 )	-----乾坤锦囊	
	elseif job == 9 then
		GiveItem( role , 0 , 4 , 1 , 95 )
		GiveItem( role , 0 , 6013 , 1 , 4 )-------收徒宝箱
		GiveItem( role , 0 , 1929 , 1 , 95 )
		--GiveItem( role , 0 , 5707 , 1 , 4 )
	elseif job == 12 then
		GiveItem( role , 0 , 39 , 1 , 95 )
		GiveItem( role , 0 , 6013 , 1 , 4 )-------收徒宝箱
		GiveItem( role , 0 , 1944 , 1 , 95 )
		--GiveItem( role , 0 , 5707 , 1 , 4 )
	elseif job == 13 then 
		GiveItem( role , 0 , 100 , 1 , 95 )
		GiveItem( role , 0 , 6013 , 1 , 4 )-------收徒宝箱
		GiveItem( role , 0 , 1959 , 1 , 95 )
		--GiveItem( role , 0 , 5707 , 1 , 4 )
	elseif job == 14 then
		GiveItem( role , 0 , 101 , 1 , 95 )
		GiveItem( role , 0 , 6013 , 1 , 4 )-------收徒宝箱
		GiveItem( role , 0 , 1956 , 1 , 95 )
		--GiveItem( role , 0 , 5707 , 1 , 4 )
	elseif job == 16 then
		GiveItem( role , 0 , 76 , 1 , 95 )
		GiveItem( role , 0 , 6013 , 1 , 4 )-------收徒宝箱
		GiveItem( role , 0 , 1977 , 1 , 95 )
		--GiveItem( role , 0 , 5707 , 1 , 4 )
	else 
		CALCULATE_ITEMEFFECT_LUA_000873 = GetResString("CALCULATE_ITEMEFFECT_LUA_000873")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000873)
		UseItemFailed ( role )	
	end
end 


-------------海盗收徒宝箱------------
function ItemUse_STBOX( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end      
	local job = GetChaAttr(role, ATTR_JOB)
	local lv = GetChaAttr(role, ATTR_LV) 
	local Item_CanGet = GetChaFreeBagGridNum ( role )
		if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000874 = GetResString("CALCULATE_ITEMEFFECT_LUA_000874")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000874)
		UseItemFailed ( role )
		return
	end 
	if lv < 41 or job == 0 or job == 1 or job == 2 or job == 4 or job == 5 then 
		CALCULATE_ITEMEFFECT_LUA_000875 = GetResString("CALCULATE_ITEMEFFECT_LUA_000875")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000875)
		UseItemFailed ( role )	
	else
		--GiveItem( role , 0 , 6048 , 1 , 4 )------收徒贴
		GiveItem( role , 0 , 6013 , 1 , 4 )----海盗圣战宝箱
	end
end

-----------------海盗圣战宝箱-------------
function ItemUse_SZBOX( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end      
	local job = GetChaAttr(role, ATTR_JOB)
	local lv = GetChaAttr(role, ATTR_LV) 
        local cha_type = GetChaTypeID ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 4 then
		CALCULATE_ITEMEFFECT_LUA_000876 = GetResString("CALCULATE_ITEMEFFECT_LUA_000876")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000876)
		UseItemFailed ( role )
		return
	end
	if lv < 45 or job == 0 or job == 1 or job == 2 or job == 4 or job == 5 then
		CALCULATE_ITEMEFFECT_LUA_000877 = GetResString("CALCULATE_ITEMEFFECT_LUA_000877")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000877)
		UseItemFailed ( role )	
	elseif job == 9 then 
		GiveItem( role , 0 , 6050 , 1 , 4 )------圣战介绍
		GiveItem( role , 0 , 6036 , 1 , 4 )-------圣战引导图
		--GiveItem ( role , 0 , 295  , 1 , 95 )
		--GiveItem ( role , 0 , 4  , 1 , 95 ) 
		GiveItem ( role , 0 , 302  , 1 , 95 )
		local r1,r2 =MakeItem ( role , 22  , 1 , 11 )
		local Item1 = GetChaItem ( role , 2 , r2 )			--取精炼武器道具指针
	elseif job == 8 then   
		GiveItem( role , 0 , 6050 , 1 , 4 )------圣战介绍
		GiveItem( role , 0 , 6036 , 1 , 4 )-------圣战引导图
		--GiveItem ( role , 0 , 300  , 1 , 95 )
		--GiveItem ( role , 0 , 15  , 1 , 95 ) 
		GiveItem ( role , 0 , 301  , 1 , 95 )
		local r1,r2 =MakeItem ( role , 20  , 1 , 11 )
		local Item1 = GetChaItem ( role , 2 , r2 )			--取精炼武器道具指针
	elseif job == 12 then
		GiveItem( role , 0 , 6050 , 1 , 4 )------圣战介绍
		GiveItem( role , 0 , 6036 , 1 , 4 )-------圣战引导图
		--GiveItem ( role , 0 , 39  , 1 , 95 ) 
		--GiveItem ( role , 0 , 310  , 1 , 95 )
		local r1,r2 =MakeItem ( role , 44  , 1 , 11 )
		local Item1 = GetChaItem ( role , 2 , r2 )			--取精炼武器道具指针
		GiveItem ( role , 0 , 315  , 1 , 95 )
	
	elseif job == 16 then
		GiveItem( role , 0 , 6050 , 1 , 4 )------圣战介绍
		GiveItem( role , 0 , 6036 , 1 , 4 )-------圣战引导图
		--GiveItem ( role , 0 , 76  , 1 , 95 ) 
		local r1,r2 =MakeItem ( role , 83  , 1 , 11 )
		local Item1 = GetChaItem ( role , 2 , r2 )			--取精炼武器道具指针
		if cha_type == 1 or cha_type == 3 then
			--GiveItem ( role , 0 , 341  , 1 , 95 )	
			GiveItem ( role , 0 , 342  , 1 , 95 )
		else 
			--GiveItem ( role , 0 , 353  , 1 , 95 )
			GiveItem ( role , 0 , 356  , 1 , 95 )
		end
	elseif job == 13 then
		GiveItem( role , 0 , 6050 , 1 , 4 )------圣战介绍
		GiveItem( role , 0 , 6036 , 1 , 4 )-------圣战引导图	
		--GiveItem ( role , 0 , 100  , 1 , 95 )
		local r1,r2 =MakeItem ( role , 1440  , 1 , 11 )
		local Item1 = GetChaItem ( role , 2 , r2 )			--取精炼武器道具指针
		if cha_type == 3 then 
			--GiveItem ( role , 0 , 370  , 1 , 95 )
			GiveItem ( role , 0 , 378  , 1 , 95 )
		else 
			--GiveItem ( role , 0 , 392  , 1 , 95 ) 
			GiveItem ( role , 0 , 388  , 1 , 95 ) 
		end
	elseif job == 14 then   
		GiveItem( role , 0 , 6050 , 1 , 4 )------圣战介绍
		GiveItem( role , 0 , 6036 , 1 , 4 )-------圣战引导图
		--GiveItem ( role , 0 , 101  , 1 , 95 ) 
		local r1,r2 =MakeItem ( role , 107  , 1 , 11 )
		local Item1 = GetChaItem ( role , 2 , r2 )			--取精炼武器道具指针
		if cha_type == 3 then 
			--GiveItem ( role , 0 , 367  , 1 , 95 ) 
			GiveItem ( role , 0 , 375  , 1 , 95 ) 
		else  
			--GiveItem ( role , 0 , 390  , 1 , 95 ) 
			GiveItem ( role , 0 , 362  , 1 , 95 ) 
		
		end
	end
end

--------------找朋友-女-------------
function ItemUse_ZhaoGirl( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end      
	-- local Item_CanGet = GetChaFreeBagGridNum ( role )
	-- if Item_CanGet < 1 then
		-- SystemNotice(role ,"要打开找朋友需要背包里至少有1个空位")
		-- UseItemFailed ( role )
		-- return
	-- end
	local lv = GetChaAttr(role, ATTR_LV) 
	local cha_type = GetChaTypeID ( role )
	if lv < 7 or cha_type == 1 or cha_type == 2 then 
		CALCULATE_ITEMEFFECT_LUA_000878 = GetResString("CALCULATE_ITEMEFFECT_LUA_000878")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000878 )
		UseItemFailed( role )
	elseif cha_type == 3 or cha_type == 4 then
		local cha_name = GetChaDefaultName ( role )
		--GiveItem( role , 0 , 6037 , 1 , 4 )
		--GiveItem( role , 0 , 6017 , 1 , 4 )---双倍经验
		AddExpAll(role,10000,10000,1)
		CALCULATE_ITEMEFFECT_LUA_000879 = GetResString("CALCULATE_ITEMEFFECT_LUA_000879")
		ScrollNotice (cha_name..CALCULATE_ITEMEFFECT_LUA_000879 , 1)
	end
end

----------------找朋友-男-------------
function ItemUse_ZhaoBoy( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end      
	-- local Item_CanGet = GetChaFreeBagGridNum ( role )
	-- if Item_CanGet < 1 then
		-- SystemNotice(role ,"要打开找朋友需要背包里至少有1个空位")
		-- UseItemFailed ( role )
		-- return
	-- end
	local lv = GetChaAttr(role, ATTR_LV) 
	local cha_type = GetChaTypeID ( role )
	if lv < 7 or cha_type == 3 or cha_type == 4 then 
		CALCULATE_ITEMEFFECT_LUA_000880 = GetResString("CALCULATE_ITEMEFFECT_LUA_000880")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000880 )
		UseItemFailed( role )
	elseif cha_type == 1 or cha_type == 2 then
		--GiveItem( role , 0 , 6037 , 1 , 4 )
		--GiveItem( role , 0 , 6017 , 1 , 4 )---双倍经验
		AddExpAll(role,10000,10000,1)
		local cha_name = GetChaDefaultName ( role ) 
		CALCULATE_ITEMEFFECT_LUA_000879 = GetResString("CALCULATE_ITEMEFFECT_LUA_000879")
		ScrollNotice (cha_name..CALCULATE_ITEMEFFECT_LUA_000879 , 1)
	end
end

----------新捕鱼技能书-----------
function New_Sk_Script_By ( role , Item )  --技能捕鱼

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end      
	local sk_add = SK_BY         
	local form_sklv = GetSkillLv( role , sk_add ) 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 0 , 0 )  
	CALCULATE_ITEMEFFECT_LUA_000881 = GetResString("CALCULATE_ITEMEFFECT_LUA_000881")
	SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_000881)
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end


-----------求师表-----------
-- function ItemUse_SF( role ,Item )
	-- local Cha_Boat = 0
	-- Cha_Boat = GetCtrlBoat ( role )
	-- if Cha_Boat ~= nil then 
		-- SystemNotice( role , "出海时不可使用" ) 
		-- UseItemFailed ( role ) 
		-- return 
	-- end      
	-- local Item_CanGet = GetChaFreeBagGridNum ( role )
	-- if Item_CanGet < 2 then
		-- SystemNotice(role ,"要打开求师表需要背包里至少有2个空位")
		-- UseItemFailed ( role )
		-- return
	-- end
	-- local ret = HasMaster(role)
	-- if ret == LUA_TRUE then
		-- GiveItem( role , 0 , 6052 , 1 , 4 )------拜师证明
		-- AddMoney( role , 0 , 10000)
		--AddExpAll( role , 35500 , 35500 , 1 )
	-- elseif ret == LUA_FALSE then
		-- SystemNotice( role , "您必须要有师傅才能够打开哦" )
		-- UseItemFailed( role )
	-- end
-- end

----------收徒帖--------------
-- function ItemUse_TD( role , Item )
	-- local Cha_Boat = 0
	-- Cha_Boat = GetCtrlBoat ( role )
	-- if Cha_Boat ~= nil then 
		-- SystemNotice( role , "出海时不可使用" ) 
		-- UseItemFailed ( role ) 
		-- return 
	-- end
	-- local Item_CanGet = GetChaFreeBagGridNum ( role )
	-- if Item_CanGet < 2 then
		-- SystemNotice(role ,"要打开收徒贴需要背包里至少有2个空位")
		-- UseItemFailed ( role )
		-- return
	-- end
	-- local ret = HasMaster(role)
	-- if ret == LUA_TRUE then
		-- GiveItem( role , 0 , 6049 , 1 , 4 )
		-- GiveItem(role , 0 , 6017 , 5 , 4 )
	-- elseif ret == LUA_FALSE then
		-- SystemNotice( role , "您必须要有师傅才能够打开哦" )
		-- UseItemFailed( role )
	-- end
-- end

-----------特制精灵饲料---------------
function ItemUse_NewSiLiao( role , Item , Item_Traget)

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end      
		local Item_Traget_URE=GetItemAttr(Item_Traget,ITEMATTR_URE)  		--取当前耐久
		local Item_Traget_MAXURE=GetItemAttr(Item_Traget,ITEMATTR_MAXURE) 	--取最大耐久
		local Item_type = GetItemType ( Item )
		local Item_Traget_Type = GetItemType ( Item_Traget )
		local Num = 2500
		local str_Traget = GetItemAttr( Item_Traget ,ITEMATTR_VAL_STR )		--力量
		local con_Traget = GetItemAttr( Item_Traget ,ITEMATTR_VAL_CON )		--体质
		local agi_Traget = GetItemAttr( Item_Traget ,ITEMATTR_VAL_AGI )		--专注
		local dex_Traget = GetItemAttr( Item_Traget ,ITEMATTR_VAL_DEX )		--敏捷
		local sta_Traget = GetItemAttr( Item_Traget ,ITEMATTR_VAL_STA )		--精神
		local lv_Traget = str_Traget + con_Traget + agi_Traget + dex_Traget + sta_Traget  ----一个精灵的等级
		if lv_Traget > 3 then
					CALCULATE_ITEMEFFECT_LUA_000882 = GetResString("CALCULATE_ITEMEFFECT_LUA_000882")
					SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000882 ) 
					UseItemFailed ( role )
		elseif Item_type == 57 and Item_Traget_Type == 59 then
		
			if Item_Traget_URE < Item_Traget_MAXURE then
				   Give_ElfURE ( role , Item_Traget , Num )
   	 		else
                    CALCULATE_ITEMEFFECT_LUA_000081 = GetResString("CALCULATE_ITEMEFFECT_LUA_000081")
                    SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000081 ) 
					UseItemFailed ( role )
					return
			end
		end 
end


function ItemUse_CaiPiaoBOX(role,Item)  -----海盗彩票宝箱

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 5 then
		CALCULATE_ITEMEFFECT_LUA_000883 = GetResString("CALCULATE_ITEMEFFECT_LUA_000883")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000883)
		UseItemFailed ( role )
		return
	end
	local lv = GetChaAttr(role, ATTR_LV)
	local job = GetChaAttr(role, ATTR_JOB)
	if lv < 20 then 
		CALCULATE_ITEMEFFECT_LUA_000884 = GetResString("CALCULATE_ITEMEFFECT_LUA_000884")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000884 ) 
		UseItemFailed ( role ) 
		return
	end
	
	local cha_type = GetChaTypeID ( role )
	local job = GetChaAttr(role, ATTR_JOB)
	if job == 1 then  
		--AddMoney(role,50000,50000)
		GiveItem(role,0,6007,1,4)  ----海盗PK宝箱
		--GiveItem(role,0,3088,1,4)  ----24格升28格背包
		--GiveItem(role,0,3089,1,4)  ----28格升32格背包
		GiveItem ( role , 0 , 14  , 1 , 95 ) 
		GiveItem ( role , 0 , 297  , 1 , 95 )
	elseif job == 2 then 
		--AddMoney(role,50000,50000)
		GiveItem(role,0,6007,1,4)  ----海盗PK宝箱
		--GiveItem(role,0,3088,1,4)  ----24格升28格背包
		--GiveItem(role,0,3089,1,4)  ----28格升32格背包		
		GiveItem ( role , 0 , 33 , 1 , 95 ) 
		GiveItem ( role , 0 , 313  , 1 , 95 )
	elseif job == 4 then
		--AddMoney(role,50000,50000)
		GiveItem(role,0,6007,1,4)  ----海盗PK宝箱
		--GiveItem(role,0,3088,1,4)  ----24格升28格背包
		--GiveItem(role,0,3089,1,4)  ----28格升32格背包		
		GiveItem ( role , 0 , 81  , 1 , 95 ) 
		if cha_type == 1  then 
			GiveItem ( role , 0 , 337  , 1 , 95 )
			elseif cha_type == 3 then
			GiveItem ( role , 0 , 337  , 1 , 95 )
			else
			GiveItem ( role , 0 , 352  , 1 , 95 ) 
		end
	elseif job == 5 then 
		--AddMoney(role,50000,50000)
		GiveItem(role,0,6007,1,4)  ----海盗PK宝箱	
		--GiveItem(role,0,3088,1,4)  ----24格升28格背包
		--GiveItem(role,0,3089,1,4)  ----28格升32格背包		
		GiveItem ( role , 0 , 105  , 1 , 95 )
		if cha_type == 3 then 
			GiveItem ( role , 0 , 373  , 1 , 95 )
		else
			GiveItem ( role , 0 , 360  , 1 , 95 )
		end
	else 
		CALCULATE_ITEMEFFECT_LUA_000864 = GetResString("CALCULATE_ITEMEFFECT_LUA_000864")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000864)
		UseItemFailed ( role )	
	end 
end 
--海盗王2008挖宝60BOSS箱子----海盗宝藏箱子
--（0479镀银钢手套、0492斑鸠手套、0519飓风手套、0533大海虾手套、0539高级海獭手套、0552治疗者手套、0555祈愿手套、0567高级兔手套、0477重型钢手套、0655镀银钢靴、0668斑鸠靴、0695飓风靴、0709大海虾靴、0715高级海獭靴、0728治疗者靴、0731祈愿靴、0743高级兔靴、0653重型钢靴）
function ItemUse_WaBao_HDBZBox ( role , Item )	

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000885 = GetResString("CALCULATE_ITEMEFFECT_LUA_000885")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000885)
		UseItemFailed ( role )
		return
	end
	local getrandom = math.random ( 1 , 200 )
	if getrandom <= 10 then							----------55双剑士（蓝琦）手套
		CALCULATE_ITEMEFFECT_LUA_000886 = GetResString("CALCULATE_ITEMEFFECT_LUA_000886")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000886 )
		GiveItem ( role , 0 , 0479 , 1 , 22 ) 
		return
	elseif getrandom > 10 and getrandom <= 20  then		----------55狙击手（蓝琦、艾利尔）手套
		CALCULATE_ITEMEFFECT_LUA_000887 = GetResString("CALCULATE_ITEMEFFECT_LUA_000887")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000887 )
		GiveItem ( role , 0 , 0492 , 1 , 22 ) 
		return
	elseif getrandom > 20 and getrandom <= 30  then		----------55航海士（蓝琦、菲利尔）手套
		CALCULATE_ITEMEFFECT_LUA_000888 = GetResString("CALCULATE_ITEMEFFECT_LUA_000888")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000888 )
		GiveItem ( role , 0 , 0519 , 1 , 22 ) 
		return
	elseif getrandom > 30 and getrandom <= 40  then		----------55航海士（艾米）手套	
		CALCULATE_ITEMEFFECT_LUA_000889 = GetResString("CALCULATE_ITEMEFFECT_LUA_000889")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000889 )
		GiveItem ( role , 0 , 0533 , 1 , 22 ) 
		return
	elseif getrandom > 40 and getrandom <= 50  then		----------55封印师（艾米）手套
		CALCULATE_ITEMEFFECT_LUA_000890 = GetResString("CALCULATE_ITEMEFFECT_LUA_000890")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000890 )
		GiveItem ( role , 0 , 0539 , 1 , 22 ) 
		return
	elseif getrandom > 50 and getrandom <= 60  then		----------55封印师（菲利尔）手套
		CALCULATE_ITEMEFFECT_LUA_000891 = GetResString("CALCULATE_ITEMEFFECT_LUA_000891")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000891 )
		GiveItem ( role , 0 , 0552 , 1 , 22 ) 
		return
	elseif getrandom > 60 and getrandom <= 70  then		----------55圣职者（菲利尔）手套
		CALCULATE_ITEMEFFECT_LUA_000892 = GetResString("CALCULATE_ITEMEFFECT_LUA_000892")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000892 )
		GiveItem ( role , 0 , 0555 , 1 , 22 ) 
		return
	elseif getrandom > 70 and getrandom <= 80  then		----------55圣职者（艾米）手套
		CALCULATE_ITEMEFFECT_LUA_000893 = GetResString("CALCULATE_ITEMEFFECT_LUA_000893")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000893 )
		GiveItem ( role , 0 , 0567 , 1 , 22 ) 
		return
	elseif getrandom > 80 and getrandom <= 90  then		----------45巨剑士（卡西斯）手套
		CALCULATE_ITEMEFFECT_LUA_000894 = GetResString("CALCULATE_ITEMEFFECT_LUA_000894")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000894 )
		GiveItem ( role , 0 , 0477 , 1 , 22 ) 
		return
		elseif getrandom > 90 and getrandom <= 100  then	----------55双剑士（蓝琦）靴子
		CALCULATE_ITEMEFFECT_LUA_000895 = GetResString("CALCULATE_ITEMEFFECT_LUA_000895")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000895 )
		GiveItem ( role , 0 , 0655 , 1 , 22 ) 
		return
	elseif getrandom > 100 and getrandom <= 110  then	----------55狙击手（蓝琦、艾利尔）靴子
		CALCULATE_ITEMEFFECT_LUA_000896 = GetResString("CALCULATE_ITEMEFFECT_LUA_000896")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000896 )
		GiveItem ( role , 0 , 0668 , 1 , 22 ) 
		return
	elseif getrandom > 110 and getrandom <= 120  then	----------55航海士（蓝琦、菲利尔）靴子	
		CALCULATE_ITEMEFFECT_LUA_000897 = GetResString("CALCULATE_ITEMEFFECT_LUA_000897")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000897 )
		GiveItem ( role , 0 , 0695 , 1 , 22 ) 
		return
	elseif getrandom > 120 and getrandom <= 130  then	----------55航海士（艾米）靴子
		CALCULATE_ITEMEFFECT_LUA_000898 = GetResString("CALCULATE_ITEMEFFECT_LUA_000898")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000898 )
		GiveItem ( role , 0 , 0709 , 1 , 22 ) 
		return
	elseif getrandom > 130 and getrandom <= 140  then	----------55封印师（艾米）靴子
		CALCULATE_ITEMEFFECT_LUA_000899 = GetResString("CALCULATE_ITEMEFFECT_LUA_000899")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000899 )
		GiveItem ( role , 0 , 0715 , 1 , 22 ) 
		return
	elseif getrandom > 140 and getrandom <= 150  then	----------55封印师（菲利尔）靴子
		CALCULATE_ITEMEFFECT_LUA_000900 = GetResString("CALCULATE_ITEMEFFECT_LUA_000900")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000900 )
		GiveItem ( role , 0 , 0728 , 1 , 22 ) 
		return
	elseif getrandom > 150 and getrandom <= 160  then	----------55圣职者（菲利尔）靴子
		CALCULATE_ITEMEFFECT_LUA_000901 = GetResString("CALCULATE_ITEMEFFECT_LUA_000901")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000901 )
		GiveItem ( role , 0 , 0731 , 1 , 22 ) 
		return
	elseif getrandom > 160 and getrandom <= 170  then	----------55圣职者（艾米）靴子
		CALCULATE_ITEMEFFECT_LUA_000902 = GetResString("CALCULATE_ITEMEFFECT_LUA_000902")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000902 )
		GiveItem ( role , 0 , 0743 , 1 , 22 ) 
		return
	elseif getrandom > 170 and getrandom <= 180  then	----------45巨剑士（卡西斯）靴子
		CALCULATE_ITEMEFFECT_LUA_000903 = GetResString("CALCULATE_ITEMEFFECT_LUA_000903")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000903 )
		GiveItem ( role , 0 , 0653 , 1 , 22 ) 
		return
	elseif getrandom > 180 and getrandom <= 190  then	----------55双剑士（菲利尔）手套（预留）
		CALCULATE_ITEMEFFECT_LUA_000886 = GetResString("CALCULATE_ITEMEFFECT_LUA_000886")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000886 )
		GiveItem ( role , 0 , 0479 , 1 , 22 ) 
		return
	elseif getrandom > 190 and getrandom <= 200  then	----------55双剑士（菲利尔）靴子（预留）
		CALCULATE_ITEMEFFECT_LUA_000895 = GetResString("CALCULATE_ITEMEFFECT_LUA_000895")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000895 )
		GiveItem ( role , 0 , 0655 , 1 , 22 ) 
		return
	end
end




--海盗王2008挖宝80BOSS箱子--海盗秘宝箱子
function ItemUse_WaBao_HDMBBox ( role , Item )	

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000904 = GetResString("CALCULATE_ITEMEFFECT_LUA_000904")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000904)
		UseItemFailed ( role )
		return
	end
	local getrandom = math.random ( 1 , 200 )
	if getrandom <= 10 then							----------75双剑士（蓝琦）手套
		CALCULATE_ITEMEFFECT_LUA_000905 = GetResString("CALCULATE_ITEMEFFECT_LUA_000905")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000905 )
		GiveItem ( role , 0 , 0588 , 1 , 22 ) 
		return
	elseif getrandom > 10 and getrandom <= 20  then		----------75狙击手（蓝琦、艾利尔）手套
		CALCULATE_ITEMEFFECT_LUA_000906 = GetResString("CALCULATE_ITEMEFFECT_LUA_000906")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000906 )
		GiveItem ( role , 0 , 0590 , 1 , 22 ) 
		return
	elseif getrandom > 20 and getrandom <= 30  then		----------75封印师（菲利尔）手套
		CALCULATE_ITEMEFFECT_LUA_000907 = GetResString("CALCULATE_ITEMEFFECT_LUA_000907")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000907 )
		GiveItem ( role , 0 , 0592 , 1 , 22 ) 
		return
	elseif getrandom > 30 and getrandom <= 40  then		----------75封印师（艾米）手套	
		CALCULATE_ITEMEFFECT_LUA_000908 = GetResString("CALCULATE_ITEMEFFECT_LUA_000908")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000908 )
		GiveItem ( role , 0 , 0594 , 1 , 22 ) 
		return
	elseif getrandom > 40 and getrandom <= 50  then		----------75圣职者（菲利尔）手套		
		CALCULATE_ITEMEFFECT_LUA_000909 = GetResString("CALCULATE_ITEMEFFECT_LUA_000909")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000909 )
		GiveItem ( role , 0 , 0596 , 1 , 22 ) 
		return
	elseif getrandom > 50 and getrandom <= 60  then		
		CALCULATE_ITEMEFFECT_LUA_000910 = GetResString("CALCULATE_ITEMEFFECT_LUA_000910")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000910 )	----------75圣职者（艾米）手套
		GiveItem ( role , 0 , 0598 , 1 , 22 ) 
		return
	elseif getrandom > 60 and getrandom <= 70  then		----------75航海士（蓝琦、菲利尔）手套
		CALCULATE_ITEMEFFECT_LUA_000911 = GetResString("CALCULATE_ITEMEFFECT_LUA_000911")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000911 )
		GiveItem ( role , 0 , 0600 , 1 , 22 ) 
		return
	elseif getrandom > 70 and getrandom <= 80  then		----------75航海士（艾米）手套	
		CALCULATE_ITEMEFFECT_LUA_000912 = GetResString("CALCULATE_ITEMEFFECT_LUA_000912")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000912 )
		GiveItem ( role , 0 , 0602 , 1 , 22 ) 
		return
	elseif getrandom > 80 and getrandom <= 90  then		----------75巨剑士（卡西斯）手套
		CALCULATE_ITEMEFFECT_LUA_000913 = GetResString("CALCULATE_ITEMEFFECT_LUA_000913")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000913 )
		GiveItem ( role , 0 , 0604 , 1 , 22 ) 
		return
		elseif getrandom > 90 and getrandom <= 100  then	----------75双剑士（蓝琦）靴子
		CALCULATE_ITEMEFFECT_LUA_000914 = GetResString("CALCULATE_ITEMEFFECT_LUA_000914")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000914 )
		GiveItem ( role , 0 , 0748 , 1 , 22 ) 
		return
	elseif getrandom > 100 and getrandom <= 110  then	----------75狙击手（蓝琦、艾利尔）靴子
		CALCULATE_ITEMEFFECT_LUA_000915 = GetResString("CALCULATE_ITEMEFFECT_LUA_000915")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000915 )
		GiveItem ( role , 0 , 0750 , 1 , 22 ) 
		return
	elseif getrandom > 110 and getrandom <= 120  then	----------75航海士（蓝琦、菲利尔）靴子	
		CALCULATE_ITEMEFFECT_LUA_000916 = GetResString("CALCULATE_ITEMEFFECT_LUA_000916")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000916 )
		GiveItem ( role , 0 , 0752 , 1 , 22 ) 
		return
	elseif getrandom > 120 and getrandom <= 130  then	----------75航海士（艾米）靴子
		CALCULATE_ITEMEFFECT_LUA_000917 = GetResString("CALCULATE_ITEMEFFECT_LUA_000917")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000917 )
		GiveItem ( role , 0 , 0754, 1 , 22 ) 
		return
	elseif getrandom > 130 and getrandom <= 140  then	----------75封印师（艾米）靴子
		CALCULATE_ITEMEFFECT_LUA_000918 = GetResString("CALCULATE_ITEMEFFECT_LUA_000918")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000918 )
		GiveItem ( role , 0 , 0756 , 1 , 22 ) 
		return
	elseif getrandom > 140 and getrandom <= 150  then	----------75封印师（菲利尔）靴子
		CALCULATE_ITEMEFFECT_LUA_000919 = GetResString("CALCULATE_ITEMEFFECT_LUA_000919")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000919 )
		GiveItem ( role , 0 , 0758 , 1 , 22 ) 
		return
	elseif getrandom > 150 and getrandom <= 160  then	----------75圣职者（菲利尔）靴子
		CALCULATE_ITEMEFFECT_LUA_000920 = GetResString("CALCULATE_ITEMEFFECT_LUA_000920")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000920 )
		GiveItem ( role , 0 , 0760 , 1 , 22 ) 
		return
	elseif getrandom > 160 and getrandom <= 170  then	----------75圣职者（艾米）靴子
		CALCULATE_ITEMEFFECT_LUA_000921 = GetResString("CALCULATE_ITEMEFFECT_LUA_000921")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000921 )
		GiveItem ( role , 0 , 0824 , 1 , 22 ) 
		return
	elseif getrandom > 170 and getrandom <= 180  then	----------75巨剑士（卡西斯）靴子
		CALCULATE_ITEMEFFECT_LUA_000922 = GetResString("CALCULATE_ITEMEFFECT_LUA_000922")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000922 )
		GiveItem ( role , 0 , 0830 , 1 , 22 ) 
		return
	elseif getrandom > 180 and getrandom <= 190  then	----------75双剑士（菲利尔）手套（预留）
		CALCULATE_ITEMEFFECT_LUA_000905 = GetResString("CALCULATE_ITEMEFFECT_LUA_000905")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000905 )
		GiveItem ( role , 0 , 0588 , 1 , 22 ) 
		return
	elseif getrandom > 190 and getrandom <= 200  then	----------75双剑士（菲利尔）靴子（预留）
		CALCULATE_ITEMEFFECT_LUA_000914 = GetResString("CALCULATE_ITEMEFFECT_LUA_000914")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000914 )
		GiveItem ( role , 0 , 0748 , 1 , 22 ) 
		return
	end
end

-- 海盗王2008--命运房间--40级海盗武器箱子
function ItemUse_WaBao_HD40Box ( role , Item )
	
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000923 = GetResString("CALCULATE_ITEMEFFECT_LUA_000923")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000923)
		UseItemFailed ( role )
		return
	end
	local getrandom = math.random ( 1 , 60 )
	if getrandom <= 10 then							----------40双剑士武器
		CALCULATE_ITEMEFFECT_LUA_000924 = GetResString("CALCULATE_ITEMEFFECT_LUA_000924")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000924 )
		GiveItem ( role , 0 , 0004 , 1 , 22 ) 
		return
	elseif getrandom > 10 and getrandom <= 20  then		----------40巨剑士武器
		CALCULATE_ITEMEFFECT_LUA_000925 = GetResString("CALCULATE_ITEMEFFECT_LUA_000925")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000925 )
		GiveItem ( role , 0 , 0015 , 1 , 22 ) 
		return
	elseif getrandom > 20 and getrandom <= 30  then		----------40狙击手武器
		CALCULATE_ITEMEFFECT_LUA_000926 = GetResString("CALCULATE_ITEMEFFECT_LUA_000926")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000926 )
		GiveItem ( role , 0 , 0039 , 1 , 22 ) 
		return
	elseif getrandom > 30 and getrandom <= 40  then		----------40航海士武器	
		CALCULATE_ITEMEFFECT_LUA_000927 = GetResString("CALCULATE_ITEMEFFECT_LUA_000927")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000927 )
		GiveItem ( role , 0 , 0076 , 1 , 22 ) 
		return
	elseif getrandom > 40 and getrandom <= 50  then		----------40圣职者武器
		CALCULATE_ITEMEFFECT_LUA_000928 = GetResString("CALCULATE_ITEMEFFECT_LUA_000928")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000928 )
		GiveItem ( role , 0 , 0100 , 1 , 22 ) 
		return
	elseif getrandom > 50 and getrandom <= 60  then		----------40封印师武器
		CALCULATE_ITEMEFFECT_LUA_000929 = GetResString("CALCULATE_ITEMEFFECT_LUA_000929")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000929 )
		GiveItem ( role , 0 , 0101 , 1 , 22 ) 
		return
	end
end

-- 海盗王2008--命运房间--45级海盗武器箱子
function ItemUse_WaBao_HD45Box ( role , Item )	

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000930 = GetResString("CALCULATE_ITEMEFFECT_LUA_000930")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000930)
		UseItemFailed ( role )
		return
	end
	local getrandom = math.random ( 1 , 60 )
	if getrandom <= 10 then							----------45双剑士武器
		CALCULATE_ITEMEFFECT_LUA_000931 = GetResString("CALCULATE_ITEMEFFECT_LUA_000931")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000931 )
		GiveItem ( role , 0 , 0022 , 1 , 22 ) 
		return
	elseif getrandom > 10 and getrandom <= 20  then		----------45巨剑士武器
		CALCULATE_ITEMEFFECT_LUA_000932 = GetResString("CALCULATE_ITEMEFFECT_LUA_000932")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000932 )
		GiveItem ( role , 0 , 0020 , 1 , 22 ) 
		return
	elseif getrandom > 20 and getrandom <= 30  then		----------45狙击手武器
		CALCULATE_ITEMEFFECT_LUA_000933 = GetResString("CALCULATE_ITEMEFFECT_LUA_000933")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000933 )
		GiveItem ( role , 0 , 0044 , 1 , 22 ) 
		return
	elseif getrandom > 30 and getrandom <= 40  then		----------45航海士武器	
		CALCULATE_ITEMEFFECT_LUA_000934 = GetResString("CALCULATE_ITEMEFFECT_LUA_000934")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000934 )
		GiveItem ( role , 0 , 0083 , 1 , 22 ) 
		return
	elseif getrandom > 40 and getrandom <= 50  then		----------45圣职者武器
		CALCULATE_ITEMEFFECT_LUA_000935 = GetResString("CALCULATE_ITEMEFFECT_LUA_000935")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000935 )
		GiveItem ( role , 0 , 4305 , 1 , 22 ) 
		return
	elseif getrandom > 50 and getrandom <= 60  then		----------45封印师武器
		CALCULATE_ITEMEFFECT_LUA_000936 = GetResString("CALCULATE_ITEMEFFECT_LUA_000936")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000936 )
		GiveItem ( role , 0 , 0107 , 1 , 22 ) 
		return
	end
end

-- 海盗王2008--命运房间--50级海盗武器箱子
function ItemUse_WaBao_HD50Box ( role , Item )	

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000937 = GetResString("CALCULATE_ITEMEFFECT_LUA_000937")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000937)
		UseItemFailed ( role )
		return
	end
	local getrandom = math.random ( 1 , 60 )
	if getrandom <= 10 then							----------50双剑士武器
		CALCULATE_ITEMEFFECT_LUA_000938 = GetResString("CALCULATE_ITEMEFFECT_LUA_000938")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000938 )
		GiveItem ( role , 0 , 1392 , 1 , 22 ) 
		return
	elseif getrandom > 10 and getrandom <= 20  then		----------50巨剑士武器
		CALCULATE_ITEMEFFECT_LUA_000939 = GetResString("CALCULATE_ITEMEFFECT_LUA_000939")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000939 )
		GiveItem ( role , 0 , 1373 , 1 , 22 ) 
		return
	elseif getrandom > 20 and getrandom <= 30  then		----------50狙击手武器
		CALCULATE_ITEMEFFECT_LUA_000940 = GetResString("CALCULATE_ITEMEFFECT_LUA_000940")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000940 )
		GiveItem ( role , 0 , 0040 , 1 , 22 ) 
		return
	elseif getrandom > 30 and getrandom <= 40  then		----------50航海士武器	
		CALCULATE_ITEMEFFECT_LUA_000941 = GetResString("CALCULATE_ITEMEFFECT_LUA_000941")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000941 )
		GiveItem ( role , 0 , 0077 , 1 , 22 ) 
		return
	elseif getrandom > 40 and getrandom <= 50  then		----------50圣职者武器
		CALCULATE_ITEMEFFECT_LUA_000942 = GetResString("CALCULATE_ITEMEFFECT_LUA_000942")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000942 )
		GiveItem ( role , 0 , 0103 , 1 , 22 ) 
		return
	elseif getrandom > 50 and getrandom <= 60  then		----------50封印师武器
		CALCULATE_ITEMEFFECT_LUA_000943 = GetResString("CALCULATE_ITEMEFFECT_LUA_000943")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000943 )
		GiveItem ( role , 0 , 0102 , 1 , 22 ) 
		return
	end
end

-- 海盗王2008--命运房间--55级海盗武器箱子
function ItemUse_WaBao_HD55Box ( role , Item )
	
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000944 = GetResString("CALCULATE_ITEMEFFECT_LUA_000944")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000944)
		UseItemFailed ( role )
		return
	end
	local getrandom = math.random ( 1 , 60 )
	if getrandom <= 10 then							----------55双剑士武器
		CALCULATE_ITEMEFFECT_LUA_000945 = GetResString("CALCULATE_ITEMEFFECT_LUA_000945")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000945 )
		GiveItem ( role , 0 , 0023 , 1 , 22 ) 
		return
	elseif getrandom > 10 and getrandom <= 20  then		----------55巨剑士武器
		CALCULATE_ITEMEFFECT_LUA_000946 = GetResString("CALCULATE_ITEMEFFECT_LUA_000946")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000946 )
		GiveItem ( role , 0 , 0021 , 1 , 22 ) 
		return
	elseif getrandom > 20 and getrandom <= 30  then		----------55狙击手武器
		CALCULATE_ITEMEFFECT_LUA_000947 = GetResString("CALCULATE_ITEMEFFECT_LUA_000947")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000947 )
		GiveItem ( role , 0 , 0045 , 1 , 22 ) 
		return
	elseif getrandom > 30 and getrandom <= 40  then		----------55航海士武器	
		CALCULATE_ITEMEFFECT_LUA_000948 = GetResString("CALCULATE_ITEMEFFECT_LUA_000948")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000948 )
		GiveItem ( role , 0 , 0084 , 1 , 22 ) 
		return
	elseif getrandom > 40 and getrandom <= 50  then		----------55圣职者武器
		CALCULATE_ITEMEFFECT_LUA_000949 = GetResString("CALCULATE_ITEMEFFECT_LUA_000949")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000949 )
		GiveItem ( role , 0 , 1476 , 1 , 22 ) 
		return
	elseif getrandom > 50 and getrandom <= 60  then		----------55封印师武器
		CALCULATE_ITEMEFFECT_LUA_000950 = GetResString("CALCULATE_ITEMEFFECT_LUA_000950")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000950 )
		GiveItem ( role , 0 , 0108 , 1 , 22 ) 
		return
	end
end

-- 海盗王2008--命运房间--60级海盗武器箱子
function ItemUse_WaBao_HD60Box ( role , Item )
	
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000951 = GetResString("CALCULATE_ITEMEFFECT_LUA_000951")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000951)
		UseItemFailed ( role )
		return
	end
	local getrandom = math.random ( 1 , 60 )
	if getrandom <= 10 then							----------60双剑士武器
		CALCULATE_ITEMEFFECT_LUA_000952 = GetResString("CALCULATE_ITEMEFFECT_LUA_000952")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000952 )
		GiveItem ( role , 0 , 1393 , 1 , 22 ) 
		return
	elseif getrandom > 10 and getrandom <= 20  then		----------60巨剑士武器
		CALCULATE_ITEMEFFECT_LUA_000953 = GetResString("CALCULATE_ITEMEFFECT_LUA_000953")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000953 )
		GiveItem ( role , 0 , 1374 , 1 , 22 ) 
		return
	elseif getrandom > 20 and getrandom <= 30  then		----------60狙击手武器
		CALCULATE_ITEMEFFECT_LUA_000954 = GetResString("CALCULATE_ITEMEFFECT_LUA_000954")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000954 )
		GiveItem ( role , 0 , 0041 , 1 , 22 ) 
		return
	elseif getrandom > 30 and getrandom <= 40  then		----------60航海士武器	
		CALCULATE_ITEMEFFECT_LUA_000955 = GetResString("CALCULATE_ITEMEFFECT_LUA_000955")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000955 )
		GiveItem ( role , 0 , 0078 , 1 , 22 ) 
		return
	elseif getrandom > 40 and getrandom <= 50  then		----------60圣职者武器
		CALCULATE_ITEMEFFECT_LUA_000956 = GetResString("CALCULATE_ITEMEFFECT_LUA_000956")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000956 )
		GiveItem ( role , 0 , 1442 , 1 , 22 ) 
		return
	elseif getrandom > 50 and getrandom <= 60  then		----------60封印师武器
		CALCULATE_ITEMEFFECT_LUA_000957 = GetResString("CALCULATE_ITEMEFFECT_LUA_000957")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000957 )
		GiveItem ( role , 0 , 1439 , 1 , 22 ) 
		return
	end
end

-- 海盗王2008--命运房间--65级海盗武器箱子
function ItemUse_WaBao_HD65Box ( role , Item )	

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000958 = GetResString("CALCULATE_ITEMEFFECT_LUA_000958")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000958)
		UseItemFailed ( role )
		return
	end
	local getrandom = math.random ( 1 , 60 )
	if getrandom <= 10 then							----------65双剑士武器
		CALCULATE_ITEMEFFECT_LUA_000959 = GetResString("CALCULATE_ITEMEFFECT_LUA_000959")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000959 )
		GiveItem ( role , 0 , 4212 , 1 , 22 ) 
		return
	elseif getrandom > 10 and getrandom <= 20  then		----------65巨剑士武器
		CALCULATE_ITEMEFFECT_LUA_000960 = GetResString("CALCULATE_ITEMEFFECT_LUA_000960")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000960 )
		GiveItem ( role , 0 , 4209 , 1 , 22 ) 
		return
	elseif getrandom > 20 and getrandom <= 30  then		----------65狙击手武器
		CALCULATE_ITEMEFFECT_LUA_000961 = GetResString("CALCULATE_ITEMEFFECT_LUA_000961")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000961 )
		GiveItem ( role , 0 , 4214 , 1 , 22 ) 
		return
	elseif getrandom > 30 and getrandom <= 40  then		----------65航海士武器	
		CALCULATE_ITEMEFFECT_LUA_000962 = GetResString("CALCULATE_ITEMEFFECT_LUA_000962")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000962 )
		GiveItem ( role , 0 , 4216 , 1 , 22 ) 
		return
	elseif getrandom > 40 and getrandom <= 50  then		----------65圣职者武器
		CALCULATE_ITEMEFFECT_LUA_000963 = GetResString("CALCULATE_ITEMEFFECT_LUA_000963")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000963 )
		GiveItem ( role , 0 , 4197 , 1 , 22 ) 
		return
	elseif getrandom > 50 and getrandom <= 60  then		----------65封印师武器
		CALCULATE_ITEMEFFECT_LUA_000964 = GetResString("CALCULATE_ITEMEFFECT_LUA_000964")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000964 )
		GiveItem ( role , 0 , 4203 , 1 , 22 ) 
		return
	end
end

-- 海盗王2008--命运房间--70级海盗武器箱子
function ItemUse_WaBao_HD70Box ( role , Item )	

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000965 = GetResString("CALCULATE_ITEMEFFECT_LUA_000965")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000965)
		UseItemFailed ( role )
		return
	end
	local getrandom = math.random ( 1 , 60 )
	if getrandom <= 10 then							----------70双剑士武器
		CALCULATE_ITEMEFFECT_LUA_000966 = GetResString("CALCULATE_ITEMEFFECT_LUA_000966")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000966 )
		GiveItem ( role , 0 , 0113 , 1 , 22 ) 
		return
	elseif getrandom > 10 and getrandom <= 20  then		----------70巨剑士武器
		CALCULATE_ITEMEFFECT_LUA_000967 = GetResString("CALCULATE_ITEMEFFECT_LUA_000967")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000967 )
		GiveItem ( role , 0 , 0115 , 1 , 22 ) 
		return
	elseif getrandom > 20 and getrandom <= 30  then		----------70狙击手武器
		CALCULATE_ITEMEFFECT_LUA_000968 = GetResString("CALCULATE_ITEMEFFECT_LUA_000968")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000968 )
		GiveItem ( role , 0 , 0119 , 1 , 22 ) 
		return
	elseif getrandom > 30 and getrandom <= 40  then		----------70航海士武器	
		CALCULATE_ITEMEFFECT_LUA_000969 = GetResString("CALCULATE_ITEMEFFECT_LUA_000969")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000969 )
		GiveItem ( role , 0 , 0150 , 1 , 22 ) 
		return
	elseif getrandom > 40 and getrandom <= 50  then		----------70圣职者武器
		CALCULATE_ITEMEFFECT_LUA_000970 = GetResString("CALCULATE_ITEMEFFECT_LUA_000970")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000970 )
		GiveItem ( role , 0 , 0109 , 1 , 22 ) 
		return
	elseif getrandom > 50 and getrandom <= 60  then		----------70封印师武器
		CALCULATE_ITEMEFFECT_LUA_000971 = GetResString("CALCULATE_ITEMEFFECT_LUA_000971")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000971 )
		GiveItem ( role , 0 , 0111 , 1 , 22 ) 
		return
	end
end

-- 海盗王2008--命运房间--75级海盗武器箱子
function ItemUse_WaBao_HD75Box ( role , Item )
	
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000972 = GetResString("CALCULATE_ITEMEFFECT_LUA_000972")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000972)
		UseItemFailed ( role )
		return
	end
	local getrandom = math.random ( 1 , 60 )
	if getrandom <= 10 then							----------75双剑士武器
		CALCULATE_ITEMEFFECT_LUA_000973 = GetResString("CALCULATE_ITEMEFFECT_LUA_000973")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000973 )
		GiveItem ( role , 0 , 0114 , 1 , 22 ) 
		return
	elseif getrandom > 10 and getrandom <= 20  then		----------75巨剑士武器
		CALCULATE_ITEMEFFECT_LUA_000974 = GetResString("CALCULATE_ITEMEFFECT_LUA_000974")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000974 )
		GiveItem ( role , 0 , 0116 , 1 , 22 ) 
		return
	elseif getrandom > 20 and getrandom <= 30  then		----------75狙击手武器
		CALCULATE_ITEMEFFECT_LUA_000975 = GetResString("CALCULATE_ITEMEFFECT_LUA_000975")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000975 )
		GiveItem ( role , 0 , 0120 , 1 , 22 ) 
		return
	elseif getrandom > 30 and getrandom <= 40  then		----------75航海士武器	
		CALCULATE_ITEMEFFECT_LUA_000976 = GetResString("CALCULATE_ITEMEFFECT_LUA_000976")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000976 )
		GiveItem ( role , 0 , 0151 , 1 , 22 ) 
		return
	elseif getrandom > 40 and getrandom <= 50  then		----------75圣职者武器
		CALCULATE_ITEMEFFECT_LUA_000977 = GetResString("CALCULATE_ITEMEFFECT_LUA_000977")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000977 )
		GiveItem ( role , 0 , 0110 , 1 , 22 ) 
		return
	elseif getrandom > 50 and getrandom <= 60  then		----------75封印师武器
		CALCULATE_ITEMEFFECT_LUA_000978 = GetResString("CALCULATE_ITEMEFFECT_LUA_000978")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000978 )
		GiveItem ( role , 0 , 0112 , 1 , 22 ) 
		return
	end
end
-- 海盗王2008挖宝--海盗羊皮卷
function ItemUse_WaBao_HDYPJ( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000058 = GetResString("CALCULATE_ITEMEFFECT_LUA_000058")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000058)
		UseItemFailed ( role )
		return
	end 
	local Has_GoldenMap = CheckBagItem ( role , 6343 )
	local lv= GetChaAttr(role, ATTR_LV) 
	if Has_GoldenMap >= 1 then
		CALCULATE_ITEMEFFECT_LUA_000979 = GetResString("CALCULATE_ITEMEFFECT_LUA_000979")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000979 )
		UseItemFailed ( role )
		return
	end
	if lv <41 then
		CALCULATE_ITEMEFFECT_LUA_000980 = GetResString("CALCULATE_ITEMEFFECT_LUA_000980")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000980 )
		UseItemFailed ( role )
		return	
	end
	GiveItem ( role , 0 , 6343 , 1 , 0 )
end
------命运房间--箱子中的箱子
function ItemUse_WaBao_MYBOXBOX ( role , Item )

local Lv = Lv( role )
	if  Lv < 40 then 
		UseItemFailed ( role )
		CALCULATE_ITEMEFFECT_LUA_000981 = GetResString("CALCULATE_ITEMEFFECT_LUA_000981")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000981 )
		return 
	end	

		local sc = math.random(1,200)
		
	-- name = GetChaDefaultName(role)
	-- local name_notice = name.."开启命运宝箱的时候受到了天神的鄙视，导致他眩晕15秒。"
	-- Notice(name_notice)
	
		if sc >= 1 and sc <= 30 then	--被鄙视，并且眩晕（30/200）
			local statelv = 1 
			local statetime = 15
			local hp = Hp(role)		
			CALCULATE_ITEMEFFECT_LUA_000982 = GetResString("CALCULATE_ITEMEFFECT_LUA_000982")
			SystemNotice(role, CALCULATE_ITEMEFFECT_LUA_000982)
			AddState ( role , role , STATE_XY , statelv , statetime )
			AddState ( role , role , STATE_SWJTWO , statelv , 3 )
			AddState(role , role , STATE_JLTX6 , 1 , 30 )
			return
			
		elseif sc > 30 and sc <= 65 then	--商城道具（35/200）
			-- SystemNotice ( role , "哇，今天运气不错，打开命运宝箱得到了商城道具！！" )
												---08-10-09修改op
			-- local name = GetChaDefaultName(role)
			-- local shangcheng_name = "哇!"..name.."打开命运宝箱得到了一件商城道具！"
			-- ScrollNotice( shangcheng_name , 1 )
			CALCULATE_ITEMEFFECT_LUA_000983 = GetResString("CALCULATE_ITEMEFFECT_LUA_000983")
			SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000983 )
												---08-10-09修改ed
			local get_shopitem_random = math.random( 1,100 )
			if get_shopitem_random < 3 then
			GiveItem ( role , 0 , 1807 , 1 , 4 )  --理发券
				return
			elseif get_shopitem_random >= 3 and get_shopitem_random < 13 then
				GiveItem ( role , 0 , 5626 , 1 , 4 )  --超级生命恢复剂
				return	
			elseif get_shopitem_random >= 13 and get_shopitem_random < 18 then
				GiveItem ( role , 0 , 5627 , 1 , 4 )  --法力圣水
				return	
			elseif get_shopitem_random >= 18 and get_shopitem_random < 19 then
				GiveItem ( role , 0 , 3095 , 1 , 4 )  --高级努力
				return	
			elseif get_shopitem_random >= 19 and get_shopitem_random < 24 then
				GiveItem ( role , 0 , 3081 , 1 , 4 )  --菊型礼花
				return		
			elseif get_shopitem_random >= 24 and get_shopitem_random < 29 then
				GiveItem ( role , 0 , 3082 , 1 , 4 )  --豪华礼花
				return	
			elseif get_shopitem_random >= 29 and get_shopitem_random < 34 then
				GiveItem ( role , 0 , 3343 , 1 , 4 )  --玫瑰
				return		
			elseif get_shopitem_random >= 34 and get_shopitem_random < 39 then
				GiveItem ( role , 0 , 3077 , 1 , 4 )  --甜蜜巧克力
				return		
			elseif get_shopitem_random >= 39 and get_shopitem_random < 44 then
				GiveItem ( role , 0 , 3094 , 1 , 4 )  --双倍经验增幅器
				return		
			elseif get_shopitem_random >= 44 and get_shopitem_random < 46 then
				GiveItem ( role , 0 , 3100 , 1 , 4 )  --雄狮模拟药剂
				return		
			elseif get_shopitem_random >= 46 and get_shopitem_random < 48 then
				GiveItem ( role , 0 , 3101 , 1 , 4 )  --灵猴模拟药剂
				return	
			elseif get_shopitem_random >= 48 and get_shopitem_random < 50 then
				GiveItem ( role , 0 , 3102 , 1 , 4 )  --蛮牛模拟药剂
				return	
			elseif get_shopitem_random >= 50 and get_shopitem_random < 52 then
				GiveItem ( role , 0 , 3103 , 1 , 4 )  --鹰眼模拟药剂
				return	
			elseif get_shopitem_random >= 52 and get_shopitem_random < 54 then
				GiveItem ( role , 0 , 3104 , 1 , 4 )  --圣灵模拟药剂
				return	
			elseif get_shopitem_random >= 54 and get_shopitem_random < 56 then
				GiveItem ( role , 0 , 0332 , 1 , 4 )  --春风机票
				return	
			elseif get_shopitem_random >= 56 and get_shopitem_random < 58 then
				GiveItem ( role , 0 , 0563 , 1 , 4 )  --夏岛机票
				return	
			elseif get_shopitem_random >= 58 and get_shopitem_random < 60 then
				GiveItem ( role , 0 , 0583 , 1 , 4 )  --秋岛机票
				return	
			elseif get_shopitem_random >= 60 and get_shopitem_random < 62 then
				GiveItem ( role , 0 , 2491 , 1 , 4 )  --海军机票
				return	
			elseif get_shopitem_random >= 62 and get_shopitem_random < 64 then
				GiveItem ( role , 0 , 3099 , 1 , 4 )  --SP神仙水
				return		
			elseif get_shopitem_random >= 64 and get_shopitem_random < 69 then
				GiveItem ( role , 0 , 3097 , 1 , 4 )  --强力体力恢复药剂
				return	
			elseif get_shopitem_random >= 69 and get_shopitem_random < 71 then
				GiveItem ( role , 0 , 3351 , 1 , 4 )  --皇家礼炮A
				return	
			elseif get_shopitem_random >= 71 and get_shopitem_random < 73 then
				GiveItem ( role , 0 , 3352 , 1 , 4 )  --皇家礼炮B
				return	
			elseif get_shopitem_random >= 73 and get_shopitem_random < 75 then
				GiveItem ( role , 0 , 3353 , 1 , 4 )  --皇家礼炮C
				return	
			elseif get_shopitem_random >= 75 and get_shopitem_random < 77 then
				GiveItem ( role , 0 , 3354 , 1 , 4 )  --心型烟花-I
				return	
			elseif get_shopitem_random >= 77 and get_shopitem_random < 79 then
				GiveItem ( role , 0 , 3355 , 1 , 4 )  --心型烟花-LOVE
				return	
			elseif get_shopitem_random >= 79 and get_shopitem_random < 81 then
				GiveItem ( role , 0 , 3356 , 1 , 4 )  --心型烟花-U
				return	
			elseif get_shopitem_random >= 81 and get_shopitem_random < 83 then
				GiveItem ( role , 0 , 3357 , 1 , 4 )  --心型烟花-爱
				return	
			elseif get_shopitem_random >= 83 and get_shopitem_random < 85 then
				GiveItem ( role , 0 , 3358 , 1 , 4 )  --心型烟花-你
				return	
			elseif get_shopitem_random >= 85 and get_shopitem_random < 87 then
				GiveItem ( role , 0 , 3359 , 1 , 4 )  --心型烟花-我
				return	
			elseif get_shopitem_random >= 87 and get_shopitem_random < 89 then
				GiveItem ( role , 0 , 3834 , 1 , 4 )  --寂寞之塔门口机票
				return	
			elseif get_shopitem_random >= 89 and get_shopitem_random < 91 then
				GiveItem ( role , 0 , 3839 , 1 , 4 )  --寂寞之塔2层机票
				return	
			elseif get_shopitem_random >= 91 and get_shopitem_random < 93 then
				GiveItem ( role , 0 , 3840 , 1 , 4 )  --寂寞之塔3层机票
				return	
			elseif get_shopitem_random >= 93 and get_shopitem_random < 95 then
				GiveItem ( role , 0 , 3841 , 1 , 4 )  --寂寞之塔4层机票
				return	
			elseif get_shopitem_random >= 95 and get_shopitem_random < 97 then
				GiveItem ( role , 0 , 3842 , 1 , 4 )  --寂寞之塔5层机票
				return	
			elseif get_shopitem_random >= 97 and get_shopitem_random < 99 then
				GiveItem ( role , 0 , 3843 , 1 , 4 )  --寂寞之塔6层机票
				return	
			else
				GiveItem ( role , 0 , 3846 , 1 , 4 )  --替身娃娃
				return		
			end
			
		elseif sc > 65 and sc <= 125 then	--传送回城（60/200）
			RemoveChaItem( role , 6359 , 1 , 2 , -1 , 2 , 1 )
			CALCULATE_ITEMEFFECT_LUA_000984 = GetResString("CALCULATE_ITEMEFFECT_LUA_000984")
			SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000984 )
			MoveTo( role,2200,2888,"garner" )
			return
			
		elseif sc > 125 and sc <= 129 then	--宠物（4/200）
			local name = GetChaDefaultName(role)
			CALCULATE_ITEMEFFECT_LUA_000985 = GetResString("CALCULATE_ITEMEFFECT_LUA_000985")
			local zhaohuan_name = name..CALCULATE_ITEMEFFECT_LUA_000985
			ScrollNotice( zhaohuan_name , 1 )
			CALCULATE_ITEMEFFECT_LUA_000986 = GetResString("CALCULATE_ITEMEFFECT_LUA_000986")
			SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000986 )
			GiveItem(role,0,6305,1,4)   ---黑龙召唤卷ID未定				
			return
		
		elseif sc > 129 and sc <= 135 then	--双倍经验（6/200）
			local name = GetChaDefaultName(role)
			CALCULATE_ITEMEFFECT_LUA_000987 = GetResString("CALCULATE_ITEMEFFECT_LUA_000987")
			ScrollNotice( name..CALCULATE_ITEMEFFECT_LUA_000987, 1 )
			CALCULATE_ITEMEFFECT_LUA_000988 = GetResString("CALCULATE_ITEMEFFECT_LUA_000988")
			SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000988 )
			-- AddState(role , role , STATE_SBJYGZ , 1 , 1800 )
			local statelv = 1
			local statetime =1800
			TrigASBJY(role,statelv,statetime)
			return
				
		elseif sc > 135 and sc <= 139 then	--双倍掉宝（4/200）
			local name = GetChaDefaultName(role)
			CALCULATE_ITEMEFFECT_LUA_000989 = GetResString("CALCULATE_ITEMEFFECT_LUA_000989")
			ScrollNotice( name..CALCULATE_ITEMEFFECT_LUA_000989, 1 )
			CALCULATE_ITEMEFFECT_LUA_000990 = GetResString("CALCULATE_ITEMEFFECT_LUA_000990")
			SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000990 )
			-- AddState(role , role , STATE_SBBLGZ , 1 , 1800 )
			local statelv = 1
			local statetime =1800
			TrigASBBL(role,statelv,statetime)
			return
		
		elseif sc > 139 and sc <= 152 then	--古代硬币（13/200）
			local name = GetChaDefaultName(role)
			CALCULATE_ITEMEFFECT_LUA_000991 = GetResString("CALCULATE_ITEMEFFECT_LUA_000991")
			ScrollNotice( name..CALCULATE_ITEMEFFECT_LUA_000991, 1 )
			CALCULATE_ITEMEFFECT_LUA_000992 = GetResString("CALCULATE_ITEMEFFECT_LUA_000992")
			SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000992 )
			GiveItem ( role , 0 , 6348 , 1 , 4 ) 
			return
		
		elseif sc > 152 and sc <= 199 then	--钱（47/200）
			local lv = GetChaAttr(role, ATTR_LV) 
			local money = math.random(2000,2000+lv*300)
			CALCULATE_ITEMEFFECT_LUA_000993 = GetResString("CALCULATE_ITEMEFFECT_LUA_000993")
			SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000993 )
			AddMoney(role, money,money)
			return
		
		elseif sc > 199 and sc <= 200 then	-- 超兵（1/200）
			local name = GetChaDefaultName(role)
			CALCULATE_ITEMEFFECT_LUA_000994 = GetResString("CALCULATE_ITEMEFFECT_LUA_000994")
			local name_notice = name..CALCULATE_ITEMEFFECT_LUA_000994
			ScrollNotice( name_notice , 1 )
			CALCULATE_ITEMEFFECT_LUA_000995 = GetResString("CALCULATE_ITEMEFFECT_LUA_000995")
			SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000995)
			CALCULATE_ITEMEFFECT_LUA_000996 = GetResString("CALCULATE_ITEMEFFECT_LUA_000996")
			SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000996)
			GiveItem ( role , 0 , 6347 , 1 , 4 )
			return
		
										--2008-10-07按运营需求暂时取消部分op
									
		-- elseif sc > 69 and sc <= 75 then	--装备（6/200）
			-- local Lv = Lv( role )
			-- if  Lv < 40 then 
				-- UseItemFailed ( role )
				-- SystemNotice ( role , "等级不够40级，无法获得物品。" )
				-- return
			-- elseif Lv >= 40 and Lv < 45 then
				-- SystemNotice ( role , "运气不错，获得一件40级海盗武器箱子，真棒！" )
				-- GiveItem ( role , 0 , 6350 , 1 , 4 )
				-- return
			-- elseif Lv >= 45 and Lv < 50 then
				-- SystemNotice ( role , "运气不错，获得一件45级海盗武器箱子，真棒！" )
				-- GiveItem ( role , 0 , 6351 , 1 , 4 )
				-- return			
			-- elseif Lv >= 50 and Lv < 55 then
				-- SystemNotice ( role , "运气不错，获得一件50级海盗武器箱子，真棒！" )
				-- GiveItem ( role , 0 , 6352 , 1 , 4 )
				-- return			
			-- elseif Lv >= 55 and Lv < 60 then
				-- SystemNotice ( role , "运气不错，获得一件55级海盗武器箱子，真棒！" )
				-- GiveItem ( role , 0 , 6353 , 1 , 4 )
				-- return			
			-- elseif Lv >= 60 and Lv < 65 then
				-- SystemNotice ( role , "运气不错，获得一件60级海盗武器箱子，真棒！" )
				-- GiveItem ( role , 0 , 6354 , 1 , 4 )
				-- return				
			-- elseif Lv >= 65 and Lv < 70 then
				-- SystemNotice ( role , "运气不错，获得一件65级海盗武器箱子，真棒！" )
				-- GiveItem ( role , 0 , 6355 , 1 , 4 )
				-- return		
			-- elseif Lv >= 70 and Lv < 75 then
				-- SystemNotice ( role , "运气不错，获得一件70级海盗武器箱子，真棒！" )
				-- GiveItem ( role , 0 , 6356 , 1 , 4 )
				-- return
			-- elseif Lv >= 75 then
				-- SystemNotice ( role , "运气不错，获得一件75级海盗武器箱子，真棒！" )
				-- GiveItem ( role , 0 , 6357 , 1 , 4 )
				-- return
			-- end
		
		-- elseif sc > 197 and sc <= 198 then	--组件靴子（1/200）
			-- local name = GetChaDefaultName(role)
			-- local tuijia_name = name.."开启命运宝箱时获得了古代英雄的腿甲残片，真令人羡慕！"
			-- ScrollNotice( tuijia_name , 1 )
			-- GiveItem ( role , 0 , 6346 , 1 , 4 ) 
			-- return
			
		-- elseif sc > 198 and sc <= 199 then	--组件手套（1/200）
			-- local name = GetChaDefaultName(role)
			-- local shoujia_name = name.."开启命运宝箱时获得了古代英雄的手甲残片，真令人羡慕！"
			-- ScrollNotice( shoujia_name , 1 )
			-- GiveItem ( role , 0 , 6345 , 1 , 4 ) 
			-- return
			
		-- elseif sc > 199 and sc <= 200 then	--组件衣服（1/200）
			-- local name = GetChaDefaultName(role)
			-- local xiongjia_name = name.."开启命运宝箱时获得了古代英雄的胸甲残片，真令人羡慕！"
			-- ScrollNotice( xiongjia_name , 1 )
			-- GiveItem ( role , 0 , 6344 , 1 , 4 ) 	
			-- return
			
									--2008-10-07按运营需求暂时取消部分ed
		end
end

----------------------------------------魔能结晶
function ItemUse_mohe(role,Item)						--主函数

	local Box_old = GetChaItem2 (  role , 2 , 6378 )
	local roleLv = GetChaAttr(role, ATTR_LV)
	local Box_Open = GetItemAttr ( Box_old , ITEMATTR_VAL_STA )
	local LVtype = 0
	if roleLv < 10 then																		-- *角色等级少于10级大于60级则不可使用	
		CALCULATE_ITEMEFFECT_LUA_000997 = GetResString("CALCULATE_ITEMEFFECT_LUA_000997")
		SystemNotice(role, CALCULATE_ITEMEFFECT_LUA_000997)
		UseItemFailed ( role )
		return
	end
	if roleLv>100 then
		CALCULATE_ITEMEFFECT_LUA_000998 = GetResString("CALCULATE_ITEMEFFECT_LUA_000998")
		SystemNotice(role, CALCULATE_ITEMEFFECT_LUA_000998)
		UseItemFailed ( role )
		return
	end
	local now_day= os.date("%d")															-- ***一天只能开一次
	local now_day_num= tonumber(now_day)
	local Day = now_day_num
	local IDay = GetItemAttr(Item, ITEMATTR_VAL_STR)            --STR记录魔盒打开日期
	if Day == IDay then				
		CALCULATE_ITEMEFFECT_LUA_000999 = GetResString("CALCULATE_ITEMEFFECT_LUA_000999")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000999)
		UseItemFailed ( role )
		return
	end	
	local Can_Open = GetItemAttr(Item, ITEMATTR_VAL_AGI)-- ****上线2小时才能开启
	local needtime=math.floor((240-Can_Open)/2)+1
	if Can_Open < 240 then
		CALCULATE_ITEMEFFECT_LUA_001000 = GetResString("CALCULATE_ITEMEFFECT_LUA_001000")
		CALCULATE_ITEMEFFECT_LUA_001001 = GetResString("CALCULATE_ITEMEFFECT_LUA_001001")
		SystemNotice (role,CALCULATE_ITEMEFFECT_LUA_001001..needtime..CALCULATE_ITEMEFFECT_LUA_001000)
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )										-- **开启魔盒至少需要1个物品栏空位
	if  Item_CanGet < 2 then
		CALCULATE_ITEMEFFECT_LUA_001002 = GetResString("CALCULATE_ITEMEFFECT_LUA_001002")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001002)
		UseItemFailed ( role )
		return
	end
	if roleLv < 46 then       --LVtype: 10-45级为1，，46-60为2.
		LVtype = 1
	elseif roleLv < 101 then
		LVtype = 2
	end

	if Box_Open < 9 then
		local isopen=MoHeGiveItem(role,Box_Open,LVtype)   	--根据LVtype给物品
		if isopen==0 then 
			UseItemFailed ( role )
			return
		end
		Box_Open = Box_Open + 1
		CALCULATE_ITEMEFFECT_LUA_001003 = GetResString("CALCULATE_ITEMEFFECT_LUA_001003")
		CALCULATE_ITEMEFFECT_LUA_001004 = GetResString("CALCULATE_ITEMEFFECT_LUA_001004")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001004..Box_Open..CALCULATE_ITEMEFFECT_LUA_001003)	
		GiveItem(role,0,6378,1,4)
		local Box_New = GetChaItem2 (  role , 2 , 6378 )
		SetItemAttr(Box_New, ITEMATTR_VAL_STR, Day)   	--设置为当天时间
		SetItemAttr(Box_New, ITEMATTR_VAL_AGI,0)	--上线时间清
		SetItemAttr(Box_New, ITEMATTR_VAL_STA, Box_Open)	--操作次数
		SetItemAttr(Box_New, ITEMATTR_VAL_CON, Day)
	else
		local isopen=MoHeGiveItem(role,Box_Open,LVtype)   	--根据LVtype给物品
		if isopen==0 then 
			UseItemFailed ( role )
			return
		end
		CALCULATE_ITEMEFFECT_LUA_001005 = GetResString("CALCULATE_ITEMEFFECT_LUA_001005")
		CALCULATE_ITEMEFFECT_LUA_001004 = GetResString("CALCULATE_ITEMEFFECT_LUA_001004")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001004..(Box_Open+1)..CALCULATE_ITEMEFFECT_LUA_001005)
	end
end

--===============时间存储瓶
function ItemUse_shiJianCunChu	 ( role , item )

	-- SystemNotice ( role , "达瓦")
	local Item_Hour = GetItemAttr ( item , ITEMATTR_VAL_STR )		--存储时间信息
	if Item_Hour==0 then 
		CALCULATE_ITEMEFFECT_LUA_001006 = GetResString("CALCULATE_ITEMEFFECT_LUA_001006")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001006)
		UseItemFailed ( role )
		return
	end 
	-- SystemNotice ( role , "Item_Hour========"..Item_Hour)
	local p = GetChaAttr ( role ,ATTR_EXTEND6 )
	-- SystemNotice ( role , " p=========".. p)
	if p == 10 then
		p = p - Item_Hour
		-- SystemNotice ( role , " p===============".. p)
		SetChaAttr ( role ,ATTR_EXTEND6 , p )
		CALCULATE_ITEMEFFECT_LUA_001007 = GetResString("CALCULATE_ITEMEFFECT_LUA_001007")
		CALCULATE_ITEMEFFECT_LUA_001008 = GetResString("CALCULATE_ITEMEFFECT_LUA_001008")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001008..Item_Hour..CALCULATE_ITEMEFFECT_LUA_001007)
		return
	else
		CALCULATE_ITEMEFFECT_LUA_001009 = GetResString("CALCULATE_ITEMEFFECT_LUA_001009")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001009)
		UseItemFailed ( role )
		return
	end
end

-----------------------------------时间胶水
function ItemUse_SB_Switch ( role , item )

	local Item_SB = GetChaItem2 (  role , 2 , 6370 )
	local SB_Switch = GetItemAttr ( Item_SB , ITEMATTR_VAL_STR )
	local Item_Num = CheckBagItem( role, 6370 )
	-- SystemNotice (role ,"Item_Num===="..Item_Num)
	if Item_Num == 1 and SB_Switch == 0 then
		CALCULATE_ITEMEFFECT_LUA_001010 = GetResString("CALCULATE_ITEMEFFECT_LUA_001010")
		SystemNotice (role ,CALCULATE_ITEMEFFECT_LUA_001010)
		SetItemAttr (Item_SB , ITEMATTR_VAL_STR , 1 )
		return
	elseif Item_Num == 1 and SB_Switch == 1 then
	CALCULATE_ITEMEFFECT_LUA_001011 = GetResString("CALCULATE_ITEMEFFECT_LUA_001011")
	SystemNotice (role ,CALCULATE_ITEMEFFECT_LUA_001011)
		SetItemAttr (Item_SB , ITEMATTR_VAL_STR , 0 )
		return
	elseif Item_Num < 1 then
		CALCULATE_ITEMEFFECT_LUA_001012 = GetResString("CALCULATE_ITEMEFFECT_LUA_001012")
		SystemNotice (role ,CALCULATE_ITEMEFFECT_LUA_001012)
		UseItemFailed ( role )
	end
end

function Sk_Script_Xszj ( role , Item ) 											--技能卷轴“新手重击”的使用公式

	local sk_add = SK_NEW
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	CALCULATE_ITEMEFFECT_LUA_001013 = GetResString("CALCULATE_ITEMEFFECT_LUA_001013")
	SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001013 )
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 
--星座卡
function ItemUse_XingZuoKa(role,Item)

	local roleBthM,roleBthD=GetPersonBirthday(role)
	roleBth=roleBthM*100+roleBthD
	if roleBth<0 then 
		CALCULATE_ITEMEFFECT_LUA_001014 = GetResString("CALCULATE_ITEMEFFECT_LUA_001014")
		SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_001014)
		UseItemFailed ( role )
		return
	end
	local hasBag=HasBag(role,1,Item)
	if hasBag==0 then
		UseItemFailed ( role )
		return
	end
	local i=1
	local xingzuoId=0
	for i=1,12,1 do
		local ID =5881+i
		xingzuoId=CheckBagItem(role,ID)
		if xingzuoId==1 or BankNoItem(role,ID, 1)==0 then
			CALCULATE_ITEMEFFECT_LUA_001015 = GetResString("CALCULATE_ITEMEFFECT_LUA_001015")
			SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_001015)
			UseItemFailed ( role )
			return
		end
	end
	local itemID=5881+XingZuo(roleBth)
	GiveItem ( role , 0 ,itemID, 1 , 4 )
	local rolename = GetChaDefaultName ( role )
	local itemname = GetItemName ( itemID )
	CALCULATE_ITEMEFFECT_LUA_001016 = GetResString("CALCULATE_ITEMEFFECT_LUA_001016")
	CALCULATE_ITEMEFFECT_LUA_001017 = GetResString("CALCULATE_ITEMEFFECT_LUA_001017")
	CALCULATE_FUNCTIONS_LUA_000365 = GetResString("CALCULATE_FUNCTIONS_LUA_000365")
	Notice(CALCULATE_FUNCTIONS_LUA_000365..rolename..CALCULATE_ITEMEFFECT_LUA_001017 ..itemname..CALCULATE_ITEMEFFECT_LUA_001016)
	CALCULATE_ITEMEFFECT_LUA_001016 = GetResString("CALCULATE_ITEMEFFECT_LUA_001016")
	CALCULATE_ITEMEFFECT_LUA_001017 = GetResString("CALCULATE_ITEMEFFECT_LUA_001017")
	CALCULATE_FUNCTIONS_LUA_000365 = GetResString("CALCULATE_FUNCTIONS_LUA_000365")
	ScrollNotice(CALCULATE_FUNCTIONS_LUA_000365..rolename..CALCULATE_ITEMEFFECT_LUA_001017 ..itemname..CALCULATE_ITEMEFFECT_LUA_001016,1)
end
--===============开瓶器
function ItemUse_KaiPingQi(role,Item)

	local item_XSJYCunChu = GetChaItem(role , 2, 4)
	local Item_Id = GetItemID ( item_XSJYCunChu )
	if item_XSJYCunChu==nil or Item_Id~=5895 then
		CALCULATE_ITEMEFFECT_LUA_001018 = GetResString("CALCULATE_ITEMEFFECT_LUA_001018")
		SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_001018)
		UseItemFailed ( role )
		return
	else
		local isXSJYShiFang=XSJYShiFang(role,item_XSJYCunChu)
		if isXSJYShiFang==0 then
			UseItemFailed ( role )
		end 
	end	
end 
function ItemUse_XSJYCCP(role,Item)
	local expnumLow=GetItemAttr( Item , ITEMATTR_VAL_AGI  )
	local expnumHigh=GetItemAttr( Item , ITEMATTR_VAL_STR  )
	expnum=expnumHigh*1000+expnumLow
	CALCULATE_ITEMEFFECT_LUA_001019 = GetResString("CALCULATE_ITEMEFFECT_LUA_001019")
	CALCULATE_ITEMEFFECT_LUA_001020 = GetResString("CALCULATE_ITEMEFFECT_LUA_001020")
	SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_001020..expnum..CALCULATE_ITEMEFFECT_LUA_001019)
	UseItemFailed ( role )
end 

--=============新手经验培养瓶
function ItemUse_XSJYPeiYangPing(role,Item)

	local IsOpen=GetItemAttr( Item , ITEMATTR_VAL_AGI  )
	if IsOpen~=60 then 
		NeedOpenHour=math.floor((60-IsOpen)/6)
		NeedOpenM=(math.fmod((60-IsOpen),6))*10
		CALCULATE_FUNCTIONS_LUA_000425 = GetResString("CALCULATE_FUNCTIONS_LUA_000425")
		CALCULATE_ITEMEFFECT_LUA_001021 = GetResString("CALCULATE_ITEMEFFECT_LUA_001021")
		CALCULATE_ITEMEFFECT_LUA_001022 = GetResString("CALCULATE_ITEMEFFECT_LUA_001022")
		SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_001022..NeedOpenHour..CALCULATE_ITEMEFFECT_LUA_001021..NeedOpenM..CALCULATE_FUNCTIONS_LUA_000425)
		UseItemFailed ( role )
		return
	else
		AddExpAll(role,100000,100000,1)
	end	
end
function ItemUse_SWDC(role,Item)

	local Money_Have = GetChaAttr ( role , ATTR_GD )
	if Money_Have>=999990000 then
		CALCULATE_ITEMEFFECT_LUA_000165 = GetResString("CALCULATE_ITEMEFFECT_LUA_000165")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000165)
		UseItemFailed ( role )
		return	
	end
	AddMoney ( role , 0 , 100000 )
end 
function ItemUse_MOLIBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet < 4 then
		CALCULATE_ITEMEFFECT_LUA_001023 = GetResString("CALCULATE_ITEMEFFECT_LUA_001023")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001023)
		UseItemFailed ( role )
		return
	end
	local equipId={}
		equipId[1]=5537
		equipId[2]=5553
		equipId[3]=5593
		equipId[4]=5677
		equipId[5]=5569
	local chaType = GetChaTypeID( role )
	local rand={}
		rand[1]=5
		rand[2]=5
		rand[3]=4
		rand[4]=4
	local i=0
	for i=1,4,1 do	
		if chaType==i then
			
			local a=math.random(1,rand[i])
			local j=0
			local TZname={}
				CALCULATE_ITEMEFFECT_LUA_001024 = GetResString("CALCULATE_ITEMEFFECT_LUA_001024")
				TZname[1]=CALCULATE_ITEMEFFECT_LUA_001024
				CALCULATE_ITEMEFFECT_LUA_001025 = GetResString("CALCULATE_ITEMEFFECT_LUA_001025")
				TZname[2]=CALCULATE_ITEMEFFECT_LUA_001025
				CALCULATE_ITEMEFFECT_LUA_001026 = GetResString("CALCULATE_ITEMEFFECT_LUA_001026")
				TZname[3]=CALCULATE_ITEMEFFECT_LUA_001026
				CALCULATE_ITEMEFFECT_LUA_001027 = GetResString("CALCULATE_ITEMEFFECT_LUA_001027")
				TZname[4]=CALCULATE_ITEMEFFECT_LUA_001027
				CALCULATE_ITEMEFFECT_LUA_001028 = GetResString("CALCULATE_ITEMEFFECT_LUA_001028")
				TZname[5]=CALCULATE_ITEMEFFECT_LUA_001028
			local rolename = GetChaDefaultName ( role )
			if a~=4 then
				CALCULATE_ITEMEFFECT_LUA_001029 = GetResString("CALCULATE_ITEMEFFECT_LUA_001029")
				CALCULATE_ITEMEFFECT_LUA_001030 = GetResString("CALCULATE_ITEMEFFECT_LUA_001030")
				CALCULATE_FUNCTIONS_LUA_000365 = GetResString("CALCULATE_FUNCTIONS_LUA_000365")
				ScrollNotice(CALCULATE_FUNCTIONS_LUA_000365..rolename..CALCULATE_ITEMEFFECT_LUA_001030 ..TZname[a]..CALCULATE_ITEMEFFECT_LUA_001029,1)
			end
			for j=1,4,1 do
				local ID=equipId[a]+i*4+j-5
				GiveItem ( role , 0 ,ID , 1 , 4 )
				if equipId[a]~=5677 then 
					local itemname = GetItemName ( ID )
					CALCULATE_ITEMEFFECT_LUA_001029 = GetResString("CALCULATE_ITEMEFFECT_LUA_001029")
					CALCULATE_ITEMEFFECT_LUA_001030 = GetResString("CALCULATE_ITEMEFFECT_LUA_001030")
					CALCULATE_FUNCTIONS_LUA_000365 = GetResString("CALCULATE_FUNCTIONS_LUA_000365")
					Notice(CALCULATE_FUNCTIONS_LUA_000365..rolename..CALCULATE_ITEMEFFECT_LUA_001030 ..itemname..CALCULATE_ITEMEFFECT_LUA_001029)
				end
			end
		end	
	end	
end
function ItemUse_XSSJG(role,Item)
	
	local roleLv=Lv(role)
	if roleLv >=45 then
		CALCULATE_ITEMEFFECT_LUA_001031 = GetResString("CALCULATE_ITEMEFFECT_LUA_001031")
		SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_001031)
		UseItemFailed ( role )
		return
	end
	local statelv = 4
	local statetime = 1800
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		local ret = UseAexpItem(role,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	else
		local ret = UseAexpItem(Cha_Boat,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	end	
end 
function ItemUse_ShiZhiSha( role , Item )
	local SB_Type = GetItemAttr (Item,ITEMATTR_VAL_AGI)
	local SB_LV = GetItemAttr (Item,ITEMATTR_VAL_DEX)
	local Now_Time = GetItemAttr (Item,ITEMATTR_VAL_CON)
	local itemTimeM=math.floor((SB_LV*3600-Now_Time)/60)+1
	local SBTypeHZ={}
	CALCULATE_EXP_AND_LEVEL_LUA_000047 = GetResString("CALCULATE_EXP_AND_LEVEL_LUA_000047")
	SBTypeHZ[1]=CALCULATE_EXP_AND_LEVEL_LUA_000047
	SBTypeHZ[2]=" "
	CALCULATE_ITEMEFFECT_LUA_001032 = GetResString("CALCULATE_ITEMEFFECT_LUA_001032")
	SBTypeHZ[3]=CALCULATE_ITEMEFFECT_LUA_001032
	CALCULATE_ITEMEFFECT_LUA_001033 = GetResString("CALCULATE_ITEMEFFECT_LUA_001033")
	CALCULATE_ITEMEFFECT_LUA_001034 = GetResString("CALCULATE_ITEMEFFECT_LUA_001034")
	CALCULATE_ITEMEFFECT_LUA_001035 = GetResString("CALCULATE_ITEMEFFECT_LUA_001035")
	SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_001035..itemTimeM..CALCULATE_ITEMEFFECT_LUA_001034..SBTypeHZ[SB_Type]..CALCULATE_ITEMEFFECT_LUA_001033)
	UseItemNoHint ( role )
	return
end

function ItemUse_CJShiZhiSha( role , Item )
	local SB_LV = GetItemAttr (Item,ITEMATTR_VAL_DEX)
	local Now_Time = GetItemAttr (Item,ITEMATTR_VAL_CON)
	local Buff_Lv = GetItemAttr (Item,ITEMATTR_VAL_STA)
	local itemTimeM=math.floor((SB_LV*3600-Now_Time)/60)+1
	CALCULATE_ITEMEFFECT_LUA_001036 = GetResString("CALCULATE_ITEMEFFECT_LUA_001036")
	CALCULATE_FUNCTIONS_LUA_000425 = GetResString("CALCULATE_FUNCTIONS_LUA_000425")
	CALCULATE_ITEMEFFECT_LUA_001035 = GetResString("CALCULATE_ITEMEFFECT_LUA_001035")
	SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_001035..itemTimeM..CALCULATE_FUNCTIONS_LUA_000425..Buff_Lv..CALCULATE_ITEMEFFECT_LUA_001036)
	UseItemFailed ( role )
	return
end 
function ItemUse_MGHZ(role,Item)
	local roleType=GetChaTypeID(role)
	if roleType<3 then
		local MGHZTime=GetItemAttr(Item,ITEMATTR_VAL_STR)
		local daojishis=(math.fmod((120-MGHZTime),12))*5
		local daojishim=math.floor((120-MGHZTime)/12)
		CALCULATE_ITEMEFFECT_LUA_001037 = GetResString("CALCULATE_ITEMEFFECT_LUA_001037")
		CALCULATE_ITEMEFFECT_LUA_001038 = GetResString("CALCULATE_ITEMEFFECT_LUA_001038")
		CALCULATE_ITEMEFFECT_LUA_001039 = GetResString("CALCULATE_ITEMEFFECT_LUA_001039")
		SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_001039..daojishim..CALCULATE_ITEMEFFECT_LUA_001038..daojishis..CALCULATE_ITEMEFFECT_LUA_001037)
		CALCULATE_ITEMEFFECT_LUA_001040 = GetResString("CALCULATE_ITEMEFFECT_LUA_001040")
		SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_001040)
		UseItemFailed ( role )
		return
	else
		local hasBag=HasBag(role,1,Item)
		if hasBag==0 then
			UseItemFailed ( role )
			return
		end
		GiveItem(role,0,6381,1,4)	
	end	
end 

function ItemUse_DYMGHZ(role,Item)
	local roleType=GetChaTypeID(role)
	if roleType<3 then
		local MGHZTime=GetItemAttr(Item,ITEMATTR_VAL_STR)
		local daojishis=(math.fmod((120-MGHZTime),12))*5
		local daojishim=math.floor((120-MGHZTime)/12)
		CALCULATE_ITEMEFFECT_LUA_001037 = GetResString("CALCULATE_ITEMEFFECT_LUA_001037")
		CALCULATE_ITEMEFFECT_LUA_001038 = GetResString("CALCULATE_ITEMEFFECT_LUA_001038")
		CALCULATE_ITEMEFFECT_LUA_001041 = GetResString("CALCULATE_ITEMEFFECT_LUA_001041")
		SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_001041..daojishim..CALCULATE_ITEMEFFECT_LUA_001038..daojishis..CALCULATE_ITEMEFFECT_LUA_001037)
		CALCULATE_ITEMEFFECT_LUA_001042 = GetResString("CALCULATE_ITEMEFFECT_LUA_001042")
		SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_001042)
		UseItemFailed ( role )
		return
	else
		local hasBag=HasBag(role,1,Item)
		if hasBag==0 then
			UseItemFailed ( role )
			return
		end
		GiveItem(role,0,6381,10,4)	
	end	
end 
function ItemUse_GGMGHZ(role,Item)
	local roleType=GetChaTypeID(role)
	if roleType<3 then
		local MGHZTime=GetItemAttr(Item,ITEMATTR_VAL_STR)
		local daojishis=(math.fmod((120-MGHZTime),12))*5
		local daojishim=math.floor((120-MGHZTime)/12)
		CALCULATE_ITEMEFFECT_LUA_001037 = GetResString("CALCULATE_ITEMEFFECT_LUA_001037")
		CALCULATE_ITEMEFFECT_LUA_001038 = GetResString("CALCULATE_ITEMEFFECT_LUA_001038")
		CALCULATE_ITEMEFFECT_LUA_001043 = GetResString("CALCULATE_ITEMEFFECT_LUA_001043")
		SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_001043..daojishim..CALCULATE_ITEMEFFECT_LUA_001038..daojishis..CALCULATE_ITEMEFFECT_LUA_001037)
		CALCULATE_ITEMEFFECT_LUA_001044 = GetResString("CALCULATE_ITEMEFFECT_LUA_001044")
		SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_001044)
		UseItemFailed ( role )
		return
	else
		local hasBag=HasBag(role,4,Item)
		if hasBag==0 then
			UseItemFailed ( role )
			return
		end
		GiveItem(role,0,6381,333,4)	
	end	
end 

----职业训练师回城技能   by peter 2008.9.8-------------------------------------------------------------------------------------------------------------------------------------
function Peter_Script_ZYHC (role, Item )
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
	local job = GetChaAttr( role, ATTR_JOB) --取职业
	if job == 19  then
		CALCULATE_ITEMEFFECT_LUA_001045 = GetResString("CALCULATE_ITEMEFFECT_LUA_001045")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001045 )
		UseItemFailed ( role )
		return
	end
	if job == 5 or job == 13 or job == 14  then
			CALCULATE_ITEMEFFECT_LUA_001046 = GetResString("CALCULATE_ITEMEFFECT_LUA_001046")
			MoveCity(role,CALCULATE_ITEMEFFECT_LUA_001046)
	elseif  job == 2 or job == 12   then
		CALCULATE_ITEMEFFECT_LUA_001047 = GetResString("CALCULATE_ITEMEFFECT_LUA_001047")
		MoveCity(role,CALCULATE_ITEMEFFECT_LUA_001047)
	elseif  job == 1 or job == 9  or job == 8 then
		CALCULATE_ITEMEFFECT_LUA_001048 = GetResString("CALCULATE_ITEMEFFECT_LUA_001048")
		MoveCity(role,CALCULATE_ITEMEFFECT_LUA_001048)
	else
		UseItemFailed ( role )
		return
	end
		
end
function ItemUse_HuoYingCZBX( role , Item )
	
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet < 4 then
		CALCULATE_ITEMEFFECT_LUA_001023 = GetResString("CALCULATE_ITEMEFFECT_LUA_001023")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001023)
		UseItemFailed ( role )
		return
	end
	local equipId=5577
	local chaType = GetChaTypeID( role )
	local i=0
	for i=1,4,1 do	
		if chaType==i then
			local j=0
			local rolename = GetChaDefaultName ( role )
			CALCULATE_ITEMEFFECT_LUA_001049 = GetResString("CALCULATE_ITEMEFFECT_LUA_001049")
			CALCULATE_FUNCTIONS_LUA_000365 = GetResString("CALCULATE_FUNCTIONS_LUA_000365")
			ScrollNotice(CALCULATE_FUNCTIONS_LUA_000365..rolename..CALCULATE_ITEMEFFECT_LUA_001049,1)
			for j=1,4,1 do
				local ID=equipId+i*4+j-5
				GiveItem ( role , 0 ,ID , 1 , 4 ) 
				CALCULATE_ITEMEFFECT_LUA_001049 = GetResString("CALCULATE_ITEMEFFECT_LUA_001049")
				CALCULATE_FUNCTIONS_LUA_000365 = GetResString("CALCULATE_FUNCTIONS_LUA_000365")
				Notice(CALCULATE_FUNCTIONS_LUA_000365..rolename..CALCULATE_ITEMEFFECT_LUA_001049)		
			end
		end	
	end	
end 
function ItemUse_ZSDPJboy( role , Item )
	

	local mm=Ismm(role)
	if mm == 1 then 
		CALCULATE_ITEMEFFECT_LUA_001050 = GetResString("CALCULATE_ITEMEFFECT_LUA_001050")
		SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_001050)
		UseItemFailed ( role )
		return
	end
	local isOpen=ZSDPJGive(role,Item)
	if isOpen==0 then 
		UseItemFailed ( role )
		return
	end
end
function ItemUse_ZSDPJgirl( role , Item )
	
	local mm=Ismm(role)
	if mm == 0 then 
		CALCULATE_ITEMEFFECT_LUA_001051 = GetResString("CALCULATE_ITEMEFFECT_LUA_001051")
		SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_001051)
		UseItemFailed ( role )
		return
	end
	local isOpen=ZSDPJGive(role,Item)
	if isOpen==0 then 
		UseItemFailed ( role )
		return
	end
end 
function ZSDPJGive(role,Item)
	local isBag=HasBag(role,1,Item)
	if isBag == 0 then 
		return 0
	end
	local is7=GetChaItem ( role , 2 , 6  )
	local is7Id=GetItemID ( is7 )
	local is8=GetChaItem ( role , 2 , 7  )
	local is8Id=GetItemID ( is8 )
	local itemID=GetItemID ( Item )
	local num1 = GetItemAttr(Item,ITEMATTR_VAL_AGI)
	local num2 = GetItemAttr(Item,ITEMATTR_VAL_DEX)
	if itemID==is7Id then
		id =6442
	elseif itemID==is8Id then
		id =6443
	else
		local a=math.random(0,1)
		id = 6442+a
	end
	local r1,r2 =MakeItem ( role , id  , 1 , 4 )		
	local item_PJ = GetChaItem ( role , 2 , r2 )
	SetItemAttr(item_PJ,ITEMATTR_VAL_AGI,num1)
	SetItemAttr(item_PJ,ITEMATTR_VAL_DEX,num2)
	return 1
end 

------------------------------------免费档宝箱
function ItemUse_MFDBox ( role , Item )	
local Item_CanGet = GetChaFreeBagGridNum ( role )	
local name = GetChaDefaultName( role )
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_001052 = GetResString("CALCULATE_ITEMEFFECT_LUA_001052")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001052)
		UseItemFailed ( role )
		return
	end
local tfcx=GetItemAttr(Item,ITEMATTR_URE)
	if tfcx ~= 0 then
		local time1 = math.floor(tfcx/50)
		local time2 = time1 + 1
		CALCULATE_ITEMEFFECT_LUA_001053 = GetResString("CALCULATE_ITEMEFFECT_LUA_001053")
		CALCULATE_ITEMEFFECT_LUA_001054 = GetResString("CALCULATE_ITEMEFFECT_LUA_001054")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001054..time2..CALCULATE_ITEMEFFECT_LUA_001053)
		UseItemFailed ( role )
		return
	end
	local MFDBOXGL={}
	local MFDBOXVAL={}
	local MFDBOXID={}
	local MFDBOXNum = 16
	MFDBOXGL[1]=	40000	MFDBOXVAL[1]=	1	MFDBOXID[1]=	0679
	MFDBOXGL[2]=	140000	MFDBOXVAL[2]=	1	MFDBOXID[2]=	1036
	MFDBOXGL[3]=	160000	MFDBOXVAL[3]=	1	MFDBOXID[3]=	0227
	MFDBOXGL[4]=	180000	MFDBOXVAL[4]=	1	MFDBOXID[4]=	3457
	MFDBOXGL[5]=	200000	MFDBOXVAL[5]=	1	MFDBOXID[5]=	3877
	MFDBOXGL[6]=	420000	MFDBOXVAL[6]=	1	MFDBOXID[6]=	3105
	MFDBOXGL[7]=	748999	MFDBOXVAL[7]=	1	MFDBOXID[7]=	5934
	MFDBOXGL[8]=	768999	MFDBOXVAL[8]=	1	MFDBOXID[8]=	222
	MFDBOXGL[9]=	838999	MFDBOXVAL[9]=	1	MFDBOXID[9]=	223
	MFDBOXGL[10]=	888999	MFDBOXVAL[10]=	1	MFDBOXID[10]=	224
	MFDBOXGL[11]=	918999	MFDBOXVAL[11]=	1	MFDBOXID[11]=	225
	MFDBOXGL[12]=	968999	MFDBOXVAL[12]=	1	MFDBOXID[12]=	226
	MFDBOXGL[13]=	988999	MFDBOXVAL[13]=	8	MFDBOXID[13]=	0770 --平均分配8件装备
	MFDBOXGL[14]=	998999	MFDBOXVAL[14]=	12	MFDBOXID[14]=	0781
	MFDBOXGL[15]=	999999	MFDBOXVAL[15]=	15	MFDBOXID[15]=	0799
	MFDBOXGL[16]=	1000000	MFDBOXVAL[16]=	7	MFDBOXID[16]=	0785
												MFDBOXID[17]=	0763
												MFDBOXID[18]=	0777
												MFDBOXID[19]=	0803
												MFDBOXID[20]=	0789
												MFDBOXID[21]=	0774 --平均分配12件装备
												MFDBOXID[22]=	0771
												MFDBOXID[23]=	0782
												MFDBOXID[24]=	0800
												MFDBOXID[25]=	0786
												MFDBOXID[26]=	0793
												MFDBOXID[27]=	0767
												MFDBOXID[28]=	0764
												MFDBOXID[29]=	0778
												MFDBOXID[30]=	0804
												MFDBOXID[31]=	0790
												MFDBOXID[32]=	0796
												MFDBOXID[33]=	0775----平均分配15件装备
												MFDBOXID[34]=	0772
												MFDBOXID[35]=	0783
												MFDBOXID[36]=	0801
												MFDBOXID[37]=	0787
												MFDBOXID[38]=	0794
												MFDBOXID[39]=	0768
												MFDBOXID[40]=	0765
												MFDBOXID[41]=	0779
												MFDBOXID[42]=	0805
												MFDBOXID[43]=	0791
												MFDBOXID[44]=	0797
												MFDBOXID[45]=	0807
												MFDBOXID[46]=	0808
												MFDBOXID[47]=	0812
												MFDBOXID[48]=	2826----平均分配7件装备
												MFDBOXID[49]=	2822
												MFDBOXID[50]=	2818
												MFDBOXID[51]=	2831
												MFDBOXID[52]=	2832
												MFDBOXID[53]=	2824
												MFDBOXID[54]=	2835
	local i = 0 
	local j = 0 
	local b =1 
	local a = math.random(1,MFDBOXGL[MFDBOXNum])
	for i = 1 , MFDBOXNum , 1 do 
		if a<= MFDBOXGL[i] then 
			local id = 1848 
			if  MFDBOXVAL[i] == 1 then 
				id  = MFDBOXID[b]
			else 
				j = math.random (1,MFDBOXVAL[i] )
				id  = MFDBOXID[b+j-1]
			end
			local name = GetItemName (id)
			GiveItem ( role , 0 , id , 1 , 22 )	
			CALCULATE_ITEMEFFECT_LUA_001055 = GetResString("CALCULATE_ITEMEFFECT_LUA_001055")
			SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001055..name )
			return 
		end
		b = b + MFDBOXVAL[i]
	end
		

	--[[local getrandom = math.random ( 1 , 1000000 )
	if getrandom <= 40000 then							
		CALCULATE_ITEMEFFECT_LUA_001056 = GetResString("CALCULATE_ITEMEFFECT_LUA_001056")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001056 )
		GiveItem ( role , 0 , 0679 , 1 , 22 )				------------摩豆精灵蛋
		return
	elseif getrandom > 40000 and getrandom <= 90000  then
		CALCULATE_ITEMEFFECT_LUA_001057 = GetResString("CALCULATE_ITEMEFFECT_LUA_001057")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001057 )
		GiveItem ( role , 0 , 1036 , 1 , 22 ) 				------------魔幻女神卡
		return
	elseif getrandom > 90000 and getrandom <= 140000  then
		CALCULATE_ITEMEFFECT_LUA_001058 = GetResString("CALCULATE_ITEMEFFECT_LUA_001058")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001058 )
		GiveItem ( role , 0 , 0227 , 1 , 22 ) 				------------初级精灵饲料
		return
	elseif getrandom > 140000 and getrandom <= 180000  then	
		CALCULATE_ITEMEFFECT_LUA_001059 = GetResString("CALCULATE_ITEMEFFECT_LUA_001059")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001059 )
		GiveItem ( role , 0 , 3457 , 1 , 22 ) 				------------纳卡符石
		return
	elseif getrandom > 180000 and getrandom <= 220000  then
		CALCULATE_ITEMEFFECT_LUA_001060 = GetResString("CALCULATE_ITEMEFFECT_LUA_001060")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001060 )
		GiveItem ( role , 0 , 3877 , 1 , 22 ) 				------------一级精炼石兑换券
		return
	elseif getrandom > 220000 and getrandom <= 420000  then
		CALCULATE_ITEMEFFECT_LUA_001061 = GetResString("CALCULATE_ITEMEFFECT_LUA_001061")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001061 )
		GiveItem ( role , 0 , 3105 , 1 , 22 ) 				------------行走润滑剂
		return
	elseif getrandom > 420000 and getrandom <= 720000  then
		CALCULATE_ITEMEFFECT_LUA_001062 = GetResString("CALCULATE_ITEMEFFECT_LUA_001062")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001062 )
		GiveItem ( role , 0 , 5934 , 1 , 22 ) 				------------新手升级果
		return
	elseif getrandom > 720000 and getrandom <= 770000  then
		CALCULATE_ITEMEFFECT_LUA_001063 = GetResString("CALCULATE_ITEMEFFECT_LUA_001063")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001063 )
		GiveItem ( role , 0 , 0222 , 1 , 22 ) 				------------圣雪山龙果
		return
	elseif getrandom > 770000 and getrandom <= 820000  then
		CALCULATE_ITEMEFFECT_LUA_001064 = GetResString("CALCULATE_ITEMEFFECT_LUA_001064")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001064 )
		GiveItem ( role , 0 , 0223 , 1 , 22 ) 				------------冰极爽口梅
		return
		elseif getrandom > 820000 and getrandom <= 870000 then
		CALCULATE_ITEMEFFECT_LUA_001065 = GetResString("CALCULATE_ITEMEFFECT_LUA_001065")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001065 )
		GiveItem ( role , 0 , 0224 , 1 , 22 ) 				------------海风鳕鱼丝
		return
	elseif getrandom > 870000 and getrandom <= 920000  then
		CALCULATE_ITEMEFFECT_LUA_001066 = GetResString("CALCULATE_ITEMEFFECT_LUA_001066")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001066 )
		GiveItem ( role , 0 , 0225 , 1 , 22 ) 				------------白银城果脯
		return
	elseif getrandom > 920000 and getrandom <= 970000  then
		CALCULATE_ITEMEFFECT_LUA_001067 = GetResString("CALCULATE_ITEMEFFECT_LUA_001067")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001067 )
		GiveItem ( role , 0 , 0226 , 1 , 22 ) 				------------新沙岚米饼
		return
	elseif getrandom > 970000 and getrandom <= 990000  then		------------35BB
		local a = math.random ( 1 , 8 )
		if a == 1  then
			CALCULATE_ITEMEFFECT_LUA_001068 = GetResString("CALCULATE_ITEMEFFECT_LUA_001068")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001068 )
			GiveItem ( role , 0 , 0770 , 1 , 22 ) 				------------死灵之殇
			return
		elseif a == 2  then
			CALCULATE_ITEMEFFECT_LUA_001069 = GetResString("CALCULATE_ITEMEFFECT_LUA_001069")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001069 )
			GiveItem ( role , 0 , 0781 , 1 , 22 ) 				------------亡灵之触
			return		
		elseif a == 3  then
			CALCULATE_ITEMEFFECT_LUA_001070 = GetResString("CALCULATE_ITEMEFFECT_LUA_001070")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001070 )
			GiveItem ( role , 0 , 0799 , 1 , 22 ) 				------------暗影之牙
			return		
		elseif a == 4  then
			CALCULATE_ITEMEFFECT_LUA_001071 = GetResString("CALCULATE_ITEMEFFECT_LUA_001071")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001071 )
			GiveItem ( role , 0 , 0785 , 1 , 22 ) 				------------破魔法杖
			return		
		elseif a == 5  then
			CALCULATE_ITEMEFFECT_LUA_001072 = GetResString("CALCULATE_ITEMEFFECT_LUA_001072")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001072 )
			GiveItem ( role , 0 , 0763 , 1 , 22 ) 				------------幽灵铠甲
			return		
		elseif a == 6  then
			CALCULATE_ITEMEFFECT_LUA_001073 = GetResString("CALCULATE_ITEMEFFECT_LUA_001073")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001073 )
			GiveItem ( role , 0 , 0777 , 1 , 22 ) 				------------亡灵短袍
			return
		elseif a == 7  then
			CALCULATE_ITEMEFFECT_LUA_001074 = GetResString("CALCULATE_ITEMEFFECT_LUA_001074")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001074 )
			GiveItem ( role , 0 , 0803 , 1 , 22 ) 				------------海妖披风
			return		
		elseif a == 8  then
			CALCULATE_ITEMEFFECT_LUA_001075 = GetResString("CALCULATE_ITEMEFFECT_LUA_001075")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001075 )
			GiveItem ( role , 0 , 0789 , 1 , 22 ) 				------------巫毒法袍
			return		
		end
	elseif getrandom > 990000 and getrandom <= 998999  then		-----------45BB
		local b = math.random ( 1 , 12 )
		if b == 1  then
			CALCULATE_ITEMEFFECT_LUA_001076 = GetResString("CALCULATE_ITEMEFFECT_LUA_001076")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001076 )
			GiveItem ( role , 0 , 0774 , 1 , 22 ) 				------------咒纹刺剑
			return
		elseif b == 2  then
			CALCULATE_ITEMEFFECT_LUA_001077 = GetResString("CALCULATE_ITEMEFFECT_LUA_001077")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001077 )
			GiveItem ( role , 0 , 0771 , 1 , 22 ) 				------------咒纹重剑
			return		
		elseif b == 3  then
			CALCULATE_ITEMEFFECT_LUA_001078 = GetResString("CALCULATE_ITEMEFFECT_LUA_001078")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001078 )
			GiveItem ( role , 0 , 0782 , 1 , 22 ) 				------------诅咒之吻
			return		
		elseif b == 4  then
			CALCULATE_ITEMEFFECT_LUA_001079 = GetResString("CALCULATE_ITEMEFFECT_LUA_001079")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001079 )
			GiveItem ( role , 0 , 0800 , 1 , 22 ) 				------------诅咒之刺
			return		
		elseif b == 5  then
			CALCULATE_ITEMEFFECT_LUA_001080 = GetResString("CALCULATE_ITEMEFFECT_LUA_001080")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001080 )
			GiveItem ( role , 0 , 0786 , 1 , 22 ) 				------------咒术之杖
			return		
		elseif b == 6  then
			CALCULATE_ITEMEFFECT_LUA_001081 = GetResString("CALCULATE_ITEMEFFECT_LUA_001081")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001081 )
			GiveItem ( role , 0 , 0793 , 1 , 22 ) 				------------咒文法杖
			return
		elseif b == 7  then
			CALCULATE_ITEMEFFECT_LUA_001082 = GetResString("CALCULATE_ITEMEFFECT_LUA_001082")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001082 )
			GiveItem ( role , 0 , 0767 , 1 , 22 ) 				------------诅咒之灵钢甲
			return		
		elseif b == 8  then
			CALCULATE_ITEMEFFECT_LUA_001083 = GetResString("CALCULATE_ITEMEFFECT_LUA_001083")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001083 )
			GiveItem ( role , 0 , 0764 , 1 , 22 ) 				------------武士之诅咒纹身
			return	
		elseif b == 9  then
			CALCULATE_ITEMEFFECT_LUA_001084 = GetResString("CALCULATE_ITEMEFFECT_LUA_001084")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001084 )
			GiveItem ( role , 0 , 0778 , 1 , 22 ) 				------------咒纹紧身衣
			return
		elseif b == 10  then
			CALCULATE_ITEMEFFECT_LUA_001085 = GetResString("CALCULATE_ITEMEFFECT_LUA_001085")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001085 )
			GiveItem ( role , 0 , 0804 , 1 , 22 ) 				------------咒火斗篷
			return		
		elseif b == 11  then
			CALCULATE_ITEMEFFECT_LUA_001086 = GetResString("CALCULATE_ITEMEFFECT_LUA_001086")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001086 )
			GiveItem ( role , 0 , 0790 , 1 , 22 ) 				------------符文外衣
			return		
		elseif b == 12  then
			CALCULATE_ITEMEFFECT_LUA_001087 = GetResString("CALCULATE_ITEMEFFECT_LUA_001087")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001087 )
			GiveItem ( role , 0 , 0796 , 1 , 22 ) 				------------咒文之袍
			return		
		end
	elseif getrandom > 998999 and getrandom <= 999999  then		------------55BB
		local c = math.random ( 1 , 15 )			
		if c == 1  then
			CALCULATE_ITEMEFFECT_LUA_001088 = GetResString("CALCULATE_ITEMEFFECT_LUA_001088")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001088 )
			GiveItem ( role , 0 , 0775 , 1 , 22 ) 				------------幻灵之舞
			return
		elseif c == 2  then
			CALCULATE_ITEMEFFECT_LUA_001089 = GetResString("CALCULATE_ITEMEFFECT_LUA_001089")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001089 )
			GiveItem ( role , 0 , 0772 , 1 , 22 ) 				------------幻灵之咆哮
			return		
		elseif c == 3  then
			CALCULATE_ITEMEFFECT_LUA_001090 = GetResString("CALCULATE_ITEMEFFECT_LUA_001090")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001090 )
			GiveItem ( role , 0 , 0783 , 1 , 22 ) 				------------幻灵之怒吼
			return		
		elseif c == 4  then
			CALCULATE_ITEMEFFECT_LUA_001091 = GetResString("CALCULATE_ITEMEFFECT_LUA_001091")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001091 )
			GiveItem ( role , 0 , 0801 , 1 , 22 ) 				------------幻灵之牙
			return		
		elseif c == 5  then
			CALCULATE_ITEMEFFECT_LUA_001092 = GetResString("CALCULATE_ITEMEFFECT_LUA_001092")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001092 )
			GiveItem ( role , 0 , 0787 , 1 , 22 ) 				------------幻灵之精神法杖
			return		
		elseif c == 6  then
			CALCULATE_ITEMEFFECT_LUA_001093 = GetResString("CALCULATE_ITEMEFFECT_LUA_001093")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001093 )
			GiveItem ( role , 0 , 0794 , 1 , 22 ) 				------------幻化之杖
			return
		elseif c == 7  then
			CALCULATE_ITEMEFFECT_LUA_001094 = GetResString("CALCULATE_ITEMEFFECT_LUA_001094")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001094 )
			GiveItem ( role , 0 , 0768 , 1 , 22 ) 				------------幻灵战甲
			return		
		elseif c == 8  then
			CALCULATE_ITEMEFFECT_LUA_001095 = GetResString("CALCULATE_ITEMEFFECT_LUA_001095")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001095 )
			GiveItem ( role , 0 , 0764 , 1 , 22 ) 				------------幻灵纹身
			return	
		elseif c == 9  then
			CALCULATE_ITEMEFFECT_LUA_001096 = GetResString("CALCULATE_ITEMEFFECT_LUA_001096")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001096 )
			GiveItem ( role , 0 , 0779 , 1 , 22 ) 				------------幻灵外套
			return
		elseif c == 10  then
			CALCULATE_ITEMEFFECT_LUA_001097 = GetResString("CALCULATE_ITEMEFFECT_LUA_001097")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001097 )
			GiveItem ( role , 0 , 0805 , 1 , 22 ) 				------------幻灵披风
			return		
		elseif c == 11  then
			CALCULATE_ITEMEFFECT_LUA_001098 = GetResString("CALCULATE_ITEMEFFECT_LUA_001098")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001098 )
			GiveItem ( role , 0 , 0791 , 1 , 22 ) 				------------幻法之袍
			return		
		elseif c == 12  then
			CALCULATE_ITEMEFFECT_LUA_001099 = GetResString("CALCULATE_ITEMEFFECT_LUA_001099")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001099 )
			GiveItem ( role , 0 , 0797 , 1 , 22 ) 				------------幻咒之袍
			return	
		elseif c == 13  then
			CALCULATE_ITEMEFFECT_LUA_001100 = GetResString("CALCULATE_ITEMEFFECT_LUA_001100")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001100 )
			GiveItem ( role , 0 , 0807 , 1 , 22 ) 				------------幻灵战甲手套
			return
		elseif c == 14  then
			CALCULATE_ITEMEFFECT_LUA_001101 = GetResString("CALCULATE_ITEMEFFECT_LUA_001101")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001101 )
			GiveItem ( role , 0 , 0808 , 1 , 22 ) 				------------幻灵战甲靴
			return		
		elseif c == 15  then
			CALCULATE_ITEMEFFECT_LUA_001102 = GetResString("CALCULATE_ITEMEFFECT_LUA_001102")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001102 )
			GiveItem ( role , 0 , 0812 , 1 , 22 ) 				------------幻法手套
			return		
		end
	elseif getrandom > 999999 and getrandom <= 1000000  then	-------------75BB
		local d = math.random ( 1 , 7 )
		if d == 1  then
			CALCULATE_ITEMEFFECT_LUA_001103 = GetResString("CALCULATE_ITEMEFFECT_LUA_001103")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001103 )
			GiveItem ( role , 0 , 2826 , 1 , 22 ) 				------------修罗之守护
			return
		elseif d == 2  then
			CALCULATE_ITEMEFFECT_LUA_001104 = GetResString("CALCULATE_ITEMEFFECT_LUA_001104")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001104 )
			GiveItem ( role , 0 , 2822 , 1 , 22 ) 				------------黑暗的足迹
			return		
		elseif d == 3  then
			CALCULATE_ITEMEFFECT_LUA_001105 = GetResString("CALCULATE_ITEMEFFECT_LUA_001105")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001105 )
			GiveItem ( role , 0 , 2818 , 1 , 22 ) 				------------哈迪斯的触摸
			return		
		elseif d == 4  then
			CALCULATE_ITEMEFFECT_LUA_001106 = GetResString("CALCULATE_ITEMEFFECT_LUA_001106")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001106 )
			GiveItem ( role , 0 , 2831 , 1 , 22 ) 				------------幽冥印迹
			return		
		elseif d == 5  then
			CALCULATE_ITEMEFFECT_LUA_001107 = GetResString("CALCULATE_ITEMEFFECT_LUA_001107")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001107 )
			GiveItem ( role , 0 , 2832 , 1 , 22 ) 				------------冥河之躯体
			return		
		elseif d == 6  then
			CALCULATE_ITEMEFFECT_LUA_001108 = GetResString("CALCULATE_ITEMEFFECT_LUA_001108")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001108 )
			GiveItem ( role , 0 , 2824 , 1 , 22 ) 				------------地狱的延伸
			return
		elseif d == 7  then
			CALCULATE_ITEMEFFECT_LUA_001109 = GetResString("CALCULATE_ITEMEFFECT_LUA_001109")
			Notice ( name..CALCULATE_ITEMEFFECT_LUA_001109 )
			GiveItem ( role , 0 , 2835 , 1 , 22 ) 				------------后死者的王冠
			return		
		end
	end]]
end


function ItemUse_LVUP ( role , Item )
	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	local lv = Lv(role)
	if lv >= 80 then
		CALCULATE_ITEMEFFECT_LUA_001111 = GetResString("CALCULATE_ITEMEFFECT_LUA_001111")
		SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_001111)
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 4 then 
		CALCULATE_ITEMEFFECT_LUA_001112 = GetResString("CALCULATE_ITEMEFFECT_LUA_001112")
		SystemNotice (role , CALCULATE_ITEMEFFECT_LUA_001112)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 146  , 1  , 4  )
	GiveItem ( role , 0 , 845  , 1 , 16  ) 
	GiveItem ( role , 0 , 847  , 1 , 16  )
	GiveItem ( role , 0 , 846  , 1 , 16  )
	local exp_up = GetExp[80]
	local exp_role = GetChaAttr ( role , ATTR_CLEXP )
	local exp_add = exp_up - exp_role
	local exp_add1 = exp_role + exp_add
	SetChaAttrI ( role , ATTR_CEXP , exp_add1)
end 
function ItemUse_MagicBox(role,item)
	local magicBoxID = {}
	local magicBoxNum = {}
	local magicBoxNotice = {}
	local magicnum =  	11				
	magicBoxID[1]=	3240	magicBoxNum[1]=	39		magicBoxNotice[1]=	2
	magicBoxID[2]=	6471 	magicBoxNum[2]=	63		magicBoxNotice[2]=	2
	magicBoxID[3]=	5936	magicBoxNum[3]=	103		magicBoxNotice[3]=	0
	magicBoxID[4]=	5641 	magicBoxNum[4]=	2503	magicBoxNotice[4]=	0
	magicBoxID[5]=	2835 	magicBoxNum[5]=	4903	magicBoxNotice[5]=	0
	magicBoxID[6]=	3020	magicBoxNum[6]=	5863	magicBoxNotice[6]=	0
	magicBoxID[7]=	3019	magicBoxNum[7]=	7903	magicBoxNotice[7]=	0
	magicBoxID[8]=	3018	magicBoxNum[8]=10903	magicBoxNotice[8]=	0
	magicBoxID[9]=	5699 	magicBoxNum[9]=11263	magicBoxNotice[9]=	3
	magicBoxID[10]=	5700 	magicBoxNum[10]=11623	magicBoxNotice[10]=	3
	magicBoxID[11]=	5701 	magicBoxNum[11]=11983	magicBoxNotice[11]=	3
	-- local freeBag =GetChaFreeBagGridNum  (role)
	-- if freeBag<1 then 
		-- SystemNotice(role,"请你确认你背包有空余的物品栏")
		-- UseItemFailed ( role )
		-- return
	-- end
	local i = 0
	local a = math.random (1,magicBoxNum[magicnum])
	for i = 1 ,magicnum , 1 do 
		if a<=magicBoxNum[i] then
			GiveItem(role ,0 ,magicBoxID[i] ,1,4 )
			if magicBoxNotice[i] ~= 0 then
				local Notice= {}
				CALCULATE_ITEMEFFECT_LUA_001113 = GetResString("CALCULATE_ITEMEFFECT_LUA_001113")
				Notice[1] = CALCULATE_ITEMEFFECT_LUA_001113
				CALCULATE_ITEMEFFECT_LUA_001114 = GetResString("CALCULATE_ITEMEFFECT_LUA_001114")
				Notice[2] = CALCULATE_ITEMEFFECT_LUA_001114
				CALCULATE_ITEMEFFECT_LUA_001115 = GetResString("CALCULATE_ITEMEFFECT_LUA_001115")
				Notice[3] = CALCULATE_ITEMEFFECT_LUA_001115
				local num
				local name = GetChaDefaultName(role)
				local itemName=GetItemName(magicBoxID[i])
				ScrollNotice(name..Notice[magicBoxNotice[i]]..itemName,1)
			end
			return
		end
	end
end
	


------------联众活动宝箱-----
function ItemUse_95BBBOX( role , Item )
	local Now_Day = os.date("%d")
	local Now_Month = os.date("%m")
	local Now_Time = os.date("%H")
	local Now_Year = os.date("%y")
	local NowTimeNum = tonumber(Now_Time)
	local NowDayNum = tonumber(Now_Day)
	local NowMonthNum = tonumber(Now_Month)
	local NowYearNum = tonumber(Now_Year)
	local CheckDateNum = NowYearNum * 1000000 + NowMonthNum * 10000 + NowDayNum * 100 + NowTimeNum

	if CheckDateNum < 8121417 then
		local Cha_Boat = 0
		Cha_Boat = GetCtrlBoat ( role )
		if Cha_Boat ~= nil then 
			CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
			SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
			UseItemFailed ( role ) 
			return 
		end      
		local job = GetChaAttr(role, ATTR_JOB)
		--local lv = GetChaAttr(role, ATTR_LV) 
	    	local cha_type = GetChaTypeID ( role )
		local Item_CanGet = GetChaFreeBagGridNum ( role )
		if Item_CanGet < 1 then
			CALCULATE_ITEMEFFECT_LUA_001116 = GetResString("CALCULATE_ITEMEFFECT_LUA_001116")
			SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001116)
			UseItemFailed ( role )
			return
		end 
		-- if lv < 40 then 
			-- SystemNotice(role ,"当前级别低于40级，道具使用失败！")
			-- UseItemFailed ( role )	
		-- end 
		if job == 8 then
			GiveItem( role , 0 , 6477 , 1 , 95 )
		elseif job == 9 then
			GiveItem( role , 0 , 6473 , 1 , 95 )		
		elseif job == 12 then
			GiveItem( role , 0 , 6475 , 1 , 95 )
		elseif job == 13 then 
			GiveItem( role , 0 , 6479 , 1 , 95 )
		elseif job == 14 then
			GiveItem( role , 0 , 6478 , 1 , 95 )
		elseif job == 16 then
			GiveItem( role , 0 , 6476 , 1 , 95 )
		else 
			CALCULATE_ITEMEFFECT_LUA_000873 = GetResString("CALCULATE_ITEMEFFECT_LUA_000873")
			SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000873)
			UseItemFailed ( role )	
		end
	else
		CALCULATE_ITEMEFFECT_LUA_001117 = GetResString("CALCULATE_ITEMEFFECT_LUA_001117")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_001117)
		UseItemFailed ( role )
	end
end 	

function ItemUse_guopu ( role , Item , Item_Traget ) 
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end      
		local str_Traget = GetItemAttr( Item_Traget ,ITEMATTR_VAL_STR )		--力量
		local con_Traget = GetItemAttr( Item_Traget ,ITEMATTR_VAL_CON )		--体质
		local agi_Traget = GetItemAttr( Item_Traget ,ITEMATTR_VAL_AGI )		--专注
		local dex_Traget = GetItemAttr( Item_Traget ,ITEMATTR_VAL_DEX )		--敏捷
		local sta_Traget = GetItemAttr( Item_Traget ,ITEMATTR_VAL_STA )		--精神
		local lv_Traget = str_Traget + con_Traget + agi_Traget + dex_Traget + sta_Traget  ----一个精灵的等级
		if lv_Traget > 3 then
			CALCULATE_ITEMEFFECT_LUA_000882 = GetResString("CALCULATE_ITEMEFFECT_LUA_000882")
			SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000882 ) 
			UseItemFailed ( role )
			return
		end 
		local Item_type = GetItemType ( Item )
		local Item_Traget_Type = GetItemType ( Item_Traget )
		local Item_Num = GetItemID ( Item )
		local Check_Exp = 0
		local Elf_MaxEXP = GetItemAttr(Item_Traget,ITEMATTR_MAXENERGY) 

		if Item_type == 58 and Item_Traget_Type == 59 then
				Check_Exp = CheckElf_EXP ( role , Item_Traget ) --精灵exp是否满足升级条件
				if Check_Exp == 0 then
					CALCULATE_ITEMEFFECT_LUA_000085 = GetResString("CALCULATE_ITEMEFFECT_LUA_000085")
					SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_000085 ) 
					UseItemFailed ( role )
				else
				   Lvup_Con ( role , Item_Num , Item_Traget ) --根据具体道具选择不同属性的成长函数 ( 例中为str )
				end 
		end 
end
function ItemUse_XDGLv1(role , item)
	ItemUse_XDG(role , item ,1 )
end
function ItemUse_XDGLv2(role , item)
	ItemUse_XDG(role , item ,2 )
end
function ItemUse_XDG(role , item ,num )
	local lv = GetChaAttr(role ,ATTR_LV)
	if lv< 55+11*(num-1) then
		CALCULATE_ITEMEFFECT_LUA_001118 = GetResString("CALCULATE_ITEMEFFECT_LUA_001118")
		CALCULATE_ITEMEFFECT_LUA_001119 = GetResString("CALCULATE_ITEMEFFECT_LUA_001119")
		SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_001119..55+11*(num-1)..CALCULATE_ITEMEFFECT_LUA_001118)
		UseItemFailed ( role )
		return 
	end
	if lv> 65+10*(num-1) then
		CALCULATE_ITEMEFFECT_LUA_001118 = GetResString("CALCULATE_ITEMEFFECT_LUA_001118")
		CALCULATE_ITEMEFFECT_LUA_001120 = GetResString("CALCULATE_ITEMEFFECT_LUA_001120")
		SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_001120..65+10*(num-1)..CALCULATE_ITEMEFFECT_LUA_001118)
		UseItemFailed ( role )
		return 
	end
	local cexp = GetChaAttr(role , ATTR_CEXP)
	local nlexp = GetChaAttr(role , ATTR_NLEXP)
	if cexp == nlexp-1 then
		CALCULATE_ITEMEFFECT_LUA_001121 = GetResString("CALCULATE_ITEMEFFECT_LUA_001121")
		SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_001121)
		UseItemFailed ( role )
		return 
	end
	local clexp = GetChaAttr(role , ATTR_CLEXP)
	local expadd = math.floor((cexp-clexp)*0.3)
	local exp = math.min(nlexp-1,expadd+cexp)
	SetChaAttr (role ,ATTR_CEXP, exp )
end 


function Sk_Script_WaBo ( role , Item )
	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	local Lv = Lv ( role ) 
	if Lv < 50 then
		CALCULATE_ITEMEFFECT_LUA_001122 = GetResString("CALCULATE_ITEMEFFECT_LUA_001122")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001122)
		UseItemFailed ( role )
		return
	end
	local form_sklv = GetSkillLv( role , SK_WB )
	if form_sklv ~= 0 then
		CALCULATE_ITEMEFFECT_LUA_001123 = GetResString("CALCULATE_ITEMEFFECT_LUA_001123")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001123) 
		UseItemFailed ( role )
		return
	end
	a = AddChaSkill ( role , SK_WB, 1 , 0 , 0 )  
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 
--海盗补给箱子--by:Locke.coco
function ItemUse_WaBao_HDBJBox ( role , Item )	
local map_name = GetChaMapName ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000885 = GetResString("CALCULATE_ITEMEFFECT_LUA_000885")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000885)
		UseItemFailed ( role )
		return
	end
	local getrandom = math.random ( 1 , 180 )
	if getrandom <= 10 then							----------45双剑士（蓝琦、菲利尔）手套
		CALCULATE_ITEMEFFECT_LUA_001125 = GetResString("CALCULATE_ITEMEFFECT_LUA_001125")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001125 )
		GiveItem ( role , 0 , 0478 , 1 , 14 ) 
		return
	elseif getrandom > 10 and getrandom <= 20  then		----------45狙击手（蓝琦、菲利尔）手套
		CALCULATE_ITEMEFFECT_LUA_001126 = GetResString("CALCULATE_ITEMEFFECT_LUA_001126")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001126 )
		GiveItem ( role , 0 , 0491 , 1 , 14 ) 
		return
	elseif getrandom > 20 and getrandom <= 30  then		----------45航海士（蓝琦、菲利尔）手套
		CALCULATE_ITEMEFFECT_LUA_001127 = GetResString("CALCULATE_ITEMEFFECT_LUA_001127")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001127 )
		GiveItem ( role , 0 , 0518 , 1 , 14 ) 
		return
	elseif getrandom > 30 and getrandom <= 40  then		----------45航海士（艾米）手套	
		CALCULATE_ITEMEFFECT_LUA_001128 = GetResString("CALCULATE_ITEMEFFECT_LUA_001128")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001128 )
		GiveItem ( role , 0 , 0532 , 1 , 14 ) 
		return
	elseif getrandom > 40 and getrandom <= 50  then		----------45封印师（艾米）手套
		CALCULATE_ITEMEFFECT_LUA_001129 = GetResString("CALCULATE_ITEMEFFECT_LUA_001129")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001129 )
		GiveItem ( role , 0 , 0538 , 1 , 14 ) 
		return
	elseif getrandom > 50 and getrandom <= 60  then		----------45封印师（菲利尔）手套
		CALCULATE_ITEMEFFECT_LUA_001130 = GetResString("CALCULATE_ITEMEFFECT_LUA_001130")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001130 )
		GiveItem ( role , 0 , 0551 , 1 , 14 ) 
		return
	elseif getrandom > 60 and getrandom <= 70  then		----------45圣职者（菲利尔）手套
		CALCULATE_ITEMEFFECT_LUA_001131 = GetResString("CALCULATE_ITEMEFFECT_LUA_001131")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001131 )
		GiveItem ( role , 0 , 0554 , 1 , 14 ) 
		return
	elseif getrandom > 70 and getrandom <= 80  then		----------45圣职者（艾米）手套
		CALCULATE_ITEMEFFECT_LUA_001132 = GetResString("CALCULATE_ITEMEFFECT_LUA_001132")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001132 )
		GiveItem ( role , 0 , 0564 , 1 , 14 ) 
		return
	elseif getrandom > 80 and getrandom <= 90  then		----------45巨剑士（卡西斯）手套
		CALCULATE_ITEMEFFECT_LUA_001133 = GetResString("CALCULATE_ITEMEFFECT_LUA_001133")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001133 )
		GiveItem ( role , 0 , 0477 , 1 , 14 ) 
		return
		elseif getrandom > 90 and getrandom <= 100  then	----------45双剑士（蓝琦、菲利尔）靴子
		CALCULATE_ITEMEFFECT_LUA_001134 = GetResString("CALCULATE_ITEMEFFECT_LUA_001134")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001134 )
		GiveItem ( role , 0 , 0654 , 1 , 14 ) 
		return
	elseif getrandom > 100 and getrandom <= 110  then	----------45狙击手（蓝琦、艾利尔）靴子
		CALCULATE_ITEMEFFECT_LUA_001135 = GetResString("CALCULATE_ITEMEFFECT_LUA_001135")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001135 )
		GiveItem ( role , 0 , 0667 , 1 , 14 ) 
		return
	elseif getrandom > 110 and getrandom <= 120  then	----------45航海士（蓝琦、菲利尔）靴子	
		CALCULATE_ITEMEFFECT_LUA_001136 = GetResString("CALCULATE_ITEMEFFECT_LUA_001136")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001136 )
		GiveItem ( role , 0 , 0694 , 1 , 14 ) 
		return
	elseif getrandom > 120 and getrandom <= 130  then	----------45航海士（艾米）靴子
		CALCULATE_ITEMEFFECT_LUA_001137 = GetResString("CALCULATE_ITEMEFFECT_LUA_001137")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001137 )
		GiveItem ( role , 0 , 0708 , 1 , 14 ) 
		return
	elseif getrandom > 130 and getrandom <= 140  then	----------45封印师（艾米）靴子
		CALCULATE_ITEMEFFECT_LUA_001138 = GetResString("CALCULATE_ITEMEFFECT_LUA_001138")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001138 )
		GiveItem ( role , 0 , 0714 , 1 , 14 ) 
		return
	elseif getrandom > 140 and getrandom <= 150  then	----------45封印师（菲利尔）靴子
		CALCULATE_ITEMEFFECT_LUA_001139 = GetResString("CALCULATE_ITEMEFFECT_LUA_001139")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001139 )
		GiveItem ( role , 0 , 0727 , 1 , 14 ) 
		return
	elseif getrandom > 150 and getrandom <= 160  then	----------45圣职者（菲利尔）靴子
		CALCULATE_ITEMEFFECT_LUA_001140 = GetResString("CALCULATE_ITEMEFFECT_LUA_001140")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001140 )
		GiveItem ( role , 0 , 0730 , 1 , 14 ) 
		return
	elseif getrandom > 160 and getrandom <= 170  then	----------45圣职者（艾米）靴子
		CALCULATE_ITEMEFFECT_LUA_001141 = GetResString("CALCULATE_ITEMEFFECT_LUA_001141")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001141 )
		GiveItem ( role , 0 , 0740 , 1 , 14 ) 
		return
	elseif getrandom > 170 and getrandom <= 180  then	----------45巨剑士（卡西斯）靴子
		CALCULATE_ITEMEFFECT_LUA_001142 = GetResString("CALCULATE_ITEMEFFECT_LUA_001142")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001142 )
		GiveItem ( role , 0 , 0653 , 1 , 14 ) 
		return
	end
end
--海盗军需箱子--by:Locke.coco
function ItemUse_WaBao_HDJXBox ( role , Item )
local map_name = GetChaMapName ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		CALCULATE_ITEMEFFECT_LUA_000885 = GetResString("CALCULATE_ITEMEFFECT_LUA_000885")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000885)
		UseItemFailed ( role )
		return
	end
	local getrandom = math.random ( 1 , 180 )
	if getrandom <= 10 then							----------55双剑士（蓝琦、菲利尔）手套
		CALCULATE_ITEMEFFECT_LUA_001143 = GetResString("CALCULATE_ITEMEFFECT_LUA_001143")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001143 )
		GiveItem ( role , 0 , 0479 , 1 , 14 ) 
		return
	elseif getrandom > 10 and getrandom <= 20  then		----------55狙击手（蓝琦、菲利尔）手套
		CALCULATE_ITEMEFFECT_LUA_001144 = GetResString("CALCULATE_ITEMEFFECT_LUA_001144")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001144 )
		GiveItem ( role , 0 , 0492 , 1 , 14 ) 
		return
	elseif getrandom > 20 and getrandom <= 30  then		----------55航海士（蓝琦、菲利尔）手套
		CALCULATE_ITEMEFFECT_LUA_001145 = GetResString("CALCULATE_ITEMEFFECT_LUA_001145")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001145 )
		GiveItem ( role , 0 , 0519 , 1 , 14 ) 
		return
	elseif getrandom > 30 and getrandom <= 40  then		----------55航海士（艾米）手套	
		CALCULATE_ITEMEFFECT_LUA_001146 = GetResString("CALCULATE_ITEMEFFECT_LUA_001146")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001146 )
		GiveItem ( role , 0 , 0533 , 1 , 14 ) 
		return
	elseif getrandom > 40 and getrandom <= 50  then		----------55封印师（艾米）手套
		CALCULATE_ITEMEFFECT_LUA_001147 = GetResString("CALCULATE_ITEMEFFECT_LUA_001147")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001147 )
		GiveItem ( role , 0 , 0539 , 1 , 14 ) 
		return
	elseif getrandom > 50 and getrandom <= 60  then		----------55封印师（菲利尔）手套
		CALCULATE_ITEMEFFECT_LUA_001148 = GetResString("CALCULATE_ITEMEFFECT_LUA_001148")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001148 )
		GiveItem ( role , 0 , 0552 , 1 , 14 ) 
		return
	elseif getrandom > 60 and getrandom <= 70  then		----------55圣职者（菲利尔）手套
		CALCULATE_ITEMEFFECT_LUA_001149 = GetResString("CALCULATE_ITEMEFFECT_LUA_001149")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001149 )
		GiveItem ( role , 0 , 0555 , 1 , 14 ) 
		return
	elseif getrandom > 70 and getrandom <= 80  then		----------55圣职者（艾米）手套
		CALCULATE_ITEMEFFECT_LUA_001150 = GetResString("CALCULATE_ITEMEFFECT_LUA_001150")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001150 )
		GiveItem ( role , 0 , 0567 , 1 , 14 ) 
		return
	elseif getrandom > 80 and getrandom <= 90  then		----------45巨剑士（卡西斯）手套
		CALCULATE_ITEMEFFECT_LUA_001133 = GetResString("CALCULATE_ITEMEFFECT_LUA_001133")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001133 )
		GiveItem ( role , 0 , 0477 , 1 , 14 ) 
		return
		elseif getrandom > 90 and getrandom <= 100  then	----------55双剑士（蓝琦、菲利尔）靴子
		CALCULATE_ITEMEFFECT_LUA_001151 = GetResString("CALCULATE_ITEMEFFECT_LUA_001151")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001151 )
		GiveItem ( role , 0 , 0655 , 1 , 14 ) 
		return
	elseif getrandom > 100 and getrandom <= 110  then	----------55狙击手（蓝琦、艾利尔）靴子
		CALCULATE_ITEMEFFECT_LUA_001152 = GetResString("CALCULATE_ITEMEFFECT_LUA_001152")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001152 )
		GiveItem ( role , 0 , 0668 , 1 , 14 ) 
		return
	elseif getrandom > 110 and getrandom <= 120  then	----------55航海士（蓝琦、菲利尔）靴子	
		CALCULATE_ITEMEFFECT_LUA_001153 = GetResString("CALCULATE_ITEMEFFECT_LUA_001153")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001153 )
		GiveItem ( role , 0 , 0695 , 1 , 14 ) 
		return
	elseif getrandom > 120 and getrandom <= 130  then	----------55航海士（艾米）靴子
		CALCULATE_ITEMEFFECT_LUA_001154 = GetResString("CALCULATE_ITEMEFFECT_LUA_001154")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001154 )
		GiveItem ( role , 0 , 0709 , 1 , 14 ) 
		return
	elseif getrandom > 130 and getrandom <= 140  then	----------55封印师（艾米）靴子
		CALCULATE_ITEMEFFECT_LUA_001155 = GetResString("CALCULATE_ITEMEFFECT_LUA_001155")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001155 )
		GiveItem ( role , 0 , 0715 , 1 , 14 ) 
		return
	elseif getrandom > 140 and getrandom <= 150  then	----------55封印师（菲利尔）靴子
		CALCULATE_ITEMEFFECT_LUA_001156 = GetResString("CALCULATE_ITEMEFFECT_LUA_001156")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001156 )
		GiveItem ( role , 0 , 0728 , 1 , 14 ) 
		return
	elseif getrandom > 150 and getrandom <= 160  then	----------55圣职者（菲利尔）靴子
		CALCULATE_ITEMEFFECT_LUA_001157 = GetResString("CALCULATE_ITEMEFFECT_LUA_001157")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001157 )
		GiveItem ( role , 0 , 0731 , 1 , 14 ) 
		return
	elseif getrandom > 160 and getrandom <= 170  then	----------55圣职者（艾米）靴子
		CALCULATE_ITEMEFFECT_LUA_001158 = GetResString("CALCULATE_ITEMEFFECT_LUA_001158")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001158 )
		GiveItem ( role , 0 , 0743 , 1 , 14 ) 
		return
	elseif getrandom > 170 and getrandom <= 180  then	----------45巨剑士（卡西斯）靴子
		CALCULATE_ITEMEFFECT_LUA_001142 = GetResString("CALCULATE_ITEMEFFECT_LUA_001142")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001142 )
		GiveItem ( role , 0 , 0653 , 1 , 14 ) 
		return
	end
end


function Sk_Script_WaBo ( role , Item )
	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	local Lv = Lv ( role ) 
	if Lv < 50 then
		CALCULATE_ITEMEFFECT_LUA_001122 = GetResString("CALCULATE_ITEMEFFECT_LUA_001122")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001122)
		UseItemFailed ( role )
		return
	end
	local form_sklv = GetSkillLv( role , SK_WB )
	if form_sklv ~= 0 then
		CALCULATE_ITEMEFFECT_LUA_001123 = GetResString("CALCULATE_ITEMEFFECT_LUA_001123")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001123) 
		UseItemFailed ( role )
		return
	end
	a = AddChaSkill ( role , SK_WB, 1 , 0 , 0 )  
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 


function ItemUse_65JZDH ( role , Item )	            ---65级戒指兑换券

	local item_type = BaoXiang_65JZDH
	local item_type_rad = BaoXiang_65JZDH_Rad 
	local item_type_count = BaoXiang_65JZDH_Count 
	local maxitem = BaoXiang_65JZDH_Mxcount						-- 终结编号
	local item_quality = 4
	local General = 0  
	local ItemId = 0 
	
	-- local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	-- if Item_CanGet <= 0 then
		-- SystemNotice(role ,"身上没有足够的空间，开启失败")
		-- UseItemFailed ( role )
		-- return
	-- end
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k

		end 
		b = d 
	end 
	if c == -1 then 
		ItemId = 6618 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
end

function ItemUse_75JZDH ( role , Item )	            ---75级戒指兑换券

	local item_type = BaoXiang_75JZDH
	local item_type_rad = BaoXiang_75JZDH_Rad 
	local item_type_count = BaoXiang_75JZDH_Count 
	local maxitem = BaoXiang_75JZDH_Mxcount						-- 终结编号
	local item_quality = 4
	local General = 0  
	local ItemId = 0 
	
	-- local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	-- if Item_CanGet <= 0 then
		-- SystemNotice(role ,"身上没有足够的空间，开启失败")
		-- UseItemFailed ( role )
		-- return
	-- end
	for i = 1 , maxitem , 1 do 
		General = item_type_rad [ i ] + General		
	end 
	local a = math.random ( 1, General )
	local b = 0
	local d = 0 
	local c = -1							--命中物品编号
	for k = 1 , maxitem , 1 do				-- 随机出添加的前缀编号

		d = item_type_rad [ k ] + b

		 if a <= d and a > b then
			c = k

		end 
		b = d 
	end 
	if c == -1 then 
		ItemId = 6638 
	else 
		ItemId = item_type [c]  
		ItemCount = item_type_count [c] 
	end 
	GiveItem ( role , 0 , ItemId , ItemCount , item_quality ) 
end




-------------------------------------------------------6级黑龙心匣子
function ItemUse_6JHLXBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 866
	local stone1_lv = 6
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv6StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end


-------------------------------------------------------7级黑龙心匣子
function ItemUse_7JHLXBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 866
	local stone1_lv = 7
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv7StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end


-------------------------------------------------------8级黑龙心匣子
function ItemUse_8JHLXBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 866
	local stone1_lv = 8
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv8StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end

-------------------------------------------------------9级黑龙心匣子
function ItemUse_9JHLXBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 866
	local stone1_lv = 9
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv9StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end

-------------------------------------------------------6级黑龙瞳匣子
function ItemUse_6JHLTBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 864
	local stone1_lv = 6
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv6StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end


-------------------------------------------------------7级黑龙瞳匣子
function ItemUse_7JHLTBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 864
	local stone1_lv = 7
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv7StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end


-------------------------------------------------------8级黑龙瞳匣子
function ItemUse_8JHLTBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 864
	local stone1_lv = 8
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv8StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end


-------------------------------------------------------9级黑龙瞳匣子
function ItemUse_9JHLTBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 864
	local stone1_lv = 9
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv9StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end


-------------------------------------------------------6级黑龙魂匣子
function ItemUse_6JHLHBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 865
	local stone1_lv = 6
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv6StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end


-------------------------------------------------------7级黑龙魂匣子
function ItemUse_7JHLHBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 865
	local stone1_lv = 7
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv7StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end



-------------------------------------------------------8级黑龙魂匣子
function ItemUse_8JHLHBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 865
	local stone1_lv = 8
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv8StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end



-------------------------------------------------------9级黑龙魂匣子
function ItemUse_9JHLHBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 865
	local stone1_lv = 9
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv9StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end





-------------------------------------------------------6级死神辉耀匣子
function ItemUse_6JSSHYBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 5845
	local stone1_lv = 6
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv6StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end


-------------------------------------------------------7级死神辉耀匣子
function ItemUse_7JSSHYBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 5845
	local stone1_lv = 7
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv7StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end



-------------------------------------------------------8级死神辉耀匣子
function ItemUse_8JSSHYBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 5845
	local stone1_lv = 8
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv8StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end



-------------------------------------------------------9级死神辉耀匣子
function ItemUse_9JSSHYBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 5845
	local stone1_lv = 9
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv9StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end



-------------------------------------------------------6级死神不死匣子
function ItemUse_6JSSBSBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 5846
	local stone1_lv = 6
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv6StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end


-------------------------------------------------------7级死神不死匣子
function ItemUse_7JSSBSBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 5846
	local stone1_lv = 7
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv7StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end



-------------------------------------------------------8级死神不死匣子
function ItemUse_8JSSBSBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 5846
	local stone1_lv = 8
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv8StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end



-------------------------------------------------------9级死神不死匣子
function ItemUse_9JSSBSBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 5846
	local stone1_lv = 9
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv9StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end



-------------------------------------------------------6级死神光芒匣子
function ItemUse_6JSSGMBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 5847
	local stone1_lv = 6
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv6StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end


-------------------------------------------------------7级死神光芒匣子
function ItemUse_7JSSGMBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 5847
	local stone1_lv = 7
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv7StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end



-------------------------------------------------------8级死神光芒匣子
function ItemUse_8JSSGMBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 5847
	local stone1_lv = 8
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv8StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end



-------------------------------------------------------9级死神光芒匣子
function ItemUse_9JSSGMBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 5847
	local stone1_lv = 9
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv9StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end




-------------------------------------------------------6级死神凝聚匣子
function ItemUse_6JSSNJBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 5848
	local stone1_lv = 6
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv6StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end


-------------------------------------------------------7级死神凝聚匣子
function ItemUse_7JSSNJBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 5848
	local stone1_lv = 7
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv7StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end



-------------------------------------------------------8级死神凝聚匣子
function ItemUse_8JSSNJBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 5848
	local stone1_lv = 8
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv8StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end



-------------------------------------------------------9级死神凝聚匣子
function ItemUse_9JSSNJBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 5848
	local stone1_lv = 9
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv9StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end



-------------------------------------------------------6级死神旋舞匣子
function ItemUse_6JSSXWBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 5849
	local stone1_lv = 6
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv6StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end


-------------------------------------------------------7级死神旋舞匣子
function ItemUse_7JSSXWBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 5849
	local stone1_lv = 7
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv7StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end



-------------------------------------------------------8级死神旋舞匣子
function ItemUse_8JSSXWBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 5849
	local stone1_lv = 8
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv8StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end



-------------------------------------------------------9级死神旋舞匣子
function ItemUse_9JSSXWBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 5849
	local stone1_lv = 9
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv9StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end



-------------------------------------------------------6级死神不死匣子
function ItemUse_6JSSBSBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 5846
	local stone1_lv = 6
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv6StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end


-------------------------------------------------------7级死神不死匣子
function ItemUse_7JSSBSBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 5846
	local stone1_lv = 7
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv7StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end



-------------------------------------------------------8级死神不死匣子
function ItemUse_8JSSBSBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 5846
	local stone1_lv = 8
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv8StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end



-------------------------------------------------------5级精炼石匣子
function ItemUse_5JJLSBOX ( role , Item )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = 885
	local stone1_lv = 5
	local r1,r2 =MakeItem ( role , stone1_id  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	local Item_newJLID1 = GetItemID ( Item_newJL1 )		
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
	local cha_name = GetChaDefaultName ( role )
	local now_yes = os.date("%y")		-------------年
	local now_month= os.date("%m")		-------------月
	local now_day= os.date("%d")		-------------日
	local now_hour= os.date("%H")		-------------时
	local now_miniute= os.date("%M")	-------------分
	now_yes = tonumber(now_yes)			-------------年     
	now_month= tonumber(now_month)		-------------月     
	now_day= tonumber(now_day)			-------------日     
	now_hour= tonumber(now_hour)			-------------时     
	now_miniute= tonumber(now_miniute)	 	-------------分
	LG( "Lv5StoneBox" ,cha_name, now_yes, now_month, now_day, now_hour, now_miniute , stone1_id )
end


-----------------------------2009年新年道具------------------------------------------BY L.LI

function ItemUse_JBFD( role , Item )	----------金币福袋
	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_001159 = GetResString("CALCULATE_ITEMEFFECT_LUA_001159")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001159)
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 6588  , 1 , 16 ) 	
end

function ItemUse_PTSJ ( role , Item )-----普通水饺
	local Now_Day = os.date("%d")
	local Now_Month = os.date("%m")
	local Now_Time = os.date("%H")
	local NowTimeNum = tonumber(Now_Time)
	local NowDayNum = tonumber(Now_Day)
	local NowMonthNum = tonumber(Now_Month)
	local CheckDateNum = NowMonthNum * 10000 + NowDayNum * 100 + NowTimeNum
	
	if CheckDateNum < 12524  then
		CALCULATE_ITEMEFFECT_LUA_001160 = GetResString("CALCULATE_ITEMEFFECT_LUA_001160")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001160 )
		UseItemFailed ( role )
		return
	end
  	local hp = GetChaAttr(role, ATTR_HP) 
	local mxhp = GetChaAttr(role,ATTR_MXHP) 	
	hp = hp + 20 

	if hp > mxhp then 
		hp = mxhp 
	end 
	SetCharaAttr(hp, role, ATTR_HP)

end


function ItemUse_XRSJ ( role , Item )-----鲜肉水饺
		local Now_Day = os.date("%d")
	local Now_Month = os.date("%m")
	local Now_Time = os.date("%H")
	local NowTimeNum = tonumber(Now_Time)
	local NowDayNum = tonumber(Now_Day)
	local NowMonthNum = tonumber(Now_Month)
	local CheckDateNum = NowMonthNum * 10000 + NowDayNum * 100 + NowTimeNum
	
	if CheckDateNum < 12524  then
		CALCULATE_ITEMEFFECT_LUA_001160 = GetResString("CALCULATE_ITEMEFFECT_LUA_001160")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001160 )
		UseItemFailed ( role )
		return
	end
	local sp = GetChaAttr(role, ATTR_SP) 
	local mxsp = GetChaAttr(role,ATTR_MXSP)
  	local hp = GetChaAttr(role, ATTR_HP) 
	local mxhp = GetChaAttr(role,ATTR_MXHP) 	
	hp = hp + 0.1*mxhp
	sp = sp + 0.1*mxsp
	if sp > mxsp then 
		sp = mxsp 
	end 
	if hp > mxhp then 
		hp = mxhp 
	end 
	SetCharaAttr(hp, role, ATTR_HP)
	SetCharaAttr(sp, role, ATTR_SP)
end

function ItemUse_HXSJ ( role , Item )-----海鲜水饺
	local Now_Day = os.date("%d")
	local Now_Month = os.date("%m")
	local Now_Time = os.date("%H")
	local NowTimeNum = tonumber(Now_Time)
	local NowDayNum = tonumber(Now_Day)
	local NowMonthNum = tonumber(Now_Month)
	local CheckDateNum = NowMonthNum * 10000 + NowDayNum * 100 + NowTimeNum
	
	if CheckDateNum < 12524  then
		CALCULATE_ITEMEFFECT_LUA_001160 = GetResString("CALCULATE_ITEMEFFECT_LUA_001160")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001160 )
		UseItemFailed ( role )
		return
	end
	local sp = GetChaAttr(role, ATTR_SP) 
	local mxsp = GetChaAttr(role,ATTR_MXSP)
  	local hp = GetChaAttr(role, ATTR_HP) 
	local mxhp = GetChaAttr(role,ATTR_MXHP) 	
	hp = hp + 0.15*mxhp
	sp = sp + 0.15*mxsp
	if sp > mxsp then 
		sp = mxsp 
	end 
	if hp > mxhp then 
		hp = mxhp 
	end 
	SetCharaAttr(hp, role, ATTR_HP)
	SetCharaAttr(sp, role, ATTR_SP)
end

function ItemUse_SJSJ ( role , Item )-----什锦水饺
	local Now_Day = os.date("%d")
	local Now_Month = os.date("%m")
	local Now_Time = os.date("%H")
	local NowTimeNum = tonumber(Now_Time)
	local NowDayNum = tonumber(Now_Day)
	local NowMonthNum = tonumber(Now_Month)
	local CheckDateNum = NowMonthNum * 10000 + NowDayNum * 100 + NowTimeNum
	
	if CheckDateNum < 12524  then
		CALCULATE_ITEMEFFECT_LUA_001160 = GetResString("CALCULATE_ITEMEFFECT_LUA_001160")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001160 )
		UseItemFailed ( role )
		return
	end
	local sp = GetChaAttr(role, ATTR_SP) 
	local mxsp = GetChaAttr(role,ATTR_MXSP)
  	local hp = GetChaAttr(role, ATTR_HP) 
	local mxhp = GetChaAttr(role,ATTR_MXHP) 	
	hp = hp + 0.25*mxhp
	sp = sp + 0.25*mxsp
	if sp > mxsp then 
		sp = mxsp 
	end 
	if hp > mxhp then 
		hp = mxhp 
	end 
	SetCharaAttr(hp, role, ATTR_HP)
	SetCharaAttr(sp, role, ATTR_SP)
end

function ItemUse_Jnsy ( role , Item )---加纳盛宴
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		local attr_ap = Attr_ap( role )
		local ap_extre = 1
		attr_ap = attr_ap + ap_extre 
		SetCharaAttr( attr_ap, role, ATTR_AP )
		local cha_name = GetChaDefaultName ( role ) 
		CALCULATE_ITEMEFFECT_LUA_001161 = GetResString("CALCULATE_ITEMEFFECT_LUA_001161")
		CALCULATE_FORGE_LUA_000186 = GetResString("CALCULATE_FORGE_LUA_000186")
		ScrollNotice( CALCULATE_FORGE_LUA_000186..cha_name..CALCULATE_ITEMEFFECT_LUA_001161,1 )
	else
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
end


function ItemUse_Zhenheilong2( role , Item )	----------真黑龙神盒
	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	local cha_type = GetChaTypeID ( role )
	if cha_type == 1 or cha_type == 2 or cha_type == 3 then
		if Item_CanGet < 3 then
			CALCULATE_ITEMEFFECT_LUA_001162 = GetResString("CALCULATE_ITEMEFFECT_LUA_001162")
			SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001162)
			UseItemFailed ( role )
			return
		end
	GiveItem ( role , 0 , 2367  , 1 , 20 ) 
	GiveItem ( role , 0 , 2368  , 1 , 20 ) 
	GiveItem ( role , 0 , 2369  , 1 , 20 )
	elseif cha_type == 4 then 
		if Item_CanGet < 4 then
			CALCULATE_ITEMEFFECT_LUA_001163 = GetResString("CALCULATE_ITEMEFFECT_LUA_001163")
			SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001163)
			UseItemFailed ( role )
			return
		end
		GiveItem ( role , 0 , 2367  , 1 , 20 ) 
		GiveItem ( role , 0 , 2368  , 1 , 20 ) 
		GiveItem ( role , 0 , 2369  , 1 , 20 )
		GiveItem ( role , 0 , 2370  , 1 , 20 )		
	end
end 


function ItemXianHe4 ( role , ItemID )
	-- local Cha_Boat = 0
	-- Cha_Boat = GetCtrlBoat ( role )
	-- if Cha_Boat ~=  nil then
		-- SystemNotice( role , "出海时不可使用" )
		-- UseItemFailed ( role )
		-- return
	-- end
	-- local Item_CanGet = GetChaFreeBagGridNum ( role )
	-- if Item_CanGet <1 then
		-- SystemNotice(role ,"要打开宝箱需要背包里至少有1个空位")
		-- UseItemFailed ( role )
		-- return
	-- end
	local stone1_id = ItemID
	local stone1_lv = math.random(1,4)
	local r1,r2 =MakeItem ( role , ItemID  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
end


function ItemShenHe8 ( role , ItemID )

	-- local Cha_Boat = 0
	-- Cha_Boat = GetCtrlBoat ( role )
	-- if Cha_Boat ~=  nil then
		-- SystemNotice( role , "出海时不可使用" )
		-- UseItemFailed ( role )
		-- return
	-- end
	-- local Item_CanGet = GetChaFreeBagGridNum ( role )
	-- if Item_CanGet <1 then
		-- SystemNotice(role ,"要打开宝箱需要背包里至少有1个空位")
		-- UseItemFailed ( role )
		-- return
	-- end
	local stone1_id = ItemID
	local stoneGL = {}
	stoneGL[5 ] = 85
	stoneGL[6 ] = 10
	stoneGL[7 ] = 4
	stoneGL[8 ] = 1
	local stone1_lv =5 
	local ret = math.random(1,100)
	while ret>stoneGL[stone1_lv ] and stone1_lv<=8 and stone1_lv>=5 do
		ret = ret - stoneGL[stone1_lv ]
		stone1_lv = stone1_lv+1
	end
	local r1,r2 =MakeItem ( role , ItemID  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
end


function ItemUse_XianHe1Box (  role , Item )		------风灵仙盒
	ItemXianHe4 ( role , 860 )		
end 


function ItemUse_XianHe2Box (  role , Item )		------鹰眼石仙盒
	ItemXianHe4 ( role , 861 )		
end 

function ItemUse_XianHe3Box (  role , Item )		-----岩玉仙盒
	ItemXianHe4 ( role , 862 )		
end 


function ItemUse_XianHe4Box (  role , Item )		------炎玉仙盒
	ItemXianHe4 ( role , 863 )		
end 


function ItemUse_XianHe5Box (  role , Item )		------黑龙之瞳仙盒
	ItemXianHe4 ( role , 864 )		
end 


function ItemUse_XianHe6Box (  role , Item )		------黑龙之瞳仙盒
	ItemXianHe4 ( role , 865 )		
end 


function ItemUse_XianHe7Box (  role , Item )		------黑龙之心仙盒
	ItemXianHe4 ( role , 866 )		
end 


function ItemUse_XianHe8Box (  role , Item )		------加纳之神仙盒
	ItemXianHe4 ( role , 1012)		
end 


function ItemUse_XianHe9Box (  role , Item )		------精炼石仙盒
	ItemXianHe4 ( role , 885)		
end 


function ItemUse_XianHe10Box (  role , Item )		------死神辉耀仙盒
	ItemXianHe4 ( role , 5845)		
end 


function ItemUse_XianHe11Box (  role , Item )		------死神不死仙盒
	ItemXianHe4 ( role , 5846)		
end 


function ItemUse_XianHe12Box (  role , Item )		------死神光芒仙盒
	ItemXianHe4 ( role , 5847)		
end 


function ItemUse_XianHe13Box (  role , Item )		------死神凝聚仙盒
	ItemXianHe4 ( role , 5848)		
end 


function ItemUse_XianHe14Box (  role , Item )		------死神旋舞仙盒
	ItemXianHe4 ( role , 5849)		
end 

function ItemUse_XianHe15Box (  role , Item )		------黄玉仙盒
	ItemXianHe4 ( role , 5750)		
end 


function ItemUse_XianHe16Box (  role , Item )		------赤玉仙盒
	ItemXianHe4 ( role , 5751)		
end 

function ItemUse_XianHe17Box (  role , Item )		------青玉仙盒
	ItemXianHe4 ( role , 5752)		
end 


function ItemUse_XianHe18Box (  role , Item )		------夏天灵光仙盒
	ItemXianHe4 ( role , 5771)		
end

function ItemUse_XianHe19Box (  role , Item )		------洛克必中仙盒
	ItemXianHe4 ( role , 5772)		
end  


function ItemUse_XianHe20Box (  role , Item )		------冰冰躲闪仙盒
	ItemXianHe4 ( role , 5773)		
end  


function ItemUse_XianHe21Box (  role , Item )		------丰烽抵御仙盒
	ItemXianHe4 ( role , 5774)		
end 


function ItemUse_XianHe22Box (  role , Item )		------夏克强化仙盒
	ItemXianHe4 ( role , 5775)		
end 


function ItemUse_ShenHe1Box (  role , Item )		------风灵仙盒
	ItemShenHe8 ( role , 860 )		
end 


function ItemUse_ShenHe2Box (  role , Item )		------鹰眼石仙盒
	ItemShenHe8 ( role , 861 )		
end 

function ItemUse_ShenHe3Box (  role , Item )		-----岩玉仙盒
	ItemShenHe8 ( role , 862 )		
end 


function ItemUse_ShenHe4Box (  role , Item )		------炎玉仙盒
	ItemShenHe8 ( role , 863 )		
end 


function ItemUse_ShenHe5Box (  role , Item )		------黑龙之瞳仙盒
	ItemShenHe8 ( role , 864 )		
end 


function ItemUse_ShenHe6Box (  role , Item )		------黑龙之瞳仙盒
	ItemShenHe8 ( role , 865 )		
end 


function ItemUse_ShenHe7Box (  role , Item )		------黑龙之心仙盒
	ItemShenHe8 ( role , 866 )		
end 


function ItemUse_ShenHe8Box (  role , Item )		------加纳之神仙盒
	ItemShenHe8 ( role , 1012)		
end 


function ItemUse_ShenHe9Box (  role , Item )		------精炼石仙盒
	ItemShenHe8 ( role , 885)		
end 


function ItemUse_ShenHe10Box (  role , Item )		------死神辉耀仙盒
	ItemShenHe8 ( role , 5845)		
end 


function ItemUse_ShenHe11Box (  role , Item )		------死神不死仙盒
	ItemShenHe8 ( role , 5846)		
end 


function ItemUse_ShenHe12Box (  role , Item )		------死神光芒仙盒
	ItemShenHe8 ( role , 5847)		
end 


function ItemUse_ShenHe13Box (  role , Item )		------死神凝聚仙盒
	ItemShenHe8 ( role , 5848)		
end 


function ItemUse_ShenHe14Box (  role , Item )		------死神旋舞仙盒
	ItemShenHe8 ( role , 5849)		
end 

function ItemUse_ShenHe15Box (  role , Item )		------黄玉仙盒
	ItemShenHe8 ( role , 5750)		
end 


function ItemUse_ShenHe16Box (  role , Item )		------赤玉仙盒
	ItemShenHe8 ( role , 5751)		
end 

function ItemUse_ShenHe17Box (  role , Item )		------青玉仙盒
	ItemShenHe8 ( role , 5752)		
end 


function ItemUse_ShenHe18Box (  role , Item )		------夏天灵光仙盒
	ItemShenHe8 ( role , 5771)		
end

function ItemUse_ShenHe19Box (  role , Item )		------洛克必中仙盒
	ItemShenHe8 ( role , 5772)		
end  


function ItemUse_ShenHe20Box (  role , Item )		------冰冰躲闪仙盒
	ItemShenHe8 ( role , 5773)		
end  


function ItemUse_ShenHe21Box (  role , Item )		------丰烽抵御仙盒
	ItemShenHe8 ( role , 5774)		
end 


function ItemUse_ShenHe22Box (  role , Item )		------夏克强化仙盒
	ItemShenHe8 ( role , 5775)		
end

function ItemUse_HYLRGJSZHQ ( role , Item  )		--------花园狼人弓箭手召唤券by_Loch.Bai

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local star = 0
	star =IsChaInRegion( role, 2 )
	if star == 1 then
		CALCULATE_ITEMEFFECT_LUA_000234 = GetResString("CALCULATE_ITEMEFFECT_LUA_000234")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000234 )
		UseItemFailed ( role )
		return
	end
	local x, y = GetChaPos(role)
	local MonsterID = 741
	local Refresh = 3700					--重生时间，秒单位
	local life = 3600000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x-300 , y-300 , 145 , Refresh, role )
	SetChaLifeTime( new, life )
end
 ------------------属性重置胶囊 by L.li  20090226-----
 -- function ItemUse_SXCZ (role,Item)
	---------------洗角色属性点
	-- local ap = GetChaAttr( role , ATTR_AP )
	---SystemNotice(role ,"剩余属性点=="..ap)
	-- local cha_str = GetChaAttr(role, ATTR_BSTR  ) 
	-- local cha_dex = GetChaAttr(role, ATTR_BDEX  ) 
	-- local cha_agi = GetChaAttr(role, ATTR_BAGI  ) 
	-- local cha_con = GetChaAttr(role, ATTR_BCON ) 
	-- local cha_sta = GetChaAttr(role, ATTR_BSTA )
	-- ap=ap+cha_str+cha_dex+cha_agi+cha_con+cha_sta-25
	-- SetChaAttr(role, ATTR_BSTR ,5 ) 
	-- SyncChar(role,4)
	-- SetChaAttr(role, ATTR_BDEX ,5 ) 
	-- SyncChar(role,4)
	-- SetChaAttr(role, ATTR_BAGI ,5 ) 
	-- SyncChar(role,4)
	-- SetChaAttr(role, ATTR_BCON,5 ) 
	-- SyncChar(role,4)
	-- SetChaAttr(role, ATTR_BSTA,5 ) 
	-- SyncChar(role,4)
	-- SetChaAttr(role , ATTR_AP,ap  )
	-- SyncChar(role,4)
-- end
function ItemUse_QJZhenheilong ( role , Item )
	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	local cha_type = GetChaTypeID ( role )
	if cha_type == 1 or cha_type == 2 or cha_type == 3 then
		if Item_CanGet < 3 then
			CALCULATE_ITEMEFFECT_LUA_001164 = GetResString("CALCULATE_ITEMEFFECT_LUA_001164")
			SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001164)
			UseItemFailed ( role )
			return
		end
		GiveItem ( role , 0 , 0845  , 1 , 20 ) 
		GiveItem ( role , 0 , 0846  , 1 , 20 ) 
		GiveItem ( role , 0 , 0847  , 1 , 20 )
	elseif cha_type == 4 then 
		if Item_CanGet < 4 then
			CALCULATE_ITEMEFFECT_LUA_001165 = GetResString("CALCULATE_ITEMEFFECT_LUA_001165")
			SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001165)
			UseItemFailed ( role )
			return
		end
		GiveItem ( role , 0 , 0845  , 1 , 20 ) 
		GiveItem ( role , 0 , 0846  , 1 , 20 ) 
		GiveItem ( role , 0 , 0847  , 1 , 20 )
		GiveItem ( role , 0 , 0848  , 1 , 20 )		
	end
end 



function ItemBaoHe5 ( role , ItemID )			------------5级石头
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_id = ItemID
	local stone1_lv = 5
	local r1,r2 =MakeItem ( role , ItemID  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
end


function ItemBaoHe8 ( role , ItemID )			-------------8级石头
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <1 then
		CALCULATE_ITEMEFFECT_LUA_000118 = GetResString("CALCULATE_ITEMEFFECT_LUA_000118")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000118)
		UseItemFailed ( role )
		return
	end
	local stone1_lv = 8
	local r1,r2 =MakeItem ( role , ItemID  , 1 , 4 )
	local Item_newJL1 = GetChaItem ( role , 2 , r2 )			
	SetItemAttr ( Item_newJL1 , ITEMATTR_VAL_BaoshiLV , stone1_lv)
	SynChaKitbag(role,13)
end 

function ItemUse_BaoHe01Box (role, Item)
	ItemBaoHe5 ( role , 0863 )
end


function ItemUse_BaoHe02Box (role, Item)
	ItemBaoHe5 ( role , 0862 )
end

function ItemUse_BaoHe03Box (role, Item)
	ItemBaoHe5 ( role , 0860 )
end

function ItemUse_BaoHe04Box (role, Item)
	ItemBaoHe5 ( role , 0861 )
end

function ItemUse_BaoHe05Box (role, Item)
	ItemBaoHe5 ( role , 1012 )
end

function ItemUse_BaoHe06Box (role, Item)
	ItemBaoHe5 ( role , 5846 )
end


function ItemUse_BaoHe07Box (role, Item)
	ItemBaoHe5 ( role , 5845 )
end


function ItemUse_BaoHe08Box (role, Item)
	ItemBaoHe5 ( role , 5847 )
end


function ItemUse_BaoHe09Box (role, Item)
	ItemBaoHe5 ( role , 5849 )
end

function ItemUse_BaoHe10Box (role, Item)
	ItemBaoHe5 ( role , 5848 )
end

function ItemUse_BaoHe11Box (role, Item)
	ItemBaoHe5 ( role , 5771 )
end


function ItemUse_BaoHe12Box (role, Item)
	ItemBaoHe5 ( role , 5773 )
end


function ItemUse_BaoHe13Box (role, Item)
	ItemBaoHe5 ( role , 5772 )
end


function ItemUse_BaoHe14Box (role, Item)
	ItemBaoHe5 ( role , 5774 )
end

function ItemUse_BaoHe15Box (role, Item)
	ItemBaoHe5 ( role , 5775 )
end


function ItemUse_BaoHe16Box (role, Item)
	ItemBaoHe5 ( role , 5750 )
end


function ItemUse_BaoHe17Box (role, Item)
	ItemBaoHe5 ( role , 5752 )
end


function ItemUse_BaoHe18Box (role, Item)
	ItemBaoHe5 ( role , 5751 )
end


function ItemUse_BaoHe19Box (role, Item)
	ItemBaoHe8 ( role , 863 )
end

function ItemUse_BaoHe20Box (role, Item)
	ItemBaoHe8 ( role , 862 )
end

function ItemUse_BaoHe21Box (role, Item)
	ItemBaoHe8 ( role , 860 )
end

function ItemUse_BaoHe22Box (role, Item)
	ItemBaoHe8 ( role , 861 )
end

function ItemUse_BaoHe23Box (role, Item)
	ItemBaoHe8 ( role , 1012 )
end

function ItemUse_BaoHe24Box (role, Item)
	ItemBaoHe8 ( role , 885 )
end

function ItemUse_BaoHe25Box (role, Item)
	ItemBaoHe8 ( role , 5771 )
end

function ItemUse_BaoHe26Box (role, Item)
	ItemBaoHe8 ( role , 5773 )
end

function ItemUse_BaoHe27Box (role, Item)
	ItemBaoHe8 ( role , 5772 )
end


function ItemUse_BaoHe28Box (role, Item)
	ItemBaoHe8 ( role , 5774 )
end

function ItemUse_BaoHe29Box (role, Item)
	ItemBaoHe8 ( role , 5775 )
end


function ItemUse_BaoHe30Box (role, Item)
	ItemBaoHe8 ( role , 5750 )
end

function ItemUse_BaoHe31Box (role, Item)
	ItemBaoHe8 ( role , 5752 )
end

function ItemUse_BaoHe32Box (role, Item)
	ItemBaoHe8 ( role , 5751 )
end 


function ItemUse_MagicBox2 ( role , Item )
	local name = GetChaDefaultName(role)
	-- local Cha_Boat = 0
	-- Cha_Boat = GetCtrlBoat ( role )
	-- if Cha_Boat ~=  nil then
		-- SystemNotice( role , "出海时不可使用" )
		-- UseItemFailed ( role )
		-- return
	-- end
	-- local Item_CanGet = GetChaFreeBagGridNum ( role )
	-- if Item_CanGet <1 then
		-- SystemNotice(role ,"要打开宝箱需要背包里至少有1个空位")
		-- UseItemFailed ( role )
		-- return
	-- end
	local a = math.random ( 1 , 10000 )
	if a > 0 and a < 176 then
		GiveItem ( role , 0 , 6671 , 1 , 4 )
		CALCULATE_ITEMEFFECT_LUA_001166 = GetResString("CALCULATE_ITEMEFFECT_LUA_001166")
		ScrollNotice(name..CALCULATE_ITEMEFFECT_LUA_001166,1)
	elseif a >= 176 and a < 351 then
		GiveItem ( role , 0 , 6695 , 1 , 4 )
		CALCULATE_ITEMEFFECT_LUA_001167 = GetResString("CALCULATE_ITEMEFFECT_LUA_001167")
		ScrollNotice(name..CALCULATE_ITEMEFFECT_LUA_001167,1)
	elseif a >= 351 and a < 526 then
		GiveItem ( role , 0 , 6691 , 1 , 4 )
		CALCULATE_ITEMEFFECT_LUA_001168 = GetResString("CALCULATE_ITEMEFFECT_LUA_001168")
		ScrollNotice(name..CALCULATE_ITEMEFFECT_LUA_001168,1)
	elseif a >= 526 and a < 701 then
		GiveItem ( role , 0 , 6683 , 1 , 4 )
		CALCULATE_ITEMEFFECT_LUA_001169 = GetResString("CALCULATE_ITEMEFFECT_LUA_001169")
		ScrollNotice(name..CALCULATE_ITEMEFFECT_LUA_001169,1)
	elseif a >= 701 and a < 801 then
		GiveItem ( role , 0 , 3240 , 1 , 4 )
		CALCULATE_ITEMEFFECT_LUA_001170 = GetResString("CALCULATE_ITEMEFFECT_LUA_001170")
		ScrollNotice(name..CALCULATE_ITEMEFFECT_LUA_001170,1)
	elseif a >= 801 and a < 1501 then
		GiveItem ( role , 0 , 5936 , 1 , 4 )
		CALCULATE_ITEMEFFECT_LUA_001171 = GetResString("CALCULATE_ITEMEFFECT_LUA_001171")
		ScrollNotice(name..CALCULATE_ITEMEFFECT_LUA_001171,1)
	elseif a >= 1501 and a < 2451 then
		GiveItem ( role , 0 , 6759 , 1 , 4 )	
	elseif a >= 2451 and a < 3401 then
		GiveItem ( role , 0 , 6760 , 1 , 4 )		
	elseif a >= 3401 and a < 5101 then
		GiveItem ( role , 0 , 6612 , 10 , 4 )
	elseif a >= 5101 and a < 6701 then
		GiveItem ( role , 0 , 1860 , 1 , 4 )	
	elseif a >= 6701 and a < 8301 then
		GiveItem ( role , 0 , 1871 , 1 , 4 )
	else 
		GiveItem ( role , 0 , 5618 , 10 , 4 )
	end
end 
function ItemUse_HappySiLiao( role , Item , Item_Traget )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end      
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Item_Traget_URE=GetItemAttr(Item_Traget,ITEMATTR_URE)  --取当前耐久
	local Item_Traget_MAXURE=GetItemAttr(Item_Traget,ITEMATTR_MAXURE)--取最大耐久
	local Item_type = GetItemType ( Item )
	local Item_Traget_Type = GetItemType ( Item_Traget )
	local elfLV=GetElfLV(Item_Traget)
	local Num = 2500
	if Item_type == 57 and Item_Traget_Type == 59 then
		if Item_Traget_URE < Item_Traget_MAXURE then
			Give_ElfURE ( role , Item_Traget , Num )
			local statelv = 1
			local statetime = 20*60
			AddNewState(role,NSTATE_JYNOXH,statelv,statetime,elfLV)
			CALCULATE_ITEMEFFECT_LUA_001172 = GetResString("CALCULATE_ITEMEFFECT_LUA_001172")
			HelpInfo(role,0,CALCULATE_ITEMEFFECT_LUA_001172)
		else
			CALCULATE_ITEMEFFECT_LUA_001173 = GetResString("CALCULATE_ITEMEFFECT_LUA_001173")
			HelpInfo(role,0,CALCULATE_ITEMEFFECT_LUA_001173)
			UseItemFailed ( role )
			return
		end
	end 
end
function ItemUse_AdvancedHappySiLiao( role , Item , Item_Traget )	
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end      
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Item_Traget_URE=GetItemAttr(Item_Traget,ITEMATTR_URE)  --取当前耐久
	local Item_Traget_MAXURE=GetItemAttr(Item_Traget,ITEMATTR_MAXURE)--取最大耐久
	local Item_type = GetItemType ( Item )
	local Item_Traget_Type = GetItemType ( Item_Traget )
	local elfLV=GetElfLV(Item_Traget)
	local Num = 5000
	if Item_type == 57 and Item_Traget_Type == 59 then
		if Item_Traget_URE < Item_Traget_MAXURE then
			Give_ElfURE ( role , Item_Traget , Num )
			local statelv = 1
			local statetime = 40*60
			AddNewState(role,NSTATE_JYNOXH,statelv,statetime,elfLV)
			CALCULATE_ITEMEFFECT_LUA_001174 = GetResString("CALCULATE_ITEMEFFECT_LUA_001174")
			HelpInfo(role,0,CALCULATE_ITEMEFFECT_LUA_001174)
		else
			CALCULATE_ITEMEFFECT_LUA_001175 = GetResString("CALCULATE_ITEMEFFECT_LUA_001175")
			HelpInfo(role,0,CALCULATE_ITEMEFFECT_LUA_001175)
			UseItemFailed ( role )
			return
		end
	end 
end

function ItemUse_3BChanChu( role , Item , Item_Traget )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end      
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Item_type = GetItemType ( Item )
	local Item_Traget_Type = GetItemType ( Item_Traget )
	local elfLV=GetElfLV(Item_Traget)
	if Item_type == 57 and Item_Traget_Type == 59 then
		local stateLV = GetNewStateLV(role,NSTATE_JYCC,elfLV)
		local statelv = 2
		local statetime = 30*60
		local itemNO=GetItemID(Item)
		local itemName=GetItemName (itemNO)
		if statelv >= stateLV then 
			AddNewState(role,NSTATE_JYCC,statelv,statetime,elfLV)
			CALCULATE_ITEMEFFECT_LUA_001176 = GetResString("CALCULATE_ITEMEFFECT_LUA_001176")
			CALCULATE_ITEMEFFECT_LUA_001177 = GetResString("CALCULATE_ITEMEFFECT_LUA_001177")
			HelpInfo(role,0,CALCULATE_ITEMEFFECT_LUA_001177..itemName..CALCULATE_ITEMEFFECT_LUA_001176)
		else
			CALCULATE_ITEMEFFECT_LUA_001178 = GetResString("CALCULATE_ITEMEFFECT_LUA_001178")
			CALCULATE_ITEMEFFECT_LUA_001177 = GetResString("CALCULATE_ITEMEFFECT_LUA_001177")
			HelpInfo(role,0,CALCULATE_ITEMEFFECT_LUA_001177..itemName..CALCULATE_ITEMEFFECT_LUA_001178)
			UseItemFailed ( role )
		end
	end 
end
function ItemUse_2BChanChu( role , Item , Item_Traget )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end      
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Item_type = GetItemType ( Item )
	local Item_Traget_Type = GetItemType ( Item_Traget )
	local elfLV=GetElfLV(Item_Traget)
	if Item_type == 57 and Item_Traget_Type == 59 then
		local stateLV = GetNewStateLV(role,NSTATE_JYCC,elfLV)
		local statelv = 1
		local statetime = 30*60
		local itemNO=GetItemID(Item)
		local itemName=GetItemName (itemNO)
		if statelv >= stateLV then 
			AddNewState(role,NSTATE_JYCC,statelv,statetime,elfLV)
			CALCULATE_ITEMEFFECT_LUA_001179 = GetResString("CALCULATE_ITEMEFFECT_LUA_001179")
			CALCULATE_ITEMEFFECT_LUA_001177 = GetResString("CALCULATE_ITEMEFFECT_LUA_001177")
			HelpInfo(role,0,CALCULATE_ITEMEFFECT_LUA_001177..itemName..CALCULATE_ITEMEFFECT_LUA_001179)
		else
			CALCULATE_ITEMEFFECT_LUA_001178 = GetResString("CALCULATE_ITEMEFFECT_LUA_001178")
			CALCULATE_ITEMEFFECT_LUA_001177 = GetResString("CALCULATE_ITEMEFFECT_LUA_001177")
			HelpInfo(role,0,CALCULATE_ITEMEFFECT_LUA_001177..itemName..CALCULATE_ITEMEFFECT_LUA_001178)
			UseItemFailed ( role )
		end
	end 
end
function ItemUse_2BChengZhang( role , Item , Item_Traget )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end      
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Item_type = GetItemType ( Item )
	local Item_Traget_Type = GetItemType ( Item_Traget )
	local elfLV=GetElfLV(Item_Traget)
	if Item_type == 57 and Item_Traget_Type == 59 then
		local stateLV = GetNewStateLV(role,NSTATE_JYCZ,elfLV)
		local statelv = 1
		local statetime = 30*60
		local itemNO=GetItemID(Item)
		local itemName=GetItemName (itemNO)
		if statelv >= stateLV then 
			AddNewState(role,NSTATE_JYCZ,statelv,statetime,elfLV)
			CALCULATE_ITEMEFFECT_LUA_001180 = GetResString("CALCULATE_ITEMEFFECT_LUA_001180")
			CALCULATE_ITEMEFFECT_LUA_001177 = GetResString("CALCULATE_ITEMEFFECT_LUA_001177")
			HelpInfo(role,0,CALCULATE_ITEMEFFECT_LUA_001177..itemName..CALCULATE_ITEMEFFECT_LUA_001180)
		else
			CALCULATE_ITEMEFFECT_LUA_001178 = GetResString("CALCULATE_ITEMEFFECT_LUA_001178")
			CALCULATE_ITEMEFFECT_LUA_001177 = GetResString("CALCULATE_ITEMEFFECT_LUA_001177")
			HelpInfo(role,0,CALCULATE_ITEMEFFECT_LUA_001177..itemName..CALCULATE_ITEMEFFECT_LUA_001178)
			UseItemFailed ( role )
		end
	end 
end
function ItemUse_3BChengZhang( role , Item , Item_Traget )
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end      
	local ret = CheckJingLingLv( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_000079 = GetResString("CALCULATE_ITEMEFFECT_LUA_000079")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_000079)
		UseItemFailed ( role ) 
		return 
	end
	local Item_type = GetItemType ( Item )
	local Item_Traget_Type = GetItemType ( Item_Traget )
	local elfLV=GetElfLV(Item_Traget)
	if Item_type == 57 and Item_Traget_Type == 59 then
		local stateLV = GetNewStateLV(role,NSTATE_JYCZ,elfLV)
		local statelv = 2
		local statetime = 30*60
		local itemNO=GetItemID(Item)
		local itemName=GetItemName (itemNO)
		if statelv >= stateLV then 
			AddNewState(role,NSTATE_JYCZ,statelv,statetime,elfLV)
			CALCULATE_ITEMEFFECT_LUA_001181 = GetResString("CALCULATE_ITEMEFFECT_LUA_001181")
			CALCULATE_ITEMEFFECT_LUA_001177 = GetResString("CALCULATE_ITEMEFFECT_LUA_001177")
			HelpInfo(role,0,CALCULATE_ITEMEFFECT_LUA_001177..itemName..CALCULATE_ITEMEFFECT_LUA_001181)
		else
			CALCULATE_ITEMEFFECT_LUA_001178 = GetResString("CALCULATE_ITEMEFFECT_LUA_001178")
			CALCULATE_ITEMEFFECT_LUA_001177 = GetResString("CALCULATE_ITEMEFFECT_LUA_001177")
			HelpInfo(role,0,CALCULATE_ITEMEFFECT_LUA_001177..itemName..CALCULATE_ITEMEFFECT_LUA_001178)
			UseItemFailed ( role )
		end
	end 
end

function CheckCanUseSpeedLVUP(elf)
	local elfUre=GetItemAttr(elf,ITEMATTR_URE)  --取当前耐久
	local elfMaxUre=GetItemAttr(elf,ITEMATTR_MAXURE)
	local urePer = elfUre/elfMaxUre
	if urePer>=0.5 then 
		return 1
	else
		return 0 
	end
end
function ItemUse_StrSpeedLVUP ( role , Item , Item_Traget ) 
	local ret = CheckJingLingLv1( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_001182 = GetResString("CALCULATE_ITEMEFFECT_LUA_001182")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_001182)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local Item_type = GetItemType ( Item )
	local Item_Traget_Type = GetItemType ( Item_Traget )
	if Item_type == 58 and Item_Traget_Type == 59 then
		local ret = CheckCanUseSpeedLVUP(Item_Traget) --精灵exp是否满足升级条件
		if ret == 0 then
			CALCULATE_ITEMEFFECT_LUA_001183 = GetResString("CALCULATE_ITEMEFFECT_LUA_001183")
			SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_001183 ) 
			UseItemFailed ( role )
			return 
		else
		   ElfLVUP(role,Item_Traget,ITEMATTR_VAL_STR,1,1)  --体质属性的成长函数 
		end 
	end 
end
function ItemUse_AgiSpeedLVUP ( role , Item , Item_Traget ) 
	local ret = CheckJingLingLv1( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_001182 = GetResString("CALCULATE_ITEMEFFECT_LUA_001182")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_001182)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local Item_type = GetItemType ( Item )
	local Item_Traget_Type = GetItemType ( Item_Traget )
	if Item_type == 58 and Item_Traget_Type == 59 then
		local ret = CheckCanUseSpeedLVUP(Item_Traget) --精灵exp是否满足升级条件
		if ret == 0 then
			CALCULATE_ITEMEFFECT_LUA_001183 = GetResString("CALCULATE_ITEMEFFECT_LUA_001183")
			SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_001183 ) 
			UseItemFailed ( role )
			return 
		else
		   ElfLVUP(role,Item_Traget,ITEMATTR_VAL_AGI,1,1)  --体质属性的成长函数 
		end 
	end 
end
function ItemUse_ConSpeedLVUP ( role , Item , Item_Traget ) 
	local ret = CheckJingLingLv1( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_001182 = GetResString("CALCULATE_ITEMEFFECT_LUA_001182")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_001182)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local Item_type = GetItemType ( Item )
	local Item_Traget_Type = GetItemType ( Item_Traget )
	if Item_type == 58 and Item_Traget_Type == 59 then
		local ret = CheckCanUseSpeedLVUP(Item_Traget) --精灵exp是否满足升级条件
		if ret == 0 then
			CALCULATE_ITEMEFFECT_LUA_001183 = GetResString("CALCULATE_ITEMEFFECT_LUA_001183")
			SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_001183 ) 
			UseItemFailed ( role )
			return
		else
		   ElfLVUP(role,Item_Traget,ITEMATTR_VAL_CON,1,1)  --体质属性的成长函数 
		end 
	end 
end
function ItemUse_StaSpeedLVUP ( role , Item , Item_Traget ) 
	local ret = CheckJingLingLv1( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_001182 = GetResString("CALCULATE_ITEMEFFECT_LUA_001182")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_001182)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local Item_type = GetItemType ( Item )
	local Item_Traget_Type = GetItemType ( Item_Traget )
	if Item_type == 58 and Item_Traget_Type == 59 then
		local ret = CheckCanUseSpeedLVUP(Item_Traget) --精灵exp是否满足升级条件
		if ret == 0 then
			CALCULATE_ITEMEFFECT_LUA_001183 = GetResString("CALCULATE_ITEMEFFECT_LUA_001183")
			SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_001183 ) 
			UseItemFailed ( role )
			return 
		else
		   ElfLVUP(role,Item_Traget,ITEMATTR_VAL_STA,1,1)  --体质属性的成长函数 
		end 
	end 
end
function ItemUse_DexSpeedLVUP ( role , Item , Item_Traget ) 
	local ret = CheckJingLingLv1( role , Item_Traget )
	if ret == 0 then
		CALCULATE_ITEMEFFECT_LUA_001182 = GetResString("CALCULATE_ITEMEFFECT_LUA_001182")
		CALCULATE_ITEMEFFECT_LUA_000080 = GetResString("CALCULATE_ITEMEFFECT_LUA_000080")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000080..JLMAXLV..CALCULATE_ITEMEFFECT_LUA_001182)
		UseItemFailed ( role ) 
		return 
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ~= nil then 
		CALCULATE_ITEMEFFECT_LUA_000044 = GetResString("CALCULATE_ITEMEFFECT_LUA_000044")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_000044 ) 
		UseItemFailed ( role ) 
		return 
	end 
	local Item_type = GetItemType ( Item )
	local Item_Traget_Type = GetItemType ( Item_Traget )
	if Item_type == 58 and Item_Traget_Type == 59 then
		local ret = CheckCanUseSpeedLVUP(Item_Traget) --精灵exp是否满足升级条件
		if ret == 0 then
			CALCULATE_ITEMEFFECT_LUA_001183 = GetResString("CALCULATE_ITEMEFFECT_LUA_001183")
			SystemNotice(role , CALCULATE_ITEMEFFECT_LUA_001183 ) 
			UseItemFailed ( role )
			return 
		else
		   ElfLVUP(role,Item_Traget,ITEMATTR_VAL_DEX,1,1)  --体质属性的成长函数 
		end 
	end 
end

function ItemUse_FoolBox( role,item )

	local wnjz_count= CheckBagItem ( role , 6876 ) --检查万能鉴定卷轴数量
	local hajz_count= CheckBagItem ( role , 6875 ) --检查黑暗鉴定卷轴数量
	local gmjz_count= CheckBagItem ( role , 6874 ) --检查光明鉴定卷轴数量
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	local NocLock =	KitbagLock( role, 0 )
	local ran = math.random ( 1 , 100 )
	local Cha_Boat = GetCtrlBoat ( role )
	local name =GetChaDefaultName(role)
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	
	if NocLock == LUA_FALSE then
		CALCULATE_FUNCTIONS_LUA_000144 = GetResString("CALCULATE_FUNCTIONS_LUA_000144")
		SystemNotice( role , CALCULATE_FUNCTIONS_LUA_000144)
		return 
	end
	
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_001184 = GetResString("CALCULATE_ITEMEFFECT_LUA_001184")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001184)
		UseItemFailed ( role )
		return
	end	
	
	if wnjz_count > 0 then
		if ran < 15 then
			TakeItem( role , 0 , 6876 , 1)
			GiveItem( role , 0 , 5845  , 1 , 4 )
			CALCULATE_ITEMEFFECT_LUA_001185 = GetResString("CALCULATE_ITEMEFFECT_LUA_001185")
			Notice(name..CALCULATE_ITEMEFFECT_LUA_001185)
			return
		elseif ran < 30 then	
			TakeItem( role , 0 , 6876 , 1)
			GiveItem( role , 0 , 5846  , 1 , 4 )
			CALCULATE_ITEMEFFECT_LUA_001186 = GetResString("CALCULATE_ITEMEFFECT_LUA_001186")
			Notice(name..CALCULATE_ITEMEFFECT_LUA_001186)
			return
		elseif ran < 45 then	
			TakeItem( role , 0 , 6876 , 1)
			GiveItem( role , 0 , 5847  , 1 , 4 )
			CALCULATE_ITEMEFFECT_LUA_001187 = GetResString("CALCULATE_ITEMEFFECT_LUA_001187")
			Notice(name..CALCULATE_ITEMEFFECT_LUA_001187)
			return
		elseif ran < 60 then	
			TakeItem( role , 0 , 6876 , 1)
			GiveItem( role , 0 , 5848  , 1 , 4 )
			CALCULATE_ITEMEFFECT_LUA_001188 = GetResString("CALCULATE_ITEMEFFECT_LUA_001188")
			Notice(name..CALCULATE_ITEMEFFECT_LUA_001188)
			return
		elseif ran < 75 then 	
			TakeItem( role , 0 , 6876 , 1)
			GiveItem( role , 0 , 5849  , 1 , 4 )
			CALCULATE_ITEMEFFECT_LUA_001189 = GetResString("CALCULATE_ITEMEFFECT_LUA_001189")
			Notice(name..CALCULATE_ITEMEFFECT_LUA_001189)
			return
		elseif ran < 82 then 	
			TakeItem( role , 0 , 6876 , 1)
			GiveItem( role , 0 , 6614  , 1 , 4 )
			CALCULATE_ITEMEFFECT_LUA_001190 = GetResString("CALCULATE_ITEMEFFECT_LUA_001190")
			Notice(name..CALCULATE_ITEMEFFECT_LUA_001190)	
			return
		elseif ran < 88 then 	
			TakeItem( role , 0 , 6876 , 1)
			GiveItem( role , 0 , 6615  , 1 , 4 )
			CALCULATE_ITEMEFFECT_LUA_001191 = GetResString("CALCULATE_ITEMEFFECT_LUA_001191")
			Notice(name..CALCULATE_ITEMEFFECT_LUA_001191)	
			return
		elseif ran < 94 then 	
			TakeItem( role , 0 , 6876 , 1)
			GiveItem( role , 0 , 6616  , 1 , 4 )
			CALCULATE_ITEMEFFECT_LUA_001192 = GetResString("CALCULATE_ITEMEFFECT_LUA_001192")
			Notice(name..CALCULATE_ITEMEFFECT_LUA_001192)	
			return	
		else 	
			TakeItem( role , 0 , 6876 , 1)
			GiveItem( role , 0 , 6617  , 1 , 4 )
			CALCULATE_ITEMEFFECT_LUA_001193 = GetResString("CALCULATE_ITEMEFFECT_LUA_001193")
			Notice(name..CALCULATE_ITEMEFFECT_LUA_001193)	
			return			
		end
	end
	
	if hajz_count > 0 then	
		if ran < 60 then
			TakeItem( role , 0 , 6875 , 1)
			GiveItem( role , 0 , 866  , 1 , 4 )
			CALCULATE_ITEMEFFECT_LUA_001194 = GetResString("CALCULATE_ITEMEFFECT_LUA_001194")
			Notice(name..CALCULATE_ITEMEFFECT_LUA_001194)
			return
		elseif ran < 80 then	
			TakeItem( role , 0 , 6875 , 1)
			GiveItem( role , 0 , 865  , 1 , 4 )
			CALCULATE_ITEMEFFECT_LUA_001195 = GetResString("CALCULATE_ITEMEFFECT_LUA_001195")
			Notice(name..CALCULATE_ITEMEFFECT_LUA_001195)
			return
		else	
			TakeItem( role , 0 , 6875 , 1)
			GiveItem( role , 0 , 864  , 1 , 4 )
			CALCULATE_ITEMEFFECT_LUA_001196 = GetResString("CALCULATE_ITEMEFFECT_LUA_001196")
			Notice(name..CALCULATE_ITEMEFFECT_LUA_001196)
			return
		end
	end

	if gmjz_count > 0 then
		if ran < 20 then
			TakeItem( role , 0 , 6874 , 1)
			GiveItem( role , 0 , 860  , 1 , 4 )
			CALCULATE_ITEMEFFECT_LUA_001197 = GetResString("CALCULATE_ITEMEFFECT_LUA_001197")
			Notice(name..CALCULATE_ITEMEFFECT_LUA_001197)
			return
		elseif ran < 40 then	
			TakeItem( role , 0 , 6874 , 1)
			GiveItem( role , 0 , 861  , 1 , 4 )
			CALCULATE_ITEMEFFECT_LUA_001198 = GetResString("CALCULATE_ITEMEFFECT_LUA_001198")
			Notice(name..CALCULATE_ITEMEFFECT_LUA_001198)
			return
		elseif ran < 60 then	
			TakeItem( role , 0 , 6874 , 1)
			GiveItem( role , 0 , 862  , 1 , 4 )
			CALCULATE_ITEMEFFECT_LUA_001199 = GetResString("CALCULATE_ITEMEFFECT_LUA_001199")
			Notice(name..CALCULATE_ITEMEFFECT_LUA_001199)
			return
		elseif ran < 80 then	
			TakeItem( role , 0 , 6874 , 1)
			GiveItem( role , 0 , 863  , 1 , 4 )
			CALCULATE_ITEMEFFECT_LUA_001200 = GetResString("CALCULATE_ITEMEFFECT_LUA_001200")
			Notice(name..CALCULATE_ITEMEFFECT_LUA_001200)
			return
		else 	
			TakeItem( role , 0 , 6874 , 1)
			GiveItem( role , 0 , 1012  , 1 , 4 )
			CALCULATE_ITEMEFFECT_LUA_001201 = GetResString("CALCULATE_ITEMEFFECT_LUA_001201")
			Notice(name..CALCULATE_ITEMEFFECT_LUA_001201)
			return
		end
	end
	
	GiveItem( role , 0 , 885  , 1 , 4 )
	CALCULATE_ITEMEFFECT_LUA_001202 = GetResString("CALCULATE_ITEMEFFECT_LUA_001202")
	Notice(name..CALCULATE_ITEMEFFECT_LUA_001202)
	
end

function ItemUse_100UP ( role , Item )
	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	local lv = Lv(role)
	if lv < 100 then
		CALCULATE_ITEMEFFECT_LUA_001203 = GetResString("CALCULATE_ITEMEFFECT_LUA_001203")
		SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_001203)
		UseItemFailed ( role )
		return
	end
	
	local exp_next = GetChaAttr ( role , ATTR_NLEXP )
	SetChaAttrI ( role , ATTR_CEXP , exp_next)
	
end 
function ItemUse_FHJKL ( role , Item )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	local cha_type = GetChaTypeID ( role ) 
	if cha_type == 3 or cha_type == 4 then
		CALCULATE_ITEMEFFECT_LUA_001204 = GetResString("CALCULATE_ITEMEFFECT_LUA_001204")
		SystemNotice (role , CALCULATE_ITEMEFFECT_LUA_001204)
		UseItemFailed ( role )
		return			
	end 
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_001205 = GetResString("CALCULATE_ITEMEFFECT_LUA_001205")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001205)
		UseItemFailed ( role )
		return
	end	
	local Item_CZ = CheckBagItem( role , 6897 )
	if Item_CZ == 0 then
		CALCULATE_ITEMEFFECT_LUA_001206 = GetResString("CALCULATE_ITEMEFFECT_LUA_001206")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001206)
		UseItemFailed ( role )
		return
	end
	j = TakeItem ( role , 0 , 6897 , 1 )
	if j == 0 then
		CALCULATE_ITEMEFFECT_LUA_001207 = GetResString("CALCULATE_ITEMEFFECT_LUA_001207")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001207)
		UseItemFailed ( role )
		return 
	end 
	if cha_type == 1 or cha_type == 2 then
		sc = math.random ( 1, 100 )
		if sc > 0 and sc <=30 then
			GiveItem (role,0,1014,1,4)
		elseif sc > 31 and sc <= 70 then
			GiveItem (role , 0 , 6898 , 1 , 4 )
		else
			GiveItem ( role , 0 , 6899 , 1 ,4 )
		end		
	end 
end 



function ItemUse_FHJWE ( role , Item )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	local cha_type = GetChaTypeID ( role ) 
	if cha_type == 1 or cha_type == 2 then
		CALCULATE_ITEMEFFECT_LUA_001208 = GetResString("CALCULATE_ITEMEFFECT_LUA_001208")
		SystemNotice (role , CALCULATE_ITEMEFFECT_LUA_001208)
		UseItemFailed ( role )
		return			
	end 
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_001209 = GetResString("CALCULATE_ITEMEFFECT_LUA_001209")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001209)
		UseItemFailed ( role )
		return
	end	
	local Item_CZ = CheckBagItem( role , 6897 )
	if Item_CZ == 0 then
		CALCULATE_ITEMEFFECT_LUA_001210 = GetResString("CALCULATE_ITEMEFFECT_LUA_001210")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001210)
		UseItemFailed ( role )
		return
	end
	j = TakeItem ( role , 0 , 6897 , 1 )
	if j == 0 then
		CALCULATE_ITEMEFFECT_LUA_001207 = GetResString("CALCULATE_ITEMEFFECT_LUA_001207")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001207)
		UseItemFailed ( role )
		return 
	end 
	if cha_type == 3 or cha_type == 4 then
		sc = math.random ( 1, 100 )
		if sc > 0 and sc <=30 then
			GiveItem (role,0,3016,1,4)
		elseif sc > 31 and sc <= 70 then
			GiveItem (role , 0 , 6898 , 1 , 4 )
		else
			GiveItem ( role , 0 , 6899 , 1 ,4 )
		end		
	end 
end 


function ItemUse_KZBOX ( role , Item )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	if Item_CanGet < 4 then
		CALCULATE_ITEMEFFECT_LUA_001211 = GetResString("CALCULATE_ITEMEFFECT_LUA_001211")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001211)
		UseItemFailed ( role )
		return
	end
	local sc = math.random ( 1 , 5 )
	if sc == 1 then
		GiveItem (role , 0 , 5970 , 1 , 4 )
		GiveItem (role , 0 , 5971 , 1 , 4 )
		GiveItem (role , 0 , 5972 , 1 , 4 )
		GiveItem (role , 0 , 5973 , 1 , 4 )
	elseif sc == 2 then      
		GiveItem (role , 0 , 5974 , 1 , 4 )
		GiveItem (role , 0 , 5975 , 1 , 4 )
		GiveItem (role , 0 , 5976 , 1 , 4 )
		GiveItem (role , 0 , 5977 , 1 , 4 )
	elseif sc == 3 then      
		GiveItem (role , 0 , 5978 , 1 , 4 )
		GiveItem (role , 0 , 5979 , 1 , 4 )
		GiveItem (role , 0 , 5980 , 1 , 4 )
		GiveItem (role , 0 , 5981 , 1 , 4 )
	elseif sc == 4 then      
		GiveItem (role , 0 , 5982 , 1 , 4 )
		GiveItem (role , 0 , 5983 , 1 , 4 )
		GiveItem (role , 0 , 5984 , 1 , 4 )
		GiveItem (role , 0 , 5985 , 1 , 4 )	
	else                   
		GiveItem (role , 0 , 5986 , 1 , 4 )
		GiveItem (role , 0 , 5987 , 1 , 4 )
		GiveItem (role , 0 , 5988 , 1 , 4 )
		GiveItem (role , 0 , 5989 , 1 , 4 )	
	end                    
end 

function ItemUse_LDJ ( role , Item )
	CALCULATE_ITEMEFFECT_LUA_001212 = GetResString("CALCULATE_ITEMEFFECT_LUA_001212")
	SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001212)
	UseItemFailed ( role )
end 
function ItemUse_CJQLBOX ( role , Item )
	local Cha_Boat = GetCtrlBoat ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_001213 = GetResString("CALCULATE_ITEMEFFECT_LUA_001213")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001213)
		UseItemFailed ( role )
		return
	end
	GiveItem (role , 0 , 2835 , 1 , 4 )	
end 
function ItemUse_ZJQLBOX ( role , Item )
	local Cha_Boat = GetCtrlBoat ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_001213 = GetResString("CALCULATE_ITEMEFFECT_LUA_001213")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001213)
		UseItemFailed ( role )
		return
	end
	sc = math.random ( 1 , 100 )
	local cha_name = GetChaDefaultName ( role )
	if sc > 0 and sc <= 30 then
		GiveItem (role , 0 , 6922 , 1 , 4 )	
		local itemname = GetItemName ( 6922 )
		CALCULATE_ITEMEFFECT_LUA_001214 = GetResString("CALCULATE_ITEMEFFECT_LUA_001214")
		ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001214..itemname,1)		
	elseif sc >30 and sc <= 60 then
		GiveItem (role , 0 , 6923 , 1 , 4 )	
	elseif sc > 60 and sc <= 80 then
		GiveItem (role , 0 , 6924 , 1 , 4 )	
	else
		GiveItem (role , 0 , 6925 , 1 , 4 )	
	end
end 


function ItemUse_GJQLBOX ( role , Item )
	local Cha_Boat = GetCtrlBoat ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_001213 = GetResString("CALCULATE_ITEMEFFECT_LUA_001213")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001213)
		UseItemFailed ( role )
		return
	end
	sc = math.random ( 1 , 100 )
	if sc > 0 and sc <= 30 then
		GiveItem (role , 0 , 6926 , 1 , 4 )	
	elseif sc >30 and sc <= 70 then
		GiveItem (role , 0 , 6927 , 1 , 4 )	
	else
		GiveItem (role , 0 , 6928 , 1 , 4 )
	end
end 

function ItemUse_QLWQBOX ( role , Item )
	local Cha_Boat = GetCtrlBoat ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_001213 = GetResString("CALCULATE_ITEMEFFECT_LUA_001213")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001213)
		UseItemFailed ( role )
		return
	end
	sc = math.random ( 1 , 100 )
	local cha_name = GetChaDefaultName ( role )
	if sc > 0 and sc <= 20 then
		ItemID = {}
		ItemID[1] = 2817
		ItemID[2] = 2820
		ItemID[3] = 2823
		ItemID[4] = 2826
		ItemID[5] = 2829
		ItemID[6] = 2832
		i = math.random (1,6)
		GiveItem (role , 0 , ItemID[i] , 1 , 4 )
		local itemname = GetItemName ( ItemID[i] )
		CALCULATE_ITEMEFFECT_LUA_001215 = GetResString("CALCULATE_ITEMEFFECT_LUA_001215")
		ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001215..itemname,1)		
	elseif sc > 20 and sc <= 60 then
		ItemID2 = {}
		ItemID2[1] = 2818
		ItemID2[2] = 2821
		ItemID2[3] = 2824
		ItemID2[4] = 2827
		ItemID2[5] = 2830
		ItemID2[6] = 2833
		a = math.random (1,6)
		GiveItem (role , 0 , ItemID2[a] , 1 , 4 )
		local itemname = GetItemName ( ItemID2[a] )
		CALCULATE_ITEMEFFECT_LUA_001215 = GetResString("CALCULATE_ITEMEFFECT_LUA_001215")
		ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001215..itemname,1)	
	else
		ItemID3 = {}
		ItemID3[1] = 2819
		ItemID3[2] = 2822
		ItemID3[3] = 2825
		ItemID3[4] = 2828
		ItemID3[5] = 2831
		ItemID3[6] = 2834
		b = math.random (1,6)
		GiveItem (role , 0 , ItemID3[b] , 1 , 4 )
		local itemname = GetItemName ( ItemID3[b] )
		CALCULATE_ITEMEFFECT_LUA_001215 = GetResString("CALCULATE_ITEMEFFECT_LUA_001215")
		ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001215..itemname,1)	
	end
end 


function ItemUse_QLYFBOX ( role , Item )
	local Cha_Boat = GetCtrlBoat ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_001213 = GetResString("CALCULATE_ITEMEFFECT_LUA_001213")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001213)
		UseItemFailed ( role )
		return
	end
	sc = math.random ( 1 , 100 )
	local cha_name = GetChaDefaultName ( role )
	if sc > 0 and sc <= 20 then
		ItemID = {}
		ItemID[1] = 2331
		ItemID[2] = 2332
		ItemID[3] = 2333
		ItemID[4] = 2334
		ItemID[5] = 2335
		ItemID[6] = 2336
		ItemID[7] = 2337
		ItemID[8] = 2338
		ItemID[9] = 2339
		ItemID[10] = 2340
		ItemID[11] = 2341
		ItemID[12] = 2342
		ItemID[13] = 2343
		ItemID[14] = 2344
		i = math.random (1,14)
		GiveItem (role , 0 , ItemID[i] , 1 , 4 )
		local itemname = GetItemName ( ItemID[i] )
		CALCULATE_ITEMEFFECT_LUA_001215 = GetResString("CALCULATE_ITEMEFFECT_LUA_001215")
		ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001215..itemname,1)	
	elseif sc > 20 and sc <= 60 then
		ItemID2 = {}
		ItemID2[1] = 2818
		ItemID2[2] = 2821
		ItemID2[3] = 2824
		ItemID2[4] = 2827
		ItemID2[5] = 2830
		ItemID2[6] = 2833
		a = math.random (1,6)
		GiveItem (role , 0 , ItemID2[a] , 1 , 4 )
		local itemname = GetItemName ( ItemID2[a] )
		CALCULATE_ITEMEFFECT_LUA_001215 = GetResString("CALCULATE_ITEMEFFECT_LUA_001215")
		ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001215..itemname,1)	
	else
		ItemID3 = {}
		ItemID3[1] = 2819
		ItemID3[2] = 2822
		ItemID3[3] = 2825
		ItemID3[4] = 2828
		ItemID3[5] = 2831
		ItemID3[6] = 2834
		b = math.random (1,6)
		GiveItem (role , 0 , ItemID3[b] , 1 , 4 )
		local itemname = GetItemName ( ItemID3[b] )
		CALCULATE_ITEMEFFECT_LUA_001215 = GetResString("CALCULATE_ITEMEFFECT_LUA_001215")
		ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001215..itemname,1)
	end
end 



function ItemUse_QLSTBOX ( role , Item )
	local Cha_Boat = GetCtrlBoat ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_001213 = GetResString("CALCULATE_ITEMEFFECT_LUA_001213")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001213)
		UseItemFailed ( role )
		return
	end
	sc = math.random ( 1 , 100 )
	local cha_name = GetChaDefaultName ( role )
	if sc > 0 and sc <= 20 then
		ItemID = {}
		ItemID[1] = 2331
		ItemID[2] = 2332
		ItemID[3] = 2333
		ItemID[4] = 2334
		ItemID[5] = 2335
		ItemID[6] = 2336
		ItemID[7] = 2337
		ItemID[8] = 2338
		ItemID[9] = 2339
		ItemID[10] = 2340
		ItemID[11] = 2341
		ItemID[12] = 2342
		ItemID[13] = 2343
		ItemID[14] = 2344
		i = math.random (1,14)
		GiveItem (role , 0 , ItemID[i] , 1 , 4 )
		local itemname = GetItemName ( ItemID[i] )
		CALCULATE_ITEMEFFECT_LUA_001215 = GetResString("CALCULATE_ITEMEFFECT_LUA_001215")
		ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001215..itemname,1)	
	elseif sc > 20 and sc <= 50 then
		ItemID2 = {}
		ItemID2[1] = 2817
		ItemID2[2] = 2820
		ItemID2[3] = 2823
		ItemID2[4] = 2826
		ItemID2[5] = 2829
		ItemID2[6] = 2832
		a = math.random (1,6)
		GiveItem (role , 0 , ItemID2[a] , 1 , 4 )
		local itemname = GetItemName ( ItemID2[a] )
		CALCULATE_ITEMEFFECT_LUA_001215 = GetResString("CALCULATE_ITEMEFFECT_LUA_001215")
		ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001215..itemname,1)	
	else
		ItemID3 = {}
		ItemID3[1] = 2819
		ItemID3[2] = 2822
		ItemID3[3] = 2825
		ItemID3[4] = 2828
		ItemID3[5] = 2831
		ItemID3[6] = 2834
		b = math.random (1,6)
		GiveItem (role , 0 , ItemID3[b] , 1 , 4 )
		local itemname = GetItemName ( ItemID3[b] )
		CALCULATE_ITEMEFFECT_LUA_001215 = GetResString("CALCULATE_ITEMEFFECT_LUA_001215")
		ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001215..itemname,1)	
	end
end 



function ItemUse_QLXZBOX ( role , Item )
	local Cha_Boat = GetCtrlBoat ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_001213 = GetResString("CALCULATE_ITEMEFFECT_LUA_001213")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001213)
		UseItemFailed ( role )
		return
	end
	sc = math.random ( 1 , 100 )
	local cha_name = GetChaDefaultName ( role )
	if sc > 0 and sc <= 20 then
		ItemID = {}
		ItemID[1] = 2331
		ItemID[2] = 2332
		ItemID[3] = 2333
		ItemID[4] = 2334
		ItemID[5] = 2335
		ItemID[6] = 2336
		ItemID[7] = 2337
		ItemID[8] = 2338
		ItemID[9] = 2339
		ItemID[10] = 2340
		ItemID[11] = 2341
		ItemID[12] = 2342
		ItemID[13] = 2343
		ItemID[14] = 2344
		i = math.random (1,14)
		GiveItem (role , 0 , ItemID[i] , 1 , 4 )
		local itemname = GetItemName ( ItemID[i] )
		CALCULATE_ITEMEFFECT_LUA_001215 = GetResString("CALCULATE_ITEMEFFECT_LUA_001215")
		ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001215..itemname,1)
	elseif sc > 20 and sc <= 50 then
		ItemID2 = {}
		ItemID2[1] = 2817
		ItemID2[2] = 2820
		ItemID2[3] = 2823
		ItemID2[4] = 2826
		ItemID2[5] = 2829
		ItemID2[6] = 2832
		a = math.random (1,6)
		GiveItem (role , 0 , ItemID2[a] , 1 , 4 )
		local itemname = GetItemName ( ItemID2[a] )
		CALCULATE_ITEMEFFECT_LUA_001215 = GetResString("CALCULATE_ITEMEFFECT_LUA_001215")
		ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001215..itemname,1)
	else
		ItemID3 = {}
		ItemID3[1] = 2818
		ItemID3[2] = 2821
		ItemID3[3] = 2824
		ItemID3[4] = 2827
		ItemID3[5] = 2830
		ItemID3[6] = 2833
		b = math.random (1,6)
		GiveItem (role , 0 , ItemID3[b] , 1 , 4 )
		local itemname = GetItemName ( ItemID3[b] )
		CALCULATE_ITEMEFFECT_LUA_001215 = GetResString("CALCULATE_ITEMEFFECT_LUA_001215")
		ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001215..itemname,1)
	end
end 


function ItemUse_QLWLBOX ( role , Item )
	local Cha_Boat = GetCtrlBoat ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_001213 = GetResString("CALCULATE_ITEMEFFECT_LUA_001213")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001213)
		UseItemFailed ( role )
		return
	end
	sc = math.random ( 1 , 10 )
	local cha_name = GetChaDefaultName ( role )
	if sc < 5 then
		ItemID={}
		ItemID[1]= 2331
		ItemID[2]= 2332
		i = math.random (1,2)
		GiveItem (role , 0 , ItemID[i] , 1 , 4 )
		local itemname = GetItemName ( ItemID[i] )
		CALCULATE_ITEMEFFECT_LUA_001215 = GetResString("CALCULATE_ITEMEFFECT_LUA_001215")
		ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001215..itemname,1)
	else
		ItemID2 = {}
		ItemID2[1] = 2333
		ItemID2[2] = 2334
		a = math.random (1,2)
		GiveItem (role , 0 , ItemID2[a] , 1 , 4 )
		local itemname = GetItemName ( ItemID2[a] )
		CALCULATE_ITEMEFFECT_LUA_001215 = GetResString("CALCULATE_ITEMEFFECT_LUA_001215")
		ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001215..itemname,1)
	end
end 



function ItemUse_QLMFBOX ( role , Item )
	local Cha_Boat = GetCtrlBoat ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_001213 = GetResString("CALCULATE_ITEMEFFECT_LUA_001213")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001213)
		UseItemFailed ( role )
		return
	end
	sc = math.random ( 1 , 2 )
	local cha_name = GetChaDefaultName ( role )
	if sc == 1 then
		ItemID={}
		ItemID[1]= 2341
		ItemID[2]= 2342
		i = math.random (1,2)
		GiveItem (role , 0 , ItemID[i] , 1 , 4 )
		local itemname = GetItemName ( ItemID[i] )
		CALCULATE_ITEMEFFECT_LUA_001215 = GetResString("CALCULATE_ITEMEFFECT_LUA_001215")
		ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001215..itemname,1)
	else
		ItemID2 = {}
		ItemID2[1] = 2343
		ItemID2[2] = 2344
		a = math.random (1,2)
		GiveItem (role , 0 , ItemID2[a] , 1 , 4 )
		local itemname = GetItemName ( ItemID2[a] )
		CALCULATE_ITEMEFFECT_LUA_001215 = GetResString("CALCULATE_ITEMEFFECT_LUA_001215")
		ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001215..itemname,1)
	end
end 



function ItemUse_QLBOSS_BOX ( role , Item )

	local Cha_Boat = GetCtrlBoat ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_001213 = GetResString("CALCULATE_ITEMEFFECT_LUA_001213")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001213)
		UseItemFailed ( role )
		return
	end
	sc = math.random ( 1 , 2 )
	local cha_name = GetChaDefaultName ( role )
	if sc == 1 then
		ItemID={}
		ItemID[1]= 2335
		ItemID[2]= 2336
		i = math.random (1,2)
		GiveItem (role , 0 , ItemID[i] , 1 , 4 )
		local itemname = GetItemName ( ItemID[i] )
		CALCULATE_ITEMEFFECT_LUA_001215 = GetResString("CALCULATE_ITEMEFFECT_LUA_001215")
		ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001215..itemname,1)
	else
		ItemID2 = {}
		ItemID2[1] = 2339
		ItemID2[2] = 2340
		a = math.random (1,2)
		GiveItem (role , 0 , ItemID2[a] , 1 , 4 )
		local itemname = GetItemName ( ItemID2[a] )
		CALCULATE_ITEMEFFECT_LUA_001215 = GetResString("CALCULATE_ITEMEFFECT_LUA_001215")
		ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001215..itemname,1)
	end
end 

--打开的宝贝探测器（by Loch.Bai）
function ItemUse_XunBao_DKDBBTCQ ( role , Item )
	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
 	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000058 = GetResString("CALCULATE_ITEMEFFECT_LUA_000058")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000058)
		UseItemFailed ( role )
		return
	end 
	
	local Has_Map_NewPT = CheckBagItem ( role , 6929 )
	if Has_Map_NewPT >= 2 then
		CALCULATE_ITEMEFFECT_LUA_001216 = GetResString("CALCULATE_ITEMEFFECT_LUA_001216")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001216 )
		UseItemFailed ( role )
		return
	end
	local name = GetChaDefaultName ( role )
	local Lv = Lv( role )
	local Item = GetChaItem2 ( role , 2 , 6929 )						-------------------这个接口是取角色背包里某种ID的道具指针，前提是这个道具在背包里只有一个
	local Item_MAXURE = GetItemAttr ( Item , ITEMATTR_MAXURE )
	local Item_URE = GetItemAttr ( Item , ITEMATTR_URE )
	local Item_MAXENERGY = GetItemAttr ( Item , ITEMATTR_MAXENERGY )
	local pos_x = Item_MAXURE									-------------------最大耐久，记录x坐标
	local pos_y = Item_MAXENERGY								-------------------最大能量，记录y坐标
	local Themap = Item_URE
	--按照宝图等级随机分配挖图的坐标
	local MapList = { }
	
	MapList [0] = "NoMap"
	MapList [1] = "garner"
	MapList [2] = "magicsea"
	MapList [3] = "darkblue"

	local MapNameList = { }
	
	CALCULATE_ITEMEFFECT_LUA_000062 = GetResString("CALCULATE_ITEMEFFECT_LUA_000062")
	MapNameList [0] = CALCULATE_ITEMEFFECT_LUA_000062
	CALCULATE_ITEMEFFECT_LUA_000063 = GetResString("CALCULATE_ITEMEFFECT_LUA_000063")
	MapNameList [1] = CALCULATE_ITEMEFFECT_LUA_000063
	CALCULATE_ITEMEFFECT_LUA_000064 = GetResString("CALCULATE_ITEMEFFECT_LUA_000064")
	MapNameList [2] = CALCULATE_ITEMEFFECT_LUA_000064
	CALCULATE_ITEMEFFECT_LUA_000065 = GetResString("CALCULATE_ITEMEFFECT_LUA_000065")
	MapNameList [3] = CALCULATE_ITEMEFFECT_LUA_000065
	if pos_x == 0 or pos_y == 0 or Themap == 0 then
		UseItemFailed ( role )
		local zuobiao = math.random ( 1,70 )
		if zuobiao <= 10 then
		pos_x , pos_y , Themap = GetTheMapPos_40 ( role , 1 )
		elseif zuobiao > 10 and zuobiao <= 20 then
		pos_x , pos_y , Themap = GetTheMapPos_45 ( role , 1 )
		elseif zuobiao > 20 and zuobiao <= 30 then
		pos_x , pos_y , Themap = GetTheMapPos_50 ( role , 1 )
		elseif zuobiao > 30 and zuobiao <= 40 then
		pos_x , pos_y , Themap = GetTheMapPos_55 ( role , 1 )
		elseif zuobiao > 40 and zuobiao <= 50 then
		pos_x , pos_y , Themap = GetTheMapPos_60 ( role , 1 )
		elseif zuobiao > 50 and zuobiao <= 60 then
		pos_x , pos_y , Themap = GetTheMapPos_65 ( role , 1 )
		elseif zuobiao > 60 and zuobiao <= 70 then
		pos_x , pos_y , Themap = GetTheMapPos_70 ( role , 1 )
		end
		Item_MAXURE = pos_x
		Item_URE = Themap									---------------------当前耐久为0~3，通过MapList[Themap]来变相记录是哪张地图
		Item_MAXENERGY = pos_y
		CALCULATE_ITEMEFFECT_LUA_000066 = GetResString("CALCULATE_ITEMEFFECT_LUA_000066")
		CALCULATE_ITEMEFFECT_LUA_000067 = GetResString("CALCULATE_ITEMEFFECT_LUA_000067")
		CALCULATE_ITEMEFFECT_LUA_001217 = GetResString("CALCULATE_ITEMEFFECT_LUA_001217")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001217..MapNameList[Themap]..CALCULATE_ITEMEFFECT_LUA_000067..pos_x..","..pos_y..CALCULATE_ITEMEFFECT_LUA_000066 )
		SetItemAttr ( Item , ITEMATTR_MAXENERGY , Item_MAXENERGY )
		SetItemAttr ( Item , ITEMATTR_MAXURE , Item_MAXURE )
		SetItemAttr ( Item , ITEMATTR_URE , Item_URE )
		return
	end

	local GetPos = CheckGetMapPos ( role , pos_x , pos_y , MapList[Themap] )
	
	if GetPos == 0 then
		CALCULATE_ITEMEFFECT_LUA_000066 = GetResString("CALCULATE_ITEMEFFECT_LUA_000066")
		CALCULATE_ITEMEFFECT_LUA_000067 = GetResString("CALCULATE_ITEMEFFECT_LUA_000067")
		CALCULATE_ITEMEFFECT_LUA_001217 = GetResString("CALCULATE_ITEMEFFECT_LUA_001217")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001217..MapNameList[Themap]..CALCULATE_ITEMEFFECT_LUA_000067..pos_x..","..pos_y..CALCULATE_ITEMEFFECT_LUA_000066 )
		UseItemFailed ( role )
		return
	elseif GetPos == 1 then   	
		local getrandom = math.random ( 1 , 100 )
		if getrandom <= 25 then					----------------------------------------------什么都没有获得
			local statelv = 1
			local statetime = 30
			AddState ( role , role , STATE_BIW , statelv , statetime )
			CALCULATE_FUNCTIONS_LUA_000374 = GetResString("CALCULATE_FUNCTIONS_LUA_000374")
			SystemNotice(role,CALCULATE_FUNCTIONS_LUA_000374)
			return
		elseif	getrandom > 25 and getrandom <= 50	then
			local statelv = 1
			local statetime = 2			
			AddState ( role , role , STATE_LEIPI , statelv , statetime )
			CALCULATE_FUNCTIONS_LUA_000375 = GetResString("CALCULATE_FUNCTIONS_LUA_000375")
			SystemNotice(role,CALCULATE_FUNCTIONS_LUA_000375)
			return
		elseif	getrandom > 50 and getrandom <= 75	then
			AddState ( role , role , STATE_CUSI , 1 , 1 )
			CALCULATE_FUNCTIONS_LUA_000376 = GetResString("CALCULATE_FUNCTIONS_LUA_000376")
			SystemNotice(role,CALCULATE_FUNCTIONS_LUA_000376)
			return
		elseif	getrandom > 75 and getrandom <= 100	then
			GiveItem ( role , 0 , 6918 , 1 , 4 )  -----------------------------------------未知的勤劳宝箱
			CALCULATE_ITEMEFFECT_LUA_001218 = GetResString("CALCULATE_ITEMEFFECT_LUA_001218")
			SystemNotice(role,CALCULATE_ITEMEFFECT_LUA_001218)
			return
		end
	end
end
---寻宝技能学习（by Loch.Bai）
function Sk_Script_XunBao ( role , Item )
	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	local Lv = Lv ( role ) 
	local form_sklv = GetSkillLv( role , SK_XUNBAO )
	if form_sklv ~= 0 then
		CALCULATE_ITEMEFFECT_LUA_001219 = GetResString("CALCULATE_ITEMEFFECT_LUA_001219")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001219) 
		UseItemFailed ( role )
		return
	end
	a = AddChaSkill ( role , SK_XUNBAO, 1 , 0 , 0 )  
	CALCULATE_ITEMEFFECT_LUA_001220 = GetResString("CALCULATE_ITEMEFFECT_LUA_001220")
	SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001220)
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 
---宝贝探测其器to打开的宝贝探测器（by Loch.Bai）
function ItemUse_XunBao_BBTCQ( role , Item )
	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_000058 = GetResString("CALCULATE_ITEMEFFECT_LUA_000058")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000058)
		UseItemFailed ( role )
		return
	end 
	local Has_GoldenMap = CheckBagItem ( role , 6929 )
	if Has_GoldenMap >= 1 then
		CALCULATE_ITEMEFFECT_LUA_001221 = GetResString("CALCULATE_ITEMEFFECT_LUA_001221")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001221 )
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 6929 , 1 , 0 )
	CALCULATE_ITEMEFFECT_LUA_001222 = GetResString("CALCULATE_ITEMEFFECT_LUA_001222")
	SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_001222 )
end



function ItemUse_WYLDBOXAA ( role , Item )
	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_001223 = GetResString("CALCULATE_ITEMEFFECT_LUA_001223")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001223)
		UseItemFailed ( role )
		return
	end 
	ItemID	=	{}
	ItemID[1]	=	2817
	ItemID[2]	=	2820
	ItemID[3]	=	2818
	ItemID[4]	=	2821
	ItemID[5]	=	2819
	ItemID[6]	=	2822
	sc = math.random ( 1, 10 )
	if sc > 0 and sc <= 2 then
		i = math.random (1,2)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	elseif sc >2 and sc <= 6 then
		i = math.random (3,4)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	else
		i = math.random (5,6)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	end
	local cha_name = GetChaDefaultName ( role )		
	local itemname = GetItemName ( ItemID[i] )
	CALCULATE_ITEMEFFECT_LUA_001224 = GetResString("CALCULATE_ITEMEFFECT_LUA_001224")
	ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001224..itemname,1)		
end 


function ItemUse_WYLDBOXAB ( role , Item )
	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_001223 = GetResString("CALCULATE_ITEMEFFECT_LUA_001223")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001223)
		UseItemFailed ( role )
		return
	end 
	ItemID	=	{}
	ItemID[1]	=	2829
	ItemID[2]	=	2832
	ItemID[3]	=	2830
	ItemID[4]	=	2833
	ItemID[5]	=	2831
	ItemID[6]	=	2834	


	sc = math.random ( 1, 10 )
	if sc > 0 and sc <= 2 then
		i = math.random (1,2)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	elseif sc >2 and sc <= 6 then
		i = math.random (3,4)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	else
		i = math.random (5,6)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	end
	local cha_name = GetChaDefaultName ( role )		
	local itemname = GetItemName ( ItemID[i] )
	CALCULATE_ITEMEFFECT_LUA_001225 = GetResString("CALCULATE_ITEMEFFECT_LUA_001225")
	ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001225..itemname,1)		
end 


function ItemUse_WYLDBOXAC ( role , Item )
	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_001223 = GetResString("CALCULATE_ITEMEFFECT_LUA_001223")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001223)
		UseItemFailed ( role )
		return
	end 
	ItemID	=	{}
	ItemID[1]	=	2823
	ItemID[2]	=	2826
	ItemID[3]	=	2824
	ItemID[4]	=	2827
	ItemID[5]	=	2825
	ItemID[6]	=	2828
	
	sc = math.random ( 1, 10 )
	if sc > 0 and sc <= 2 then
		i = math.random (1,2)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	elseif sc >2 and sc <= 6 then
		i = math.random (3,4)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	else
		i = math.random (5,6)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	end

	local cha_name = GetChaDefaultName ( role )		
	local itemname = GetItemName ( ItemID[i] )
	CALCULATE_ITEMEFFECT_LUA_001226 = GetResString("CALCULATE_ITEMEFFECT_LUA_001226")
	ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001226..itemname,1)		
end 


function ItemUse_WYLDBOXBA ( role , Item )
	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_001223 = GetResString("CALCULATE_ITEMEFFECT_LUA_001223")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001223)
		UseItemFailed ( role )
		return
	end 
	ItemID	=	{}
	ItemID[1]	=	2331
	ItemID[2]	=	2332
	ItemID[3]	=	2333
	ItemID[4]	=	2334
	ItemID[5]	=	2818
	ItemID[6]	=	2821
	ItemID[7]	=	2819
	ItemID[8]	=	2822
	
	sc = math.random ( 1, 10 )
	if sc > 0 and sc <= 2 then
		i = math.random (1,4)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	elseif sc >2 and sc <= 6 then
		i = math.random (5,6)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	else
		i = math.random (7,8)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	end	

	local cha_name = GetChaDefaultName ( role )		
	local itemname = GetItemName ( ItemID[i] )
	CALCULATE_ITEMEFFECT_LUA_001227 = GetResString("CALCULATE_ITEMEFFECT_LUA_001227")
	ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001227..itemname,1)		
end 


function ItemUse_WYLDBOXBB ( role , Item )
	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_001223 = GetResString("CALCULATE_ITEMEFFECT_LUA_001223")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001223)
		UseItemFailed ( role )
		return
	end 
	ItemID	=	{}
	ItemID[1]	=	2341
	ItemID[2]	=	2342
	ItemID[3]	=	2343
	ItemID[4]	=	2344
	ItemID[5]	=	2830
	ItemID[6]	=	2833
	ItemID[7]	=	2831
	ItemID[8]	=	2834

	sc = math.random ( 1, 10 )
	if sc > 0 and sc <= 2 then
		i = math.random (1,4)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	elseif sc >2 and sc <= 6 then
		i = math.random (5,6)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	else
		i = math.random (7,8)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	end	
	local cha_name = GetChaDefaultName ( role )		
	local itemname = GetItemName ( ItemID[i] )
	CALCULATE_ITEMEFFECT_LUA_001228 = GetResString("CALCULATE_ITEMEFFECT_LUA_001228")
	ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001228..itemname,1)		
end 


function ItemUse_WYLDBOXBC ( role , Item )
	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_001223 = GetResString("CALCULATE_ITEMEFFECT_LUA_001223")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001223)
		UseItemFailed ( role )
		return
	end 
	ItemID	=	{}
	ItemID[1]	=	2335
	ItemID[2]	=	2336
	ItemID[3]	=	2337
	ItemID[4]	=	2338
	ItemID[5]	=	2339
	ItemID[6]	=	2340
	ItemID[7]	=	2824
	ItemID[8]	=	2827
	ItemID[9]	=	2825
	ItemID[10]	=	2828

	sc = math.random ( 1, 10 )
	if sc > 0 and sc <= 2 then
		i = math.random (1,6)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	elseif sc >2 and sc <= 6 then
		i = math.random (7,8)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	else
		i = math.random (9,10)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	end	
	local cha_name = GetChaDefaultName ( role )		
	local itemname = GetItemName ( ItemID[i] )
	CALCULATE_ITEMEFFECT_LUA_001229 = GetResString("CALCULATE_ITEMEFFECT_LUA_001229")
	ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001229..itemname,1)		
end 



function ItemUse_WYLDBOXCA ( role , Item )
	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_001223 = GetResString("CALCULATE_ITEMEFFECT_LUA_001223")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001223)
		UseItemFailed ( role )
		return
	end 
	ItemID	=	{}
	ItemID[1]	=	2331
	ItemID[2]	=	2332
	ItemID[3]	=	2333
	ItemID[4]	=	2334
	ItemID[5]	=	2817
	ItemID[6]	=	2820
	ItemID[7]	=	2819
	ItemID[8]	=	2822
	
	sc = math.random ( 1, 10 )
	if sc > 0 and sc <= 2 then
		i = math.random (1,4)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	elseif sc >2 and sc <= 5 then
		i = math.random (5,6)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	else
		i = math.random (7,8)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	end		

	local cha_name = GetChaDefaultName ( role )		
	local itemname = GetItemName ( ItemID[i] )
	CALCULATE_ITEMEFFECT_LUA_001230 = GetResString("CALCULATE_ITEMEFFECT_LUA_001230")
	ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001230..itemname,1)		
end 


function ItemUse_WYLDBOXCB ( role , Item )
	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_001223 = GetResString("CALCULATE_ITEMEFFECT_LUA_001223")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001223)
		UseItemFailed ( role )
		return
	end 
	ItemID	=	{}
	ItemID[1]	=	2341
	ItemID[2]	=	2342
	ItemID[3]	=	2343
	ItemID[4]	=	2344
	ItemID[5]	=	2829
	ItemID[6]	=	2832
	ItemID[7]	=	2831
	ItemID[8]	=	2834

	sc = math.random ( 1, 10 )
	if sc > 0 and sc <= 2 then
		i = math.random (1,4)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	elseif sc >2 and sc <= 5 then
		i = math.random (5,6)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	else
		i = math.random (7,8)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	end	

	local cha_name = GetChaDefaultName ( role )		
	local itemname = GetItemName ( ItemID[i] )
	CALCULATE_ITEMEFFECT_LUA_001231 = GetResString("CALCULATE_ITEMEFFECT_LUA_001231")
	ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001231..itemname,1)		
end 


function ItemUse_WYLDBOXCC ( role , Item )
	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_001223 = GetResString("CALCULATE_ITEMEFFECT_LUA_001223")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001223)
		UseItemFailed ( role )
		return
	end 
	ItemID	=	{}
	ItemID[1]	=	2335
	ItemID[2]	=	2336
	ItemID[3]	=	2337
	ItemID[4]	=	2338
	ItemID[5]	=	2339
	ItemID[6]	=	2340
	ItemID[7]	=	2823
	ItemID[8]	=	2826
	ItemID[9]	=	2825
	ItemID[10]	=	2828

	sc = math.random ( 1, 10 )
	if sc > 0 and sc <= 2 then
		i = math.random (1,6)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	elseif sc >2 and sc <= 5 then
		i = math.random (7,8)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	else
		i = math.random (9,10)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	end	
	local cha_name = GetChaDefaultName ( role )		
	local itemname = GetItemName ( ItemID[i] )
	CALCULATE_ITEMEFFECT_LUA_001232 = GetResString("CALCULATE_ITEMEFFECT_LUA_001232")
	ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001232..itemname,1)		
end 

function ItemUse_WYLDBOXDA ( role , Item )
	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_001223 = GetResString("CALCULATE_ITEMEFFECT_LUA_001223")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001223)
		UseItemFailed ( role )
		return
	end 
	ItemID	=	{}
	ItemID[1]	=	2331
	ItemID[2]	=	2332
	ItemID[3]	=	2333
	ItemID[4]	=	2334
	ItemID[5]	=	2817
	ItemID[6]	=	2820
	ItemID[7]	=	2818
	ItemID[8]	=	2821
	
	sc = math.random ( 1, 10 )
	if sc > 0 and sc <= 2 then
		i = math.random (1,4)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	elseif sc >2 and sc <= 5 then
		i = math.random (5,6)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	else
		i = math.random (7,8)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	end	

	local cha_name = GetChaDefaultName ( role )		
	local itemname = GetItemName ( ItemID[i] )
	CALCULATE_ITEMEFFECT_LUA_001233 = GetResString("CALCULATE_ITEMEFFECT_LUA_001233")
	ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001233..itemname,1)		
end 


function ItemUse_WYLDBOXDB ( role , Item )
	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_001223 = GetResString("CALCULATE_ITEMEFFECT_LUA_001223")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001223)
		UseItemFailed ( role )
		return
	end 
	ItemID	=	{}
	ItemID[1]	=	2341
	ItemID[2]	=	2342
	ItemID[3]	=	2343
	ItemID[4]	=	2344
	ItemID[5]	=	2829
	ItemID[6]	=	2832
	ItemID[7]	=	2830
	ItemID[8]	=	2833

	sc = math.random ( 1, 10 )
	if sc > 0 and sc <= 2 then
		i = math.random (1,4)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	elseif sc >2 and sc <= 5 then
		i = math.random (5,6)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	else
		i = math.random (7,8)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	end	
	local cha_name = GetChaDefaultName ( role )		
	local itemname = GetItemName ( ItemID[i] )
	CALCULATE_ITEMEFFECT_LUA_001234 = GetResString("CALCULATE_ITEMEFFECT_LUA_001234")
	ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001234..itemname,1)		
end 


function ItemUse_WYLDBOXDC ( role , Item )
	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_001223 = GetResString("CALCULATE_ITEMEFFECT_LUA_001223")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001223)
		UseItemFailed ( role )
		return
	end 
	ItemID	=	{}
	ItemID[1]	=	2335
	ItemID[2]	=	2336
	ItemID[3]	=	2337
	ItemID[4]	=	2338
	ItemID[5]	=	2339
	ItemID[6]	=	2340
	ItemID[7]	=	2823
	ItemID[8]	=	2826
	ItemID[9]	=	2824
	ItemID[10]	=	2827
	
	sc = math.random ( 1, 10 )
	if sc > 0 and sc <= 2 then
		i = math.random (1,6)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	elseif sc >2 and sc <= 5 then
		i = math.random (7,8)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	else
		i = math.random (9,10)
		GiveItem ( role , 0 , ItemID[i]  , 1 , 4 )
	end		
	local cha_name = GetChaDefaultName ( role )		
	local itemname = GetItemName ( ItemID[i] )
	CALCULATE_ITEMEFFECT_LUA_001235 = GetResString("CALCULATE_ITEMEFFECT_LUA_001235")
	ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001235..itemname,1)	
end 
function ChargeTZXZ(role)     -----挑战勋章
	AddExp(role,0,15000,25000)
	
end
function ItemUse_ZZLH(role , Item)
	local a = math.random (1,100)
	local ItemID	=	{}
	ItemID[1]	=	3043
	ItemID[2]	=	3044
	ItemID[3]	=	3045
	local itemGL = {}
	itemGL[1]=1
	itemGL[2]=40
	itemGL[3]=100
	local i =1
	for i = 1, 3,1 do 
		if a <= itemGL[i] then 
			GiveItem(role,0,ItemID[i],1,4)
			return 
		end
	end
end

----爱情结晶-------------------------------------------------------------------------------------------------------------------------------------
function ItemUse_AQJJ(role, Item )

	local i = CheckBagItem(role,6960)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		CALCULATE_ITEMEFFECT_LUA_000016 = GetResString("CALCULATE_ITEMEFFECT_LUA_000016")
		SystemNotice (role, CALCULATE_ITEMEFFECT_LUA_000016)
		UseItemFailed ( role )
		return
	end
------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
	if map_name == "prisonisland" then
		CALCULATE_ITEMEFFECT_LUA_000017 = GetResString("CALCULATE_ITEMEFFECT_LUA_000017")
		SystemNotice ( role , CALCULATE_ITEMEFFECT_LUA_000017 )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,6960,1)
			if j == 1 then
				MoveTo( role,200,179,"yschurch" )
				return
			end
		end
	else
		UseItemFailed ( role )
	end
		
end

----------------------------------------中级双倍经验增幅器
function ItemUse_ZJSB( role , Item )

	local statelv = 1
	local ZBMain= GetChaAttr(role,ATTR_EXTEND0)
	local ZBNType= math.floor(ZBMain/10)      ---第几次占卜
	local ZBNMain= math.fmod(ZBMain,10 )			---BUFF OR DEBUFF
	local ZBday = GetChaAttr(role,ATTR_EXTEND2)		--占卜天数
	local ZBstate=GetChaAttr(role, ATTR_EXTEND1)	--
	local ZBstate1=math.floor(ZBstate/10)			--占卜效果注册
	local ZBstate2=math.fmod(ZBstate,10)				--占卜类型
	local now_day=os.date("%d")
	now_day=tonumber(now_day)
	if now_day==ZBday and ZBstate2==7 then
		statelv=14
	end

	local statetime = 7200
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		local ret = UseAexpItem(role,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	else
		local ret = UseAexpItem(Cha_Boat,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	end

	if statelv==14 then 
		CALCULATE_ITEMEFFECT_LUA_001236 = GetResString("CALCULATE_ITEMEFFECT_LUA_001236")
		SystemNotice ( role,CALCULATE_ITEMEFFECT_LUA_001236 )
	else
		CALCULATE_ITEMEFFECT_LUA_001237 = GetResString("CALCULATE_ITEMEFFECT_LUA_001237")
		SystemNotice ( role,CALCULATE_ITEMEFFECT_LUA_001237 )	
	end
end

----------------------------------------高级双倍经验增幅器
function ItemUse_GJSB( role , Item )

	local statelv = 1
	local ZBMain= GetChaAttr(role,ATTR_EXTEND0)
	local ZBNType= math.floor(ZBMain/10)      ---第几次占卜
	local ZBNMain= math.fmod(ZBMain,10 )			---BUFF OR DEBUFF
	local ZBday = GetChaAttr(role,ATTR_EXTEND2)		--占卜天数
	local ZBstate=GetChaAttr(role, ATTR_EXTEND1)	--
	local ZBstate1=math.floor(ZBstate/10)			--占卜效果注册
	local ZBstate2=math.fmod(ZBstate,10)				--占卜类型
	local now_day=os.date("%d")
	now_day=tonumber(now_day)
	if now_day==ZBday and ZBstate2==7 then
		statelv=14
	end

	local statetime = 14400
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		local ret = UseAexpItem(role,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	else
		local ret = UseAexpItem(Cha_Boat,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	end

	if statelv==14 then 
		CALCULATE_ITEMEFFECT_LUA_001238 = GetResString("CALCULATE_ITEMEFFECT_LUA_001238")
		SystemNotice ( role,CALCULATE_ITEMEFFECT_LUA_001238 )
	else
		CALCULATE_ITEMEFFECT_LUA_001239 = GetResString("CALCULATE_ITEMEFFECT_LUA_001239")
		SystemNotice ( role,CALCULATE_ITEMEFFECT_LUA_001239 )	
	end
end

----------------------------------------超级双倍经验增幅器
function ItemUse_CJSB( role , Item )

	local statelv = 1
	local ZBMain= GetChaAttr(role,ATTR_EXTEND0)
	local ZBNType= math.floor(ZBMain/10)      ---第几次占卜
	local ZBNMain= math.fmod(ZBMain,10 )			---BUFF OR DEBUFF
	local ZBday = GetChaAttr(role,ATTR_EXTEND2)		--占卜天数
	local ZBstate=GetChaAttr(role, ATTR_EXTEND1)	--
	local ZBstate1=math.floor(ZBstate/10)			--占卜效果注册
	local ZBstate2=math.fmod(ZBstate,10)				--占卜类型
	local now_day=os.date("%d")
	now_day=tonumber(now_day)
	if now_day==ZBday and ZBstate2==7 then
		statelv=14
	end

	local statetime = 21600
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		local ret = UseAexpItem(role,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	else
		local ret = UseAexpItem(Cha_Boat,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	end

	if statelv==14 then 
		CALCULATE_ITEMEFFECT_LUA_001240 = GetResString("CALCULATE_ITEMEFFECT_LUA_001240")
		SystemNotice ( role,CALCULATE_ITEMEFFECT_LUA_001240 )
	else
		CALCULATE_ITEMEFFECT_LUA_001241 = GetResString("CALCULATE_ITEMEFFECT_LUA_001241")
		SystemNotice ( role,CALCULATE_ITEMEFFECT_LUA_001241 )	
	end
end


----------------------------------------梦幻双倍经验增幅器
function ItemUse_MHSB( role , Item )

	local statelv = 1
	local ZBMain= GetChaAttr(role,ATTR_EXTEND0)
	local ZBNType= math.floor(ZBMain/10)      ---第几次占卜
	local ZBNMain= math.fmod(ZBMain,10 )			---BUFF OR DEBUFF
	local ZBday = GetChaAttr(role,ATTR_EXTEND2)		--占卜天数
	local ZBstate=GetChaAttr(role, ATTR_EXTEND1)	--
	local ZBstate1=math.floor(ZBstate/10)			--占卜效果注册
	local ZBstate2=math.fmod(ZBstate,10)				--占卜类型
	local now_day=os.date("%d")
	now_day=tonumber(now_day)
	if now_day==ZBday and ZBstate2==7 then
		statelv=14
	end

	local statetime = 28800
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
--	SystemNotice( role , Cha_Boat )
	if Cha_Boat ==  nil then
		local ret = UseAexpItem(role,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	else
		local ret = UseAexpItem(Cha_Boat,Item,statelv,statetime)
		if ret==0 then
			UseItemFailed ( role )
			return
		end
	end

	if statelv==14 then 
		CALCULATE_ITEMEFFECT_LUA_001242 = GetResString("CALCULATE_ITEMEFFECT_LUA_001242")
		SystemNotice ( role,CALCULATE_ITEMEFFECT_LUA_001242 )
	else 
		CALCULATE_ITEMEFFECT_LUA_001243 = GetResString("CALCULATE_ITEMEFFECT_LUA_001243")
		SystemNotice ( role,CALCULATE_ITEMEFFECT_LUA_001243 )
	end
end
-----欢天喜地
function ItemUse_50HTXD ( role , Item )
	local ItemID = GetItemID( Item )
	local ItemName  = GetItemName(ItemID)
	local cha_name = GetChaDefaultName ( role ) 
	local Lv = Lv(role)
	if Lv < 20 or Lv > 50 then	
		CALCULATE_ITEMEFFECT_LUA_001244 = GetResString("CALCULATE_ITEMEFFECT_LUA_001244")
		SystemNotice(role , ItemName..CALCULATE_ITEMEFFECT_LUA_001244)
		UseItemFailed ( role )
		return
	end
	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_001223 = GetResString("CALCULATE_ITEMEFFECT_LUA_001223")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001223)
		UseItemFailed ( role )
		return
	end 
	local Item_URE = GetItemAttr ( Item , ITEMATTR_URE )
	if Item_URE >= 49 then
		CALCULATE_ITEMEFFECT_LUA_001245 = GetResString("CALCULATE_ITEMEFFECT_LUA_001245")
		SystemNotice(role, CALCULATE_ITEMEFFECT_LUA_001245..ItemName)
		UseItemFailed ( role )
		return
	end
	local i = CheckBagItem(role,855)
	if i < 10 then
		CALCULATE_ITEMEFFECT_LUA_001246 = GetResString("CALCULATE_ITEMEFFECT_LUA_001246")
		SystemNotice(role, CALCULATE_ITEMEFFECT_LUA_001246..ItemName)
		UseItemFailed ( role )
		return
	end	
	local j = TakeItem ( role , 0 , 855 , 10 )
	if j == 1 then 
		sc = math.random (1,100)
		if sc > 0 and sc <= 20 then
		AddExpRealPer(role,0.2)
		elseif sc > 20 and sc <= 25 then
			GiveItem ( role , 0 , 853 , 1 , 4 )	
			CALCULATE_ITEMEFFECT_LUA_001247 = GetResString("CALCULATE_ITEMEFFECT_LUA_001247")
			CALCULATE_ITEMEFFECT_LUA_001248 = GetResString("CALCULATE_ITEMEFFECT_LUA_001248")
			ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001248..ItemName..CALCULATE_ITEMEFFECT_LUA_001247,1)		
		elseif sc > 25 and sc <= 35 then
			AddMoney ( role , 0 , 200000 )
		elseif sc > 35 and sc <= 40 then
			GiveItem ( role , 0 , 227 , 20 , 4 )
		elseif sc > 40 and sc <= 45 then
			GiveItem ( role , 0 , 3877 , 5 , 4 )
		elseif sc > 45 and sc <= 51 then
			GiveItem ( role , 0 , 770 , 1 , 4 )
			local ItemIDName = GetItemName(770)
			CALCULATE_ITEMEFFECT_LUA_001249 = GetResString("CALCULATE_ITEMEFFECT_LUA_001249")
			CALCULATE_ITEMEFFECT_LUA_001248 = GetResString("CALCULATE_ITEMEFFECT_LUA_001248")
			ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001248..ItemName..CALCULATE_ITEMEFFECT_LUA_001249..ItemIDName,1)		
		elseif sc > 51 and sc <= 57 then
			GiveItem ( role , 0 , 781 , 1 , 4 )
			local ItemIDName = GetItemName(781)
			CALCULATE_ITEMEFFECT_LUA_001249 = GetResString("CALCULATE_ITEMEFFECT_LUA_001249")
			CALCULATE_ITEMEFFECT_LUA_001248 = GetResString("CALCULATE_ITEMEFFECT_LUA_001248")
			ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001248..ItemName..CALCULATE_ITEMEFFECT_LUA_001249..ItemIDName,1)		
		elseif sc > 57 and sc <= 63 then
			GiveItem ( role , 0 , 799 , 1 , 4 )
			local ItemIDName = GetItemName(799)
			CALCULATE_ITEMEFFECT_LUA_001249 = GetResString("CALCULATE_ITEMEFFECT_LUA_001249")
			CALCULATE_ITEMEFFECT_LUA_001248 = GetResString("CALCULATE_ITEMEFFECT_LUA_001248")
			ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001248..ItemName..CALCULATE_ITEMEFFECT_LUA_001249..ItemIDName,1)	
		elseif sc > 63 and sc <= 69 then
			GiveItem ( role , 0 , 785 , 1 , 4 )
			local ItemIDName = GetItemName(785)
			CALCULATE_ITEMEFFECT_LUA_001249 = GetResString("CALCULATE_ITEMEFFECT_LUA_001249")
			CALCULATE_ITEMEFFECT_LUA_001248 = GetResString("CALCULATE_ITEMEFFECT_LUA_001248")
			ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001248..ItemName..CALCULATE_ITEMEFFECT_LUA_001249..ItemIDName,1)	
		elseif sc > 69 and sc <= 75 then
			GiveItem ( role , 0 , 774 , 1 , 4 )
			local ItemIDName = GetItemName(774)
			CALCULATE_ITEMEFFECT_LUA_001249 = GetResString("CALCULATE_ITEMEFFECT_LUA_001249")
			CALCULATE_ITEMEFFECT_LUA_001248 = GetResString("CALCULATE_ITEMEFFECT_LUA_001248")
			ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001248..ItemName..CALCULATE_ITEMEFFECT_LUA_001249..ItemIDName,1)	
		elseif sc > 75 and sc <= 80 then
			GiveItem ( role , 0 , 771 , 1 , 4 )
			local ItemIDName = GetItemName(771)
			CALCULATE_ITEMEFFECT_LUA_001249 = GetResString("CALCULATE_ITEMEFFECT_LUA_001249")
			CALCULATE_ITEMEFFECT_LUA_001248 = GetResString("CALCULATE_ITEMEFFECT_LUA_001248")
			ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001248..ItemName..CALCULATE_ITEMEFFECT_LUA_001249..ItemIDName,1)	
		elseif sc > 80 and sc <= 85 then
			GiveItem ( role , 0 , 782 , 1 , 4 )
			local ItemIDName = GetItemName(782)
			CALCULATE_ITEMEFFECT_LUA_001249 = GetResString("CALCULATE_ITEMEFFECT_LUA_001249")
			CALCULATE_ITEMEFFECT_LUA_001248 = GetResString("CALCULATE_ITEMEFFECT_LUA_001248")
			ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001248..ItemName..CALCULATE_ITEMEFFECT_LUA_001249..ItemIDName,1)	
		elseif sc > 85 and sc <= 90 then
			GiveItem ( role , 0 , 800 , 1 , 4 )
			local ItemIDName = GetItemName(800)
			CALCULATE_ITEMEFFECT_LUA_001249 = GetResString("CALCULATE_ITEMEFFECT_LUA_001249")
			CALCULATE_ITEMEFFECT_LUA_001248 = GetResString("CALCULATE_ITEMEFFECT_LUA_001248")
			ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001248..ItemName..CALCULATE_ITEMEFFECT_LUA_001249..ItemIDName,1)	
		elseif sc > 90 and sc <= 95 then
			GiveItem ( role , 0 , 786 , 1 , 4 )
			local ItemIDName = GetItemName(786)
			CALCULATE_ITEMEFFECT_LUA_001249 = GetResString("CALCULATE_ITEMEFFECT_LUA_001249")
			CALCULATE_ITEMEFFECT_LUA_001248 = GetResString("CALCULATE_ITEMEFFECT_LUA_001248")
			ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001248..ItemName..CALCULATE_ITEMEFFECT_LUA_001249..ItemIDName,1)	
		else
			GiveItem ( role , 0 , 793 , 1 , 4 )	
			local ItemIDName = GetItemName(793)
			CALCULATE_ITEMEFFECT_LUA_001249 = GetResString("CALCULATE_ITEMEFFECT_LUA_001249")
			CALCULATE_ITEMEFFECT_LUA_001248 = GetResString("CALCULATE_ITEMEFFECT_LUA_001248")
			ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001248..ItemName..CALCULATE_ITEMEFFECT_LUA_001249..ItemIDName,1)	
		end
	else
		UseItemFailed ( role )
		CALCULATE_ITEMEFFECT_LUA_000364 = GetResString("CALCULATE_ITEMEFFECT_LUA_000364")
		SystemNotice( role, CALCULATE_ITEMEFFECT_LUA_000364)
	end	
end 


function ItemUse_60HTXD ( role , Item )
	local ItemID = GetItemID( Item )
	local ItemName  = GetItemName(ItemID)
	local cha_name = GetChaDefaultName ( role ) 
	local Lv = Lv(role)
	if Lv < 51 or Lv > 60 then	
		CALCULATE_ITEMEFFECT_LUA_001250 = GetResString("CALCULATE_ITEMEFFECT_LUA_001250")
		SystemNotice(role , ItemName..CALCULATE_ITEMEFFECT_LUA_001250)
		UseItemFailed ( role )
		return
	end
	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_001223 = GetResString("CALCULATE_ITEMEFFECT_LUA_001223")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001223)
		UseItemFailed ( role )
		return
	end 
	local Item_URE = GetItemAttr ( Item , ITEMATTR_URE )
	if Item_URE >= 49 then
		CALCULATE_ITEMEFFECT_LUA_001251 = GetResString("CALCULATE_ITEMEFFECT_LUA_001251")
		SystemNotice(role, CALCULATE_ITEMEFFECT_LUA_001251)
		UseItemFailed ( role )
		return
	end
	local i = CheckBagItem(role,855)
	if i < 20 then
		CALCULATE_ITEMEFFECT_LUA_001252 = GetResString("CALCULATE_ITEMEFFECT_LUA_001252")
		SystemNotice(role, CALCULATE_ITEMEFFECT_LUA_001252..ItemName)
		UseItemFailed ( role )
		return
	end	
	local j = TakeItem ( role , 0 , 855 , 20 )
	if j == 1 then 
		sc = math.random (1,100)
		if sc > 0 and sc <= 10 then
		AddExpRealPer(role,0.1)
		elseif sc > 10 and sc <= 15 then
			GiveItem ( role , 0 , 853 , 1 , 4 )
			CALCULATE_ITEMEFFECT_LUA_001247 = GetResString("CALCULATE_ITEMEFFECT_LUA_001247")
			CALCULATE_ITEMEFFECT_LUA_001248 = GetResString("CALCULATE_ITEMEFFECT_LUA_001248")
			ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001248..ItemName..CALCULATE_ITEMEFFECT_LUA_001247,1)		
		elseif sc > 15 and sc <= 25 then
			AddMoney ( role , 0 , 500000 )
		elseif sc > 25 and sc <= 35 then
			GiveItem ( role , 0 , 6581 , 1 , 4 )
			local ItemIDName = GetItemName(6581)
			CALCULATE_ITEMEFFECT_LUA_001249 = GetResString("CALCULATE_ITEMEFFECT_LUA_001249")
			CALCULATE_ITEMEFFECT_LUA_001248 = GetResString("CALCULATE_ITEMEFFECT_LUA_001248")
			ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001248..ItemName..CALCULATE_ITEMEFFECT_LUA_001249..ItemIDName,1)		
		elseif sc > 35 and sc <= 40 then
			GiveItem ( role , 0 , 3877 , 5 , 4 )
		elseif sc > 40 and sc <= 50 then
			GiveItem ( role , 0 , 775 , 1 , 4 )
			local ItemIDName = GetItemName(775)
			CALCULATE_ITEMEFFECT_LUA_001249 = GetResString("CALCULATE_ITEMEFFECT_LUA_001249")
			CALCULATE_ITEMEFFECT_LUA_001248 = GetResString("CALCULATE_ITEMEFFECT_LUA_001248")
			ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001248..ItemName..CALCULATE_ITEMEFFECT_LUA_001249..ItemIDName,1)	
		elseif sc > 50 and sc <= 60 then
			GiveItem ( role , 0 , 772 , 1 , 4 )
			local ItemIDName = GetItemName(772)
			CALCULATE_ITEMEFFECT_LUA_001249 = GetResString("CALCULATE_ITEMEFFECT_LUA_001249")
			CALCULATE_ITEMEFFECT_LUA_001248 = GetResString("CALCULATE_ITEMEFFECT_LUA_001248")
			ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001248..ItemName..CALCULATE_ITEMEFFECT_LUA_001249..ItemIDName,1)	
		elseif sc > 60 and sc <= 70 then
			GiveItem ( role , 0 , 783 , 1 , 4 )
			local ItemIDName = GetItemName(783)
			CALCULATE_ITEMEFFECT_LUA_001249 = GetResString("CALCULATE_ITEMEFFECT_LUA_001249")
			CALCULATE_ITEMEFFECT_LUA_001248 = GetResString("CALCULATE_ITEMEFFECT_LUA_001248")
			ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001248..ItemName..CALCULATE_ITEMEFFECT_LUA_001249..ItemIDName,1)	
		elseif sc > 70 and sc <= 80 then
			GiveItem ( role , 0 , 801 , 1 , 4 )
			local ItemIDName = GetItemName(801)
			CALCULATE_ITEMEFFECT_LUA_001249 = GetResString("CALCULATE_ITEMEFFECT_LUA_001249")
			CALCULATE_ITEMEFFECT_LUA_001248 = GetResString("CALCULATE_ITEMEFFECT_LUA_001248")
			ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001248..ItemName..CALCULATE_ITEMEFFECT_LUA_001249..ItemIDName,1)	
		elseif sc > 80 and sc <= 90 then
			GiveItem ( role , 0 , 787 , 1 , 4 )
			local ItemIDName = GetItemName(787)
			CALCULATE_ITEMEFFECT_LUA_001249 = GetResString("CALCULATE_ITEMEFFECT_LUA_001249")
			CALCULATE_ITEMEFFECT_LUA_001248 = GetResString("CALCULATE_ITEMEFFECT_LUA_001248")
			ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001248..ItemName..CALCULATE_ITEMEFFECT_LUA_001249..ItemIDName,1)	
		else
			GiveItem ( role , 0 , 794 , 1 , 4 )	
			local ItemIDName = GetItemName(794)
			CALCULATE_ITEMEFFECT_LUA_001249 = GetResString("CALCULATE_ITEMEFFECT_LUA_001249")
			CALCULATE_ITEMEFFECT_LUA_001248 = GetResString("CALCULATE_ITEMEFFECT_LUA_001248")
			ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001248..ItemName..CALCULATE_ITEMEFFECT_LUA_001249..ItemIDName,1)
		end
	else
		UseItemFailed ( role )
		CALCULATE_ITEMEFFECT_LUA_000364 = GetResString("CALCULATE_ITEMEFFECT_LUA_000364")
		SystemNotice( role, CALCULATE_ITEMEFFECT_LUA_000364)
	end	
end 


function ItemUse_70HTXD ( role , Item )
	local ItemID = GetItemID( Item )
	local ItemName  = GetItemName(ItemID)
	local cha_name = GetChaDefaultName ( role ) 
	local Lv = Lv(role)
	if Lv < 61 or Lv > 70 then	
		CALCULATE_ITEMEFFECT_LUA_001253 = GetResString("CALCULATE_ITEMEFFECT_LUA_001253")
		SystemNotice(role , ItemName..CALCULATE_ITEMEFFECT_LUA_001253)
		UseItemFailed ( role )
		return
	end
	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_001110 = GetResString("CALCULATE_ITEMEFFECT_LUA_001110")
		SystemNotice( role , CALCULATE_ITEMEFFECT_LUA_001110 )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		CALCULATE_ITEMEFFECT_LUA_001223 = GetResString("CALCULATE_ITEMEFFECT_LUA_001223")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001223)
		UseItemFailed ( role )
		return
	end 
	local Item_URE = GetItemAttr ( Item , ITEMATTR_URE )
	if Item_URE >= 49 then
		CALCULATE_ITEMEFFECT_LUA_001245 = GetResString("CALCULATE_ITEMEFFECT_LUA_001245")
		SystemNotice(role, CALCULATE_ITEMEFFECT_LUA_001245..ItemName)
		UseItemFailed ( role )
		return
	end
	local i = CheckBagItem(role,855)
	if i < 30 then
		CALCULATE_ITEMEFFECT_LUA_001254 = GetResString("CALCULATE_ITEMEFFECT_LUA_001254")
		SystemNotice(role, CALCULATE_ITEMEFFECT_LUA_001254..ItemName)
		UseItemFailed ( role )
		return
	end	
	local j = TakeItem ( role , 0 , 855 , 30 )
	if j == 1 then 
		sc = math.random (1,100)
		if sc > 0 and sc <= 5 then
		AddExpRealPer(role,0.05)
		elseif sc > 5 and sc <= 8 then
			GiveItem ( role , 0 , 853 , 1 , 4 )	
			CALCULATE_ITEMEFFECT_LUA_001247 = GetResString("CALCULATE_ITEMEFFECT_LUA_001247")
			CALCULATE_ITEMEFFECT_LUA_001248 = GetResString("CALCULATE_ITEMEFFECT_LUA_001248")
			ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001248..ItemName..CALCULATE_ITEMEFFECT_LUA_001247,1)		
		elseif sc > 8 and sc <= 11 then
			AddMoney ( role , 0 , 1000000 )
		elseif sc > 11 and sc <= 13 then
			GiveItem ( role , 0 , 861 , 1 , 4 )
		elseif sc > 13 and sc <= 18 then
			GiveItem ( role , 0 , 6819 , 1 , 4 )
		elseif sc > 18 and sc <= 23 then
			GiveItem ( role , 0 , 6822 , 1 , 4 )
		elseif sc > 23 and sc <= 28 then
			GiveItem ( role , 0 , 6825 , 1 , 4 )
		elseif sc > 28 and sc <= 33 then
			GiveItem ( role , 0 , 6828 , 1 , 4 )
		elseif sc > 33 and sc <= 38 then
			GiveItem ( role , 0 , 6831 , 1 , 4 )
		elseif sc > 38 and sc <= 40 then
			GiveItem ( role , 0 , 863 , 1 , 4 )
		elseif sc > 40 and sc <= 42 then
			GiveItem ( role , 0 , 862 , 1 , 4 )
		elseif sc > 42 and sc <= 44 then
			GiveItem ( role , 0 , 860 , 1 , 4 )
		elseif sc > 44 and sc <= 55 then
			GiveItem ( role , 0 , 6582 , 1 , 4 )
		elseif sc > 55 and sc <= 60 then
			GiveItem ( role , 0 , 776 , 1 , 4 )
			local ItemIDName = GetItemName(776)
			CALCULATE_ITEMEFFECT_LUA_001249 = GetResString("CALCULATE_ITEMEFFECT_LUA_001249")
			CALCULATE_ITEMEFFECT_LUA_001248 = GetResString("CALCULATE_ITEMEFFECT_LUA_001248")
			ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001248..ItemName..CALCULATE_ITEMEFFECT_LUA_001249..ItemIDName,1)		
		elseif sc > 60 and sc <= 65 then
			GiveItem ( role , 0 , 773 , 1 , 4 )	
			local ItemIDName = GetItemName(773)
			CALCULATE_ITEMEFFECT_LUA_001249 = GetResString("CALCULATE_ITEMEFFECT_LUA_001249")
			CALCULATE_ITEMEFFECT_LUA_001248 = GetResString("CALCULATE_ITEMEFFECT_LUA_001248")
			ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001248..ItemName..CALCULATE_ITEMEFFECT_LUA_001249..ItemIDName,1)	
		elseif sc > 65 and sc <= 70 then 
			GiveItem ( role , 0 , 784 , 1 , 4 )	
			local ItemIDName = GetItemName(784)
			CALCULATE_ITEMEFFECT_LUA_001249 = GetResString("CALCULATE_ITEMEFFECT_LUA_001249")
			CALCULATE_ITEMEFFECT_LUA_001248 = GetResString("CALCULATE_ITEMEFFECT_LUA_001248")
			ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001248..ItemName..CALCULATE_ITEMEFFECT_LUA_001249..ItemIDName,1)	
		elseif sc > 70 and sc <= 75 then 
			GiveItem ( role , 0 , 802 , 1 , 4 )	
			local ItemIDName = GetItemName(802)
			CALCULATE_ITEMEFFECT_LUA_001249 = GetResString("CALCULATE_ITEMEFFECT_LUA_001249")
			CALCULATE_ITEMEFFECT_LUA_001248 = GetResString("CALCULATE_ITEMEFFECT_LUA_001248")
			ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001248..ItemName..CALCULATE_ITEMEFFECT_LUA_001249..ItemIDName,1)	
		elseif sc > 75 and sc <= 80 then 
			GiveItem ( role , 0 , 788 , 1 , 4 )	
			local ItemIDName = GetItemName(788)
			CALCULATE_ITEMEFFECT_LUA_001249 = GetResString("CALCULATE_ITEMEFFECT_LUA_001249")
			CALCULATE_ITEMEFFECT_LUA_001248 = GetResString("CALCULATE_ITEMEFFECT_LUA_001248")
			ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001248..ItemName..CALCULATE_ITEMEFFECT_LUA_001249..ItemIDName,1)	
		elseif sc > 80 and sc <= 85 then 
			GiveItem ( role , 0 , 795 , 1 , 4 )	
			local ItemIDName = GetItemName(795)
			CALCULATE_ITEMEFFECT_LUA_001249 = GetResString("CALCULATE_ITEMEFFECT_LUA_001249")
			CALCULATE_ITEMEFFECT_LUA_001248 = GetResString("CALCULATE_ITEMEFFECT_LUA_001248")
			ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001248..ItemName..CALCULATE_ITEMEFFECT_LUA_001249..ItemIDName,1)	
		elseif sc > 85 and sc <= 90 then 
			GiveItem ( role , 0 , 6344 , 1 , 4 )	
			local ItemIDName = GetItemName(6344)
			CALCULATE_ITEMEFFECT_LUA_001249 = GetResString("CALCULATE_ITEMEFFECT_LUA_001249")
			CALCULATE_ITEMEFFECT_LUA_001248 = GetResString("CALCULATE_ITEMEFFECT_LUA_001248")
			ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001248..ItemName..CALCULATE_ITEMEFFECT_LUA_001249..ItemIDName,1)				
		elseif sc > 90 and sc <= 95 then 
			GiveItem ( role , 0 , 6345 , 1 , 4 )	
			local ItemIDName = GetItemName(6345)
			CALCULATE_ITEMEFFECT_LUA_001249 = GetResString("CALCULATE_ITEMEFFECT_LUA_001249")
			CALCULATE_ITEMEFFECT_LUA_001248 = GetResString("CALCULATE_ITEMEFFECT_LUA_001248")
			ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001248..ItemName..CALCULATE_ITEMEFFECT_LUA_001249..ItemIDName,1)	
		else
			GiveItem ( role , 0 , 6346 , 1 , 4 )	
			local ItemIDName = GetItemName(6346)
			CALCULATE_ITEMEFFECT_LUA_001249 = GetResString("CALCULATE_ITEMEFFECT_LUA_001249")
			CALCULATE_ITEMEFFECT_LUA_001248 = GetResString("CALCULATE_ITEMEFFECT_LUA_001248")
			ScrollNotice ( cha_name..CALCULATE_ITEMEFFECT_LUA_001248..ItemName..CALCULATE_ITEMEFFECT_LUA_001249..ItemIDName,1)	
		end
	else
		UseItemFailed ( role )
		CALCULATE_ITEMEFFECT_LUA_000364 = GetResString("CALCULATE_ITEMEFFECT_LUA_000364")
		SystemNotice( role, CALCULATE_ITEMEFFECT_LUA_000364)
	end	
end 


-------------------------------45BB衣服+45BB武器
function ItemUse_45BBBOX( role, Item )

	local lv = GetChaAttr(role, ATTR_LV)
	local job = GetChaAttr( role, ATTR_JOB) --取职业
	local cha_type = GetChaTypeID ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 2 then
		CALCULATE_ITEMEFFECT_LUA_000518 = GetResString("CALCULATE_ITEMEFFECT_LUA_000518")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000518)
		UseItemFailed ( role )
		return
	end
	if lv < 40 then
		CALCULATE_ITEMEFFECT_LUA_000115 = GetResString("CALCULATE_ITEMEFFECT_LUA_000115")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000115)
		UseItemFailed ( role )
		return
	end
	if cha_type == 1 and job==9 then
		GiveItem ( role , 0 , 0767 , 1 , 4 )----------------诅咒之灵钢甲	
		GiveItem ( role , 0 , 0774 , 1 , 4 )--------------咒纹刺剑
	elseif cha_type == 3 and job == 9 then 
		GiveItem ( role , 0 , 0767 , 1 , 4 )----------------诅咒之灵钢甲	
		GiveItem ( role , 0 , 0774 , 1 , 4 )--------------咒纹刺剑
	elseif cha_type == 2 and job==8 then
		GiveItem ( role , 0 , 0764  , 1 , 4 )-----------------武士之诅咒纹身
		GiveItem ( role , 0 , 0771  , 1 , 4 )--------------咒纹重剑
	elseif cha_type == 1 and job==12 then
		GiveItem ( role , 0 , 0778  , 1 , 4 )-------------咒纹紧身衣
		GiveItem ( role , 0 , 0782  , 1 , 4 )--------------诅咒之吻
	elseif cha_type == 3 and job==12 then
		GiveItem ( role , 0 , 0778  , 1 , 4 )-------------咒纹紧身衣
		GiveItem ( role , 0 , 0782  , 1 , 4 )--------------诅咒之吻
	elseif cha_type == 4 and job==13 then
		GiveItem ( role , 0 , 0790  , 1 , 4 )-------------符文外衣
		GiveItem ( role , 0 , 0786  , 1 , 4 )--------------咒术之杖
	elseif cha_type == 3  and job==13 then
		GiveItem ( role , 0 , 0790  , 1 , 4 )-------------符文外衣
		GiveItem ( role , 0 , 0786  , 1 , 4 )--------------咒术之杖
	elseif cha_type == 3  and job==14 then
		GiveItem ( role , 0 , 0796  , 1 , 4 )-------------咒文之袍
		GiveItem ( role , 0 , 0793  , 1 , 4 )--------------咒文法杖
	elseif cha_type == 4 and job==14 then
		GiveItem ( role , 0 , 0796  , 1 , 4 )-------------咒文之袍
		GiveItem ( role , 0 , 0793  , 1 , 4 )--------------咒文法杖
	elseif cha_type == 3 and job==16 then
		GiveItem ( role , 0 , 0804  , 1 , 4 )-------------咒火斗篷
		GiveItem ( role , 0 , 0800  , 1 , 4 )--------------诅咒之刺
	elseif cha_type == 1 and job==16 then
		GiveItem ( role , 0 , 0804  , 1 , 4 )-------------咒火斗篷
		GiveItem ( role , 0 , 0800  , 1 , 4 )--------------诅咒之刺
	elseif cha_type ==4 and job==16 then
		GiveItem ( role , 0 , 0804  , 1 , 4 )-------------咒火斗篷
		GiveItem ( role , 0 , 0800  , 1 , 4 )--------------诅咒之刺
	else 
		CALCULATE_ITEMEFFECT_LUA_000103 = GetResString("CALCULATE_ITEMEFFECT_LUA_000103")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_000103)
		UseItemFailed ( role )
		return
	end
end


function ItemUse_AddLv1(role) 

	local cha_lv = Lv(role)
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		CALCULATE_ITEMEFFECT_LUA_000023 = GetResString("CALCULATE_ITEMEFFECT_LUA_000023")
		SystemNotice(Cha_Boat,CALCULATE_ITEMEFFECT_LUA_000023)
		UseItemFailed ( role )
		return LUA_FALSE
	else	
		local exp_role=GetChaAttr (  role , ATTR_CEXP )----------当前经验
		-- if cha_lv >=1 and cha_lv <=79 then
		local cha_nlv = cha_lv+1
		local cha_n2lv= cha_nlv+1
		local lvNeedexp=GetExp[cha_nlv]-GetExp[cha_lv]
		local NlvNeedexp= GetExp[cha_n2lv]-GetExp[cha_nlv]
		local LvlessExp = exp_role-GetExp[cha_lv]
		local per= LvlessExp/lvNeedexp
		local NLvlessEXP=per*NlvNeedexp
		local ExpAfterAdd=NLvlessEXP+GetExp[cha_nlv]
		ExpAfterAdd=math.floor(ExpAfterAdd)
		SetChaAttr(role,ATTR_CEXP,ExpAfterAdd)
			-- local exp_add= GetExp[cha_nlv]-GetExp[cha_lv]
				-- SystemNotice(role,"exp_add="..exp_add)
			-- AddExp( role , npc , exp_add , exp_add)
		-- elseif	cha_lv >= 80 and cha_lv <= 89 then
			-- local cha_nlv = cha_lv+1
			-- local exp_add= (GetExp[cha_nlv]-GetExp[cha_lv])*50
				-- SystemNotice(role,"exp_add="..exp_add)
			-- AddExp( role , npc , exp_add , exp_add)			
		-- elseif 	cha_lv >= 90 and cha_lv <= 99 then
			-- local cha_nlv = cha_lv+1
			-- local exp_add= GetExp[cha_nlv]-GetExp[cha_lv]
				-- SystemNotice(role,"exp_add="..exp_add)
			-- AddExp( role , npc , exp_add , exp_add)
		-- end	
	end		
end

function ItemUse_SQKZBOX( role , Item )

	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet < 4 then
		CALCULATE_ITEMEFFECT_LUA_001023 = GetResString("CALCULATE_ITEMEFFECT_LUA_001023")
		SystemNotice(role ,CALCULATE_ITEMEFFECT_LUA_001023)
		UseItemFailed ( role )
		return
	end

	local chaType = GetChaTypeID( role )
	local i=0
	-- for i=1,4,1 do	
		-- if chaType==i then.			
			GiveItem ( role , 0 , 5726+(chaType-1)*4  , 1 , 4 )
			GiveItem ( role , 0 , 5727+(chaType-1)*4  , 1 , 4 )
			GiveItem ( role , 0 , 5728+(chaType-1)*4  , 1 , 4 )
			GiveItem ( role , 0 , 5729+(chaType-1)*4  , 1 , 4 )
			local rolename = GetChaDefaultName ( role )
			CALCULATE_ITEMEFFECT_LUA_001255 = GetResString("CALCULATE_ITEMEFFECT_LUA_001255")
			CALCULATE_FUNCTIONS_LUA_000365 = GetResString("CALCULATE_FUNCTIONS_LUA_000365")
			ScrollNotice(CALCULATE_FUNCTIONS_LUA_000365..rolename..CALCULATE_ITEMEFFECT_LUA_001255,1)
		-- end	
	-- end	
end

--------------------------魔方（ID7377）-----Miku---------
function ItemUse_MOfang( role , Item )

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		SystemNotice( role , "Unable to use Demonic Tool while on sea." )
		UseItemFailed ( role )
		return
	end
	--判断是否为出海状态

	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 1 then
		SystemNotice(role ,"Require 1 empty slot to open Demonic Tool")
		UseItemFailed ( role )
		return
       end
	--判断背包空间
local gldzy= CheckBagItem ( role , 7378 ) --古老的咒语
	local gkjys= CheckBagItem ( role , 7379 ) --高科技钥匙

	if gldzy>0 then
	  GiveItem(role,0,6872,1,4)
	  SystemNotice(role ,"Congratulation! You have obtained 1 Trick Leveling Fruit!")
      DelBagItem ( role , 7378,1 )
	elseif gkjys>0 then

	     local b = math.random (1,10)
	     if b<9 then
		 GiveItem ( role , 0 , 6873 , 1 , 31 )
		 SystemNotice(role ,"Congratulation! You have obtained 1 Gong Gong Chest!")
DelBagItem ( role , 7379,1 )
	     elseif b>9 then
         GiveItem( role, 0, 6872, 1, 41 )
		 SystemNotice(role ,"Congratulation! You have obtained 1 Trick Leveling Fruit!")
DelBagItem ( role , 7379,1 )
		end
else
	
local mofang=CheckBagItem ( role , 7377 )
       	--检查魔方
		if mofang>0 then
		GiveItem ( role , 0 , 2953 , 1 , 0 )
		SystemNotice(role ,"Congratulation! You have obtained 1 Gift of April's Fool!")
end
end
end

--------------------------愚人节礼物----Miku---------

function ItemUse_FoolishNew ( role , Item )
RefreshCha( role )
local Cha_Boat = 0
local dif_exp_thalf_c = 0
		Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		SystemNotice( role , "Unable to use while on sea." )
		UseItemFailed ( role )
		return
	end

	local Exp_el=GetChaAttr (  role , ATTR_CEXP )----------当前等级经验

	local charLv=Lv ( role )
	if charLv<=49 then
	dif_exp_thalf_c = (DEXP[charLv+1] - DEXP[charLv])*1+Exp_el 
		SystemNotice( role , "Obtained 100% EXP from Gift of April's Fool!" )
        
	elseif charLv > 49 and charLv <= 69 then
		 dif_exp_thalf_c = (DEXP[charLv+1] - DEXP[charLv])*0.3+Exp_el
		SystemNotice( role , "Obtained 30% EXP from Gift of April's Fool!" )

	elseif charLv > 70 and charLv <= 99 then
		dif_exp_thalf_c = (DEXP[charLv+1] - DEXP[charLv])*0.1+Exp_el 
		SystemNotice( role , "Obtained 10% EXP from Gift of April's Fool!" )
       
	elseif charLv > 99 and charLv < 120 then
		dif_exp_thalf_c = (DEXP[charLv+1] - DEXP[charLv])*0.03+Exp_el 
		SystemNotice( role , "Obtained 3% EXP from Gift of April's Fool!" )
	end
    SetChaAttrI( role , ATTR_CEXP , dif_exp_thalf_c )
    dif_exp_thalf_c = 0
end

--------双剑士转职技能书
function Sk_Script_Wyz2 ( role , Item ) 	
										
	local sk_add = SK_WYZ 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv >= 2  then 
		UseItemFailed ( role )  
		return 
	end
	local zs_exp = GetChaAttr ( role , ATTR_CSAILEXP )
	if zs_exp <= 0 then
		UseItemFailed ( role )  
		return 
	end
	a = AddChaSkill ( role , sk_add, 2 , 1 , 0 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 

--------巨剑士转职技能书
function Sk_Script_Bsj2 ( role , Item ) 
											
	local sk_add = SK_BSJ 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv >= 2  then 
		UseItemFailed ( role )  
		return 
	end
	local zs_exp = GetChaAttr ( role , ATTR_CSAILEXP )
	if zs_exp <= 0 then
		UseItemFailed ( role )  
		return 
	end
	a = AddChaSkill ( role , sk_add, 2 , 1 , 0 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 

--------封印师转职技能书
function Sk_Script_Emzz2 ( role , Item ) 
											
	local sk_add = SK_EMZZ 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv >= 2  then 
		UseItemFailed ( role )  
		return 
	end 
	local zs_exp = GetChaAttr ( role , ATTR_CSAILEXP )
	if zs_exp <= 0 then
		UseItemFailed ( role )  
		return 
	end
	a = AddChaSkill ( role , sk_add, 2 , 1 , 0 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 
--------圣职者转职技能书
function Sk_Script_Sssp2 ( role , Item ) 	
										
	local sk_add = SK_SSSP 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv >= 2  then 
		UseItemFailed ( role )  
		return 
	end
	local zs_exp = GetChaAttr ( role , ATTR_CSAILEXP )
	if zs_exp <= 0 then
		UseItemFailed ( role )  
		return 
	end
	local zs_exp = GetChaAttr ( role , ATTR_CSAILEXP )
	if zs_exp <= 0 then
		UseItemFailed ( role )  
		return 
	end
	a = AddChaSkill ( role , sk_add, 2 , 1 , 0 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 

--------航海士转职技能书
function Sk_Script_Cyn2 ( role , Item ) 	
										
	local sk_add = SK_CYN 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv >= 2  then 
		UseItemFailed ( role )  
		return 
	end 
	local zs_exp = GetChaAttr ( role , ATTR_CSAILEXP )
	if zs_exp <= 0 then
		UseItemFailed ( role )  
		return 
	end
	a = AddChaSkill ( role , sk_add, 2 , 1 , 0 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 

--------狙击手转职技能书
function Sk_Script_Hlp2 ( role , Item ) 
											
	local sk_add = SK_HLP 
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv >= 2  then 
		UseItemFailed ( role )  
		return 
	end 
	local zs_exp = GetChaAttr ( role , ATTR_CSAILEXP )
	if zs_exp <= 0 then
		UseItemFailed ( role )  
		return 
	end
	a = AddChaSkill ( role , sk_add, 2 , 1 , 0 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 
---------------------王小虎的宝箱--------------罂粟花开----------------
function ItemUse_WXHBX(role)
    local temp1 = math.random(1,100)
	local temp2 = math.random(1,100)
	local temp3 = math.random(1,6)
	local playername =GetChaDefaultName ( role ) ---获取玩家昵称
	if temp1 <= 50 then 
		if temp2 <=33 then 
			GiveItem ( role , 0 , 7364 ,1 , 4 )
			ScrollNotice ( "Congratulations to player----"..playername.." ----for defeating the Thief - Wang Xiao Hu and obtained [Wang Xiao Hu's Chest]. However it's really not your day to receive a[Olda's Feather Duster] ~~~~(>_<)~~~~",1)
			return 
		elseif temp2 >33 and temp2 <=66 then 
			GiveItem ( role , 0 , 7365 ,1 , 4 )
			ScrollNotice ( "Congratulations to player ----"..playername.." ----for defeating the Thief - Wang Xiao Hu and obtained [Wang Xiao Hu's Chest]. However it's really not your day to receive a [Childre's lollipop] ~~~~(~.~)~~~~",1)
			return 
		elseif temp2 >66 then 
			GiveItem ( role , 0 , 7366 ,1 , 4 )
			ScrollNotice ( "Congratulations to player ----"..playername.."----for defeating the Thief - Wang Xiao Hu and obtained [Wang Xiao Hu's Chest]. However it's really not your day to receive a[Aunt Susan's Binding] ~~~~(>_<)~~~~",1)
			return
		end
	else
		if temp2 <= 50 then---给55级腰带
			if temp3 ==1 then
				GiveItem ( role , 0 , 7294 ,1 , 4 )
				ScrollNotice ( "Congratulations to player ----"..playername.."----for defeating the Thief - Wang Xiao Hu and obtained [Wang Xiao Hu's Chest]. Wow, you're lucky to receive a[Lv55 Champion's Belt] ~~~~o(n_n)o~~~~",1)
				return
			elseif temp3 ==2 then
				GiveItem ( role , 0 , 7297 ,1 , 4 )
				ScrollNotice ( "Congratulations to player ----"..playername.."----for defeating the Thief - Wang Xiao Hu and obtained [Wang Xiao Hu's Chest]. Wow, you're lucky to receive a [Lv55 Crusader's Belt] ~~~~o(n_n)o~~~~",1)
				return
			elseif temp3 ==3 then 
				GiveItem ( role , 0 , 7300 ,1 , 4 )
				ScrollNotice ( "Congratulations to player ----"..playername.."----for defeating the Thief - Wang Xiao Hu and obtained [Wang Xiao Hu's Chest]. Wow, you're lucky to receive a [Lv55 Cleric's Belt] ~~~~o(n_n)o~~~~",1)
				return
			elseif temp3 ==4 then
				GiveItem ( role , 0 , 7303 ,1 , 4 )
				ScrollNotice ( "Congratulations to player ----"..playername.." ----for defeating the Thief - Wang Xiao Hu and obtained [Wang Xiao Hu's Chest]. Wow, you're lucky to receive a[Lv55 Seal Master's Belt] ~~~~o(n_n)o~~~~",1)
				return
			elseif temp3 ==5 then 
				GiveItem ( role , 0 , 7306 ,1 , 4 )
				ScrollNotice ( "Congratulations to player ----"..playername.." ----for defeating the Thief - Wang Xiao Hu and obtained [Wang Xiao Hu's Chest]. Wow, you're lucky to receive a [Lv55 Voyager's Belt] ~~~~o(n_n)o~~~~",1)
				return
			elseif temp3 ==6 then
				GiveItem ( role , 0 , 7309 ,1 , 4 )
				ScrollNotice ( "Congratulations to player ----"..playername.." ----for defeating the Thief - Wang Xiao Hu and obtained [Wang Xiao Hu's Chest]. Wow, you're lucky to receive a [Lv55 Sharpshooter's Belt] ~~~~o(n_n)o~~~~",1)
				return
			end
		else--给65J腰带
			if temp3 ==1 then
				GiveItem ( role , 0 , 7312 ,1 , 4 )
				ScrollNotice ( "Congratulations to player ----"..playername.." ----for defeating the Thief - Wang Xiao Hu and obtained [Wang Xiao Hu's Chest]. Wow, you're lucky to receive a [Lv65 Champion's Belt] ~~~~o(n_n)o~~~~",1)
				return
			elseif temp3 ==2 then
				GiveItem ( role , 0 , 7315 ,1 , 4 )
				ScrollNotice ( "Congratulations to player ----"..playername.."----for defeating the Thief - Wang Xiao Hu and obtained [Wang Xiao Hu's Chest]. Wow, you're lucky to receive a [Lv65 Crusader's Belt] ~~~~o(n_n)o~~~~",1)
				return
			elseif temp3 ==3 then 
				GiveItem ( role , 0 , 7318 ,1 , 4 )
				ScrollNotice ( "Congratulations to player----"..playername.." ----for defeating the Thief - Wang Xiao Hu and obtained [Wang Xiao Hu's Chest]. Wow, you're lucky to receive a[Lv65 Cleric's Belt] ~~~~o(n_n)o~~~~",1)
				return
			elseif temp3 ==4 then
				GiveItem ( role , 0 , 7321 ,1 , 4 )
				ScrollNotice ( "Congratulations to player ----"..playername.." ----for defeating the Thief - Wang Xiao Hu and obtained [Wang Xiao Hu's Chest]. Wow, you're lucky to receive a[Lv65 Seal Master's Belt] ~~~~o(n_n)o~~~~",1)
				return
			elseif temp3 ==5 then 
				GiveItem ( role , 0 , 7324 ,1 , 4 )
				ScrollNotice ( "Congratulations to player ----"..playername.."----for defeating the Thief - Wang Xiao Hu and obtained [Wang Xiao Hu's Chest]. Wow, you're lucky to receive a[Lv65 Voyager's Belt] ~~~~o(n_n)o~~~~",1)
				return
			elseif temp3 ==6 then
				GiveItem ( role , 0 , 7327 ,1 , 4 )
				ScrollNotice ( "Congratulations to player ----"..playername.."-----for defeating the Thief - Wang Xiao Hu and obtained [Wang Xiao Hu's Chest]. Wow, you're lucky to receive a [Lv65 Sharpshooter's Belt] ~~~~o(n_n)o~~~~",1)
				return
			end
		end
	end
end


function ItemUse_Shendanshenmiliwu( role , Item )		----------神秘的圣诞礼物

	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		SystemNotice( role , "Unavailable while sailing" )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 5 then
		SystemNotice(role ,"Your inventory at least has five slots for opening the Mysterious Xmas Gift.")
		UseItemFailed ( role )
		return
	end
	local jles=CheckBagItem ( role , 7721 )
	local bankHasitem=BankNoItem(role,7721,1)
	if jles > 0 then
		SystemNotice(role ,"Click on the harvesting tool and proceed to the co-ordinates to start harvesting!")
		UseItemFailed ( role )
		return
	elseif bankHasitem == 0 then
		SystemNotice(role ,"Click on the harvesting tool and proceed to the co-ordinates to start harvesting!")
		UseItemFailed ( role )
		return
	end
	GiveItem ( role , 0 , 2888  , 1 , 4 )
	GiveItem ( role , 0 , 2889  , 1 , 4 )
	GiveItem ( role , 0 , 7721  , 1 , 4 )
	local chaitem = GetChaItem2(role,2,7721)
	local zbiaomap = math.random ( 1, 3 )
	   SetItemAttr(chaitem,ITEMATTR_VAL_PARAM1,zbiaomap)
	   SystemNotice(role ,"Click the tool to plant your Xmas Tree.!")
end
function ItemUse_SDSZZGJ ( role , Item )
	local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		SystemNotice( role , "Unavailable while sailing" )     --判断是否为出海状态
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet <= 0 then
		SystemNotice(role ,"Inventory is full!")
		UseItemFailed ( role )
		return
	end
		
	local MapList = {}
	MapList [1] = "darkblue"
	MapList [2] = "darkblue"
	MapList [3] = "darkblue"
	local zbiaox={}
	zbiaox[1]=144700
	zbiaox[2]=144700
	zbiaox[3]=144700
	
	local zbiaoy={}
	zbiaoy[1]=54700
	zbiaoy[2]=54700
	zbiaoy[3]=54700
	
	local x, y = GetChaPos(role)
	local map_name = GetChaMapName ( role )
	
	local chaitem = GetChaItem2(role,2,7721)
	local zbiaomap = GetItemAttr(chaitem,ITEMATTR_VAL_PARAM1)
	
    local mapbz = MapList [zbiaomap]
	local cenX = zbiaox[zbiaomap]
	local cenY = zbiaoy[zbiaomap]
	
	local zhzbx = math.random ( 100, 1000 )
	local zhzby = math.random ( 100, 1000 )
	if map_name ~= mapbz then
		SystemNotice ( role , "Your Xmas Tree should be planted around Atlantis Snowfield coordinates X:"..(cenX/100)..",Y:"..(cenY/100).."..." )
		UseItemFailed ( role )
		return
	end
	local zbjl=(x-cenX)*(x-cenX)+(y-cenY)*(y-cenY)
	if zbjl<= 1250000 then
		zhzbx=zhzbx+cenX
		zhzby=zhzby+cenY
	 local MonsterID =1041-----------------------------圣诞树小
	 local Refresh = 10800					--重生时间，秒单位
	 local life = 180000					--生命时间，毫秒单位
	 local new = CreateChaX( MonsterID , zhzbx , zhzby , 145 , Refresh, role )
	 SetChaHost(new,role)
	 SetChaLifeTime( new, life )
	 SetChaTarget(new, role)
	 PlayEffect( new, 361 )
	 GiveItem ( role , 0 , 7722  , 1 , 4 )
	else
		SystemNotice ( role , "Your Xmas Tree should be planted around Atlantis Snowfield coordinates X:"..(cenX/100)..",Y:"..(cenY/100).."..." )
		UseItemFailed ( role )
		return
	end
end 

-------------------------------附能斩-------------------------------------------------------------
  function Sk_Script_FNZ( role , Item ) 	
	local sk_add = SK_FNZ  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 

----------------------------化雾技能卡------------------------------------------------
function Sk_Script_HW( role , Item ) 	
	local sk_add = SK_HW  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 

----------------------------能量盾技能卡------------------------------------------------
function Sk_Script_NLD( role , Item ) 	
	local sk_add = SK_NLD  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 
----------------------------能量束缚网技能卡------------------------------------------------
function Sk_Script_NLSFW( role , Item ) 	
	local sk_add = SK_NLSFW  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 

----------------------------魔力冲击技能卡------------------------------------------------
function Sk_Script_MLCJ( role , Item ) 	
	local sk_add = SK_MLCJ  
	local form_sklv = GetSkillLv( role , sk_add ) 
	  
--	if form_sklv < 0 or form_sklv == nil then								--技能等级合法性检查
--		return 
--	end 
	if form_sklv ~= 0  then 
		UseItemFailed ( role )  
		return 
	end 
	a = AddChaSkill ( role , sk_add, 1 , 1 , 1 ) 
	if a== 0 then 
		UseItemFailed ( role )  
		return 
	end 
end 

---------------------星空回廊传送机票--------Cindy---------
function  Jz_Script_xingkong(role, Item )

	local i = CheckBagItem(role,7543)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		SystemNotice (role, "Teleportation is a tedious process. Please")
		UseItemFailed ( role )
		return
	end

------MoveCity增加监狱岛判断
	local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		SystemNotice ( role , "You can't teleport on this current map." )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,7543,1)
			if j == 1 then
				 MoveTo( role,  103, 477,  "starwalkway" )
				return
			end
		end
	else
		UseItemFailed ( role )
	end
end

------性感小兔装宝箱---- Cindy -------------
function ItemUse_tuziBox( role , Item )
    local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		SystemNotice( role , "Cannot use while sailing" )     --判断是否为出海状态
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 4 then
		SystemNotice(role ,"You need 4 inventory space to open")
		UseItemFailed ( role )
		return
	 end
		GiveItem ( role , 0 , 7468  , 1 , 4 )
		GiveItem ( role , 0 , 7469  , 1 , 4 )
	    GiveItem ( role , 0 , 7470  , 1 , 4 )
		GiveItem ( role , 0 , 7471  , 1 , 4 )
end

-------- 2011春节活动 年兔召唤券------------ Cindy --------------
function ItemUse_NT (role, Item)
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		SystemNotice( role , "Cannot use while sailing" )
		UseItemFailed ( role )
		return
	end
    local reg = 0
	      reg =IsChaInRegion( role, 2 )
	if reg == 1 then
	      SystemNotice( role , "Unable to call in safe zone" )
	      UseItemFailed ( role )
	return
	end
	local x, y = GetChaPos(role)
	x_resume = 5
	y_resume = 5
	x = x + x_resume
	y = y + y_resume
	local MonsterID =1337                    -----------------------------召唤皮皮
	local Refresh = 7200					--重生时间，秒单位
	local life = 7200000					--生命时间，毫秒单位
	local new = CreateChaX( MonsterID , x , y , 145 , Refresh, role )
	SetChaLifeTime( new, life )
end

-----小苏苏----------
function ItemUse_XZXZ ( role , Item )
	local Cha_Boat = 0
	local ItemId = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		SystemNotice( role , "出海时不可使用" )
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )	
	if Item_CanGet <= 0 then
		SystemNotice( role , "身上没有足够的空间，使用星座勋章失败")
		UseItemFailed ( role )
		return
	end
	local getrandom = math.random ( 1 , 450 )
	if getrandom == 1 then							
		local ItemId = 8445
		local itemname = GetItemName ( ItemId ) 
		local cha_name = GetChaDefaultName ( role ) 
		local message = cha_name.."开启星座勋章惊喜地获得"..itemname  
 		Notice ( message )        
		GiveItem ( role , 0 , 8445 , 1 , 4 ) 
		return
	elseif getrandom == 2 then							
		local ItemId = 8449
		local itemname = GetItemName ( ItemId ) 
		local cha_name = GetChaDefaultName ( role ) 
		local message = cha_name.."开启星座勋章惊喜地获得"..itemname  
 		Notice ( message )        
		GiveItem ( role , 0 , 8449 , 1 , 4 ) 
		return
	elseif getrandom == 3 then							
		local ItemId = 8453
		local itemname = GetItemName ( ItemId ) 
		local cha_name = GetChaDefaultName ( role ) 
		local message = cha_name.."开启星座勋章惊喜地获得"..itemname  
 		Notice ( message )        
		GiveItem ( role , 0 ,8453 , 1 , 4 ) 
		return 
	elseif getrandom == 4 then							
		local ItemId = 8457
		local itemname = GetItemName ( ItemId ) 
		local cha_name = GetChaDefaultName ( role ) 
		local message = cha_name.."开启星座勋章惊喜地获得"..itemname  
 		Notice ( message )        
		GiveItem ( role , 0 , 8457 , 1 , 4 ) 
		return
	elseif getrandom == 5 then							
		local ItemId = 8461
		local itemname = GetItemName ( ItemId ) 
		local cha_name = GetChaDefaultName ( role ) 
		local message = cha_name.."开启星座勋章惊喜地获得"..itemname  
 		Notice ( message )        
		GiveItem ( role , 0 , 8461 , 1 , 4 ) 
		return
	elseif getrandom == 6 then							
		local ItemId = 8465
		local itemname = GetItemName ( ItemId ) 
		local cha_name = GetChaDefaultName ( role ) 
		local message = cha_name.."开启星座勋章惊喜地获得"..itemname  
 		Notice ( message )        
		GiveItem ( role , 0 , 8465 , 1 , 4 ) 
		return
	elseif getrandom == 7 then							
		local ItemId = 8469
		local itemname = GetItemName ( ItemId ) 
		local cha_name = GetChaDefaultName ( role ) 
		local message = cha_name.."开启星座勋章惊喜地获得"..itemname  
 		Notice ( message )        
		GiveItem ( role , 0 , 8469 , 1 , 4 ) 
		return
	elseif getrandom == 8 then							
		local ItemId = 8473
		local itemname = GetItemName ( ItemId ) 
		local cha_name = GetChaDefaultName ( role ) 
		local message = cha_name.."开启星座勋章惊喜地获得"..itemname  
 		Notice ( message )        
		GiveItem ( role , 0 , 8473 , 1 , 4 ) 
		return 
	elseif getrandom >=9 and getrandom <=95 then
		SystemNotice ( role , "恭喜，您获得100000金币")
		AddMoney ( role , 0 , 100000 )
		return
	-- elseif getrandom > 95 and getrandom <=150 then
		-- RemoveChaItem( role , 8441 , 1 , 2 , -1 , 2 , 1 )
		-- SystemNotice ( role , "一阵大风吹来，你飘啊飘啊飘回了白银城。" )
		-- MoveTo( role,2200,2888,"garner") 				
		-- return
	-- elseif getrandom > 150 and getrandom <=205 then
		-- RemoveChaItem( role , 8441 , 1 , 2 , -1 , 2 , 1 )
		-- SystemNotice ( role , "一阵大风吹来，你飘啊飘啊飘回了沙岚城。" )
		-- MoveTo( role,879,3574,"magicsea" )					
		-- return
	-- elseif getrandom > 205 and getrandom <=260 then
		-- RemoveChaItem( role , 8441 , 1 , 2 , -1 , 2 , 1 )
		-- SystemNotice ( role , "一阵大风吹来，你飘啊飘啊飘回了冰狼堡。" )
		-- MoveTo( role,1318,504,"darkblue" )					
		-- return	
	elseif getrandom > 260 and getrandom <= 300 then
		SystemNotice ( role , "恭喜，您获得5朵玫瑰。")
		GiveItem ( role , 0 , 3343 , 5 , 4 )  --玫瑰
		return
	elseif getrandom > 300 and getrandom <= 310 then
		SystemNotice ( role ,"死神从你旁边经过，轻轻的抚摸了你一下。")
		AddState(role , role , STATE_CUSI , 1 , 1 )
		return
	elseif getrandom > 310 and getrandom <= 330 then
		SystemNotice ( role ,"一只哥斯拉从你身上踩过。")
		local statelv = 1
		local statetime = 15
		AddState ( role , role , STATE_XIANRENJIAO , statelv , statetime )
		AddState ( role , role , STATE_XY , statelv , statetime )
		return
	elseif getrandom > 330 and getrandom <= 350 then
		SystemNotice ( role ,"一道闪电从天而降。")
		AddState(role , role , STATE_LEIPI , 1 , 1 )
		return
	elseif getrandom > 350 and getrandom <=420 then
		local cha_name = GetChaDefaultName ( role ) 
		local message = cha_name.."开启星座勋章时遭到了天神的鄙视。" 
 		Notice ( message )  
		AddState(role , role , STATE_JLTX6 , 1 , 300 )
		return
	else
		SystemNotice ( role ,"很遗憾,啥都没获得，生活就是这样，有希望也有失望。")
		return
	end
end 

function ItemUse_SZZKZBX ( role , Item )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 4 then
		SystemNotice(role ,"使用酷装宝箱最少需要4个空位")
		UseItemFailed ( role )
		return
	end
	local cha_type = GetChaTypeID ( role ) 

	if cha_type == 1 then 
	      
	       GiveItem ( role , 0 , 8652  , 1 , 4 )
	       GiveItem ( role , 0 , 8653  , 1 , 4 )
	       GiveItem ( role , 0 , 8654  , 1 , 4 )
	       GiveItem ( role , 0 , 8655  , 1 , 4 )
	elseif cha_type == 2 then 

	       GiveItem ( role , 0 , 8656  , 1 , 4 )
	       GiveItem ( role , 0 , 8657  , 1 , 4 )
	       GiveItem ( role , 0 , 8658  , 1 , 4 )
	       GiveItem ( role , 0 , 8659  , 1 , 4 )
	elseif cha_type == 3  then 
	     
	       GiveItem ( role , 0 , 8660  , 1 , 4 )
	       GiveItem ( role , 0 , 8661  , 1 , 4 )
	       GiveItem ( role , 0 , 8662  , 1 , 4 )
	       GiveItem ( role , 0 , 8663  , 1 , 4 )
	elseif cha_type == 4  then 

	       GiveItem ( role , 0 , 8664  , 1 , 4 )
	       GiveItem ( role , 0 , 8665  , 1 , 4 )
	       GiveItem ( role , 0 , 8496  , 1 , 4 )
	       GiveItem ( role , 0 , 8497  , 1 , 4 )
	end

end

function ItemUse_CNZKZBX ( role , Item )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 4 then
		SystemNotice(role ,"使用酷装宝箱最少需要4个空位")
		UseItemFailed ( role )
		return
	end
	local cha_type = GetChaTypeID ( role ) 

	if cha_type == 1 then 

	       GiveItem ( role , 0 , 8536  , 1 , 4 )
	       GiveItem ( role , 0 , 8537  , 1 , 4 )
	       GiveItem ( role , 0 , 8538  , 1 , 4 )
	       GiveItem ( role , 0 , 8539  , 1 , 4 )
	elseif cha_type == 2 then 

	       GiveItem ( role , 0 , 8540  , 1 , 4 )
	       GiveItem ( role , 0 , 8541  , 1 , 4 )
	       GiveItem ( role , 0 , 8542  , 1 , 4 )
	       GiveItem ( role , 0 , 8543  , 1 , 4 )
	elseif cha_type == 3  then 
	     
	       GiveItem ( role , 0 , 8544  , 1 , 4 )
	       GiveItem ( role , 0 , 8545  , 1 , 4 )
	       GiveItem ( role , 0 , 8546  , 1 , 4 )
	       GiveItem ( role , 0 , 8547  , 1 , 4 )
	elseif cha_type == 4  then 

	       GiveItem ( role , 0 , 8548  , 1 , 4 )
	       GiveItem ( role , 0 , 8549  , 1 , 4 )
	       GiveItem ( role , 0 , 8550  , 1 , 4 )
	       GiveItem ( role , 0 , 8551  , 1 , 4 )
	end

end



function ItemUse_TPZKZBX ( role , Item )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 4 then
		SystemNotice(role ,"使用酷装宝箱最少需要4个空位")
		UseItemFailed ( role )
		return
	end
	local cha_type = GetChaTypeID ( role ) 

	if cha_type == 1 then 
	      
	       GiveItem ( role , 0 , 8552  , 1 , 4 )
	       GiveItem ( role , 0 , 8553  , 1 , 4 )
	       GiveItem ( role , 0 , 8554  , 1 , 4 )
	       GiveItem ( role , 0 , 8555  , 1 , 4 )
	elseif cha_type == 2 then 

	       GiveItem ( role , 0 , 8556  , 1 , 4 )
	       GiveItem ( role , 0 , 8557  , 1 , 4 )
	       GiveItem ( role , 0 , 8558  , 1 , 4 )
	       GiveItem ( role , 0 , 8559  , 1 , 4 )
	elseif cha_type == 3  then 
	     
	       GiveItem ( role , 0 , 8560  , 1 , 4 )
	       GiveItem ( role , 0 , 8561  , 1 , 4 )
	       GiveItem ( role , 0 , 8562  , 1 , 4 )
	       GiveItem ( role , 0 , 8563  , 1 , 4 )
	elseif cha_type == 4  then 

	       GiveItem ( role , 0 , 8564  , 1 , 4 )
	       GiveItem ( role , 0 , 8565  , 1 , 4 )
	       GiveItem ( role , 0 , 8566  , 1 , 4 )
	       GiveItem ( role , 0 , 8567  , 1 , 4 )
	end

end



function ItemUse_TXZKZBX ( role , Item )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 4 then
		SystemNotice(role ,"使用酷装宝箱最少需要4个空位")
		UseItemFailed ( role )
		return
	end
	local cha_type = GetChaTypeID ( role ) 

	if cha_type == 1 then 
	      
	       GiveItem ( role , 0 , 8568  , 1 , 4 )
	       GiveItem ( role , 0 , 8569  , 1 , 4 )
	       GiveItem ( role , 0 , 8570  , 1 , 4 )
	       GiveItem ( role , 0 , 8571  , 1 , 4 )
	elseif cha_type == 2 then 

	       GiveItem ( role , 0 , 8572  , 1 , 4 )
	       GiveItem ( role , 0 , 8573  , 1 , 4 )
	       GiveItem ( role , 0 , 8574  , 1 , 4 )
	       GiveItem ( role , 0 , 8575  , 1 , 4 )
	elseif cha_type == 3  then 
	     
	       GiveItem ( role , 0 , 8576  , 1 , 4 )
	       GiveItem ( role , 0 , 8577  , 1 , 4 )
	       GiveItem ( role , 0 , 8578  , 1 , 4 )
	       GiveItem ( role , 0 , 8579  , 1 , 4 )
	elseif cha_type == 4  then 

	       GiveItem ( role , 0 , 8580  , 1 , 4 )
	       GiveItem ( role , 0 , 8581  , 1 , 4 )
	       GiveItem ( role , 0 , 8582  , 1 , 4 )
	       GiveItem ( role , 0 , 8583  , 1 , 4 )
	end

end


function ItemUse_SSZKZBX ( role , Item )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 4 then
		SystemNotice(role ,"使用酷装宝箱最少需要4个空位")
		UseItemFailed ( role )
		return
	end
	local cha_type = GetChaTypeID ( role ) 

	if cha_type == 1 then 
	      
	       GiveItem ( role , 0 , 8584  , 1 , 4 )
	       GiveItem ( role , 0 , 8585  , 1 , 4 )
	       GiveItem ( role , 0 , 8586  , 1 , 4 )
	       GiveItem ( role , 0 , 8587  , 1 , 4 )
	elseif cha_type == 2 then 

	       GiveItem ( role , 0 , 8588  , 1 , 4 )
	       GiveItem ( role , 0 , 8589  , 1 , 4 )
	       GiveItem ( role , 0 , 8590  , 1 , 4 )
	       GiveItem ( role , 0 , 8591  , 1 , 4 )
	elseif cha_type == 3  then 
	     
	       GiveItem ( role , 0 , 8592  , 1 , 4 )
	       GiveItem ( role , 0 , 8593  , 1 , 4 )
	       GiveItem ( role , 0 , 8594  , 1 , 4 )
	       GiveItem ( role , 0 , 8595  , 1 , 4 )
	elseif cha_type == 4  then 

	       GiveItem ( role , 0 , 8596  , 1 , 4 )
	       GiveItem ( role , 0 , 8597  , 1 , 4 )
	       GiveItem ( role , 0 , 8598  , 1 , 4 )
	       GiveItem ( role , 0 , 8599  , 1 , 4 )
	end

end



function ItemUse_MJZKZBX ( role , Item )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 4 then
		SystemNotice(role ,"使用酷装宝箱最少需要4个空位")
		UseItemFailed ( role )
		return
	end
	local cha_type = GetChaTypeID ( role ) 

	if cha_type == 1 then 
	      
	       GiveItem ( role , 0 , 8600  , 1 , 4 )
	       GiveItem ( role , 0 , 8601  , 1 , 4 )
	       GiveItem ( role , 0 , 8602  , 1 , 4 )
	       GiveItem ( role , 0 , 8603  , 1 , 4 )
	elseif cha_type == 2 then 

	       GiveItem ( role , 0 , 8604  , 1 , 4 )
	       GiveItem ( role , 0 , 8605  , 1 , 4 )
	       GiveItem ( role , 0 , 8606  , 1 , 4 )
	       GiveItem ( role , 0 , 8607  , 1 , 4 )
	elseif cha_type == 3  then 
	     
	       GiveItem ( role , 0 , 8608  , 1 , 4 )
	       GiveItem ( role , 0 , 8609  , 1 , 4 )
	       GiveItem ( role , 0 , 8610  , 1 , 4 )
	       GiveItem ( role , 0 , 8611  , 1 , 4 )
	elseif cha_type == 4  then 

	       GiveItem ( role , 0 , 8612  , 1 , 4 )
	       GiveItem ( role , 0 , 8613  , 1 , 4 )
	       GiveItem ( role , 0 , 8614  , 1 , 4 )
	       GiveItem ( role , 0 , 8615  , 1 , 4 )
	end

end


function ItemUse_SPZKZBX ( role , Item )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 4 then
		SystemNotice(role ,"使用酷装宝箱最少需要4个空位")
		UseItemFailed ( role )
		return
	end
	local cha_type = GetChaTypeID ( role ) 

	if cha_type == 1 then 
	      
	       GiveItem ( role , 0 , 8616  , 1 , 4 )
	       GiveItem ( role , 0 , 8617  , 1 , 4 )
	       GiveItem ( role , 0 , 8618  , 1 , 4 )
	       GiveItem ( role , 0 , 8619  , 1 , 4 )
	elseif cha_type == 2 then 

	       GiveItem ( role , 0 , 8620  , 1 , 4 )
	       GiveItem ( role , 0 , 8621  , 1 , 4 )
	       GiveItem ( role , 0 , 8622  , 1 , 4 )
	       GiveItem ( role , 0 , 8623  , 1 , 4 )
	elseif cha_type == 3  then 
	     
	       GiveItem ( role , 0 , 8624  , 1 , 4 )
	       GiveItem ( role , 0 , 8625  , 1 , 4 )
	       GiveItem ( role , 0 , 8626  , 1 , 4 )
	       GiveItem ( role , 0 , 8627  , 1 , 4 )
	elseif cha_type == 4  then 

	       GiveItem ( role , 0 , 8628  , 1 , 4 )
	       GiveItem ( role , 0 , 8629  , 1 , 4 )
	       GiveItem ( role , 0 , 8630  , 1 , 4 )
	       GiveItem ( role , 0 , 8631  , 1 , 4 )
	end

end

function ItemUse_SYZKZBX ( role , Item )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 4 then
		SystemNotice(role ,"使用酷装宝箱最少需要4个空位")
		UseItemFailed ( role )
		return
	end
	local cha_type = GetChaTypeID ( role ) 

	if cha_type == 1 then 
	      
	       GiveItem ( role , 0 , 8632  , 1 , 4 )
	       GiveItem ( role , 0 , 8633  , 1 , 4 )
	       GiveItem ( role , 0 , 8634  , 1 , 4 )
	       GiveItem ( role , 0 , 8635  , 1 , 4 )
	elseif cha_type == 2 then 

	       GiveItem ( role , 0 , 8636  , 1 , 4 )
	       GiveItem ( role , 0 , 8637  , 1 , 4 )
	       GiveItem ( role , 0 , 8638  , 1 , 4 )
	       GiveItem ( role , 0 , 8639  , 1 , 4 )
	elseif cha_type == 3  then 
	     
	       GiveItem ( role , 0 , 8640  , 1 , 4 )
	       GiveItem ( role , 0 , 8641  , 1 , 4 )
	       GiveItem ( role , 0 , 8642  , 1 , 4 )
	       GiveItem ( role , 0 , 8643  , 1 , 4 )
	elseif cha_type == 4  then 

	       GiveItem ( role , 0 , 8644  , 1 , 4 )
	       GiveItem ( role , 0 , 8645  , 1 , 4 )
	       GiveItem ( role , 0 , 8646  , 1 , 4 )
	       GiveItem ( role , 0 , 8647  , 1 , 4 )
	end

end

----黑龙4层传送点传送卷轴----------小苏苏---------------------------------------
function Jz_Script_HLJP(role, Item )

	local i = CheckBagItem(role,8929)
	local k = ChaIsBoat(role)
	local hp = Hp(role)
	local mxhp = Mxhp(role)
	local sp = Sp(role)
	local mxsp = Mxsp(role)
	if sp < mxsp or hp < mxhp then 
		SystemNotice (role, "飞行是件很累的事情，请保持100％的hp和sp哦")
		UseItemFailed ( role )
		return
	end
	local FJP=GetChaItem(role,1,12)
	local FJPID=GetItemID(FJP)
	local FJP_1 = CheckBagItem ( role , 8001 )
	local FJP_2 = CheckBagItem ( role , 8002 )
	local FJP_3 = CheckBagItem ( role , 8003 )

	-- if		 FJP_1 >= 1 or FJPID == 8001 
		-- or	 FJP_2 >= 1 or FJPID == 8002
		-- or   FJP_3 >= 1 or FJPID == 8003 then
		-- SystemNotice ( role , "携带足球、手套或者哨子时不能使用机票，如果想要使用飞机票请扔掉相关道具" )
		-- UseItemFailed ( role )
		-- return
	-- end
------MoveCity增加监狱岛判断
local map_name = GetChaMapName ( role )	
if map_name == "prisonisland" then
		SystemNotice ( role , "当前地图不能传送" )
		UseItemFailed ( role )
		return
	end
	if k == 0 then
		if i > 0 then
			local j = DelBagItem(role,8929,1)
			if j == 1 then
				MoveCity(role,"L4MAP")
				return
			end
		end
	else
		UseItemFailed ( role )
	end
end

---------------------2011月饼-----------miku----------
function ItemUse_MiniMC ( role , Item )-----恢复上线HP与SP各2%
	local sp = GetChaAttr(role, ATTR_SP) 
	local mxsp = GetChaAttr(role,ATTR_MXSP)
  	local hp = GetChaAttr(role, ATTR_HP) 
	local mxhp = GetChaAttr(role,ATTR_MXHP) 	
	hp = hp + 0.02*mxhp
	sp = sp + 0.02*mxsp
	if sp > mxsp then 
		sp = mxsp 
	end 
	if hp > mxhp then 
		hp = mxhp 
	end 
	SetCharaAttr(hp, role, ATTR_HP)
	SetCharaAttr(sp, role, ATTR_SP)
end
function Item_1k_rep( role , Item )
	local el_fame = GetChaAttr(role, ATTR_FAME)
	
		if el_fame < 99990001 then
		
			local fame_resume = 1000
			el_fame = el_fame + fame_resume
			SetCharaAttr(el_fame, role, ATTR_FAME)
		else 
			SystemNotice( role , "Your Reputation is  too high. Can't use")
			UseItemFailed ( role )
		end
end

function Item_5k_rep( role , Item )
	local el_fame = GetChaAttr(role, ATTR_FAME)
	
		if el_fame < 99990001 then
		
			local fame_resume = 5000
			el_fame = el_fame + fame_resume
			SetCharaAttr(el_fame, role, ATTR_FAME)
		else 
			SystemNotice( role , "Your Reputation is  too high. Can't use")
			UseItemFailed ( role )
		end
end

function Item_10k_rep( role , Item )
	local el_fame = GetChaAttr(role, ATTR_FAME)
	
		if el_fame < 99990001 then
		
			local fame_resume = 10000
			el_fame = el_fame + fame_resume
			SetCharaAttr(el_fame, role, ATTR_FAME)
		else 
			SystemNotice( role , "Your Reputation is  too high. Can't use")
			UseItemFailed ( role )
		end
end
---------------------超级海盗月饼-----------cindy----------
function ItemUse_SuperMC ( role , Item )

	local mooncake_count= CheckBagItem ( role , 7655 ) --检查月饼品尝券数量
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	local NocLock =	KitbagLock( role, 0 )
	local ran = math.random ( 1 , 100 )
	local Cha_Boat = GetCtrlBoat ( role )
	local name =GetChaDefaultName(role)
	if Cha_Boat ~=  nil then
		SystemNotice( role , "出海时不可使用。" )
		UseItemFailed ( role )
		return
	end
	
	if NocLock == LUA_FALSE then
		SystemNotice( role , "您的背包处于锁定状态")
		return 
	end
	
	if Item_CanGet < 1 then
		SystemNotice(role ,"要打开超级海盗月饼需要背包里至少有1个空位")
		UseItemFailed ( role )
		return
	end	
	
	if mooncake_count > 0 then
		if ran <= 1 then
			TakeItem( role , 0 , 7655 , 1)
			GiveItem( role , 0 , 6363  , 1 , 4 )
			ScrollNotice ("玩家"..name.."使用月饼品尝券开启“超级海盗月饼”获得“黑龙宝石清洗剂”！不管你信不信，反正"..name.."是开出来了！",1)
			return
		elseif ran <= 21 then	
			TakeItem( role , 0 , 7655 , 1)
			GiveItem( role , 0 , 8525  , 1 , 4 )
			ScrollNotice ("玩家"..name.."使用月饼品尝券开启“超级海盗月饼”获得“中秋酷装宝箱”！不管你信不信，反正"..name.."是开出来了！",1)
			return
		elseif ran <= 51 then	
			TakeItem( role , 0 , 7655 , 1)
			GiveItem( role , 0 , 8929  , 1 , 4 )
			ScrollNotice ("玩家"..name.."使用月饼品尝券开启“超级海盗月饼”获得“黑龙4层传送点机票”！不管你信不信，反正"..name.."是开出来了！",1)
			return
		elseif ran <= 81 then	
			TakeItem( role , 0 , 7655 , 1)
			GiveItem( role , 0 , 1003  , 1 , 4 )
			ScrollNotice ("玩家"..name.."使用月饼品尝券开启“超级海盗月饼”获得“废弃图纸D”！不管你信不信，反正"..name.."是开出来了！",1)
			return
		else 	
			TakeItem( role , 0 , 7655 , 1)
			GiveItem( role , 0 , 5869  , 1 , 4 )
			ScrollNotice ("玩家"..name.."使用月饼品尝券开启“超级海盗月饼”获得“皮特的隐身药水”！不管你信不信，反正"..name.."是开出来了！",1)
			return
		end
	end
	GiveItem( role , 0 , 3909  , 1 , 4 )
	GiveItem( role , 0 , 3107  , 1 , 4 )
end

 ------------------------2010中秋酷装宝箱：双击，根据角色给予道具-------------------
function ItemUse_ZQKZBox( role , Item )
    local Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~=  nil then
		SystemNotice( role , "出海时不可使用" )     --判断是否为出海状态
		UseItemFailed ( role )
		return
	end
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 4 then
		SystemNotice(role ,"使用该宝箱最少需要4个空位")
		UseItemFailed ( role )
		return
	end
	local name=GetChaDefaultName ( role )
	local cha_type = GetChaTypeID ( role ) 
	if cha_type == 3  then 
		   ScrollNotice ("恭喜玩家"..name.." 开启2010中秋酷装宝箱，得到中秋酷装！",1)
		   GiveItem ( role , 0 , 8531  , 1 , 4 )
	       GiveItem ( role , 0 , 8504  , 1 , 4 )
	       GiveItem ( role , 0 , 8505  , 1 , 4 )
	       GiveItem ( role , 0 , 8506  , 1 , 4 )
	elseif cha_type == 4  then 
		   ScrollNotice ("恭喜玩家"..name.." 开启2010中秋酷装宝箱，得到中秋酷装！",1)
		   GiveItem ( role , 0 , 8532  , 1 , 4 )
	       GiveItem ( role , 0 , 8507  , 1 , 4 )
	       GiveItem ( role , 0 , 8508  , 1 , 4 )
	       GiveItem ( role , 0 , 8509  , 1 , 4 )
	elseif cha_type == 1 then 
		ScrollNotice("恭喜玩家"..name.." 开启2010中秋酷装宝箱，得到中秋酷装！",1)
	GiveItem ( role , 0 , 8529  , 1 , 4 )
	       GiveItem ( role , 0 , 8498  , 1 , 4 )
	       GiveItem ( role , 0 , 8499  , 1 , 4 )
	       GiveItem ( role , 0 , 8500  , 1 , 4 )

	elseif cha_type == 2 then 
		   ScrollNotice ("恭喜玩家"..name.." 开启2010中秋酷装宝箱，得到中秋酷装！",1)
		   GiveItem ( role , 0 , 8530  , 1 , 4 )
	       GiveItem ( role , 0 , 8501  , 1 , 4 )
	       GiveItem ( role , 0 , 8502  , 1 , 4 )
	       GiveItem ( role , 0 , 8503  , 1 , 4 )
	end
end

----------小苏苏----------------废弃图纸E
function ItemUse_FQTZE( role , Item ) 
							
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	 if Item_CanGet < 1 then
		SystemNotice(role ,"打开图纸最少需要1个空位")
		UseItemFailed ( role )
		return
	end  	
	local r1 = 0
	local r2 = 0
	local item_ID=GetItemID(Item)
	local Itemnew_ID=2300
	local rad_ID=math.random ( 1, 100 )
	if rad_ID<=30 then
		Itemnew_ID=2300  --------制造图纸30%
	elseif rad_ID>=31 and rad_ID<=85 then
		Itemnew_ID=2302  --------烹饪图纸55%
	else
		Itemnew_ID=2301  --------铸造图纸15%
	end
	r1, r2 = MakeItem ( role , Itemnew_ID  , 1 , 4 )   --r2是指图纸在背包中的位置从0开始计算
	local Itemnew = GetChaItem ( role , 2 , r2 )--	取得背包中第r2个格子中物品的指针（角色指针，背包[1是装备栏])，第r2格）


	local rad_energy=math.random ( 1, 100 )
	local energy = 1--------新手级图纸
	if item_ID==1000 then-------新手级模糊图纸
		energy=1
	elseif item_ID==1001 then -------初级模糊图纸
		if rad_energy<=10 then
			energy=4
		elseif  rad_energy<=40 and rad_energy>10 then
			energy=3
		else
			energy=2
		end
	elseif item_ID==1002 then -------中级模糊图纸
		if rad_energy<=10 then
			energy=6
		elseif  rad_energy<=40 and rad_energy>10 then
			energy=5
		else
			energy=4
		end
	elseif item_ID==1003 then -------高级模糊图纸
		if rad_energy<=5 then
			energy=8
		elseif  rad_energy<=35 and rad_energy>5 then
			energy=7
		else
			energy=6
		end
	elseif item_ID==8909 then -------高级模糊图纸
		if rad_energy>= 0 then
			energy=9
		end
	end	

	local final_ID=1849 --------默认蛋糕
	local final_LV=20 --------默认20
	local final_ID1=3116 --------默认精灵果
	local final_ID2=3116 --------默认精灵果
	local final_ID3=3116 --------默认精灵果
	local General = 0  --总数
	local ItemId =3124          --蘑菇汤
	-----===========================《《制造》》=========================
	if Itemnew_ID==2300 then 
	
	--不同等级（enregy）的图纸对应不同的物品
		local STAR_BEGIN=1    --ZHIZAO_Mxcount=280
		local STAR_END=232
		if energy==1 then
			STAR_BEGIN=1
			STAR_END=28
		elseif energy==2 then
			STAR_BEGIN=29
			STAR_END=56
		elseif energy==3 then
			STAR_BEGIN=57
			STAR_END=84
		elseif energy==4 then
			STAR_BEGIN=85
			STAR_END=112
		elseif energy==5 then
			STAR_BEGIN=113
			STAR_END=140
		elseif energy==6 then
			STAR_BEGIN=141
			STAR_END=168
		elseif energy==7 then
			STAR_BEGIN=169
			STAR_END=196
		elseif energy==8 then
			STAR_BEGIN=197
			STAR_END=224
		elseif energy==9 then
			STAR_BEGIN=225
			STAR_END=232
		end
	
	--不同等级图纸的最大	
		for i = STAR_BEGIN , STAR_END , 1 do
		    General = ZHIZAO__Rad[ i ] + General		
		end 
		local a = math.random ( 1, General )
		local b = 0
		local d = 0 
		local k = 0 
		local c = -1										--命中物品编号
		for k = STAR_BEGIN , STAR_END , 1 do				-- 随机出添加的前缀编号
			d = ZHIZAO__Rad[ k ] + b                        --概率分布
			if a <= d and a > b then
				c = k
				break 
			end 
			b = d                   --不在这段范围的概率中则以这段的结尾为起点检验下一段
		end 
		--异常处理
		if c == -1 then
			c =STAR_BEGIN
		end
		final_ID=ZHIZAO_ID[c]  --c就是该种类图纸该等级下该概率中的数组ID
		final_LV=ZHIZAO_LV[c]
		final_ID1=ZHIZAO_ID1[c]
		final_ID2=ZHIZAO_ID2[c]
		final_ID3=ZHIZAO_ID3[c]

	end
	--===========================《《铸造》》=========================
	if Itemnew_ID==2301 then -----铸造
		local STAR_BEGIN=1
		local STAR_END=913
		if energy==1 then
			STAR_BEGIN=1
			STAR_END=77
		elseif energy==2 then
			STAR_BEGIN=78
			STAR_END=166
		elseif energy==3 then
			STAR_BEGIN=167
			STAR_END=278
		elseif energy==4 then
			STAR_BEGIN=279
			STAR_END=434
		elseif energy==5 then
			STAR_BEGIN=435
			STAR_END=596
		elseif energy==6 then
			STAR_BEGIN=597
			STAR_END=732
		elseif energy==7 then
			STAR_BEGIN=733
			STAR_END=840
		elseif energy==8 then
			STAR_BEGIN=891
			STAR_END=905
		elseif energy==9 then
			STAR_BEGIN=906
			STAR_END=913
		end

		for i = STAR_BEGIN , STAR_END , 1 do 
		    General = ZHUZAO__Rad[ i ] + General		
		end 
		local a = math.random ( 1, General )
		local b = 0
		local d = 0 
		local k = 0 
		local c = -1									--命中物品编号
		for k = STAR_BEGIN , STAR_END , 1 do				-- 随机出添加的前缀编号
			d = ZHUZAO__Rad[ k ] + b
			if a <= d and a > b then
				c = k
				break 
				end 
			b = d 
		end 
		if c == -1 then
			c =STAR_BEGIN
		end
		final_ID=ZHUZAO_ID[c]
		final_LV=ZHUZAO_LV[c]
		final_ID1=ZHUZAO_ID1[c]
		final_ID2=ZHUZAO_ID2[c]
		final_ID3=ZHUZAO_ID3[c]		
	end
	
		--===========================《《烹饪》》=========================
	if Itemnew_ID==2302 then -----烹饪
		local STAR_BEGIN=1
		local STAR_END=80
		if energy==1 then
			STAR_BEGIN=1
			STAR_END=7
		elseif energy==2 then
			STAR_BEGIN=8
			STAR_END=12
		elseif energy==3 then
			STAR_BEGIN=13
			STAR_END=17
		elseif energy==4 then
			STAR_BEGIN=18
			STAR_END=26
		elseif energy==5 then
			STAR_BEGIN=27
			STAR_END=31
		elseif energy==6 then
			STAR_BEGIN=32
			STAR_END=35
		elseif energy==7 then
			STAR_BEGIN=36
			STAR_END=38
		elseif energy==8 then
			STAR_BEGIN=39
			STAR_END=40 
		elseif energy==9 then
			STAR_BEGIN=41
			STAR_END=48			
		end
		for i = STAR_BEGIN , STAR_END , 1 do 
		    General = PENGREN__Rad[ i ] + General		
		end 
		local a = math.random ( 1, General )
		local b = 0
		local d = 0 
		local k = 0 
		local c = -1									--命中物品编号
		for k = STAR_BEGIN , STAR_END , 1 do				-- 随机出添加的前缀编号
			d = PENGREN__Rad[ k ] + b
			if a <= d and a > b then
				c = k
				break 
			end 
			b = d 
		end 
		if c == -1 then
			c =STAR_BEGIN
		end
		final_ID=PENGREN_ID[c]
		final_LV=PENGREN_LV[c]
		final_ID1=PENGREN_ID1[c]
		final_ID2=PENGREN_ID2[c]
		final_ID3=PENGREN_ID3[c]		
	end

	local star_number=energy*2
	if energy<=3 then
		SetItemAttr(Itemnew, ITEMATTR_MAXURE, energy )--精灵硬币需求
		SetItemAttr(Itemnew, ITEMATTR_URE, energy )--图纸等级		
	else
		SetItemAttr(Itemnew, ITEMATTR_MAXURE, star_number )--精灵硬币需求
		SetItemAttr(Itemnew, ITEMATTR_URE, energy )--图纸等级
	end
	local sta = math.random ( 1, 8 )

	
	if Itemnew_ID==2301 and energy >3 and energy < 8 then-------------铸造图纸使用次数减半
		
		sta=sta*0.5
		sta=math.max(1,sta)

		
	elseif (energy>=8 and Itemnew_ID==2301) or  (energy==9 and Itemnew_ID==2302) or (energy==9 and Itemnew_ID==2300) then
		sta=1
	
	end
	
	SetItemAttr(Itemnew, ITEMATTR_VAL_STA, sta )--图纸使用次数
	local qulity=math.floor(final_LV*0.1)+100
	SetItemAttr(Itemnew, ITEMATTR_MAXENERGY, qulity )--质量

	local ure=10-final_LV*0.1-------------要显示成百分比
	
	SetItemAttr(Itemnew, ITEMATTR_ENERGY, ure )--基本成功率
	SetItemAttr(Itemnew, ITEMATTR_VAL_STR, final_ID1 )--需求道具1ID
	SetItemAttr(Itemnew, ITEMATTR_VAL_CON, final_ID2 )--需求道具2ID
	SetItemAttr(Itemnew, ITEMATTR_VAL_DEX, final_ID3 )--需求道具3ID
	SetItemAttr(Itemnew, ITEMATTR_VAL_AGI, final_ID )--生成物品ID

	local Num_new = GetItemForgeParam ( Itemnew , 1 )
	local Part2_new = GetNum_Part2 ( Num_new )	
	local Part4_new = GetNum_Part4 ( Num_new )
	local Part6_new = GetNum_Part6 ( Num_new )
	Part2_new = math.random ( 10, 15 )					--需求道具1数量 
	Part4_new = math.random ( 6, 10 )					--需求道具2数量
	Part6_new = math.random ( 3, 5 )					--需求道具3数量
	Num_new = SetNum_Part2 ( Num_new , Part2_new )
	Num_new = SetNum_Part4 ( Num_new , Part4_new )
	Num_new = SetNum_Part6 ( Num_new , Part6_new )
	SetItemForgeParam ( Itemnew , 1 , Num_new )
end 

--魔龙蛋糕------- cindy -----------
function ItemUse_MLcake ( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ==  nil then
		local attr_ap = Attr_ap( role )
		local ap_extre = 5
		attr_ap = attr_ap + ap_extre 
		SetCharaAttr( attr_ap, role, ATTR_AP )
		SystemNotice( role , "Congratulations, you have gain 5 stat points." ) 
	else
		SystemNotice( role , "出海时不可使用" )
		UseItemFailed ( role )
		return
	end
end
function Eclipse_PetStamina(role, Item, Item_Target)
	if (IsChaStall(role) == LUA_TRUE) then
		SystemNotice(role, "Cannot use while your stall is opened!" )
		UseItemFailed(role)
		return
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat(role)
	if Cha_Boat ~= nil then 
		SystemNotice(role, "Cannot use while sailing!") 
		UseItemFailed(role) 
		return 
	end
	local PetStamina = {}
	PetStamina[0227] = {Num = 2500}		--Fairy Ration
	PetStamina[2312] = {Num = 2500}		--Auto Ration
	PetStamina[5644] = {Num = 5000}		--Great Fairy Ration
	PetStamina[5645] = {Num = 5000}		--Great Auto Ration
	PetStamina[3152] = {Num = 12500}	--Pet Food
	local ItemID		= GetItemID(Item)
	local Target_URE	= GetItemAttr(Item_Target,ITEMATTR_URE)
	local Target_MAXURE	= GetItemAttr(Item_Target,ITEMATTR_MAXURE)
	local Item_Type		= GetItemType(Item)
	local Target_Type	= GetItemType(Item_Target)
	if PetStamina[ItemID] ~= nil then
		if Item_Type == 57 and Target_Type == 59 then
			if Target_URE < Target_MAXURE then
				Give_ElfURE(role, Item_Target, PetStamina[ItemID].Num)
			else
				SystemNotice(role, "Fairy is full") 
				UseItemFailed(role)
				return
			end
		end
	else
		SystemNotice(role, "Internal error!")
		UseItemFailed(role)
		return
	end
end
function Eclipse_PetSkillBooks(role, Item, Item_Target)
	if (IsChaStall(role) == LUA_TRUE) then
		SystemNotice(role, "Cannot use while your stall is opened!" )
		UseItemFailed(role)
		return
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat(role)
	if Cha_Boat ~= nil then 
		SystemNotice(role, "Cannot use while sailing!") 
		UseItemFailed(role) 
		return 
	end
	local PetSkillBooks = {}
	PetSkillBooks[243] = {SkillID = 1, SkillLv = 1, SkillLv_Need = 0}	--Novice Protection
	PetSkillBooks[244] = {SkillID = 1, SkillLv = 2, SkillLv_Need = 1}	--Standard Protection
	PetSkillBooks[245] = {SkillID = 1, SkillLv = 3, SkillLv_Need = 2}	--Expert Protection
	PetSkillBooks[246] = {SkillID = 2, SkillLv = 1, SkillLv_Need = 0}	--Novice Berserk
	PetSkillBooks[247] = {SkillID = 2, SkillLv = 2, SkillLv_Need = 1}	--Standard Berserk
	PetSkillBooks[248] = {SkillID = 2, SkillLv = 3, SkillLv_Need = 2}	--Expert Berserk
	PetSkillBooks[249] = {SkillID = 3, SkillLv = 1, SkillLv_Need = 0}	--Novice Magic
	PetSkillBooks[250] = {SkillID = 3, SkillLv = 2, SkillLv_Need = 1}	--Standard Magic
	PetSkillBooks[251] = {SkillID = 3, SkillLv = 3, SkillLv_Need = 2}	--Expert Magic
	PetSkillBooks[252] = {SkillID = 4, SkillLv = 1, SkillLv_Need = 0}	--Novice Recover
	PetSkillBooks[253] = {SkillID = 4, SkillLv = 2, SkillLv_Need = 1}	--Standard Recover
	PetSkillBooks[254] = {SkillID = 4, SkillLv = 3, SkillLv_Need = 2}	--Expert Recover
	PetSkillBooks[259] = {SkillID = 5, SkillLv = 1, SkillLv_Need = 0}	--Novice Meditation
	PetSkillBooks[260] = {SkillID = 5, SkillLv = 2, SkillLv_Need = 1}	--Standard Meditation
	PetSkillBooks[261] = {SkillID = 5, SkillLv = 3, SkillLv_Need = 2}	--Expert Meditation
	PetSkillBooks[1055] = {SkillID = 13, SkillLv = 1, SkillLv_Need = 0}	--Novice Pet Manufacturing	
	PetSkillBooks[1056] = {SkillID = 13, SkillLv = 2, SkillLv_Need = 1}	--Standard Pet Manufacturing	
	PetSkillBooks[1057] = {SkillID = 13, SkillLv = 3, SkillLv_Need = 2}	--Expert Pet Manufacturing	
	PetSkillBooks[1058] = {SkillID = 14, SkillLv = 1, SkillLv_Need = 0}	--Novice Pet Crafting
	PetSkillBooks[1059] = {SkillID = 14, SkillLv = 2, SkillLv_Need = 1}	--Standard Pet Crafting
	PetSkillBooks[1060] = {SkillID = 14, SkillLv = 3, SkillLv_Need = 2}	--Expert Pet Crafting
	PetSkillBooks[1061] = {SkillID = 15, SkillLv = 1, SkillLv_Need = 0}	--Novice Pet Analyze
	PetSkillBooks[1062] = {SkillID = 15, SkillLv = 2, SkillLv_Need = 1}	--Standard Pet Analyze
	PetSkillBooks[1063] = {SkillID = 15, SkillLv = 3, SkillLv_Need = 2}	--Expert Pet Analyze
	PetSkillBooks[1064] = {SkillID = 16, SkillLv = 1, SkillLv_Need = 0}	--Novice Pet Cooking
	PetSkillBooks[1065] = {SkillID = 16, SkillLv = 2, SkillLv_Need = 1}	--Standard Pet Cooking
	PetSkillBooks[1066] = {SkillID = 16, SkillLv = 3, SkillLv_Need = 2}	--Expert Pet Cooking
	local ItemID			= GetItemID(Item)
	local Item_Type			= GetItemType(Item)
	local Item_Target_Type	= GetItemType(Item_Target)
	local ForgeParam 		= GetItemForgeParam(Item_Target, 1)
	if Item_Type == 58 and Item_Target_Type == 59 then
		local FairySlot = GetChaItem(role, 2, 1)
		if FairySlot ~= Item_Target then
			SystemNotice(role, "Please put your fairy into 2nd slot of your inventory!")
			UseItemFailed(role)
			return
		end
		if PetSkillBooks[ItemID] ~= nil then
			local ElfSkillLv = GetElfSkillLv(ForgeParam,PetSkillBooks[ItemID].SkillID)
			if ElfSkillLv == PetSkillBooks[ItemID].SkillLv then
				SystemNotice(role, "Fairy already learned this skill and reached the same level!")
				UseItemFailed(role)
				return
			end
			if ElfSkillLv < PetSkillBooks[ItemID].SkillLv_Need and ElfSkillLv ~= 0 then
				SystemNotice(role, "Prerequisite fairy's skill lv didn't completed!")
				UseItemFailed(role)
				return
			end
			if ElfSkillLv == 0 and PetSkillBooks[ItemID].SkillLv > 1 then
				SystemNotice(role, "Prerequisite fairy's skill lv didn't completed!")
				UseItemFailed(role)
				return			
			end
			local Count = 0
			local RegSkill = {1,2,3,4,5,13,14,15,16}
			for k = 1,table.getn(RegSkill) do
				if GetElfSkillLv(ForgeParam,RegSkill[k]) > 0 then
					Count = Count + 1
				end
			end
			if Count >= 3 then
				SystemNotice(role, "Fairy can only learn 3 skills max!")
				UseItemFailed(role)
				return			
			end
			AddElfSkill(Item_Target, PetSkillBooks[ItemID].SkillLv, PetSkillBooks[ItemID].SkillID)
		else
			SystemNotice(role, "Internal error!")
			UseItemFailed(role)
			return
		end
	else
		SystemNotice(role, "Item type doesn't matched!")
		UseItemFailed(role)
		return	
	end
end
function Eclipse_FairyFood(role, Item, Item_Target)
	if (IsChaStall(role) == LUA_TRUE) then
		SystemNotice(role, "Cannot use while your stall is opened!" )
		UseItemFailed(role)
		return
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat(role)
	if Cha_Boat ~= nil then 
		SystemNotice(role, "Cannot use while sailing!") 
		UseItemFailed(role) 
		return 
	end
	local FairyFood = {}
	FairyFood[0222] =	{AttrType = ITEMATTR_VAL_STR, AttrAdd = 1, MinLv = 0, MaxLv = 42, Energy = 1}	--Snow Dragon Fruit
	FairyFood[0223] =	{AttrType = ITEMATTR_VAL_AGI, AttrAdd = 1, MinLv = 0, MaxLv = 42, Energy = 1}	--Icespire Plum
	FairyFood[0224] =	{AttrType = ITEMATTR_VAL_DEX, AttrAdd = 1, MinLv = 0, MaxLv = 42, Energy = 1}	--Zephyr Fish Floss
	FairyFood[0225] =	{AttrType = ITEMATTR_VAL_CON, AttrAdd = 1, MinLv = 0, MaxLv = 42, Energy = 1}	--Argent Mango
	FairyFood[0226] =	{AttrType = ITEMATTR_VAL_STA, AttrAdd = 1, MinLv = 0, MaxLv = 42, Energy = 1}	--Shaitan Biscuit
	FairyFood[0276] =	{AttrType = ITEMATTR_VAL_STR, AttrAdd = 2, MinLv = 0, MaxLv = 42, Energy = 1}	--Great Snow Dragon Fruit
	FairyFood[0277] =	{AttrType = ITEMATTR_VAL_AGI, AttrAdd = 2, MinLv = 0, MaxLv = 42, Energy = 1}	--Great Icespire Plum
	FairyFood[0278] =	{AttrType = ITEMATTR_VAL_DEX, AttrAdd = 2, MinLv = 0, MaxLv = 42, Energy = 1}	--Great Zephyr Fish Floss
	FairyFood[0279] =	{AttrType = ITEMATTR_VAL_CON, AttrAdd = 2, MinLv = 0, MaxLv = 42, Energy = 1}	--Great Argent Mango
	FairyFood[0280] =	{AttrType = ITEMATTR_VAL_STA, AttrAdd = 2, MinLv = 0, MaxLv = 42, Energy = 1}	--Great Shaitan Biscuit
	FairyFood[6842] =	{AttrType = ITEMATTR_VAL_STR, AttrAdd = 1, MinLv = 0, MaxLv = 42, Energy = 0.5}	--Super Snow Dragon Fruit
	FairyFood[6843] =	{AttrType = ITEMATTR_VAL_AGI, AttrAdd = 1, MinLv = 0, MaxLv = 42, Energy = 0.5}	--Super Icespire Plum
	FairyFood[6844] =	{AttrType = ITEMATTR_VAL_DEX, AttrAdd = 1, MinLv = 0, MaxLv = 42, Energy = 0.5}	--Super Argent Mango
	FairyFood[6845] =	{AttrType = ITEMATTR_VAL_CON, AttrAdd = 1, MinLv = 0, MaxLv = 42, Energy = 0.5}	--Super Zephyr Fish Floss
	FairyFood[6846] =	{AttrType = ITEMATTR_VAL_STA, AttrAdd = 1, MinLv = 0, MaxLv = 42, Energy = 0.5}	--Super Shaitan Biscuit
	FairyFood[7003] =	{AttrType = ITEMATTR_VAL_STR, AttrAdd = 1, MinLv = 42, MaxLv = 60, Energy = 1}	--Improved Strength Fruit
	FairyFood[7004] =	{AttrType = ITEMATTR_VAL_AGI, AttrAdd = 1, MinLv = 42, MaxLv = 60, Energy = 1}	--Improved Agility Fruit
	FairyFood[7005] =	{AttrType = ITEMATTR_VAL_DEX, AttrAdd = 1, MinLv = 42, MaxLv = 60, Energy = 1}	--Improved Accuracy Fruit
	FairyFood[7006] =	{AttrType = ITEMATTR_VAL_CON, AttrAdd = 1, MinLv = 42, MaxLv = 60, Energy = 1}	--Improved Constitution Fruit
	FairyFood[7007] =	{AttrType = ITEMATTR_VAL_STA, AttrAdd = 1, MinLv = 42, MaxLv = 60, Energy = 1}	--Improved Spirit Fruit
	local ItemID = GetItemID(Item)
	if FairyFood[ItemID] ~= nil then
		local Item_type			= GetItemType(Item)
		local Item_Target_Type	= GetItemType(Item_Target)
		local str 				= GetItemAttr(Item_Target, ITEMATTR_VAL_STR)
		local con 				= GetItemAttr(Item_Target, ITEMATTR_VAL_CON)
		local agi 				= GetItemAttr(Item_Target, ITEMATTR_VAL_AGI)
		local dex 				= GetItemAttr(Item_Target, ITEMATTR_VAL_DEX)
		local sta 				= GetItemAttr(Item_Target, ITEMATTR_VAL_STA)
		local FairyLv 			= str + agi + dex + con + sta
		local Attr_Type_Num 	= GetItemAttr(Item_Target, FairyFood[ItemID].AttrType)
		if Item_type == 58 and Item_Target_Type == 59 then
			local FairySlot = GetChaItem(role, 2, 1)
			if Item_Target ~= FairySlot then
				SystemNotice(role, "Please put your fairy into 2nd slot of your inventory!")
				UseItemFailed(role)
				return
			end
			if FairyLv < FairyFood[ItemID].MinLv then
				SystemNotice(role, "Minimum level of fairy is Lv"..FairyFood[ItemID].MinLv.." to feed with this kind of fruits!")
				UseItemFailed(role)
				return
			end
			if FairyLv >= FairyFood[ItemID].MaxLv then
				SystemNotice(role, "Fairy has reached it's maximum level to feed with this kind of fruits!")
				UseItemFailed(role)
				return
			end
			local Elf_EXP		= GetItemAttr(Item_Target, ITEMATTR_ENERGY)
			local Elf_MaxEXP 	= GetItemAttr(Item_Target, ITEMATTR_MAXENERGY)
			local Elf_MaxURE 	= GetItemAttr(Item_Target, ITEMATTR_MAXURE)
			local Elf_ExpNeed	= FairyFood[ItemID].Energy * Elf_MaxEXP
			if Elf_EXP < Elf_ExpNeed then
				SystemNotice(role, "Minimum fairy growth is "..Elf_ExpNeed.." to feed with this kind of fruits!")
				UseItemFailed(role)
				return		
			end
			local Lv_Add	= FairyFood[ItemID].AttrAdd
			local Final_Lv	= FairyLv + Lv_Add
			if Final_Lv > FairyFood[ItemID].MaxLv then
				Lv_Add = Lv_Add - (Final_Lv - FairyFood[ItemID].MaxLv)
			end
			local Success = 0
			if FairyLv >= 0 and FairyLv < 5 then Success = 1
			elseif FairyLv >= 05 and FairyLv < 10 then Success = 0.9
			elseif FairyLv >= 10 and FairyLv < 15 then Success = 0.8
			elseif FairyLv >= 15 and FairyLv < 20 then Success = 0.7
			elseif FairyLv >= 20 and FairyLv < 25 then Success = 0.6
			elseif FairyLv >= 25 and FairyLv < 30 then Success = 0.5
			elseif FairyLv >= 30 and FairyLv < 35 then Success = 0.4
			elseif FairyLv >= 35 and FairyLv < 42 then Success = 0.3
			elseif FairyLv >= 42 and FairyLv < 60 then Success = 0.5
			else Success = 0 end

			local SuccessRate = Percentage_Random(Success)
			if SuccessRate == 1 then
				AddItemEffect(role, Item_Target , 0  )
				Attr_Type_Num = Attr_Type_Num + Lv_Add
				SetItemAttr(Item_Target, FairyFood[ItemID].AttrType, Attr_Type_Num)
				local Item_MAXENERGY = 240 * (FairyLv + Lv_Add)
				if Item_MAXENERGY > 6480 then
					Item_MAXENERGY = 6480
				end
				local Item_MAXURE_NUM = Elf_MaxURE + 1000
				if Item_MAXURE_NUM > 32000 then
					Item_MAXURE_NUM = 32000
				end
				Elf_EXP = 0
				SetItemAttr(Item_Target, ITEMATTR_ENERGY, Elf_EXP)
				SetItemAttr(Item_Target, ITEMATTR_MAXENERGY, Item_MAXENERGY)
				SetItemAttr(Item_Target, ITEMATTR_MAXURE, Item_MAXURE_NUM)
				ResetItemFinalAttr(Item_Target)
				AddItemEffect(role , Item_Target , 1  )
				SystemNotice (role , "Pet level up successfully! Growth rate is depleted")
			else
				Elf_EXP = Elf_EXP * 0.5
				SetItemAttr(Item_Target, ITEMATTR_ENERGY, Elf_EXP)
				SystemNotice(role, "Pet level up failed! Growth rate reduced by half")
			end
		else
			SystemNotice(role, "Fairy or Fruit is invalid!")
			UseItemFailed(role) 
			return
		end
	else
		SystemNotice(role , "Internal error!") 
		UseItemFailed(role) 
		return
	end
end

function Eclipse_GrowthFruit(role,Item)
	if (IsChaStall(role) == LUA_TRUE) then
		SystemNotice(role, "Cannot use while your stall is opened!" )
		UseItemFailed(role)
		return
	end
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat(role)
	if Cha_Boat ~= nil then
		SystemNotice(role, "Cannot use while sailing!")
		UseItemFailed(role)
		return
	end
	local GrowthFruit = {}
	GrowthFruit[578] = {StateType = STATE_JLJSGZ, StateLv = 1, StateTime = 900}		--Fruit of Growth
	GrowthFruit[9501] = {StateType = STATE_JLJSGZ, StateLv = 2, StateTime = 900}	--Strawberry
	GrowthFruit[9502] = {StateType = STATE_JLJSGZ, StateLv = 4, StateTime = 900}	--Cranberry
	GrowthFruit[9503] = {StateType = STATE_JLJSGZ, StateLv = 3, StateTime = 1800}	--Papaya
	GrowthFruit[9504] = {StateType = STATE_JLJSGZ, StateLv = 6, StateTime = 1800}	--Pineapple
	local ItemID = GetItemID(Item)
	if GrowthFruit[ItemID] ~= nil then
		local ChaStateLv = GetChaStateLv(role, GrowthFruit[ItemID].StateType)
		if ChaStateLv >= GrowthFruit[ItemID].StateLv then
			SystemNotice(role, "Better or same fruit in effect. Please try again later!")
			UseItemFailed(role)
			return
		else
			AddState(role, role, GrowthFruit[ItemID].StateType, GrowthFruit[ItemID].StateLv, GrowthFruit[ItemID].StateTime)
		end
	else
		SystemNotice(role, "Internal error!")
		UseItemFailed(role)
		return
	end
end

function Eclipse_RecoveryFood(role,Item)
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat(role)
	if Cha_Boat ~= nil then 
		SystemNotice(role, "Cannot use while sailing!") 
		UseItemFailed(role) 
		return 
	end
	local Food = {}
	Food[263] = {HP = 1000, SP = 0, MapRestriction = 0, PotCD = 0}	--Dumpling
	Food[1847] = {HP = 20, SP = 0, MapRestriction = 0, PotCD = 0}	--Apple
	Food[1848] = {HP = 80, SP = 0, MapRestriction = 0, PotCD = 1}	--Bread
	Food[1849] = {HP = 180, SP = 0, MapRestriction = 0, PotCD = 1}	--Cake
	Food[3460] = {HP = 180, SP = 0, MapRestriction = 0, PotCD = 1}	--Cake
	Food[3116] = {HP = 15, SP = 0, MapRestriction = 0, PotCD = 0}	--Elven Fruit
	Food[3117] = {HP = 20, SP = 0, MapRestriction = 0, PotCD = 0}	--Red Date
	Food[3118] = {HP = 35, SP = 0, MapRestriction = 0, PotCD = 0}	--Mushroom
	Food[3119] = {HP = 40, SP = 0, MapRestriction = 0, PotCD = 0}	--Stramonium Fruit
	Food[3120] = {HP = 50, SP = 0, MapRestriction = 0, PotCD = 0}	--Ice Fruit
	Food[3121] = {HP = 108, SP = 0, MapRestriction = 0, PotCD = 0}	--Rainbow Fruit
	Food[3122] = {HP = 250, SP = 0, MapRestriction = 0, PotCD = 2}	--Elven Fruit Juice
	Food[3123] = {HP = 300, SP = 0, MapRestriction = 0, PotCD = 2}	--Red Date Tea
	Food[3124] = {HP = 350, SP = 0, MapRestriction = 0, PotCD = 3}	--Mushroom Soup
	Food[3125] = {HP = 400, SP = 0, MapRestriction = 0, PotCD = 3} 	--Stramonium Fruit Juice
	Food[3126] = {HP = 450, SP = 0, MapRestriction = 0, PotCD = 4} 	--Ice Cream
	Food[3127] = {HP = 500, SP = 0, MapRestriction = 0, PotCD = 4} 	--Rainbow Fruit Juice
	Food[3128] = {HP = 550, SP = 0, MapRestriction = 0, PotCD = 5} 	--Fruity Mix
	Food[3461] = {HP = 550, SP = 0, MapRestriction = 0, PotCD = 5} 	--Fruity Mix
	Food[3129] = {HP = 0, SP = 4, MapRestriction = 0, PotCD = 0}   	--Medicated Grass
	Food[3130] = {HP = 0, SP = 8, MapRestriction = 0, PotCD = 0}   	--Fancy Petal
	Food[3131] = {HP = 0, SP = 18, MapRestriction = 0, PotCD = 0}	--Strange Fruit
	Food[3132] = {HP = 0, SP = 22, MapRestriction = 0, PotCD = 0}	--Snowy Grass Bud
	Food[3133] = {HP = 0, SP = 33, MapRestriction = 0, PotCD = 0}	--Liquorice Potion
	Food[3134] = {HP = 0, SP = 38, MapRestriction = 0, PotCD = 0}	--Energetic Tea
	Food[3135] = {HP = 0, SP = 41, MapRestriction = 0, PotCD = 0}	--Special Ointment
	Food[3136] = {HP = 0, SP = 59, MapRestriction = 0, PotCD = 0}	--Snowy Soft Bud
	Food[3137] = {HP = 0, SP = 100, MapRestriction = 0, PotCD = 0}	--Tiamari Fruit
	Food[3138] = {HP = 0, SP = 111, MapRestriction = 0, PotCD = 0}	--Mystery Fruit
	Food[3139] = {HP = 0, SP = 141, MapRestriction = 0, PotCD = 0}	--Agrypnotic
	Food[3140] = {HP = 0, SP = 201, MapRestriction = 0, PotCD = 0}	--Magical Potion
	Food[3848] = {HP = 800, SP = 0, MapRestriction = 0, PotCD = 6}	--Consitution Recovery Vial
	Food[3098] = {HP = 1000, SP = 0, MapRestriction = 0, PotCD = 6}	--Constitution Recovery Flask
	Food[3899] = {HP = 30, SP = 10, MapRestriction = 0, PotCD = 0}	--Christmas Lollipop
	Food[3910] = {HP = 100, SP = 100, MapRestriction = 0, PotCD = 0}--Super Candy Stick
	Food[5626] = {HP = 1500, SP = 0, MapRestriction = 0, PotCD = 8}	--Super HP Potion
	Food[5627] = {HP = 0, SP = 250, MapRestriction = 0, PotCD = 0}	--Sweet Nectar
	Food[6203] = {HP = 235, SP = 0, MapRestriction = 0, PotCD = 4}	--Burger
	Food[6204] = {HP = 280, SP = 0, MapRestriction = 0, PotCD = 4}	--Roasted Suckling Pig
	Food[6589] = {HP = 20, SP = 0, MapRestriction = 0, PotCD = 0}	--Normal Dumpling
	Food[3099] = {HP = 0, SP = 150, MapRestriction = 0, PotCD = 0}	--SP Holy Water
	Food[6408] = {HP = 0, SP = 150, MapRestriction = 0, PotCD = 0}	--SP Holy Water
	
	local RestrictedMazes = {}
	RestrictedMazes["garner2"] = true
	
	
	local ItemID = GetItemID(Item)

	if Food[ItemID] ~= nil then
	
		local ChaName = GetChaDefaultName(role)
		--local chapot = ChaName .. tostring(itemID) -- For separated CD
		local chapot = ChaName -- For shared CD

		if CharPotCD[chapot] == nil then
			CharPotCD[chapot] = { UsedTime = os.time() }
		end
		
		local cooldown = CharPotCD[chapot].UsedTime - os.time()
		if cooldown > 0 then
			SystemNotice(role,"CD on effect! Wait "..cooldown.." second(s)!")
			UseItemFailed(role)
			return
		end
		
		local char_map = GetChaMapName(role)
		local hp_resume = Food[ItemID].HP

		if RestrictedMazes[char_map] then
			if Food[ItemID].MapRestriction == 1 then
				SystemNotice(role, "This pot is forbidden in this map.")
				UseItemFailed(role)
				return
			end
		end
		
		if hp_resume ~= 0 then
	
			
			local hp = GetChaAttr(role, ATTR_HP)
			local mxhp = GetChaAttr(role,ATTR_MXHP)
			if hp <= 0 then
				UseItemFailed(role)
				return	
			end
			hp = hp + hp_resume
			if hp > mxhp then
				hp = mxhp
			end
			SetCharaAttr(hp, role, ATTR_HP)
			SystemNotice(role,"Recovered "..hp_resume.." HP!")
		end
		
		local sp_resume = Food[ItemID].SP
		
		if sp_resume ~= 0 then
			local sp = GetChaAttr(role, ATTR_SP)
			local mxsp = GetChaAttr(role,ATTR_MXSP)
			if sp <= 0 then
				UseItemFailed(role)
				return	
			end
			sp = sp + sp_resume
			if sp > mxsp then
				sp = mxsp
			end
			SetCharaAttr(sp, role, ATTR_SP)
			SystemNotice(role,"Recovered "..hp_resume.." SP!")
		end
		
		local cd = Food[ItemID].PotCD
		CharPotCD[chapot] = { UsedTime = (os.time()+cd) }
	end
end

function Eclipse_RecoveryFood2(role,Item)
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat(role)
	if Cha_Boat ~= nil then 
		SystemNotice(role, "Cannot use while sailing!") 
		UseItemFailed(role) 
		return 
	end
	local Food = {}
	Food[3909] = {HP = 0.3, SP = 0, MapRestriction = 1, PotCD = 10}		--Gyoza
	Food[5629] = {HP = 0.35, SP = 0, MapRestriction = 1, PotCD = 12}	--Superman Dumplings
	Food[6590] = {HP = 0.1, SP = 0.1, MapRestriction = 1, PotCD = 8}	--Fresh Meat Dumpling
	Food[6591] = {HP = 0.15, SP = 0.15, MapRestriction = 1, PotCD = 9}	--Seafood Dumpling
	Food[6592] = {HP = 0.25, SP = 0.25, MapRestriction = 1, PotCD = 10}	--Mix Dumpling
	
	local RestrictedMazes = {}
	RestrictedMazes["garner2"] = true
	
	local ItemID = GetItemID(Item)
	if Food[ItemID] ~= nil then
	
		local ChaName = GetChaDefaultName(role)
		--local chapot = ChaName .. tostring(itemID) -- For separated CD
		local chapot = ChaName -- For shared CD

		if CharPotCD[chapot] == nil then
			CharPotCD[chapot] = { UsedTime = os.time() }
		end
		
		local cooldown = CharPotCD[chapot].UsedTime - os.time()
		if cooldown > 0 then
			SystemNotice(role,"CD on effect! Wait "..cooldown.." second(s)!")
			UseItemFailed(role)
			return
		end
	
		local char_map = GetChaMapName(role)
		local hp_resume_pct = Food[ItemID].HP

		if RestrictedMazes[char_map] then
			if Food[ItemID].MapRestriction == 1 then
				SystemNotice(role, "This pot is forbidden in this map.")
				UseItemFailed(role)
				return
			end
		end
		
	
		if hp_resume_pct ~= 0 then
			local hp = GetChaAttr(role, ATTR_HP)
			local mxhp = GetChaAttr(role,ATTR_MXHP)
			if hp <= 0 then
				UseItemFailed(role)
				return	
			end
			hp = hp + mxhp * hp_resume_pct
			if hp > mxhp then
				hp = mxhp
			end
			SetCharaAttr(hp, role, ATTR_HP)
			SystemNotice(role,"Recovered a great amount of your HP!")
		end
		
		local sp_resume_pct = Food[ItemID].SP
				
		if sp_resume_pct ~= 0 then
			local sp = GetChaAttr(role, ATTR_SP)
			local mxsp = GetChaAttr(role,ATTR_MXSP)
			if sp <= 0 then
				UseItemFailed(role)
				return	
			end
			sp = sp + mxsp * sp_resume_pct
			if sp > mxsp then
				sp = mxsp
			end
			SetCharaAttr(sp, role, ATTR_SP)
			SystemNotice(role,"Recovered a great amount of your SP!")
		end
		
		local cd = Food[ItemID].PotCD
		CharPotCD[chapot] = { UsedTime = (os.time()+cd) }
	end
end

function Eclipse_RecoveryFood3(role,Item)
	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat(role)
	if Cha_Boat ~= nil then 
		SystemNotice(role, "Cannot use while sailing!") 
		UseItemFailed(role) 
		return 
	end
	local Food = {}
	Food[6407] = {HP = 200, SP = 0, State = 166, StateLv = 1, StateTime = 900}	--Steam Bun
	Food[1078] = {HP = 200, SP = 0, State = 166, StateLv = 1, StateTime = 900}	--Steam Bun
	Food[1079] = {HP = 400, SP = 0, State = 166, StateLv = 2, StateTime = 600}	--Bun
	Food[1080] = {HP = 600, SP = 0, State = 166, StateLv = 3, StateTime = 420}	--Biscuit
	Food[1082] = {HP = 800, SP = 0, State = 166, StateLv = 4, StateTime = 300}	--Fried Dough
	Food[1083] = {HP = 1000, SP = 0, State = 166, StateLv = 5, StateTime = 120}	--Spring Roll
	Food[1084] = {HP = 0, SP = 100, State = 167, StateLv = 1, StateTime = 900}	--Maiden Wine
	Food[1085] = {HP = 0, SP = 200, State = 167, StateLv = 2, StateTime = 600}	--Scholar Wine
	Food[1088] = {HP = 0, SP = 300, State = 167, StateLv = 3, StateTime = 420}	--Dukan Wine
	Food[1087] = {HP = 0, SP = 400, State = 167, StateLv = 4, StateTime = 300}	--Mao Wine
	Food[1089] = {HP = 0, SP = 500, State = 167, StateLv = 5, StateTime = 180}	--Ginseng Wine
	Food[1090] = {HP = 0, SP = 600, State = 167, StateLv = 6, StateTime = 120}	--Tiger Bone Tonic
	Food[4019] = {HP = 0, SP = 0, State = 165, StateLv = 1, StateTime = 900}	--Codfish Steamboat
	Food[4020] = {HP = 0, SP = 0, State = 165, StateLv = 2, StateTime = 600}	--Sturgeon Fish with Bamboo
	Food[4021] = {HP = 0, SP = 0, State = 165, StateLv = 3, StateTime = 600}	--Savory Bubble Fish
	Food[4022] = {HP = 0, SP = 0, State = 165, StateLv = 4, StateTime = 480}	--Sturgeon Soup
	Food[4023] = {HP = 0, SP = 0, State = 165, StateLv = 5, StateTime = 480}	--Fried Oyster Soup
	Food[4024] = {HP = 0, SP = 0, State = 165, StateLv = 6, StateTime = 360}	--Prawn Dumpling
	Food[4025] = {HP = 0, SP = 0, State = 165, StateLv = 7, StateTime = 300}	--Tigerfish Bone Crisp
	Food[4026] = {HP = 0, SP = 0, State = 165, StateLv = 8, StateTime = 180}	--Ratfish Rice
	Food[4027] = {HP = 0, SP = 0, State = 165, StateLv = 9, StateTime = 180}	--China Clay
	Food[4028] = {HP = 0, SP = 0, State = 165, StateLv = 10, StateTime = 60}	--BBQ Shark Fin
	local ItemID = GetItemID(Item)
	if Food[ItemID] ~= nil then
		if Food[ItemID].HP ~= 0 then
			local hp = GetChaAttr(role, ATTR_HP)
			local mxhp = GetChaAttr(role,ATTR_MXHP)
			if hp <= 0 then
				UseItemFailed(role)
				return	
			end
			hp = hp + Food[ItemID].HP
			if hp > mxhp then
				hp = mxhp
			end
			SetCharaAttr(hp, role, ATTR_HP)
		end
		if Food[ItemID].SP ~= 0 then
			local sp = GetChaAttr(role, ATTR_SP)
			local mxsp = GetChaAttr(role,ATTR_MXSP)
			if sp <= 0 then
				UseItemFailed(role)
				return	
			end
			sp = sp + Food[ItemID].SP
			if sp > mxsp then
				sp = mxsp
			end
			SetCharaAttr(sp, role, ATTR_SP)
		end
		if Food[ItemID].State ~= 0 then
			local ChaStateLv = GetChaStateLv(role, Food[ItemID].State)
			if ChaStateLv > Food[ItemID].StateLv then
				SystemNotice(role, "You have used a higher level item of the same kind. Please try again later!")
				UseItemFailed(role)
				return
			end
			AddState(role, role, Food[ItemID].State, Food[ItemID].StateLv, Food[ItemID].StateTime)			
		end
	end
end

---Water Break Set
function ItemUse_framestone( role, Item )

	local lv = GetChaAttr(role, ATTR_LV)
	local job = GetChaAttr( role, ATTR_JOB) --取职业
	local cha_type = GetChaTypeID ( role )
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 4 then
		SystemNotice(role ,"To open Water Break Chestguard requires 4 empty slots")
		UseItemFailed ( role )
		return
	end
	if lv < 65 then
		SystemNotice(role ,"Current level below 65, unable to use item!")
		UseItemFailed ( role )
		return
	end
	if cha_type == 1 and job==9 then
		GiveItem ( role , 0 , 6284 , 1 , 4 )----------------Crussader	
		GiveItem ( role , 0 , 6285 , 1 , 4 )----------------Crussader	
		GiveItem ( role , 0 , 6286 , 1 , 4 )----------------Crussader	
	elseif cha_type == 2 and job==8 then
		GiveItem ( role , 0 , 6281  , 1 , 4 )-----------------Champion
		GiveItem ( role , 0 , 6282  , 1 , 4 )-----------------Champion
		GiveItem ( role , 0 , 6283  , 1 , 4 )-----------------Champion
	elseif cha_type == 3 and job==9 then
		GiveItem ( role , 0 , 6284  , 1 , 4 )-----------------Crussader Phyllis
		GiveItem ( role , 0 , 6285  , 1 , 4 )-----------------Crussader Phyllis
		GiveItem ( role , 0 , 6286  , 1 , 4 )-----------------Crussader Phyllis
	elseif cha_type == 3 and job==12 then
		GiveItem ( role , 0 , 6287  , 1 , 4 )----------------Sharpshooter
		GiveItem ( role , 0 , 6288  , 1 , 4 )----------------Sharpshooter
		GiveItem ( role , 0 , 6289  , 1 , 4 )----------------Sharpshooter
	elseif cha_type == 1 and job==12 then
		GiveItem ( role , 0 , 6287  , 1 , 4 )----------------Sharpshooter
		GiveItem ( role , 0 , 6288  , 1 , 4 )----------------Sharpshooter
		GiveItem ( role , 0 , 6289  , 1 , 4 )----------------Sharpshooter
	elseif cha_type == 3 and job==13 then
	        GiveItem ( role , 0 , 6290  , 1 , 4 )----------------Cleric
	        GiveItem ( role , 0 , 6291  , 1 , 4 )----------------Cleric
	        GiveItem ( role , 0 , 6292  , 1 , 4 )----------------Cleric
	elseif cha_type == 4 and job==13 then
	        GiveItem ( role , 0 , 6290  , 1 , 4 )----------------Cleric Ami
	        GiveItem ( role , 0 , 6291  , 1 , 4 )----------------Cleric Ami
	        GiveItem ( role , 0 , 6292  , 1 , 4 )----------------Cleric Ami
	elseif cha_type == 3 and job==14 then
	        GiveItem ( role , 0 , 6499  , 1 , 4 )----------------Seal Master
	        GiveItem ( role , 0 , 6500  , 1 , 4 )----------------Seal Master
	        GiveItem ( role , 0 , 6501  , 1 , 4 )----------------Seal Master
	elseif cha_type == 4 and job==14 then
	        GiveItem ( role , 0 , 6499  , 1 , 4 )----------------Seal Master Ami
	        GiveItem ( role , 0 , 6500  , 1 , 4 )----------------Seal Master Ami
	        GiveItem ( role , 0 , 6501  , 1 , 4 )----------------Seal Master Ami
	elseif cha_type == 1 and job==16 then
	        GiveItem ( role , 0 , 6502  , 1 , 4 )----------------Voyager Lance
	        GiveItem ( role , 0 , 6503  , 1 , 4 )----------------Voyager Lance
	        GiveItem ( role , 0 , 6504  , 1 , 4 )----------------Voyager Lance
	elseif cha_type == 3 and job==16 then
	        GiveItem ( role , 0 , 6502  , 1 , 4 )----------------Voyager Phyllis
	        GiveItem ( role , 0 , 6503  , 1 , 4 )----------------Voyager Phyllis
	        GiveItem ( role , 0 , 6504  , 1 , 4 )----------------Voyager Phyllis
	elseif cha_type == 4 and job==16 then
	        GiveItem ( role , 0 , 6502  , 1 , 4 )----------------Voyager Ami
	        GiveItem ( role , 0 , 6503  , 1 , 4 )----------------Voyager Ami
	        GiveItem ( role , 0 , 6504  , 1 , 4 )----------------Voyager Ami
	else 
		SystemNotice(role ,"Cannot be used right now, please find the class instructors to change class.")
		UseItemFailed ( role )
		return
	end
end
--10k Note 
function ItemUse_10kgold( role , Item ) 							
 	local Money_add = 10000
	local Money_Have = GetChaAttr ( role , ATTR_GD )
	if Money_Have>=999900000 then
		SystemNotice (role, "Your Inventory is passed 999m Unable to use.")
		UseItemFailed ( role )
		return	
	end
	AddMoney ( role , 0 , Money_add )
end 

--10k Note
function ItemUse_100kgold( role , Item ) 							
 	local Money_add = 100000
	local Money_Have = GetChaAttr ( role , ATTR_GD )
	if Money_Have>=999900000 then
		SystemNotice (role, "Your Inventory is passed 999m Unable to use.")
		UseItemFailed ( role )
		return	
	end
	AddMoney ( role , 0 , Money_add )
end 

function ItemUse_dschar(role)

	local lvl = GetChaAttr( role , ATTR_LV )
	local exp = GetChaAttr( role , ATTR_CEXP )
	local ret = HasMaster(role)
	if ret == LUA_TRUE then
		SystemNotice( role , "You Have a mentor! Unable to use this!" )
		UseItemFailed ( role )
		return 0
	end

	if lvl >= 2 and lvl <=55 then
		SystemNotice( role , "Only a brand new level 1 character can become an 55 character." )
		UseItemFailed ( role )
		return 0
	end


		SetChaAttr(role, ATTR_CEXP , 19674240)
		SystemNotice ( role ,"Congrats you are Reborned to 55 caracter now. Please Relog !")
		return 1
end
function ItemUse_CrackedGem( role , Item )
	local cha = TurnToCha ( role ) 
	local cha_type = GetChaTypeID ( cha ) 
	local cha_name = GetChaDefaultName ( role )	
	
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	 if Item_CanGet < 2 then
		SystemNotice(role ,"Inventory requires at least 2 empty slots to use Random Cracked Gem Chest")
		UseItemFailed ( role )
		return
	end
	local rad = math.random ( 1, 8 )
	if rad ==1 then --Striking
	GiveItem ( role , 0 , 6821  , 1 , 4 )		
	LG('Random Cracked',''..cha_name..' has opened Random Cracked Gem Chest and obtained 1x '..GetItemName(6821)..'!')
	end
	if rad ==2 then --Soul
	GiveItem ( role , 0 , 6830  , 1 , 4 )
	LG('Random Cracked',''..cha_name..' has opened Random Cracked Gem Chest and obtained 1x '..GetItemName(6830)..'!')
	end
	if rad ==3 then --Colo
	GiveItem ( role , 0 , 6824  , 1 , 4 )
	LG('Random Cracked',''..cha_name..' has opened Random Cracked Gem Chest and obtained 1x '..GetItemName(6824)..'!')
	end
	if rad ==4 then --Wind
	GiveItem ( role , 0 , 6818  , 1 , 4 )
	LG('Random Cracked',''..cha_name..' has opened Random Cracked Gem Chest and obtained 1x '..GetItemName(6818)..'!')
	end
	if rad ==5 then --Rage
	GiveItem ( role , 0 , 6827  , 1 , 4)	
	LG('Random Cracked',''..cha_name..' has opened Random Cracked Gem Chest and obtained 1x '..GetItemName(6827)..'!')	
	end
	if rad ==6 then --Soul
	GiveItem ( role , 0 , 6830  , 1 , 4 )
	LG('Random Cracked',''..cha_name..' has opened Random Cracked Gem Chest and obtained 1x '..GetItemName(6830)..'!')
	end
	if rad ==7 then --Wind
	GiveItem ( role , 0 , 6818  , 1 , 4 )
	LG('Random Cracked',''..cha_name..' has opened Random Cracked Gem Chest and obtained 1x '..GetItemName(6818)..'!')
	end
	if rad ==8 then --Striking
	GiveItem ( role , 0 , 6821  , 1 , 4 )		
	LG('Random Cracked',''..cha_name..' has opened Random Cracked Gem Chest and obtained 1x '..GetItemName(6821)..'!')
	end
end

function ItemUse_BrokenGem( role , Item )
	local cha = TurnToCha ( role ) 
	local cha_type = GetChaTypeID ( cha ) 
	local cha_name = GetChaDefaultName ( role )	
	
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	
	 if Item_CanGet < 2 then
		SystemNotice(role ,"Inventory requires at least 2 empty slots to use Random Normal Gem Chest")
		UseItemFailed ( role )
		return
	end
	local rad = math.random ( 1, 5 )
	if rad ==1 then --Striking
	GiveItem ( role , 0 , 878  , 1 , 4 )		
	LG('Random Normal',''..cha_name..' has opened Random Normal Gem Chest and obtained 1x '..GetItemName(878)..'!')
	end
	if rad ==2 then --Soul
	GiveItem ( role , 0 , 879  , 1 , 4 )
	LG('Random Normal',''..cha_name..' has opened Random Normal Gem Chest and obtained 1x '..GetItemName(879)..'!')
	end
	if rad ==3 then --Colo
	GiveItem ( role , 0 , 880  , 1 , 4 )
	LG('Random Normal',''..cha_name..' has opened Random Normal Gem Chest and obtained 1x '..GetItemName(880)..'!')
	end
	if rad ==4 then --Wind
	GiveItem ( role , 0 , 881  , 1 , 4 )
	LG('Random Normal',''..cha_name..' has opened Random Normal Gem Chest and obtained 1x '..GetItemName(881)..'!')
	end
	if rad ==5 then --Rage
	GiveItem ( role , 0 , 887  , 1 , 4)	
	LG('Random Normal',''..cha_name..' has opened Random Normal Gem Chest and obtained 1x '..GetItemName(887)..'!')	
	end
end

--- Brokne and Cracked Gem Vouncher


function ItemUse_brokenR( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		SystemNotice( role , "Not available when going to sea" ) 
		UseItemFailed ( role ) 
		return 
	end      
	local job = GetChaAttr(role, ATTR_JOB)
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 4 then
		SystemNotice(role ,"To open gem vouncher you need at last 1 slot free on bag")
		UseItemFailed ( role )
		return
	end 
		GiveItem ( role , 0 , 6826 , 1 , 101 )
end


function ItemUse_brokenC( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		SystemNotice( role , "Not available when going to sea" ) 
		UseItemFailed ( role ) 
		return 
	end      
	local job = GetChaAttr(role, ATTR_JOB)
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 4 then
		SystemNotice(role ,"To open gem vouncher you need at last 1 slot free on bag")
		UseItemFailed ( role )
		return
	end 
		GiveItem ( role , 0 , 6823 , 1 , 101 )
end
	
	

	
function ItemUse_brokenST( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		SystemNotice( role , "Not available when going to sea" ) 
		UseItemFailed ( role ) 
		return 
	end      
	local job = GetChaAttr(role, ATTR_JOB)
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 4 then
		SystemNotice(role ,"To open gem vouncher you need at last 1 slot free on bag")
		UseItemFailed ( role )
		return
	end 
		GiveItem ( role , 0 , 6820 , 1 , 101 )
end	


function ItemUse_brokenW( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		SystemNotice( role , "Not available when going to sea" ) 
		UseItemFailed ( role ) 
		return 
	end      
	local job = GetChaAttr(role, ATTR_JOB)
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 4 then
		SystemNotice(role ,"To open gem vouncher you need at last 1 slot free on bag")
		UseItemFailed ( role )
		return
	end 
		GiveItem ( role , 0 , 6817 , 1 , 101 )
end


function ItemUse_brokenS( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		SystemNotice( role , "Not available when going to sea" ) 
		UseItemFailed ( role ) 
		return 
	end      
	local job = GetChaAttr(role, ATTR_JOB)
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 4 then
		SystemNotice(role ,"To open gem vouncher you need at last 1 slot free on bag")
		UseItemFailed ( role )
		return
	end 
		GiveItem ( role , 0 , 6829 , 1 , 101 )
end




function ItemUse_brokenCS( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		SystemNotice( role , "Not available when going to sea" ) 
		UseItemFailed ( role ) 
		return 
	end      
	local job = GetChaAttr(role, ATTR_JOB)
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 4 then
		SystemNotice(role ,"To open gem vouncher you need at last 1 slot free on bag")
		UseItemFailed ( role )
		return
	end 
		GiveItem ( role , 0 , 6830 , 1 , 101 )
end

function ItemUse_brokenCR( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		SystemNotice( role , "Not available when going to sea" ) 
		UseItemFailed ( role ) 
		return 
	end      
	local job = GetChaAttr(role, ATTR_JOB)
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 4 then
		SystemNotice(role ,"To open gem vouncher you need at last 1 slot free on bag")
		UseItemFailed ( role )
		return
	end 
		GiveItem ( role , 0 , 7138 , 1 , 101 )
end

function ItemUse_brokenCC( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		SystemNotice( role , "Not available when going to sea" ) 
		UseItemFailed ( role ) 
		return 
	end      
	local job = GetChaAttr(role, ATTR_JOB)
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 4 then
		SystemNotice(role ,"To open gem vouncher you need at last 1 slot free on bag")
		UseItemFailed ( role )
		return
	end 
		GiveItem ( role , 0 , 7135 , 1 , 101 )
end


function ItemUse_brokenCST( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		SystemNotice( role , "Not available when going to sea" ) 
		UseItemFailed ( role ) 
		return 
	end      
	local job = GetChaAttr(role, ATTR_JOB)
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 4 then
		SystemNotice(role ,"To open gem vouncher you need at last 1 slot free on bag")
		UseItemFailed ( role )
		return
	end 
		GiveItem ( role , 0 , 7132 , 1 , 101 )
end

function ItemUse_brokenCWI( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		SystemNotice( role , "Not available when going to sea" ) 
		UseItemFailed ( role ) 
		return 
	end      
	local job = GetChaAttr(role, ATTR_JOB)
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 4 then
		SystemNotice(role ,"To open gem vouncher you need at last 1 slot free on bag")
		UseItemFailed ( role )
		return
	end 
		GiveItem ( role , 0 , 7129 , 1 , 101 )
end


function ItemUse_Refstack( role , Item )

	local Cha_Boat = 0
	Cha_Boat = GetCtrlBoat ( role )
	if Cha_Boat ~= nil then 
		SystemNotice( role , "Not available when going to sea" ) 
		UseItemFailed ( role ) 
		return 
	end      
	local job = GetChaAttr(role, ATTR_JOB)
	local Item_CanGet = GetChaFreeBagGridNum ( role )
	if Item_CanGet < 4 then
		SystemNotice(role ,"To open ref vouncher you need at last 1 slot free on bag")
		UseItemFailed ( role )
		return
	end 
		GiveItem ( role , 0 , 0885 , 1 , 101 )
end